import{_ as V,B as D,E as I,C as P,k as p,W as R,o as l,l as d,F as r,G as v,v as t,L as A,m as C,P as W,q as g,J as B,K as z,x as b,ad as F,a2 as N,s as U,aD as E,ag as Q,T as j,D as K,t as q,I as S,Z as J,c as T,A as G,ah as X,X as $,O as Z}from"../../../../v9.4.0.5/chunks/bootstrap.js";import{U as Y,r as x,A as ee}from"../../../../v9.4.0.5/chunks/adminRouter.js";import{a as ae,d as te}from"../../../../v9.4.0.5/chunks/DataTableActions.js";import{D as se}from"../../../../v9.4.0.5/chunks/DataTableIsDefault.js";import{C as ne}from"../../../../v9.4.0.5/chunks/Checkbox.js";import"../../../../v9.4.0.5/chunks/vue-router.js";import"../../../../v9.4.0.5/chunks/FormGenerator.js";import"../../../../v9.4.0.5/chunks/AdminNavigationBar.js";import"../../../../v9.4.0.5/chunks/HelpSection.js";const le={name:"ldap-list-page",data:function(){return{dataToDisplay:["domain","port","encryption","username"],adList:[],hideDefaultLogin:!1,isLoading:!1}},beforeMount(){this.getLdapList()},methods:{getLdapList(){this.isLoading=!0,D.get("api/ldap/settings").then(e=>{this.adList=e.data.data.ldap_list,this.hideDefaultLogin=e.data.data.hide_default_login}).catch(e=>{I(e,"ldap-list-page")}).finally(()=>{this.isLoading=!1})},deleteItem(e){confirm("Are you sure you want to delete?")&&(this.isLoading=!0,D.delete("api/ldap/settings/"+e).then(n=>{P(n,"ldap-list-page"),this.getLdapList()}).catch(n=>{I(n,"ldap-list-page")}).finally(()=>{this.isLoading=!1}))},updateHideDefaultLogin(){this.isLoading=!0;const e={hide_default_login:this.hideDefaultLogin};D.post("api/ldap/hide-default-login",e).then(a=>{P(a,"ldap-list-page")}).catch(a=>{I(a,"ldap-list-page")}).finally(()=>{this.isLoading=!1})}}},ie={class:"col-sm-12"},oe={class:"card-tools d-flex mt-1"},de={class:"btn-tool"},re={class:"list-group"},pe={class:"row"},ue={class:"col-md-2"},ce={class:"ldap-schema-img"},he=["src","alt"],me={class:"description-header"},ge={class:"description-text"},_e={class:"col-md-2 description-block action-block float-end"},fe={class:"fas fa-edit","aria-hidden":"true"},be=["onClick"],ye={class:"fas fa-trash","aria-hidden":"true"};function ve(e,a,n,o,i,s){const u=p("alert"),w=p("custom-loader"),c=p("router-link"),k=p("faveo-box"),y=R("tooltip");return l(),d("div",ie,[r(k,{title:e.trans("ldap_list")},{headerMenu:v(()=>[t("div",oe,[A((l(),C(c,{class:"btn btn-tool",to:"/ldap/settings/create"},{default:v(()=>a[2]||(a[2]=[t("i",{class:"glyphicon glyphicon-plus","aria-hidden":"true"},null,-1)])),_:1})),[[y,{content:e.trans("configure_new_ldap"),placement:"left"}]]),A((l(),d("span",de,[A(t("input",{class:"hide-checkbox",type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=f=>e.hideDefaultLogin=f),onChange:a[1]||(a[1]=f=>s.updateHideDefaultLogin())},null,544),[[W,e.hideDefaultLogin]])])),[[y,{content:e.trans("hide_default_login"),placement:"left"}]])])]),default:v(()=>[r(u,{componentName:"ldap-list-page"}),e.isLoading?(l(),C(w,{key:0,duration:4e3})):g("",!0),t("div",re,[(l(!0),d(B,null,z(e.adList,f=>(l(),d("div",{class:"list-group-item",key:f.id},[t("div",pe,[A((l(),d("div",ue,[t("div",ce,[t("img",{src:f.image_url,alt:f.schema,class:"w-100"},null,8,he)])])),[[y,e.trans(f.schema)]]),(l(!0),d(B,null,z(e.dataToDisplay,L=>(l(),d("div",{class:"col-md-2 description-block data-block",key:L},[t("h5",me,b(e.trans(L)),1),t("span",ge,b(f[L]?f[L]:"---"),1)]))),128)),t("div",_e,[r(c,{class:"btn btn-primary btn-sm",to:"/ldap/settings/"+f.id+"/edit"},{default:v(()=>[A(t("i",fe,null,512),[[y,e.trans("edit")]])]),_:2},1032,["to"]),t("button",{class:"btn btn-secondary btn-sm",onClick:L=>s.deleteItem(f.id)},[A(t("i",ye,null,512),[[y,e.trans("delete")]])],8,be)])])]))),128))])]),_:1},8,["title"])])}const we=V(le,[["render",ve],["__scopeId","data-v-6412ff2d"]]);function Ce(e){const{domain:a,username:n,password:o,ldap_label:i,forgot_password_link:s}=e;var u={domain:[a,"isRequired"],username:[n,"isRequired"],password:[o,"isRequired"],ldap_label:[i,"max(24)"]};const w=new F(N),{errors:c,isValid:k}=w.validate(u);return U.dispatch("setValidationError",c),{errors:c,isValid:k}}function ke(e){var a={};for(let s=0;s<e.length;s++){let u=[];u[0]=e[s].search_base,u[1]="isRequired",a["searchbase"+[s]]=u}const n=new F(N),{errors:o,isValid:i}=n.validate(a);return U.dispatch("setValidationError",o),{errors:o,isValid:i}}const Le={props:{ldapId:{type:String,default:""},addUser:{type:Function,default:function(){return null}},searchBaseArray:{type:Array,default:[]},getLdap:{type:Function,default:function(){return null}},showOrganization:{type:Boolean,default:!0},showDepartment:{type:Boolean,default:!0},showRole:{type:Boolean,default:!0},loadingValue:{type:Boolean,default:!0}},data:function(){return{name:"searchbase",iconClass:"fa fa-trash",is_valid:"",search_base:"",loading:this.loadingValue,loadingSpeed:4e3,usersArray:[{id:"user",name:"user"},{id:"admin",name:"admin"},{id:"agent",name:"agent"}],deletePopup:!1,containerStyle:{width:"500px"},searchValueId:"",indexValue:"",organization_ids:[]}},watch:{searchBaseArray(e){return e}},methods:{addQuery(){this.addUser({id:"",search_base:"",filter:"",user_type:"user",departments:[],organizations:[]})},onSearchBase(e,a){let n=a.replace("searchbase","");this.searchBaseArray[n].search_base=e},onFilter(e,a){let n=a.replace("filter-","");this.searchBaseArray[n].filter=e},onOrganizationChange(e,a){this.searchBaseArray[a].organizations=e},onDepartmentChange(e,a){this.searchBaseArray[a].departments=e},onHandle(e,a){this.searchBaseArray[a].user_type=e},confirmLdapPing(e,a){this.loading=!0,D.get("api/ldap/search-base/ping/"+this.ldapId,{params:{search_base:e,filter:a}}).then(n=>{this.loading=!1,P(n,"searchbase")}).catch(n=>{this.loading=!1,I(n,"searchbase")})},deleteUser(e,a){this.deletePopup=!0,e?(this.deletePopup=!0,this.searchValueId=e):this.indexValue=a},onSubmitDelete(){this.searchValueId?D.delete("api/ldap/search-base/"+this.searchValueId).then(e=>{this.deletePopup=!1,P(e,"searchbase"),this.getLdap(),this.searchValueId=""}).catch(e=>{I(e,"searchbase")}):(this.deletePopup=!1,U.dispatch("setAlert",{type:"success",message:"Successfully Deleted",component_name:"searchbase"}),this.searchBaseArray.splice(this.indexValue,1))},onClose(){this.deletePopup=!1,this.searchValueId=""},isValidSearchBase(){const{errors:e,isValid:a}=ke(this.searchBaseArray);return!!a},saveandImport(e,a){this.loading=!0;let n=_.each(e,function(o){o.user_type==="user"&&(o.department_ids=[]),o.user_type!=="user"&&(o.organization_ids=[]),o.departments&&(o.department_ids=E(o.departments)),o.organizations&&(o.organization_ids=E(o.organizations))});if(this.isValidSearchBase()){const o="/api/ldap/search-bases/"+this.ldapId;D.post(o,{search_bases:n,import:a}).then(i=>{this.loading=!1,P(i,"searchbase"),this.getLdap()}).catch(i=>{this.loading=!1,I(i,"searchbase")})}else this.loading=!1}},components:{"static-select":Q,"text-field":j,"dynamic-select":K}},De={key:0,class:"row"},Se={class:"modal-title"},Ie={class:"row"},Ae={class:"form-group col-sm-2"},Pe={for:"actions"},Be=["id","onClick","title"],Ve=["id","title","onClick"],ze={class:"row"},Me={class:"card-footer"},Te=["disabled"],Ue=["disabled"],qe=["disabled"];function Ee(e,a,n,o,i,s){const u=p("alert"),w=p("custom-loader"),c=p("modal"),k=p("text-field"),y=p("static-select"),f=p("dynamic-select"),L=p("faveo-box");return l(),d("div",null,[r(u,{componentName:"searchbase"}),e.loading===!0?(l(),d("div",De,[r(w,{duration:e.loadingSpeed},null,8,["duration"])])):g("",!0),e.deletePopup?(l(),C(c,{key:1,classname:"modal-sm",containerStyle:e.containerStyle,showModal:e.deletePopup,onClose:s.onClose},{title:v(()=>[t("h4",Se,b(e.lang("delete_search_base")),1)]),fields:v(()=>[t("span",null,b(e.lang("delete_confirmation_message")),1)]),controls:v(()=>[t("button",{type:"button",onClick:a[0]||(a[0]=h=>s.onSubmitDelete()),class:"btn btn-secondary"},[t("i",{class:q(e.iconClass),"aria-hidden":"true"},null,2),S(" "+b(e.lang("delete")),1)])]),_:1},8,["containerStyle","showModal","onClose"])):g("",!0),r(L,{title:e.lang("import_settings")},{actions:v(()=>[t("div",Me,[t("button",{class:"btn btn-primary update-btn",id:"query",onClick:a[1]||(a[1]=h=>s.saveandImport(n.searchBaseArray,!1)),disabled:e.loading},[a[6]||(a[6]=t("span",{class:"fas fa-save"},null,-1)),S(" "+b(e.lang("save")),1)],8,Te),t("button",{class:"btn btn-primary update-btn",id:"importquery",onClick:a[2]||(a[2]=h=>s.saveandImport(n.searchBaseArray,!0)),disabled:e.loading},[a[7]||(a[7]=t("span",{class:"fas fa-save"},null,-1)),S(" "+b(e.lang("save_and_import")),1)],8,Ue),t("button",{class:"btn btn-primary update-btn",id:"importquery",onClick:a[3]||(a[3]=(...h)=>s.addQuery&&s.addQuery(...h)),disabled:e.loading},[a[8]||(a[8]=t("span",{class:"glyphicon glyphicon-plus"},null,-1)),S(" "+b(e.lang("add_more")),1)],8,qe)])]),default:v(()=>[(l(!0),d(B,null,z(n.searchBaseArray,(h,m)=>(l(),d("div",{key:m,class:"clearfix ldap-import-query"},[t("div",Ie,[r(k,{id:"searchbase-"+m,label:e.lang("search_base"),value:h.search_base,type:"text",name:"searchbase"+m,onChange:s.onSearchBase,classname:"col-sm-4",required:!0},null,8,["id","label","value","name","onChange"]),r(k,{id:"filter-"+m,label:e.lang("filter"),value:h.filter,type:"text",name:"filter-"+m,onChange:s.onFilter,classname:"col-sm-6",hint:e.lang("ldap_filter_hint")},null,8,["id","label","value","name","onChange","hint"]),t("div",Ae,[t("label",Pe,b(e.lang("actions")),1),t("div",null,[h.search_base?(l(),d("span",{key:0,id:"ping-"+m,class:"btn btn-primary",onClick:M=>s.confirmLdapPing(h.search_base,h.filter),title:e.lang("ping_user")},a[4]||(a[4]=[t("i",{class:"fa fa-paper-plane"},null,-1)]),8,Be)):g("",!0),t("span",{id:"delete-"+m,class:"btn btn-secondary",title:e.lang("delete_user"),onClick:M=>s.deleteUser(h.id,m)},a[5]||(a[5]=[t("i",{class:"fa fa-trash"},null,-1)]),8,Ve)])])]),t("div",ze,[n.showRole?(l(),C(y,{key:0,id:"user-type-"+m,label:e.lang("user_type"),elements:e.usersArray,name:m,hideEmptySelect:!0,value:h.user_type,classname:"col-sm-4",onChange:s.onHandle,required:!0},null,8,["id","label","elements","name","value","onChange"])):g("",!0),h.user_type!=="user"&&n.showDepartment?(l(),C(f,{key:"search-base-"+m+"-department",id:"search-base-"+m+"-department",apiEndpoint:"/api/dependency/departments",label:e.lang("department"),multiple:!0,name:m,prePopulate:!1,classname:"col-sm-6",value:h.departments,onChange:s.onDepartmentChange},null,8,["id","label","name","value","onChange"])):g("",!0),h.user_type==="user"&&n.showOrganization?(l(),C(f,{key:"search-base-"+m+"-organization",id:"search-base-"+m+"-organization",apiEndpoint:"/api/dependency/organizations",label:e.lang("organizations"),multiple:!0,name:m,prePopulate:!1,classname:"col-sm-6",value:h.organizations,onChange:s.onOrganizationChange},null,8,["id","label","name","value","onChange"])):g("",!0)])]))),128))]),_:1},8,["title"])])}const $e=V(Le,[["render",Ee],["__scopeId","data-v-3614a82b"]]);const He={name:"ldap-table",description:"Ldap table component",setup(){const e=J();return{formattedTime:T(()=>e.getters.formattedTime)}},props:{ldapId:{type:String,default:""}},data(){return{showModal:!1,data:{id:0,name:""},hasDataPopulated:!1,minimized:!0,base:window.axios.defaults.baseURL,columns:["name","created_at","updated_at","is_default","action"],options:{},apiUrl:"/api/dependency/ldap-directory-attributes/"+this.ldapId}},beforeMount(){const e=this;this.options={headings:{name:this.lang("name"),created_at:this.lang("created_at"),updated_at:this.lang("updated_at"),is_default:this.lang("is_default"),action:this.lang("action")},texts:{filter:"",limit:""},templates:{action:(a,n)=>e.h(ae,{data:n}),is_default:(a,n)=>e.h(se,{data:n}),created_at:(a,n)=>this.formattedTime(n.created_at),updated_at:(a,n)=>this.formattedTime(n.updated_at)},sortable:["name","created_at","updated_at","is_default"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"scroll"},requestAdapter(a){return{sort_field:a.orderBy?a.orderBy:"is_default",sort_order:a.ascending?"desc":"asc",search_query:a.query.trim(),page:a.page,limit:a.limit}},responseAdapter({data:a}){return{data:a.data.data.map(n=>(n.edit_modal="api/ldap/ldap-directory-attribute/"+e.ldapId,n.delete_url=window.axios.defaults.baseURL+"/api/ldap/ldap-directory-attribute/"+n.id,n.active=n.active=="1"?"active":"inactive",n)),count:a.data.total}},orderBy:{column:"is_default",ascending:!0}}},methods:{toggleList(){this.minimized=!this.minimized,this.minimized?this.hasDataPopulated=!1:this.hasDataPopulated=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"data-table-modal":te,"tool-tip":G}},Oe={class:"card card-light"},Re={class:"card-header"},Fe={class:"card-title"},Ne=["title"],Qe=["title"],je={class:"card-body"},Je={class:"box-header"},We={class:"row"},Ke={key:0,class:"col-md-12"},Ge={class:"card-footer"};function Xe(e,a,n,o,i,s){const u=p("alert"),w=p("tool-tip"),c=p("data-table"),k=p("data-table-modal");return l(),d("div",null,[r(u,{componentName:"dataTableModal"}),t("div",Oe,[t("div",Re,[t("h3",Fe,b(e.lang("directory_attributes")),1),r(w,{message:e.lang("directory_attributes_description"),size:"large"},null,8,["message"]),t("a",{id:"toggle-list-button",onClick:a[0]||(a[0]=(...y)=>s.toggleList&&s.toggleList(...y))},[i.minimized?(l(),d("span",{key:0,class:"pull-right glyphicon glyphicon-menu-down",title:e.lang("expand")},null,8,Ne)):(l(),d("span",{key:1,class:"pull-right glyphicon glyphicon-menu-up",title:e.lang("collapse")},null,8,Qe))])]),t("div",je,[t("div",{class:q(["toggle1",{"toggle-expand":i.hasDataPopulated}])},[t("div",Je,[t("div",We,[i.minimized?g("",!0):(l(),d("div",Ke,[t("a",{class:"btn btn-primary right",onClick:a[1]||(a[1]=y=>i.showModal=!0),href:"javascript:;"},[a[2]||(a[2]=t("span",{class:"glyphicon glyphicon-plus"},null,-1)),S(" "+b(e.lang("add_more")),1)])]))])]),i.hasDataPopulated?(l(),C(c,{key:0,url:i.apiUrl,dataColumns:i.columns,option:i.options},null,8,["url","dataColumns","option"])):g("",!0)],2)]),t("div",Ge,[i.showModal?(l(),C(k,{key:0,title:"create",onClose:s.onClose,showModal:i.showModal,apiUrl:"api/ldap/ldap-directory-attribute/"+this.ldapId,data:i.data},null,8,["onClose","showModal","apiUrl","data"])):g("",!0)])])])}const Ze=V(He,[["render",Xe],["__scopeId","data-v-5a098cfb"]]),H="api/ldap/settings/",Ye={name:"ldap-settings",description:"ldap setting page",beforeMount(){const e=X(window.location.pathname);this.ldapId=e||"",this.ldapId!==""?this.getldapSetting():(this.hasDataPopulated=!0,this.loading=!1)},data:function(){return{domain:"",is_valid:0,password:"",port:null,encryption:null,schema:"active_directory",ldap_label:"",forgot_password_link:"",prefix:"",suffix:"",username:"",user_type:"",search_bases:[],show_organization:!0,show_department:!0,show_role:!0,loading:!0,loadingSpeed:4e3,hasDataPopulated:!1,message:"",ldapId:"",tableHeadings:{faveo:{header:"faveo_attribute",description:"faveo_attribute_description"},thirdParty:{header:"active_directory_attribute",description:"active_directory_attribute_description"},overwrite:{header:"overwrite",description:"ldap_overwrite_description"}}}},watch:{},methods:{getldapSetting(){this.loading=!0,D.get(H+this.ldapId).then(e=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(e.data.data),this.message=e.data.message,e.data.data.search_bases.length>0||setTimeout(()=>{this.search_bases.push({id:"",search_base:"",filter:"",user_type:"user",departments:[],organizations:[]})},5)}).catch(e=>{this.loading=!1})},updateStatesWithData(e){const a=this,n=this.$data;Object.keys(e).map(o=>{n.hasOwnProperty(o)&&(a[o]=e[o])})},addUser(e){this.search_bases.push(e)},onChange(e,a){this[a]=e},confirmLdapPing(e){this.loading=!0,D.get("api/ldap/search-base/ping",{params:{search_base:e}}).then(a=>{this.loading=!1,P(a,"searchbase")}).catch(a=>{this.loading=!1,I(a,"searchbase")})},deleteUser(e){this.search_bases.splice(e,1)},saveConfiguration(){this.isValid()&&(this.loading=!0,D.post(H,this.getSaveApiParams()).then(e=>{this.loading=!1,this.showSearchQueryBlock=!0,P(e,"ldap"),this.ldapId=e.data.data.ldap_id,this.getldapSetting()}).catch(e=>{this.loading=!1,I(e,"ldap")}))},getSaveApiParams(){return{id:this.ldapId!==""?this.ldapId:void 0,domain:this.domain,username:this.username,password:this.password,port:this.port,encryption:this.encryption,schema:this.schema,ldap_label:this.ldap_label,forgot_password_link:this.forgot_password_link,prefix:this.prefix,suffix:this.suffix}},isValid(){const{errors:e,isValid:a}=Ce(this.$data);return!!a}},computed:{schemas(){return[{id:"active_directory",name:"ActiveDirectory"},{id:"open_ldap",name:"OpenLDAP"},{id:"free_ipa",name:"FreeIPA"}]},encryptions(){return[{id:null,name:"None"},{id:"ssl",name:"SSL"},{id:"tls",name:"TLS"}]}},components:{"static-select":Q,"text-field":j,"search-basis":$e,"user-import-mapper":Y,"ldap-table":Ze,checkbox:ne}},xe={class:"col-sm-12"},ea={key:1},aa={key:0,id:"ldap-configure-warning",class:"alert alert-warning text-uppercase"},ta={style:{"margin-top":"2rem"}},sa={class:"row"},na={style:{"margin-top":"2rem"}},la={class:"row"},ia={class:"card-footer"},oa=["disabled"];function da(e,a,n,o,i,s){const u=p("custom-loader"),w=p("alert"),c=p("text-field"),k=p("static-select"),y=p("faveo-box"),f=p("search-basis"),L=p("user-import-mapper"),h=p("ldap-table"),m=R("focus-first-input");return l(),d("div",xe,[!e.hasDataPopulated||e.loading?(l(),C(u,{key:0,duration:e.loadingSpeed},null,8,["duration"])):g("",!0),r(w,{componentName:"ldap"}),e.hasDataPopulated?(l(),d("div",ea,[r(y,{title:e.lang("ldap_configuration_settings")},{actions:v(()=>[t("div",ia,[t("button",{id:"ldap-settings-submit",class:"btn btn-primary",onClick:a[0]||(a[0]=(...M)=>s.saveConfiguration&&s.saveConfiguration(...M)),disabled:e.loading},[a[3]||(a[3]=t("span",{class:"fas fa-save"},null,-1)),S("  "+b(e.lang("save_configuration")),1)],8,oa)])]),default:v(()=>[e.message?(l(),d("h6",aa,[a[1]||(a[1]=t("span",null,[t("i",{class:"fa fa-exclamation-triangle"})],-1)),a[2]||(a[2]=S()),t("span",null,b(e.message),1)])):g("",!0),t("div",ta,[r(y,{title:e.lang("connection_settings")},{default:v(()=>[A((l(),d("div",sa,[r(c,{label:e.lang("ldap_domain"),value:e.domain,type:"text",name:"domain",onChange:s.onChange,placehold:e.lang("enter_a_value"),classname:"col-md-4",required:!0,id:"domain"},null,8,["label","value","onChange","placehold"]),r(c,{label:e.lang("username"),defaultKey:"user_name",value:e.username,type:"text",name:"username",onChange:s.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-4",required:!0,id:"username"},null,8,["label","value","onChange","placehold"]),r(c,{label:e.lang("password"),value:e.password,type:"password",name:"password",onChange:s.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-4",required:!0,id:"password"},null,8,["label","value","onChange","placehold"]),r(k,{label:e.lang("ldap_schema"),elements:s.schemas,name:"schema",value:e.schema,classname:"col-sm-4",onChange:s.onChange,placeHolder:e.lang("select"),hint:e.lang("ldap_schema_description"),id:"schema"},null,8,["label","elements","value","onChange","placeHolder","hint"]),r(c,{label:e.lang("port"),value:e.port,type:"number",name:"port",onChange:s.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-4",hint:e.lang("ldap_port_hint"),id:"port"},null,8,["label","value","onChange","placehold","hint"]),r(k,{label:e.lang("encryption"),elements:s.encryptions,name:"encryption",value:e.encryption,classname:"col-sm-4",onChange:s.onChange,placeHolder:e.lang("select"),hint:e.lang("ldap_encryption_hint"),id:"encryption"},null,8,["label","elements","value","onChange","placeHolder","hint"])])),[[m]])]),_:1},8,["title"])]),t("div",na,[r(y,{title:e.lang("login_settings")},{default:v(()=>[t("div",la,[r(c,{label:e.lang("ldap_label"),value:e.ldap_label,type:"text",name:"ldap_label",onChange:s.onChange,classname:"col-sm-4",hint:e.lang("ldap_label_hint"),id:"label"},null,8,["label","value","onChange","hint"]),r(c,{label:e.lang("forgot_password_link"),value:e.forgot_password_link,type:"text",name:"forgot_password_link",onChange:s.onChange,classname:"col-sm-4",hint:e.lang("forgot_password_link_description"),id:"forgot-password-link"},null,8,["label","value","onChange","hint"]),r(c,{label:e.lang("username_prefix"),value:e.prefix,type:"text",name:"prefix",onChange:s.onChange,classname:"col-sm-4",hint:e.lang("username_prefix_description"),id:"prefix"},null,8,["label","value","onChange","hint"]),r(c,{label:e.lang("username_suffix"),value:e.suffix,type:"text",name:"suffix",onChange:s.onChange,classname:"col-sm-4",hint:e.lang("username_suffix_description"),id:"suffix"},null,8,["label","value","onChange","hint"])])]),_:1},8,["title"])])]),_:1},8,["title"]),e.is_valid!=0?(l(),C(f,{key:0,"ldap-id":e.ldapId,addUser:s.addUser,searchBaseArray:e.search_bases,getLdap:s.getldapSetting,showOrganization:e.show_organization,showDepartment:e.show_department,showRole:e.show_role,loadingValue:e.loading},null,8,["ldap-id","addUser","searchBaseArray","getLdap","showOrganization","showDepartment","showRole","loadingValue"])):g("",!0),e.is_valid!=0?(l(),C(L,{key:1,"api-endpoint":"/api/ldap/advanced-settings/"+e.ldapId,updateParent:s.getldapSetting,"table-headings":e.tableHeadings},null,8,["api-endpoint","updateParent","table-headings"])):g("",!0),e.is_valid!=0?(l(),C(h,{key:2,"ldap-id":e.ldapId},null,8,["ldap-id"])):g("",!0)])):g("",!0)])}const O=V(Ye,[["render",da]]);const ra={props:["data"],setup(){const e=J();return{buttonStyle:T(()=>e.getters.getButtonStyle),linkStyle:T(()=>e.getters.getLinkStyle)}},data(){return{disabled:!1,ldapSettings:null,login_via_ldap:!1,oauthLogin:""}},beforeMount(){this.ldapSettings=JSON.parse(this.data).providerData.ldap_meta_settings,this.ldapSettings&&this.ldapSettings.hide_default_login&&this.hideDefaultLogin(),this.oauthLogin=JSON.parse(this.data).login_type},mounted(){window.emitter.on("login-success",()=>{this.disabled=!0}),window.emitter.on("login-failure",()=>{this.disabled=!1,this.login_via_ldap=!1}),window.emitter.on("logging-in-with-enter-key",()=>{document.getElementById("default-login-button").style.display=="none"&&document.getElementById("ldap-login-button-0").click()})},methods:{hideDefaultLogin(){document.getElementById("default-login-button").style.display="none",document.getElementById("default-forgot-password").style.display="none"},ldapLoginSubmit(e){this.login_via_ldap=!0,window.emitter.on("login-data-submitting",a=>{a.ldap=this.login_via_ldap,a.ldap_id=e}),document.getElementById("default-login-button").click()}}},pa={id:"ldap-login"},ua={class:"ldap-login-block"},ca={class:"d-grid"},ha=["id","disabled","onClick"],ma={key:0},ga=["id","href"];function _a(e,a,n,o,i,s){return l(),d("div",pa,[(l(!0),d(B,null,z(i.ldapSettings&&i.ldapSettings.directory_settings,(u,w)=>(l(),d("span",ua,[t("div",ca,[t("button",{id:"ldap-login-button-"+w,class:q(["ldap-login-button btn-block btn-flat",i.oauthLogin!=="oAuth"?"btn btn-custom mt-1 mb-1":"btn-light link-dark border-0 p-2 mt-2 mb-2"]),disabled:i.disabled,style:$(i.oauthLogin!=="oAuth"?o.buttonStyle:"border-radius: 4px !important; border-width: 1px !important; border-color: #BDC1CAFF !important; border-style: solid !important;"),onClick:()=>s.ldapLoginSubmit(u.id)},[i.oauthLogin==="oAuth"?(l(),d("strong",ma,b(u.ldap_label!==""?u.ldap_label:e.lang("login_via_ldap")),1)):(l(),d(B,{key:1},[S(b(u.ldap_label!==""?u.ldap_label:e.lang("login_via_ldap")),1)],64))],14,ha)]),u.forgot_password_link!==""?(l(),d("a",{key:0,id:"ldap-forgot-password-"+w,href:u.forgot_password_link,target:"_blank",style:$(o.linkStyle)},b(e.lang("forgot_ldap_password")),13,ga)):g("",!0)]))),256))])}const fa=V(ra,[["render",_a]]);let ba={path:"/ldap",component:ee,name:"LDAP",redirect:"/ldap/settings",children:[{path:"settings",component:we,name:"LDAP Settings",meta:{title:"ldap",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"ldap_settings"}}},{path:"settings/create",component:O,name:"LDAP Create",meta:{title:"ldap",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"ldap_settings",to:"/ldap"},active:"create"}}},{path:"settings/:id/edit",component:O,name:"LDAP Edit",meta:{title:"ldap",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"ldap_settings",to:"/ldap"},active:"edit"}}}]};x.addRoute(ba);Z("ldap-login",fa,"login-box-mounted","login-box");
