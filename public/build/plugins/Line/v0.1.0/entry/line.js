import{ad as I,a2 as $,s as F,_ as T,B as E,E as k,C as L,T as S,D as R,ae as U,k as o,W as M,o as i,m as v,G as c,v as n,x as C,F as r,l as d,q as b,L as u,t as N,I as w,a1 as q,H as O}from"../../../../v9.4.0.5/chunks/bootstrap.js";import{L as P,r as H,A as Y}from"../../../../v9.4.0.5/chunks/adminRouter.js";import{b as z,c as j}from"../../../../v9.4.0.5/chunks/DataTableActions.js";import{S as G}from"../../../../v9.4.0.5/chunks/FormGenerator.js";import"../../../../v9.4.0.5/chunks/vue-router.js";import"../../../../v9.4.0.5/chunks/HelpSection.js";import"../../../../v9.4.0.5/chunks/AdminNavigationBar.js";import"../../../../v9.4.0.5/chunks/Checkbox.js";const W={data(){return{template:"",password:"password",name:"",channel_id:"",channelAccessToken:"",channel_secret:"",webhook_url:"",app_exists:!1,required:!0,loading:!1,isLoading:!1,loadingSpeed:4e3,elements_new_ticket:[{name:"One Day",value:1},{name:"Five Days",value:5},{name:"Ten Days",value:10},{name:"Fifteen Days",value:15},{name:"Thirty Days",value:30}],containerStyle:{width:"500px"},elements_is_image_inline:[{name:"Yes",value:1},{name:"No",value:0}],new_ticket_interval:{name:"One Day",value:"1"},is_image_inline:{name:"Yes",value:1}}},methods:{resetFields(){this.name="",this.channel_id="",this.channelAccessToken="",this.channel_secret="",this.is_image_inline={name:"Yes",value:1},this.new_ticket_interval="",this.template=""}}};function J(t){const{name:e,channel_id:a,channelAccessToken:g,channel_secret:s}=t;let l={name:[e,"isRequired"],channel_id:[a,"isRequired"],channelAccessToken:[g,"isRequired"],channel_secret:[s,"isRequired"]};const h=new I($),{errors:_,isValid:m}=h.validate(l);return F.dispatch("setValidationError",_),{errors:_,isValid:m}}const K={mixins:[W],name:"line-create-edit-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},title:{type:String,default:""},app_id:{type:[String,Number],default:""}},data(){return{containerStyle:{width:"800px"},loading:!1,isDisabled:!1,name:"",auth_token:"",account_sid:"",department:"",iconClass:"fas fa-save",btnName:"save"}},beforeMount(){this.app_id&&(this.iconClass="fas fa-sync",this.btnName="update",this.getData())},methods:{getData(){this.loading=!0,this.isDisabled=!0,E.get("/line/api/line/"+this.app_id).then(t=>{this.loading=!1,this.isDisabled=!1;const e=t.data.data;this.name=e.name,this.channelAccessToken=e.channelAccessToken,this.channel_id=e.channel_Id,this.channel_secret=e.channel_secret,this.is_image_inline=this.filterValues(this.elements_is_image_inline,e.is_image_inline),this.new_ticket_interval=this.filterValues(this.elements_new_ticket,e.new_ticket_interval),this.department=e.department.name}).catch(t=>{this.isDisabled=!1,this.loading=!1,k(t,"line-create-edit")})},filterValues(t,e){return t.filter(a=>{if(a.value==e)return a})[0]},onChange(t,e){this[e]=t},isValid(){const{erros:t,isValid:e}=J(this.$data);return e},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;let t={};t.name=this.name,t.channelAccessToken=this.channelAccessToken,t.channel_id=this.channel_id,t.new_ticket_interval=this.new_ticket_interval.value,t.channel_secret=this.channel_secret,t.dept_id=this.department?this.department.id:null,E.post("/line/api/lineCreateOrUpdate/"+this.app_id,t).then(e=>{this.loading=!1,this.isDisabled=!1,L(e,"line-create-edit"),setTimeout(()=>{window.emitter.emit("refreshData"),this.onClose()},2e3)}).catch(e=>{this.isDisabled=!1,k(e,"line-create-edit"),this.loading=!1})}}},components:{"text-field":S,"dynamic-select":R,"number-field":U}},Q={class:"modal-title"},X={key:0,class:"row"},Z={key:1,id:"line-settings"},x={class:"row"},ee={class:"row"},te={class:"row"},ne={id:"controls"},ae=["disabled"];function se(t,e,a,g,s,l){const h=o("alert"),_=o("reuse-loader"),m=o("text-field"),p=o("number-field"),f=o("dynamic-select"),D=o("modal"),y=M("focus-first-input");return a.showModal?(i(),v(D,{key:0,showModal:a.showModal,onClose:a.onClose,containerStyle:s.containerStyle,class:"scrollable-area"},{title:c(()=>[n("h4",Q,C(t.trans(a.title)),1)]),alert:c(()=>[r(h,{componentName:"line-create-edit"})]),fields:c(()=>[s.loading?(i(),d("div",X,[r(_,{"animation-duration":4e3,color:"#1d78ff",size:60})])):b("",!0),s.loading?b("",!0):(i(),d("div",Z,[u((i(),d("div",x,[r(m,{label:t.trans("name"),onChange:l.onChange,value:s.name,type:"text",name:"name",required:t.required,classname:"col-sm-6",hint:t.trans("name_hint"),id:"name"},null,8,["label","onChange","value","required","hint"]),r(p,{label:t.trans("channel_id"),onChange:l.onChange,value:t.channel_id,type:"number",name:"channel_id",required:t.required,classname:"col-sm-6",hint:t.trans("channel_id_added"),id:"channel_id"},null,8,["label","onChange","value","required","hint"])])),[[y]]),n("div",ee,[r(m,{label:t.trans("channel_access_token"),onChange:l.onChange,value:t.channelAccessToken,type:"password",name:"channelAccessToken",required:t.required,classname:"col-sm-6",hint:t.trans("line_token_hint"),id:"channelAccessToken"},null,8,["label","onChange","value","required","hint"]),r(m,{label:t.trans("channel_secret"),onChange:l.onChange,value:t.channel_secret,type:"text",name:"channel_secret",required:t.required,classname:"col-sm-6",hint:t.trans("channel_secret_hint"),id:"channel_secret"},null,8,["label","onChange","value","required","hint"])]),n("div",te,[r(f,{name:"new_ticket_interval",classname:"col-sm-6",elements:t.elements_new_ticket,multiple:!1,prePopulate:!1,label:t.trans("new_ticket_interval"),value:t.new_ticket_interval,onChange:l.onChange,searchable:!1,clearable:!1},null,8,["elements","label","value","onChange"]),r(f,{label:t.trans("which_department_line"),multiple:!1,name:"department",strlength:"40",classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",value:s.department,onChange:l.onChange,clearable:!!s.department,style:{"margin-top":"auto"}},null,8,["label","value","onChange","clearable"])])]))]),controls:c(()=>[n("div",ne,[n("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=A=>l.onSubmit()),disabled:s.isDisabled},[n("i",{class:N(s.iconClass)},null,2),w(" "+C(t.trans(s.btnName)),1)],8,ae)])]),_:1},8,["showModal","onClose","containerStyle"])):b("",!0)}const B=T(K,[["render",se],["__scopeId","data-v-d8a0baaa"]]),le={components:{"status-switch":G},props:["data"],methods:{onChange(t,e){this.statusChange(this.data.channel_Id,e)},statusChange(t){axios.get("line/api/status/"+t).then(e=>{L(e,"dataTableModal"),window.emitter.emit("refreshData")}).catch(e=>{k(e,"dataTableModal")})}}},ie={class:"btn-group"};function oe(t,e,a,g,s,l){const h=o("status-switch");return i(),d("div",ie,[(i(),v(h,{name:a.data.business_phone,value:a.data.active,key:Math.random(),onChange:l.onChange},null,8,["name","value","onChange"]))])}const re=T(le,[["render",oe]]),de={name:"line-table-actions",props:{data:{type:Object,required:!0}},data(){return{showDeleteModal:!1,showEditModal:!1,title:"line_number_edit"}},methods:{onModal(t){this[t]=!0,this.$store.dispatch("unsetAlert")},onClose(){this.showEditModal=!1,this.showDeleteModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"delete-modal":z,"line-create-edit-modal":B}};function ce(t,e,a,g,s,l){const h=o("line-create-edit-modal"),_=o("delete-modal"),m=M("tooltip");return i(),d("div",null,[u((i(),d("button",{class:"btn btn-light table_btn",onClick:e[0]||(e[0]=p=>l.onModal("showEditModal"))},e[2]||(e[2]=[n("i",{class:"fas fa-edit"},null,-1)]))),[[m,t.lang("edit")]]),u((i(),d("button",{class:"btn btn-light table_btn",onClick:e[1]||(e[1]=p=>l.onModal("showDeleteModal"))},e[3]||(e[3]=[n("i",{class:"fas fa-trash"},null,-1)]))),[[m,t.lang("delete")]]),r(q,{name:"modal"},{default:c(()=>[s.showEditModal?(i(),v(h,{key:0,onClose:l.onClose,showModal:s.showEditModal,title:s.title,app_id:a.data.id},null,8,["onClose","showModal","title","app_id"])):b("",!0)]),_:1}),r(q,{name:"modal"},{default:c(()=>[s.showDeleteModal?(i(),v(_,{key:0,onClose:l.onClose,showModal:s.showDeleteModal,deleteUrl:a.data.delete_url},null,8,["onClose","showModal","deleteUrl"])):b("",!0)]),_:1})])}const me=T(de,[["render",ce]]),he={name:"LineTemplate",components:{"text-field":S},props:{showTemplateModal:{type:Boolean,default:!1},onClose:{type:Function}},data(){return{template:"",id:"",loading:!0}},beforeMount(){this.getTemplateValue()},methods:{getTemplateValue(){axios.get("/line/template/get").then(t=>{this.loading=!1;const e=t.data.data;this.template=e.template,this.id=e.id}).catch(t=>{this.loading=!1,k(t)})},onChange(t,e){this[e]=t},addToDescription(t){this.template+=" "+t+" "},onSubmit(){this.loading=!0;let t={template:this.template,id:this.id};this.$store.dispatch("unsetValidationError"),axios.post("/line/template/store",t).then(e=>{this.loading=!1,L(e,"LineTemplate"),setTimeout(()=>{window.emitter.emit("refreshData"),this.onClose()},3e3)}).catch(e=>{this.loading=!1,k(e,"LineTemplate")})}}},ue={class:"modal-title"},_e={class:"row"},pe={class:"col-md-12"},fe={class:"card card-light"},be={class:"card-header"},ve={class:"card-title"},ge={class:"card-body col-md-12"},we={class:"alert alert-dismissable alert-info"},Ce={class:"fs-8"},ye={class:"list-inline"},ke={"data-placement":"right"},Me={"data-placement":"right"},Te={"data-placement":"right"},De={"data-placement":"right"},qe={class:"row"},Le={id:"controls"};function Se(t,e,a,g,s,l){const h=o("alert"),_=o("text-field"),m=o("modal"),p=M("tooltip");return a.showTemplateModal?(i(),v(m,{key:0,showModal:a.showTemplateModal,onClose:a.onClose,class:"scrollable-area"},{title:c(()=>[n("h4",ue,C(t.trans("line_template")),1)]),alert:c(()=>[r(h,{componentName:"LineTemplate"})]),fields:c(()=>[n("div",_e,[n("div",pe,[n("div",fe,[n("div",be,[n("h3",ve,C(t.trans("list-of-available-shot-codes")),1)]),n("div",ge,[n("div",we,[e[5]||(e[5]=n("i",{class:"fas fa-info-circle me-2"},null,-1)),n("span",null,[n("small",Ce,C(t.trans("template-shortcode-tips")),1)]),e[6]||(e[6]=n("button",{type:"button",class:"btn-close float-end","data-bs-dismiss":"alert","aria-label":"Close"},null,-1))]),n("ul",ye,[n("li",{class:"list-inline-item",style:{width:"23%",cursor:"pointer"},onClick:e[0]||(e[0]=f=>l.addToDescription("{{$ticket_number}}"))},[u((i(),d("span",ke,e[7]||(e[7]=[w("{{$ticket_number}}")]))),[[p,t.trans("ticket_number_tooltip"),void 0,{right:!0}]])]),n("li",{class:"list-inline-item",style:{width:"23%",cursor:"pointer"},onClick:e[1]||(e[1]=f=>l.addToDescription("{{$ticket_status}}"))},[u((i(),d("span",Me,e[8]||(e[8]=[w("{{$ticket_status}}")]))),[[p,t.trans("ticket_status_tooltip"),void 0,{right:!0}]])]),n("li",{class:"list-inline-item",style:{width:"23%",cursor:"pointer"},onClick:e[2]||(e[2]=f=>l.addToDescription("{{$ticket_requester}}"))},[u((i(),d("span",Te,e[9]||(e[9]=[w("{{$ticket_requester}}")]))),[[p,t.trans("ticket_requester_tooltip"),void 0,{right:!0}]])]),n("li",{class:"list-inline-item",style:{width:"23%",cursor:"pointer"},onClick:e[3]||(e[3]=f=>l.addToDescription("{{$company_name}}"))},[u((i(),d("span",De,e[10]||(e[10]=[w("{{$company_name}}")]))),[[p,t.trans("company_name_tooltip"),void 0,{right:!0}]])])])])])])]),n("div",qe,[r(_,{id:"template",label:t.trans("template_content"),value:s.template,required:!0,onChange:l.onChange,type:"textarea",name:"template",classname:"col-sm-12"},null,8,["label","value","onChange"])])]),controls:c(()=>[n("div",Le,[n("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=f=>l.onSubmit())},[e[11]||(e[11]=n("i",{class:"fas fa-save"},null,-1)),w(" "+C(t.trans("save")),1)])])]),_:1},8,["showModal","onClose"])):b("",!0)}const Ae=T(he,[["render",Se]]);const Ve={name:"line-number-settings",data(){return{apiUrl:"line/api/lineApiList",columns:["name","channel_Id","department.name","status","actions"],options:{},showModal:!1,title:"line_create",business_phone:"",copied:!1,showTemplateModal:!1}},beforeMount(){const t=this;this.webhook_url=this.basePath()+"/line-webhook",this.options={headings:{name:this.trans("name"),channel_Id:this.trans("channel_Id"),status:this.trans("status"),"department.name":this.trans("department"),actions:this.trans("actions")},columnsClasses:{name:"line-name",channel_id:"channel-id",status:"line-active",department:"Department",actions:"line-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{status:(e,a)=>t.h(re,{data:a}),"department.name":function(e,a){return a.department?a.department.name:"--"},actions:(e,a)=>t.h(me,{data:a})},requestAdapter(e){return{"search-query":e.query.trim(),"sort-field":e.orderBy?e.orderBy:"id","sort-order":e.ascending?"asc":"desc",page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.data.map(a=>(a.delete_url=t.basePath()+"/line/api/lineDeleteCredentials/"+a.id,a)),count:e.data.total}},orderBy:{column:"id",ascending:!0},sortable:["name","channel_id"],filterable:["name","channel_id"],pagination:{chunk:5,nav:"fixed",edge:!0}}},methods:{viewTemplateModal(){this.showTemplateModal=!0},onCopy(){j(this.webhook_url),this.copied=!0,setTimeout(()=>{this.copied=!1},5e3)},addLine(){this.showModal=!0},onClose(){this.showModal=!1,this.showCreateEditModal=!1,this.showTemplateModal=!1,this.$store.dispatch("unsetValidationError"),this.$store.dispatch("unsetAlert")}},components:{LineTemplate:Ae,LabelCreateEdit:P,"line-create-edit-modal":B,"text-field":S}},Ee={class:"col-sm-12"},Ne={class:"row"},Be={class:"col-sm-1 ps-0"},Ie={class:"card-tools cursor-pointer"},$e={id:"line-view"};function Fe(t,e,a,g,s,l){const h=o("alert"),_=o("text-field"),m=o("data-table"),p=o("faveo-box"),f=o("line-create-edit-modal"),D=o("LineTemplate"),y=M("tooltip"),A=M("focus-first-input");return i(),d("div",Ee,[r(h,{componentName:"dataTableModal"}),r(p,{title:t.trans("line_list")},{headerMenu:c(()=>[n("div",Ie,[u((i(),d("button",{class:"btn btn-tool",onClick:e[1]||(e[1]=V=>l.addLine())},e[3]||(e[3]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)]))),[[y,t.trans("add_line_number")]]),u((i(),d("button",{class:"btn btn-tool",onClick:e[2]||(e[2]=V=>l.viewTemplateModal())},e[4]||(e[4]=[n("i",{class:"fa-solid fa-bolt"},null,-1)]))),[[y,t.trans("line_template_tooltip")]])])]),default:c(()=>[u((i(),d("div",Ne,[r(_,{label:t.trans("webhook_url"),value:t.webhook_url,type:"text",name:"webhook_url",classname:"col-sm-5",hint:t.trans("webhook_info_url"),id:"webhook_url",disabled:!0},null,8,["label","value","hint"]),n("div",Be,[u((i(),d("a",{class:"btn btn-light uri-copy",onClick:e[0]||(e[0]=O(V=>l.onCopy(),["prevent"])),style:{"margin-top":"30px"}},[n("span",{class:N(s.copied?"fas fa-check text-success":"fa fa-clipboard"),id:"eye"},null,2)])),[[y,s.copied?t.trans("clipboard-copy-message"):t.trans("click-to-copy")]])])])),[[A]]),n("div",$e,[r(m,{url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"line-view"},null,8,["url","dataColumns","option"])])]),_:1},8,["title"]),r(q,{name:"modal"},{default:c(()=>[s.showModal?(i(),v(f,{key:0,onClose:l.onClose,showModal:s.showModal,title:s.title},null,8,["onClose","showModal","title"])):b("",!0)]),_:1}),s.showTemplateModal?(i(),v(D,{key:0,onClose:l.onClose,showTemplateModal:s.showTemplateModal},null,8,["onClose","showTemplateModal"])):b("",!0)])}const Re=T(Ve,[["render",Fe],["__scopeId","data-v-939b422b"]]);let Ue={path:"/line",component:Y,name:"Line",redirect:"/line/settings",children:[{path:"settings",component:Re,name:"Line Settings",meta:{title:"line_config",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"line_settings"}}}]};H.addRoute(Ue);
