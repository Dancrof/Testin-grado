import{e as v,w as Me,W as _e,o as f,l as w,L as X,v as i,q as k,J as z,m as C,G as M,x as D,F,a4 as ue,a7 as re,t as ee,I,a5 as Fe,C as de,E as H,ad as ze,a2 as S,s as qe,Z as te,$ as ae,T as j,a6 as Se,ay as Ce,h as K,P as Ve,a1 as We,a8 as Ge,aG as Pe,M as Ae,aH as Ze,f as P,_ as Te,aj as Qe,c as oe,B as Ie,k as Ue,j as et,D as ne,g as tt,K as xe,ax as at,aI as fe,r as lt,A as ot,ah as Oe,au as st,u as ge,aJ as it,O as nt}from"../../../../v9.4.0.5/chunks/bootstrap.js";import{r as rt,A as dt}from"../../../../v9.4.0.5/chunks/adminRouter.js";import{a as je,u as Ke,R as ct}from"../../../../v9.4.0.5/chunks/vue-router.js";import{D as Ye,a as ut}from"../../../../v9.4.0.5/chunks/DataTableActions.js";import{R as mt,C as ft,S as vt}from"../../../../v9.4.0.5/chunks/FormGenerator.js";import"../../../../v9.4.0.5/chunks/HelpSection.js";import"../../../../v9.4.0.5/chunks/AdminNavigationBar.js";import"../../../../v9.4.0.5/chunks/Checkbox.js";const ht={class:"modal-title"},_t={key:0},yt={key:1,class:"row"},pt=["disabled"],gt={__name:"ArchiveTicketActions",props:{data:{type:[String,Object],required:!0}},setup(e){const t=v(""),a=e;t.value=JSON.parse(a.data),Me(()=>a.data,(r,s)=>{t.value=JSON.parse(r)},{deep:!0,immediate:!0});const c=v(!1),d=v(""),l=v(""),n=v(!1),m=r=>{d.value=r,l.value=r==="destroy"?"fas fa-trash":r==="archive"?"fas fa-archive":"fas fa-undo",c.value=!0},b=()=>{d.value="",c.value=!1,p.value=!1,n.value=!1,l.value=""},p=v(!1),T=()=>{var u;p.value=!0,n.value=!0;const r={ids:t.value.component.selectedTickets},s={archive:()=>axios.post("/archive/manual-archive/ticket",r),restore:()=>axios.get("/archive/manual-restore/ticket",{params:r}),destroy:()=>axios.delete("/archive/manual-destroy/ticket",{data:r})};(u=s[d.value])==null||u.call(s).then(_=>{p.value=!1,de(_,"archive-actions"),setTimeout(()=>{b(),window.emitter.emit("refreshTicketsIndex"),window.emitter.emit("closeTimelineView"),window.emitter.emit("refreshData"),window.emitter.emit("uncheckCheckbox")},3e3)}).catch(_=>{p.value=!1,b(),H(_,"inbox")})};return window.emitter.on("selectedTickets",r=>{t.value.component.selectedTickets=r}),(r,s)=>{const u=_e("tooltip");return f(),w(z,null,[t.value.category==="closed"&&t.value.component.selectedTickets.length&&t.value.component.permissions.manual_move_archive_tickets?X((f(),w("button",{key:0,type:"button",class:"btn btn-md btn-light",onClick:s[0]||(s[0]=_=>m("archive")),id:"archive-ticket"},s[3]||(s[3]=[i("i",{class:"fas fa-archive"},null,-1)]))),[[u,r.lang("archive")]]):k("",!0),t.value.category==="archived"&&t.value.component.selectedTickets.length?(f(),w(z,{key:1},[t.value.component.permissions.manual_restore_archive_tickets?X((f(),w("button",{key:0,type:"button",class:"btn btn-md btn-light",onClick:s[1]||(s[1]=_=>m("restore")),id:"restore-ticket"},s[4]||(s[4]=[i("i",{class:"fa-solid fa-rotate-right"},null,-1)]))),[[u,r.lang("restore-ticket")]]):k("",!0),t.value.component.permissions.manual_destroy_archive_tickets?X((f(),w("button",{key:1,type:"button",class:"btn btn-md btn-light",onClick:s[2]||(s[2]=_=>m("destroy")),id:"destroy-ticket"},s[5]||(s[5]=[i("i",{class:"fa-regular fa-circle-xmark"},null,-1)]))),[[u,r.lang("destroy-ticket")]]):k("",!0)],64)):k("",!0),c.value?(f(),C(Fe,{key:2,"show-modal":c.value,"on-close":b,containerStyle:{width:"600px"}},{title:M(()=>[i("h4",ht,D(r.trans(d.value)),1)]),alert:M(()=>[F(ue,{componentName:"archive-actions"})]),fields:M(()=>[!p.value&&!n.value?(f(),w("div",_t,[i("span",null,D(r.trans("are_you_sure")),1)])):k("",!0),p.value?(f(),w("div",yt,[F(re)])):k("",!0)]),controls:M(()=>[i("button",{type:"button",onClick:T,class:ee(["btn",d.value==="destroy"?"btn-secondary":"btn-primary"]),disabled:n.value},[i("i",{class:ee(l.value),"aria-hidden":"true"},null,2),I(" "+D(r.trans(d.value)),1)],10,pt)]),_:1},8,["show-modal"])):k("",!0)],64)}}};function bt(e){const{DB_HOST:t,DB_DATABASE:a,DB_USERNAME:c,DB_PASSWORD:d,PORT:l}=e;var n={DB_HOST:[t,"isRequired"],DB_DATABASE:[a,"isRequired"],DB_USERNAME:[c,"isRequired"],DB_PASSWORD:[d,"isRequired"],PORT:[l,"isRequired"]};const m=new ze(S),{errors:b,isValid:p}=m.validate(n);return qe.dispatch("setValidationError",b),{errors:b,isValid:p}}const kt={class:"col-sm-12"},wt={class:"card card-light"},At={class:"card-header"},Dt={class:"card-title"},Ft={class:"card-body"},St={key:0,class:"row"},Ct={class:"row"},Tt={class:"row"},xt={class:"row"},Et={class:"row mt-3"},Bt={class:"col-sm-12"},$t={class:"font-weight-bold"},Rt={class:"row"},It={class:"row"},Ot={key:0,class:"card-footer"},Lt={__name:"DataArchiveDBSettings",setup(e){const t=te(),a=je(),c=Ke(),d=v(!1),l=v(!1),n=(r,s)=>{m[s]=r},m={id:a.params.id,DB_HOST:"",DB_DATABASE:"",DB_USERNAME:"",DB_PASSWORD:"",PORT:"",DB_SSL_KEY:"",DB_SSL_CERT:"",DB_SSL_CA:""};S("yes"),S("no");const b=()=>{const{errors:r,isValid:s}=bt(m);return s},p=()=>{t.dispatch("unsetValidationError"),b()&&(d.value=!0,axios.post("/archive/db-setup",m).then(r=>{d.value=!1,de(r,"DataArchiveDBSettings"),setTimeout(()=>{c.push({name:"Data Archive Index"})},3e3)}).catch(r=>{d.value=!1,H(r,"DataArchiveDBSettings")}))},T=()=>{l.value=!0,axios.get("/archive/db-setup/"+a.params.id).then(r=>{l.value=!1;const s=r.data.data;m.DB_HOST=s.DB_HOST,m.DB_DATABASE=s.DB_DATABASE,m.DB_USERNAME=s.DB_USERNAME,m.DB_PASSWORD=s.DB_PASSWORD,m.PORT=s.PORT,m.DB_SSL_KEY=s.DB_SSL_KEY,m.DB_SSL_CERT=s.DB_SSL_CERT,m.DB_SSL_CA=s.DB_SSL_CA}).catch(r=>{l.value=!1,H(r,"DataArchiveDBSettings")})};return ae(()=>{T()}),(r,s)=>(f(),w("div",kt,[F(ue,{componentName:"DataArchiveDBSettings"}),d.value?(f(),C(Se,{key:0})):k("",!0),i("div",wt,[i("div",At,[i("h3",Dt,D(r.trans("db_config")),1)]),i("div",Ft,[l.value?(f(),w("div",St,[F(re)])):k("",!0),l.value?k("",!0):(f(),w(z,{key:1},[i("div",Ct,[F(j,{name:"DB_HOST",value:m.DB_HOST,label:r.trans("host"),type:"text","on-change":n,classname:"col-sm-6",required:!0},null,8,["value","label"]),F(j,{name:"DB_DATABASE",value:m.DB_DATABASE,label:r.trans("database"),type:"text","on-change":n,classname:"col-sm-6",required:!0},null,8,["value","label"])]),i("div",Tt,[F(j,{name:"DB_USERNAME",value:m.DB_USERNAME,label:r.trans("user_name"),type:"text","on-change":n,classname:"col-sm-6",required:!0},null,8,["value","label"]),F(j,{name:"DB_PASSWORD",value:m.DB_PASSWORD,label:r.trans("password"),type:"password","on-change":n,classname:"col-sm-6",required:!0},null,8,["value","label"])]),i("div",xt,[F(j,{name:"PORT",value:m.PORT,label:r.trans("port"),type:"number","on-change":n,classname:"col-sm-6",required:!0},null,8,["value","label"])]),i("div",Et,[i("div",Bt,[i("p",$t,D(r.trans("want_secure_connection_to_your_database")),1)])]),i("div",Rt,[F(j,{name:"DB_SSL_KEY",value:m.DB_SSL_KEY,label:r.trans("path_to_SSL_key_file"),type:"text","on-change":n,classname:"col-sm-6"},null,8,["value","label"]),F(j,{name:"DB_SSL_CERT",value:m.DB_SSL_CERT,label:r.trans("path_to_SSL_cert_file"),type:"text","on-change":n,classname:"col-sm-6"},null,8,["value","label"])]),i("div",It,[F(j,{name:"DB_SSL_CA",value:m.DB_SSL_CA,label:r.trans("path_to_SSL_ca_file"),type:"text","on-change":n,classname:"col-sm-6"},null,8,["value","label"])])],64))]),l.value?k("",!0):(f(),w("div",Ot,[i("button",{type:"button",class:"btn btn-primary",onClick:p},[s[0]||(s[0]=i("i",{class:"fas fa-save"},null,-1)),I(" "+D(r.trans("save")),1)])]))])]))}};const Nt={class:"col-sm-12"},Mt={class:"card card-light"},qt={class:"card-header"},Vt={class:"card-title"},Wt={class:"card-body",id:"data_archive_db_index"},Pt={class:"alert alert-info"},Ut={class:"modal-title"},jt={key:0},Kt={key:0,class:"form-check mt-2"},Yt={class:"form-check-label",for:"archive_migrate"},Ht={key:1,class:"row"},Jt=["disabled"],Xt="/archive/db-setup/lists",zt={__name:"DataArchiveDBIndex",setup(e){Ce.methods,te();const t=v(["name","status","action"]),a=v({}),c=v(!1),d=v(""),l=v(!1),n=v(!1),m=v(!1),b=v(!1),p=()=>{c.value=!1,d.value=""},T=()=>{l.value=!0,n.value=!0,axios.post("/archive/db-setup/activate/"+d.value,{archive_migrate:b.value}).then(r=>{window.emitter.emit("ADBIndexrefreshData"),de(r,"dataTableModal"),l.value=!1,n.value=!1,p()}).catch(r=>{l.value=!1,n.value=!1,H(r,"dataTableModal"),p()})};return ae(()=>{a.value={headings:{name:S("name"),status:S("status"),action:S("action")},columnsClasses:{name:"adb-index-name",status:"adb-index-status",action:"adb-index-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{action:(r,s)=>{let u=K("button",{class:"btn btn-sm btn-primary",onClick:()=>{c.value=!0,d.value=s.id,m.value=s.migrate_from_archive},disabled:!!s.status},[K("i",{class:"fas fa-check-circle"}),` ${S("activate")}`]);return K("span",{title:s.status?S("activated"):S("activate")},[u])},name:(r,s)=>s.is_configurable?K(ct,{to:`/data-archive/settings/${s.id}`},s.name):K("span",{},s.name),status:(r,s)=>{let u=K("span",{class:s.status?"btn btn-success btn-xs pointer_normal":"btn btn-danger btn-xs pointer_normal"},s.status?S("active"):S("inactive"));return K("a",{class:"pointer_normal"},[u])}},sortable:[],filterable:!1,pagination:{chunk:5,nav:"scroll"},requestAdapter(r){return{sort:r.orderBy?r.orderBy:"order",sort_order:r.ascending?"asc":"desc",search:r.query.trim(),page:r.page,limit:r.limit}},responseAdapter({data:r}){return{data:r.data.data,count:r.data.total}}}}),(r,s)=>{const u=_e("tooltip");return f(),w("div",Nt,[F(ue,{componentName:"dataTableModal"}),i("div",Mt,[i("div",qt,[i("h3",Vt,D(r.trans("db_config")),1)]),i("div",Wt,[i("div",Pt,[s[1]||(s[1]=i("i",{class:"fas fa-info-circle"},null,-1)),s[2]||(s[2]=I("  ")),i("span",null,D(r.trans("archive_database_info")),1)]),F(Ye,{url:Xt,dataColumns:t.value,option:a.value,scroll_to:"data_archive_db_index",componentTitle:"ADBIndex"},null,8,["dataColumns","option"])])]),F(We,{name:"modal"},{default:M(()=>[c.value?(f(),C(Fe,{key:0,showModal:c.value,onClose:p,"container-style":{width:"500px"}},{title:M(()=>[i("h4",Ut,D(r.trans("activate")),1)]),fields:M(()=>[l.value?k("",!0):(f(),w("div",jt,[i("span",null,D(r.trans("are_you_sure")),1),m.value?(f(),w("div",Kt,[X(i("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=_=>b.value=_),id:"archive_migrate"},null,512),[[Ve,b.value]]),X((f(),w("label",Yt,[I(D(r.trans("migrate_from_archive")),1)])),[[u,r.trans("migrate_from_archive_tooltip")]])])):k("",!0)])),l.value?(f(),w("div",Ht,[F(re,{"animation-duration":4e3,size:60})])):k("",!0)]),controls:M(()=>[i("button",{type:"button",onClick:T,class:"btn btn-primary",disabled:n.value},[s[3]||(s[3]=i("i",{class:"fas fa-check"},null,-1)),I(" "+D(r.trans("activate")),1)],8,Jt)]),_:1},8,["showModal"])):k("",!0)]),_:1})])}}};const Gt={id:"archive-workflow-index",class:"col-sm-12"},Zt="/archive/get/workflow-lists",Qt={__name:"ArchiveWorkflowIndex",setup(e){const{basePath:t}=Ce.methods,a=te(),c=v(["name","status","category_type","created_at","updated_at","actions"]),d=v({});return ae(()=>{d.value={headings:{name:S("name"),status:S("status"),category_type:S("category_type"),created_at:S("created"),updated_at:S("updated"),actions:S("actions")},columnsClasses:{name:"aworkflow-index-name",status:"aworkflow-index-status",category_type:"aworkflow-category_type",created_at:"aworkflow-index-created",updated_at:"aworkflow-index-updated",actions:"aworkflow-index-actions"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{actions:(l,n)=>K(ut,{data:n}),status:(l,n)=>{let m=K("span",{class:n.status?"btn btn-success btn-xs pointer_normal":"btn btn-danger btn-xs pointer_normal"},n.status?S("active"):S("inactive"));return K("a",{class:"pointer_normal"},[m])},category_type:(l,n)=>n.category_type.charAt(0).toUpperCase()+n.category_type.slice(1),created_at(l,n){return a.getters.formattedTime(n.created_at)},updated_at(l,n){return a.getters.formattedTime(n.updated_at)}},sortable:["name","status","created_at","updated_at","category_type"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"scroll"},requestAdapter(l){return{sort:l.orderBy?l.orderBy:"order",sort_order:l.ascending?"asc":"desc",search:l.query.trim(),page:l.page,limit:l.limit}},responseAdapter({data:l}){return{data:l.data.data.map(n=>(n.edit_url="/data-archive/workflow/"+n.id+"/edit",n.delete_url=t()+"/archive/delete-workflow/workflow/"+n.id,n.is_default=n.default,n.deleteMessage="are_you_sure_you_want_to_delete",n)),count:l.data.total}}}}),(l,n)=>(f(),w("div",Gt,[F(ue,{"component-name":"dataTableModal"}),F(Ge,{title:l.trans("list_of_workflows")},{default:M(()=>[F(Ye,{url:Zt,dataColumns:c.value,option:d.value,scroll_to:"archive-workflow-index"},null,8,["dataColumns","option"])]),_:1},8,["title"])]))}},$=[{id:"equal",name:S("equal_to")},{id:"not_equal",name:S("not_equal_to")},{id:"contains",name:S("contains")},{id:"dn_contains",name:S("does_not_contain")},{id:"starts",name:S("starts_with")},{id:"ends",name:S("ends_with")},{id:"greater_than",name:S("greater_than")},{id:"lesser_than",name:S("lesser_than")},{id:"less_than_and_greater_than",name:S("less_than_and_greater_than")}];class He{constructor(t="archive__"+Math.random().toString(),a=[],c=[],d=[],l="all",n="any",m="any",b="agent"){this.id=t,this.rules=a,this.restores=c,this.destroys=d,this.matcher_for_rule=l,this.matcher_for_restore=n,this.matcher_for_destroy=m,this.actionsPerformer=b}}class ce{constructor(t="rule__"+Math.random().toString(),a="ticket",c=null,d=null,l=$[0],n=[],m=0){this._id=t,this.category=a,this.field=c,this.value=d,this.relation=l,this.rules=n,this.do_not_delete=m}}class ve{constructor(t="restore__"+Math.random().toString(),a="ticket",c=null,d=null,l=$[0],n=[],m=0){this._id=t,this.category=a,this.field=c,this.value=d,this.relation=l,this.rules=n,this.do_not_delete=m}}class he{constructor(t="destroy__"+Math.random().toString(),a="ticket",c=null,d=null,l=$[0],n=[],m=0){this._id=t,this.category=a,this.field=c,this.value=d,this.relation=l,this.rules=n,this.do_not_delete=m}}const be=(e=[],t)=>{let a=[];return e.forEach(c=>a.push(De(t,c))),a},De=(e,t)=>{let a=[],c=null;return t.data_type==="mobile"&&t.enable_extension&&t.value?c={value:t.value,nodes:t.union}:c=Pe(t.value,t.options,t.default),Array.isArray(c)?c.forEach(d=>{d.nodes&&d.nodes.forEach(l=>{a.push(De(e,l))})}):c&&c.nodes&&c.nodes.forEach(d=>{a.push(De(e,d))}),Je(e,t,a)},Je=(e,t,a=[])=>{if(e==="rule"){const c=$.find(d=>d.id===t.relation);return new ce(t.rule_id,t.category,t,t.value,c,a,t.do_not_delete)}else if(e==="restore"){const c=$.find(d=>d.id===t.relation);return new ve(t.restore_id,t.category,t,t.value,c,a,t.do_not_delete)}else if(e==="destroy"){const c=$.find(d=>d.id===t.relation);return new he(t.destroy_id,t.category,t,t.value,c,a,t.do_not_delete)}},ke=(e=[],t)=>{let a=JSON.parse(JSON.stringify(e));a=c(a,t);function c(d,l){return d=d.filter(n=>n.field),d.forEach(n=>{const m=Ae.convertStringOfPropertiesToObject(n.field.api_info).key||"label";n.value=Ze(n.value,n.field.default,m),n.field=n.field.key,n.relation=n.relation.id,n.do_not_delete=n.do_not_delete?1:0,P(n[l])&&(n[l]=c(n[l],l))}),d}return a},ea=e=>typeof e=="string"&&e.includes("__"),Le=(e="")=>["text","number","date","email","file","textarea","htmltextarea","checkbox","time"].indexOf(e)>-1?e==="checkbox"?[$[0],$[1],$[2],$[3]]:e==="time"?[$[0],$[6],$[7],$[8]]:$.filter(a=>a.id!=="greater_than"&&a.id!=="lesser_than"&&a.id!=="less_than_and_greater_than"):[$[0],$[1]];const ta={class:"automator-form"},aa={class:"form-field-wrapper"},la={__name:"ArchiveFormField",props:{enforcerType:{type:String,required:!0},formField:{type:Object,required:!0},labelStyle:{type:Object,default:()=>{}},isChild:{type:Boolean,default:!1},enforcerObject:{type:Object,default:()=>({})},multipleField:{type:Boolean,default:!1}},setup(e){const t=te();let a=e;v(null);const c=v([]),d=v([]),l=v(null),n=v(!1);v([]);const m=v(!0),b=v(null),p=v(!1),T=v(""),r=v("");ae(()=>{(a.formField.data_type==="select"||a.formField.data_type==="select"&&a.formField.title==="Api")&&ye(),a.formField.data_type==="mobile"&&(a.formField.value&&a.formField.value.includes(" ")&&(b.value=a.formField.value.split(" ")[0]),a.formField.enable_extension&&a.formField.union&&a.formField.union.length&&(T.value=a.formField.union[0].value?a.formField.union[0].value:"")),p.value=!0}),Qe(()=>{if(a.formField.data_type==="mobile"&&a.formField.enable_extension&&a.formField.value){let o="";a.formField.value&&a.formField.value.includes(" ")?o=a.formField.value.split(" ")[1]:o=a.formField.value,l.value=o,Y({value:l.value,nodes:a.formField.union})}else l.value=Pe(a.formField.value,a.formField.options,a.formField.default,a.formField.data_type),Y(l.value);setTimeout(()=>{n.value=!0},1e3)});const s=at(),u=oe(()=>a.formField.key+(s==null?void 0:s.vnode.key)),_=oe(()=>{let o=Ae.convertStringOfPropertiesToObject(a.formField.api_info).url;return!o&&a.formField.api_info&&(o=a.formField.api_info),o}),x=oe(()=>Ae.convertStringOfPropertiesToObject(a.formField.api_info).key||"label"),E=oe(()=>a.isChild),O=oe(()=>{let o=[];return a.isChild||o.push("required"),o.join("|")}),G=(o,B,A)=>{if(a.formField.data_type==="time"||a.formField.data_type==="count"){const g=o.which?o.which:o.keyCode;if(a.multipleField){if((g<48||g>57)&&g!==126)o.preventDefault();else if(g===126){const V=(l.value||"")+String.fromCharCode(g),R=V.indexOf("~"),y=V.lastIndexOf("~");(R!==-1&&R!==y||R!==-1&&R!==0&&R!==V.length-1||V.length===1&&R===0)&&o.preventDefault()}}else(g<48||g>57)&&o.preventDefault();((l.value||"")+String.fromCharCode(g))[0]==="0"&&o.preventDefault()}else if(A==="number"||A==="mobile"){o=o||window.event;let g=o.which?o.which:o.keyCode;if(g>31&&(g<48||g>57))o.preventDefault();else return!0}else if(A==="float"||A==="decimal"){o=o||window.event;let g=o.which?o.which:o.keyCode,U=o.target.value;if(g===46&&U.indexOf(".")!==-1||g===46&&U.length===0)o.preventDefault();else{if(g>=48&&g<=57||g===46)return!0;o.preventDefault()}}else if(A==="time"||A==="count"){const g=o.which?o.which:o.keyCode;if(a.multipleField){if((g<48||g>57)&&g!==126)o.preventDefault();else if(g===126){const V=(l.value||"")+String.fromCharCode(g),R=V.indexOf("~"),y=V.lastIndexOf("~");(R!==-1&&R!==y||R!==-1&&R!==0&&R!==V.length-1||V.length===1&&R===0)&&o.preventDefault()}}else(g<48||g>57)&&o.preventDefault();((l.value||"")+String.fromCharCode(g))[0]==="0"&&o.preventDefault()}},Z=(o,B,A)=>{if(A==="number"||A==="mobile")o=o||window.event,o.clipboardData.getData("Text").match(/[^\d]/)&&o.preventDefault();else if(A==="float"||A==="decimal"){o=o||window.event;let U=(o.clipboardData||window.clipboardData).getData("Text");/^[-]?\d*\.?\d*$/.test(U)||o.preventDefault()}},Q=(o,B)=>{if(this[B]=o,a.formField.enable_extension){let A={value:l.value,nodes:a.formField.union};N(A,a.formField.key)}else N(l.value,a.formField.key)},q=()=>{m.value=!1,setTimeout(()=>{m.value=!0},1)},le=o=>{let B=a.enforcerObject[a.enforcerType+"s"].find(A=>A.field.key===o);return B||{_id:"test"}},N=(o,B)=>{if(n.value){if(a.formField.data_type==="decimal"&&typeof o=="string"&&o.endsWith(".")&&(o+="0"),Array.isArray(o)){const A=JSON.parse(JSON.stringify(l.value||[]));l.value=o,o.length>A.length?se(fe.differenceWith(o,A,fe.isEqual)[0],!0):o.length<A.length&&t.dispatch("updateArchiveList",{key:a.enforcerType,affectedUnique:s==null?void 0:s.vnode.key,formFieldUnique:a.formField.key,value:l.value,itemToRemove:fe.differenceWith(A,o,fe.isEqual)[0]})}else a.formField.data_type==="mobile"&&typeof o=="object"&&!Array.isArray(o)?l.value=o.value:l.value=o,se(o);Y(o)}},se=(o,B=!1)=>{let A=[];P(o)&&P(o.nodes)&&o.nodes.forEach(U=>{const V=Je(a.enforcerType,U);A.push(V)}),A.value=A;const g={key:a.enforcerType,affectedUnique:s==null?void 0:s.vnode.key,formFieldUnique:a.formField.key,enforcerList:A,value:l.value,isMultiple:B};a.formField.data_type==="mobile"&&(g.appendValue=b.value),t.dispatch("updateArchiveList",g)},Y=(o,B)=>{c.value=[],o&&(Array.isArray(o)?o.forEach(A=>{P(A.nodes)&&c.value.push(...A.nodes)}):P(o.nodes)&&(c.value=o.nodes))},ye=()=>{P(_)?a.formField.title==="Api"?Ie.get(_).then(o=>{d.value=o.data}).catch(o=>{console.error(o)}):pe():d.value=a.formField.options},pe=()=>{Ie.get(_).then(o=>{d.value=o.data}).catch(o=>{console.error(o)})},J=o=>{r.value=o};return window.emitter.on("updateArchiveField",q),window.emitter.on("updateArchiveRelation",J),(o,B)=>{const A=Ue("ArchiveFormField",!0);return f(),w("div",ta,[m.value?(f(),w(z,{key:0},[e.formField.data_type==="date"?(f(),C(et,{key:0,type:e.formField.request_time_information?"datetime":"date",label:e.formField.label,labelStyle:e.labelStyle,value:l.value,name:u.value,onChange:N,format:e.formField.request_time_information?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD",clearable:!0,rules:O.value,outputFormat:"YYYY-MM-DD HH:mm:ss"},null,8,["type","label","labelStyle","value","name","format","rules"])):k("",!0),e.formField.data_type==="api"||e.formField.data_type==="multiselect"?(f(),C(ne,{key:1,id:e.formField.key,label:e.formField.label,multiple:e.formField.data_type==="multiselect",name:u.value,apiEndpoint:_.value,value:l.value,onChange:N,labelStyle:e.labelStyle,rules:O.value,clearable:E.value,"show-icon":!1},null,8,["id","label","multiple","name","apiEndpoint","value","labelStyle","rules","clearable"])):k("",!0),e.formField.data_type==="select"&&e.formField.title!=="Api"?(f(),C(ne,{key:2,id:e.formField.key,label:e.formField.label,multiple:!1,name:u.value,apiEndpoint:_.value,value:l.value,onChange:N,optionLabel:x.value,labelStyle:e.labelStyle,rules:O.value,clearable:E.value,"show-icon":!1},null,8,["id","label","name","apiEndpoint","value","optionLabel","labelStyle","rules","clearable"])):k("",!0),e.formField.data_type==="select"&&e.formField.title==="Api"?(f(),C(ne,{key:3,id:e.formField.key,label:e.formField.label,multiple:!1,name:e.formField.key,elements:d.value,value:l.value,onChange:N,optionLabel:x.value,rules:O.value,hint:e.formField.description,strlength:75,"tip-rule":e.formField.show_description,"show-icon":!1,fieldUniqueName:e.formField.key,labelLength:25,labelStyle:e.labelStyle},null,8,["id","label","name","elements","value","optionLabel","rules","hint","tip-rule","fieldUniqueName","labelStyle"])):k("",!0),e.formField.data_type==="text"||e.formField.data_type==="textarea"||e.formField.data_type==="htmltextarea"||e.formField.data_type==="number"||e.formField.data_type==="decimal"||e.formField.data_type==="email"||e.formField.data_type==="time"||e.formField.data_type==="count"?(f(),C(j,{key:4,id:e.formField.key,label:e.formField.label,type:e.formField.data_type==="htmltextarea"?"textarea":e.formField.title==="EXT"||e.formField.data_type==="time"?"text":e.formField.data_type,name:u.value,value:l.value,onChange:N,labelStyle:e.labelStyle,rules:O.value,pattern:e.formField.pattern,"validation-message":e.formField.validation_message,keypressEvt:G,placehold:o.lang(e.multipleField?"time_multiple_field":!e.multipleField&&e.formField.data_type==="time"?"enter_the_days":e.formField.data_type==="count"?"enter_thread_count":"enter_a_value"),pasteEvt:Z,max:e.formField.title==="EXT"?8:void 0,isEXT:e.formField.title==="EXT"},null,8,["id","label","type","name","value","labelStyle","rules","pattern","validation-message","placehold","max","isEXT"])):k("",!0),e.formField.data_type==="radio"?(f(),C(mt,{key:5,name:u.value,label:e.formField.label,options:e.formField.options,value:l.value,onChange:N,labelStyle:e.labelStyle,rules:O.value},null,8,["name","label","options","value","labelStyle","rules"])):k("",!0),e.formField.data_type==="checkbox"?(f(),C(ft,{key:6,name:u.value,label:e.formField.label,options:e.formField.options,value:l.value,onChange:N,labelStyle:e.labelStyle,rules:O.value},null,8,["name","label","options","value","labelStyle","rules"])):k("",!0)],64)):k("",!0),p.value&&e.formField.data_type==="mobile"?(f(),C(tt,{key:1,fieldFor:"automator",id:u.value,label:e.formField.label,type:e.formField.data_type,name:u.value,value:l.value,onChange:N,isInlineForm:!1,countryCode:b.value,onCountryCode:B[0]||(B[0]=g=>Q(g,"country_code")),keypressEvt:G,pasteEvt:Z,rules:O.value,extensionEnabled:e.formField.enable_extension,ext:e.formField.enable_extension?e.formField.union:[],labelStyle:e.labelStyle,extValue:T.value},null,8,["id","label","type","name","value","countryCode","rules","extensionEnabled","ext","labelStyle","extValue"])):k("",!0),i("div",aa,[(f(!0),w(z,null,xe(c.value,g=>(f(),C(A,{key:le(g.key)._id,"form-field":g,enforcerType:e.enforcerType,"enforcer-object":le(g.key),isChild:!0},null,8,["form-field","enforcerType","enforcer-object"]))),128))])])}}},oa=Te(la,[["__scopeId","data-v-3d4b9745"]]);const sa={class:"col-sm-3 item-menu"},ia={key:0,class:"fas fa-trash trash-d-btn disabledDiv"},na={class:"offset-md-2 max-width-max-content item_btns"},ra=["onClick"],da={__name:"ArchiveItem",props:{categories:{type:Array,default:()=>[]},item:{type:[ce,ve,he],required:!0},index:{type:Number,required:!0},archiveCategoryChange:{type:Function,default:()=>{}},type:{type:String,default:"rule"},isDefault:{type:Boolean,default:!1}},setup(e){let t=e;const a=te(),c={rule:ce,restore:ve,destroy:he},d=v(""),l=v(null),n=v(null),m=v([]),b=v(!1),p=v(!1);ae(()=>{d.value=t.item.category,l.value=t.item.field,n.value=t.item.relation,l.value&&(m.value=Le(l.value.data_type))});const T=E=>{l.value=E,r(),a.dispatch("onArchiveFieldChange",{key:t.type+"s",index:t.index,field:l.value}),window.emitter.emit("updateArchiveField")},r=()=>{l.value?(m.value=Le(l.value.data_type),s(m.value[0])):m.value=[]},s=E=>{n.value=E,a.dispatch("onArchiveRelationChange",{key:t.type+"s",index:t.index,relation:n.value}),window.emitter.emit("updateArchiveField")},u=E=>{l.value=null,d.value=E,a.dispatch("onArchiveCategoryChange",{key:t.type+"s",index:t.index,value:new c[t.type](t.item._id,d.value)}),t.archiveCategoryChange(),window.emitter.emit("updateArchiveField")},_=()=>{window.emitter.emit("deleteArchiveItem",{type:t.type,index:t.index,id:t.item._id})},x=()=>{b.value=!0,setTimeout(()=>{b.value=!1,window.emitter.emit("updateArchiveField")},1)};return Me(n,(E,O)=>{window.emitter.emit("updateArchiveRelation",E.id),p.value=E.id==="less_than_and_greater_than"}),window.emitter.on("deletedArchiveItem",x),(E,O)=>{var Z,Q;const G=_e("tooltip");return f(),w("div",{class:ee(["row","archive-item",l.value&&l.value.disabled?"disabledDiv":""])},[b.value?(f(),C(Se,{key:0})):k("",!0),i("div",sa,[i("span",null,[(Z=l.value)!=null&&Z.do_not_delete?(f(),w("i",ia)):(f(),w("i",{key:1,class:ee(["fas fa-trash trash-btn",[l.value&&l.value.disabled?"disabledDiv":""]]),onClick:O[0]||(O[0]=q=>_())},null,2))]),i("span",na,[(f(!0),w(z,null,xe(e.categories,q=>X((f(),w("a",{key:q.name,href:"javascript:;",class:ee([{"item-active-border":d.value===q.name},"btn btn-default mr-1"]),onClick:le=>d.value!==q.name&&u(q.name)},[i("i",{class:ee(q.icon)},null,2)],10,ra)),[[G,E.trans(q.name+"_field")]])),128))])]),b.value?k("",!0):(f(),C(ne,{key:1,classname:"col-sm-3",labelStyle:{display:"none"},multiple:!1,id:e.type+"-"+e.item._id,name:e.type+"-"+e.item._id,apiEndpoint:(Q=e.categories.find(q=>q.name===d.value))==null?void 0:Q.api_info,optionLabel:"label",value:l.value,onChange:T,strlength:50,clearable:!1},null,8,["id","name","apiEndpoint","value"])),l.value!==null?(f(),w(z,{key:2},[b.value?k("",!0):(f(),C(ne,{key:0,classname:"col-sm-3",labelStyle:{display:"none"},multiple:!1,name:"relation-"+e.item._id,elements:m.value,optionLabel:"name",value:n.value,onChange:s,strlength:35,clearable:!1},null,8,["name","elements","value"])),(f(),w("div",{class:"col-sm-3",key:JSON.stringify(l.value)+JSON.stringify(d.value)},[(f(),C(oa,{key:e.item._id,enforcerType:e.type,"form-field":l.value,"enforcer-object":e.item,multipleField:p.value,labelStyle:{display:"none"}},null,8,["enforcerType","form-field","enforcer-object","multipleField"]))]))],64)):k("",!0)],2)}}},ca=Te(da,[["__scopeId","data-v-19cdf959"]]),ua={class:"card card-light"},ma={class:"card-header"},fa={class:"card-title"},va={class:"card-body"},ha={key:0,class:"row ml-3"},_a={class:"col-sm-3"},ya={class:"radio-inline"},pa=["checked"],ga={class:"col-sm-3"},ba={class:"radio-inline"},ka=["checked"],wa={key:1,class:"row ml-3"},Aa={class:"col-sm-3"},Da={class:"radio-inline"},Fa=["checked"],Sa={class:"col-sm-3"},Ca={class:"radio-inline"},Ta=["checked"],xa={key:2,class:"row ml-3"},Ea={class:"col-sm-3"},Ba={class:"radio-inline"},$a=["checked"],Ra={class:"col-sm-3"},Ia={class:"radio-inline"},Oa=["checked"],La={class:"mt-3"},we={__name:"ArchiveWorkflowSection",props:{pageType:{type:String,default:""},categories:{type:Array,default:()=>[]},type:{type:String,default:"rule"},isDefault:{type:Boolean,default:!1}},setup(e){const t=te();let a=e;const c=lt({matcher_for_rule:"all",matcher_for_restore:"any",matcher_for_destroy:"any"}),d=v([]),l={rule:ce,restore:ve,destroy:he},n={rule:"getArchiveRules",restore:"getArchiveRestores",destroy:"getArchiveDestroys"};ae(()=>{const u=n[a.type]||"getArchiveRules";d.value=t.getters[u],c.matcher_for_rule=t.getters.getArchiveDataByKey("matcher_for_rule")||"all",c.matcher_for_restore=t.getters.getArchiveDataByKey("matcher_for_restore")||"any",c.matcher_for_destroy=t.getters.getArchiveDataByKey("matcher_for_destroy")||"any",P(d.value)||b()});const m=oe(()=>d.value),b=()=>{const u=l[a.type]||ce;t.dispatch("addNewElementToArchiveProperty",{key:a.type+"s",value:new u})},p=(u,_)=>{c[_]=u,t.dispatch("setArchiveDataByKey",{key:_,value:u})},T=()=>{const u=n[a.type]||"getArchiveRules";d.value=[],d.value=t.getters[u],window.emitter.emit("deletedArchiveItem")},r={rule:"archive_rules",restore:"archive_restore",destroy:"archive_destroy"},s={rule:"archive_rules_tooltip",restore:"archive_restore_tooltip",destroy:"archive_destroy_tooltip"};return(u,_)=>(f(),w("div",ua,[i("div",ma,[i("h3",fa,D(u.trans(e.pageType))+" "+D(u.trans(r[e.type])),1),F(ot,{message:u.trans(s[e.type]),size:"medium"},null,8,["message"])]),i("div",va,[e.type==="rule"?(f(),w("div",ha,[i("div",_a,[i("label",ya,[i("input",{type:"radio",class:"form-check-input",name:"matcher_for_rule",onChange:_[0]||(_[0]=x=>p("any","matcher_for_rule")),value:"any",checked:c.matcher_for_rule==="any"},null,40,pa),I(" "+D(u.lang("match_any_of_below")),1)])]),i("div",ga,[i("label",ba,[i("input",{type:"radio",class:"form-check-input",name:"matcher_for_rule",onChange:_[1]||(_[1]=x=>p("all","matcher_for_rule")),value:"all",checked:c.matcher_for_rule==="all"},null,40,ka),I(" "+D(u.lang("match_all_of_below")),1)])])])):k("",!0),e.type==="destroy"?(f(),w("div",wa,[i("div",Aa,[i("label",Da,[i("input",{type:"radio",class:"form-check-input",name:"matcher_for_destroy",onChange:_[2]||(_[2]=x=>p("any","matcher_for_destroy")),value:"any",checked:c.matcher_for_destroy==="any"},null,40,Fa),I(" "+D(u.lang("match_any_of_below")),1)])]),i("div",Sa,[i("label",Ca,[i("input",{type:"radio",class:"form-check-input",name:"matcher_for_destroy",onChange:_[3]||(_[3]=x=>p("all","matcher_for_destroy")),value:"all",checked:c.matcher_for_destroy==="all"},null,40,Ta),I(" "+D(u.lang("match_all_of_below")),1)])])])):k("",!0),e.type==="restore"?(f(),w("div",xa,[i("div",Ea,[i("label",Ba,[i("input",{type:"radio",class:"form-check-input",name:"matcher_for_restore",onChange:_[4]||(_[4]=x=>p("any","matcher_for_restore")),value:"any",checked:c.matcher_for_restore==="any"},null,40,$a),I(" "+D(u.lang("match_any_of_below")),1)])]),i("div",Ra,[i("label",Ia,[i("input",{type:"radio",class:"form-check-input",name:"matcher_for_restore",onChange:_[5]||(_[5]=x=>p("all","matcher_for_restore")),value:"all",checked:c.matcher_for_restore==="all"},null,40,Oa),I(" "+D(u.lang("match_all_of_below")),1)])])])):k("",!0),(f(!0),w(z,null,xe(m.value,(x,E)=>(f(),C(ca,{key:x._id,item:x,index:E,categories:e.categories,archiveCategoryChange:T,type:e.type,isDefault:e.isDefault},null,8,["item","index","categories","type","isDefault"]))),128)),i("div",La,[i("a",{onClick:_[6]||(_[6]=x=>b()),href:"javascript:;"},[i("span",null,[_[7]||(_[7]=i("i",{class:"fas fa-plus-circle"},null,-1)),I(" "+D(u.trans("add_new_"+e.type)),1)])])])])]))}};const Na={class:"col-sm-12"},Ma={class:"card card-light"},qa={class:"card-header"},Va={class:"card-title"},Wa={class:"card-body"},Pa={class:"alert alert-info"},Ua={key:0,class:"row"},ja={class:"row"},Ka={class:"form-group col-sm-2"},Ya={for:"status"},Ha={class:"row mb-3"},Ja={class:"col-sm-12"},Xa={class:"pointer-cursor",name:"show_filters",for:"show_filters"},za={class:"card-footer"},Ga={class:"modal-title"},Za={key:1},Qa={__name:"ArchiveWorkflowCreateEdit",setup(e){const t=te(),a=je(),c=Ke(),{currentPath:d}=Ce.methods,l=v("create_workflow"),n=v("save"),m=v("fas fa-save"),b=v(!1),p=v(!0),T=a.query.page_type,r=v(!1),s=v({name:"",show_filters:!1,status:!0}),u=(y,h)=>{s.value[h]=y},_=v(!1),x=v(""),E=v([]),O=v([]),G=v([]),Z=async()=>{_.value=!1;try{const y=await axios.get("/api/form/automator?category=archive_workflow&type=ticket");x.value=y.data.data.submit_endpoint||"",E.value=y.data.data.form_categories||[],O.value=y.data.data.form_categories_destroys||[],G.value=y.data.data.form_categories_restores||[]}catch(y){H(y,"DataArchiveWorkflow")}finally{_.value=!0}},Q=v(null),q=async()=>{if(await it(Q.value)){b.value=!0;const h=t.getters.getArchiveData;let W={type:"archive_workflow",data:{category_type:T,name:s.value.name,status:s.value.status,show_filters:s.value.show_filters,id:h.id,matcher_for_rule:h.matcher_for_rule,matcher_for_restore:h.matcher_for_restore,matcher_for_destroy:h.matcher_for_destroy,triggered_by:h.actionsPerformer,rules:N(ke(h.rules,"rules")),restores:N(ke(h.restores,"restores")),destroys:N(ke(h.destroys,"destroys"))}};axios.post(x.value,W).then(L=>{de(L,"DataArchiveWorkflow"),b.value=!1,Y.value?le():setTimeout(()=>{c.push({name:"data_archive_workflow.index"})},3e3)}).catch(L=>{var ie,Ee,Be;if(b.value=!1,((ie=L==null?void 0:L.response)==null?void 0:ie.status)===412&&((Be=(Ee=L==null?void 0:L.response)==null?void 0:Ee.data)!=null&&Be.message)){let $e={};Object.keys(L.response.data.message).forEach(Re=>{let me=Re.split("."),Xe=W.data[me[1]][me[2]].field+W.data[me[1]][me[2]]._id;$e[Xe]=L.response.data.message[Re]}),L.response.data.message=$e,H(L,"DataArchiveWorkflow");return}H(L,"DataArchiveWorkflow")})}},le=()=>{p.value=!0,axios.get(`/api/get-enforcer/archive_workflow/${Y.value}`).then(y=>{const h=y.data;s.value.name=h.name,s.value.show_filters=h.show_filters,s.value.status=h.status,r.value=h.default;const W=new He(h.id,be(h.rules,"rule"),be(h.restores,"restore"),be(h.destroys,"destroy"),h.matcher_for_rule,h.matcher_for_restore,h.matcher_for_destroy,h.triggered_by);t.dispatch("createNewArchiveInstance",W),p.value=!1}).catch(y=>{p.value=!1,H(y,"DataArchiveWorkflow")})},N=y=>{for(let h in y)se(y[h].category,y[h]);return y},se=(y,h)=>{for(let W in h.rules)h.rules[W].category=y,h.rules[W].rules.length&&se(y,h.rules[W]);return h},Y=v(null),ye=()=>{t.dispatch("createNewArchiveInstance"),p.value=!1},pe=()=>{l.value="edit_workflow",n.value="update",m.value="fas fa-sync",le()};ae(()=>{Z(),Y.value=Oe(d())?Oe(d()):Y.value,P(Y.value)?pe():ye()}),st(()=>{t.dispatch("destroyArchiveInstance")});const J=v(!1),o=v(""),B=v(""),A=v(""),g=v(!1),U=({type:y,index:h,id:W})=>{J.value=!0,o.value=y,B.value=h,A.value=W},V=()=>{if(ea(A.value)){R(o.value,B.value);return}g.value=!0,axios.delete(`/archive/delete-workflow/${o.value}/${A.value}`).then(y=>{R(o.value,B.value),J.value=!1,g.value=!1,de(y,"DataArchiveWorkflow")}).catch(y=>{J.value=!1,g.value=!1,H(y,"DataArchiveWorkflow")})},R=(y,h)=>{J.value=!1,g.value=!1,t.dispatch("deleteElementFromArchive",{key:y,index:h}),window.emitter.emit("deletedArchiveItem")};return window.emitter.on("deleteArchiveItem",U),(y,h)=>{const W=Ue("ValidationObserver"),L=_e("focus-first-input");return f(),w("div",Na,[F(ue,{componentName:"DataArchiveWorkflow"}),b.value?(f(),C(Se,{key:0})):k("",!0),i("div",Ma,[i("div",qa,[i("h3",Va,D(y.trans(l.value)),1)]),i("div",Wa,[i("div",Pa,[h[2]||(h[2]=i("i",{class:"fas fa-info-circle"},null,-1)),h[3]||(h[3]=I("  ")),i("span",null,D(y.trans("archive_automator_info")),1)]),p.value||!_.value?(f(),w("div",Ua,[F(re)])):k("",!0),!p.value&&_.value?(f(),C(W,{key:1,ref_key:"dataArchiveWorkflowForm",ref:Q},{default:M(()=>[X((f(),w("div",ja,[F(j,{name:"name",value:s.value.name,label:y.trans("name"),type:"text","on-change":u,classname:"col-sm-6",required:!0,rules:"required"},null,8,["value","label"]),i("div",Ka,[i("label",Ya,D(y.trans("status")),1),h[4]||(h[4]=i("br",null,null,-1)),F(vt,{name:"status",value:s.value.status,"on-change":u},null,8,["value"])])])),[[L]]),i("div",Ha,[i("div",Ja,[i("label",Xa,[i("b",null,D(y.trans("display_the_filter"))+" :",1),h[5]||(h[5]=I("   ")),X(i("input",{class:"checkbox_align",type:"checkbox",name:"show_filters",id:"show_filters","onUpdate:modelValue":h[0]||(h[0]=ie=>s.value.show_filters=ie),"false-value":0,"true-value":1},null,512),[[Ve,s.value.show_filters]])])])]),F(we,{categories:E.value,pageType:ge(T),type:"rule",key:"rule",isDefault:r.value},null,8,["categories","pageType","isDefault"]),F(we,{categories:O.value,pageType:ge(T),type:"destroy",key:"destroy",isDefault:r.value},null,8,["categories","pageType","isDefault"]),F(we,{categories:G.value,pageType:ge(T),type:"restore",key:"restore",isDefault:r.value},null,8,["categories","pageType","isDefault"])]),_:1},512)):k("",!0)]),i("div",za,[i("button",{onClick:q,class:"btn btn-primary",type:"button"},[i("i",{class:ee(m.value)},null,2),I(" "+D(y.trans(n.value)),1)])])]),F(We,{name:"modal"},{default:M(()=>[J.value?(f(),C(Fe,{key:0,showModal:!0,onClose:()=>J.value=!1,containerStyle:{width:"400px"}},{title:M(()=>[i("h4",Ga,D(y.trans("delete")),1)]),fields:M(()=>[b.value?(f(),C(re,{key:0})):k("",!0),b.value?k("",!0):(f(),w("span",Za,D(y.trans("are_you_sure_you_want_to_delete")),1))]),controls:M(()=>[i("button",{id:"approval-action-confirm",type:"button",onClick:h[1]||(h[1]=ie=>V()),class:"btn btn-danger"},[h[6]||(h[6]=i("i",{class:"fas fa-trash-alt"},null,-1)),I(" "+D(y.trans("confirm")),1)])]),_:1},8,["onClose"])):k("",!0)]),_:1})])}}},Ne=Te(Qa,[["__scopeId","data-v-90691dce"]]),el={archive:null},tl={getArchiveData:e=>e.archive,getArchiveDataByKey:e=>function(t){return e.archive[t]},getArchiveRules:e=>e.archive.rules,getArchiveRestores:e=>e.archive.restores,getArchiveDestroys:e=>e.archive.destroys,getSelectedRestoreKeys:e=>e.archive.restores.map(t=>t.field?t.field.key:""),getSelectedRulesKeys:e=>e.archive.rules.map(t=>t.field?t.field.key:""),getSelectedDestroyKeys:e=>e.archive.destroys.map(t=>t.field?t.field.key:"")},al={createNewArchiveInstance:(e,t)=>e.archive=t||new He,destroyArchiveInstance:e=>e.archive=null,setArchiveDataByKey:(e,{key:t,value:a})=>e.archive[t]=a,addNewElementToArchiveProperty:(e,{key:t,value:a})=>e.archive[t].push(a),deleteElementFromArchive:(e,{key:t,index:a})=>{if(typeof a>"u"){console.error(`Can't delete ${t} having index undefined`);return}e.archive[t+"s"].splice(a,1)},onArchiveCategoryChange:(e,{key:t,index:a,value:c})=>e.archive[t][a]=c,onArchiveRelationChange:(e,{key:t,index:a,relation:c})=>e.archive[t][a].relation=c,onArchiveFieldChange:(e,{key:t,index:a,field:c})=>{if(!P(c))e.archive[t][a].field=null;else{let d=JSON.parse(JSON.stringify(c));d._id=e.archive[t][a]._id,e.archive[t][a].field=d}e.archive[t][a][t]=[],e.archive[t][a].value=null},updateArchiveList:(e,{key:t,affectedUnique:a,formFieldUnique:c,enforcerList:d,value:l,isMultiple:n,itemToRemove:m,appendValue:b})=>{const p=t+"s";T(e.archive[p]);function T(s){for(let u=0;u<s.length;u++){if(s[u]._id===a&&s[u].field.key===c){P(m)?r(m,s[u][p]):n?s[u][p].push(...d):s[u][p]=d,s[u].value=b?b+" "+l:l;break}P(s[u][p])&&T(s[u][p])}}function r(s,u){s.nodes&&s.nodes.forEach(_=>{const x=u.findIndex(E=>E.field.key===_.key);x>-1&&u.splice(x,1)})}}},ll={createNewArchiveInstance:({commit:e},t)=>e("createNewArchiveInstance",t),destroyArchiveInstance:({commit:e})=>e("destroyArchiveInstance"),setArchiveDataByKey:({commit:e},t)=>e("setArchiveDataByKey",t),addNewElementToArchiveProperty:({commit:e},t)=>e("addNewElementToArchiveProperty",t),deleteElementFromArchive:({commit:e},t)=>e("deleteElementFromArchive",t),onArchiveCategoryChange:({commit:e},t)=>e("onArchiveCategoryChange",t),onArchiveRelationChange:({commit:e},t)=>e("onArchiveRelationChange",t),onArchiveFieldChange:({commit:e},t)=>e("onArchiveFieldChange",t),updateArchiveList:({commit:e},t)=>e("updateArchiveList",t)},ol={state:el,getters:tl,mutations:al,actions:ll};nt("archive-ticket-actions",gt,"ticketActionsMounted","ticket-actions-mounted","agent","span");qe.registerModule("archiveWorkflow",ol);let sl={path:"/data-archive",component:dt,name:"DataArchive",redirect:"/data-archive/settings",children:[{path:"settings",component:zt,name:"Data Archive Index",meta:{title:"data-archive",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"db_config"}}},{path:"settings/:id",component:Lt,name:"Data Archive Settings",meta:{title:"data-archive",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"db_config",to:"/data-archive/settings"},active:"data-archive-settings"}}},{path:"workflow/index",component:Qt,name:"data_archive_workflow.index",meta:{title:"data-archive",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"archive-workflow"}}},{path:"workflow/create",component:Ne,name:"Data Archive Workflow Create",meta:{title:"data-archive",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"archive-workflow",to:"/data-archive/workflow/index"},active:"create"}}},{path:"workflow/:id/edit",component:Ne,name:"Data Archive Workflow Edit",meta:{title:"data-archive",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"archive-workflow",to:"/data-archive/workflow/index"},active:"edit"}}}]};rt.addRoute(sl);
