import{ad as b,a2 as S,s as C,_ as L,B as m,E as c,C as V,T as x,D,k as i,W as B,o as n,l as o,F as l,q as p,m as N,G as v,v as r,I as q,x as w,L as E}from"../../../../v9.4.0.5/chunks/bootstrap.js";import{r as T,A}from"../../../../v9.4.0.5/chunks/adminRouter.js";import"../../../../v9.4.0.5/chunks/vue-router.js";import"../../../../v9.4.0.5/chunks/FormGenerator.js";import"../../../../v9.4.0.5/chunks/AdminNavigationBar.js";import"../../../../v9.4.0.5/chunks/DataTableActions.js";import"../../../../v9.4.0.5/chunks/Checkbox.js";import"../../../../v9.4.0.5/chunks/HelpSection.js";function F(e){const{survey_link:t}=e;let u={survey_link:[t,"isRequired"]};const d=new b(S),{errors:s,isValid:a}=d.validate(u);return C.dispatch("setValidationError",s),{errors:s,isValid:a}}const H={name:"lime-survey-settings",data(){return{loading:!0,survey_link:"",haspopulated:!1,statuses:[]}},beforeMount(){this.getLimeSurveyLink()},methods:{onChange(e,t){this[t]=e},getLimeSurveyLink(){this.loading=!0,m.get("/lime-survey/api/get-survey-link").then(e=>{this.loading=!1,this.haspopulated=!0,this.survey_link=e.data.data.link||"",this.statuses=e.data.data.statuses}).catch(e=>{this.loading=!1,this.haspopulated=!1,c(e,"lime-survey-settings")})},isValid(){const{errors:e,isValid:t}=F(this.$data);return t},onSubmit(){if(this.isValid()){this.loading=!0;let e={};e.survey_link=this.survey_link,this.statuses.length>0&&(e.statuses=this.statuses.map(t=>t.id)),m.post("/lime-survey/api/post-survey-link",e).then(t=>{V(t,"lime-survey-settings"),this.getLimeSurveyLink()}).catch(t=>{this.loading=!1,this.haspopulated=!0,c(t,"lime-survey-settings")})}}},components:{"text-field":x,"dynamic-select":D}},M={class:"col-sm-12"},P={key:0},R={class:"row"},G={class:"card-footer"},I=["disabled"];function W(e,t,u,d,s,a){const h=i("alert"),_=i("custom-loader"),y=i("text-field"),g=i("dynamic-select"),f=i("faveo-box"),k=B("focus-first-input");return n(),o("div",M,[l(h,{componentName:"lime-survey-settings"}),s.loading?(n(),o("div",P,[l(_,{loadingSpeed:4e3})])):p("",!0),s.haspopulated?(n(),N(f,{key:1,title:e.trans("limesurvey_settings")},{actions:v(()=>[r("div",G,[r("button",{slot:"actions",type:"button",onClick:t[0]||(t[0]=J=>a.onSubmit()),disabled:s.loading,class:"btn btn-primary"},[t[1]||(t[1]=r("i",{class:"fa fa-save"},null,-1)),q(" "+w(e.trans("save")),1)],8,I)])]),default:v(()=>[E((n(),o("div",R,[l(y,{label:e.trans("survey_link"),type:"text",value:s.survey_link,name:"survey_link",class:"col-sm-12",required:!0,onChange:a.onChange,placehold:e.lang("enter_a_value")},null,8,["label","value","onChange","placehold"]),l(g,{label:e.trans("select_status"),multiple:!0,name:"statuses",prePopulate:!0,classname:"col-sm-12",apiEndpoint:"/api/dependency/statuses",value:s.statuses,onChange:a.onChange,required:!1,hint:e.trans("limesurvey_settings_status_tooltip")},null,8,["label","value","onChange","hint"])])),[[k]])]),_:1},8,["title"])):p("",!0)])}const j=L(H,[["render",W]]);let z={path:"/lime-survey",component:A,name:"LimeSurvey",redirect:"/lime-survey/settings",children:[{path:"settings",component:j,name:"LimeSurvey Settings",meta:{title:"limesurvey",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"limesurvey_settings"}}}]};T.addRoute(z);
