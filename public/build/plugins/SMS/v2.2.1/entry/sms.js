import{_ as V,B as k,C as O,E as f,ae as E,m as S,G as c,a1 as N,k as h,W as M,o as a,v as i,F as l,q as u,x as n,L as q,l as r,I as _,t as D,X as I,a5 as F,J as L,s as B,ad as U,a2 as H,T as J,D as G,Z as W,c as X,O as z}from"../../../../v9.4.0.5/chunks/bootstrap.js";import{V as Z,F as K,r as Q,a as Y}from"../../../../v9.4.0.5/chunks/clientRouter.js";import{T as $}from"../../../../v9.4.0.5/chunks/PermaLink.js";import{r as x,A as ee}from"../../../../v9.4.0.5/chunks/adminRouter.js";import"../../../../v9.4.0.5/chunks/vue-router.js";import"../../../../v9.4.0.5/chunks/DataTableActions.js";import"../../../../v9.4.0.5/chunks/approvalTicketRules.js";import"../../../../v9.4.0.5/chunks/BarcodeModal.js";import"../../../../v9.4.0.5/chunks/Checkbox.js";import"../../../../v9.4.0.5/chunks/index.js";import"../../../../v9.4.0.5/chunks/FormGenerator.js";import"../../../../v9.4.0.5/chunks/AdminNavigationBar.js";import"../../../../v9.4.0.5/chunks/HelpSection.js";const te={name:"verify-2fa",description:"Two-factor Authentication component",props:{layout:{type:Object,default:()=>{}},auth:{type:Object,default:()=>{}},pp:{type:[Object,String],default:""},remember:{type:Boolean,default:!1}},data(){return{retry_after:59,loading:!1,otp:"",mobile:"",buttonStyle:{borderColor:this.layout.portal.client_button_border_color,color:this.layout.portal.client_button_font_color+" !important",backgroundColor:this.layout.portal.client_button_color},language:this.layout.language,isDisabled:!1,updateEmail:!1,isVerifyingMobile:!1,requireMobileRegistration:!1,token:""}},beforeMount(){this.$route.query.requireMobileRegistration==1&&(this.requireMobileRegistration=!0,this.updateEmail=!0),this.$route.query.isVerifyingMobile&&(this.isVerifyingMobile=!0),this.token=this.$route.query.token,this.resendOTP(!0)},methods:{onChange(e,t){this[t]=e,t==="otp"&&(this.isDisabled=e.length<6)},showField(e=1){this.updateEmail=e==1},triggerEvent(e){(e.which||e.keyCode)===13&&this.onSubmit()},resendOTP(e=!1){this.$store.dispatch("unsetValidationError"),this.$Progress.start(),this.isDisabled=!0,this.loading=!0,this.otp="",k.post("api/resend-sms-otp",{token:this.$route.query.token}).then(t=>{this.$Progress.finish(),this.isDisabled=!1,this.loading=!1,this.retry_after=t.data.data.retry_after,e||O(t,"otp"),this.setTimeIntervalForOTP()}).catch(t=>{this.$Progress.fail(),this.isDisabled=!1,this.loading=!1,f(t,"otp")})},setTimeIntervalForOTP(){const t=setInterval(()=>{this.retry_after=this.retry_after-1,this.retry_after==0&&clearInterval(t)},1e3)},isValidMobile(e){return e.length>=7&&e.length<=20},onSubmitUdateMobileAndResendOTP(){if(this.otp="",this.$store.dispatch("unsetValidationError"),!this.isValidMobile(this.mobile)){this.$store.dispatch("setValidationError",{mobile:this.mobile.length<7?this.lang("invalid_mobile_number_min_length"):this.lang("invalid_mobile_number_max_length")});return}this.$Progress.start(),this.isDisabled=!0,this.loading=!0;const e={};e.mobile=this.mobile,e.token=this.$route.query.token,k.post("api/update-mobile-resend-otp",e).then(t=>{this.$Progress.finish(),this.isDisabled=!1,this.loading=!1,this.retry_after=59,this.updateEmail=!1,O(t,"otp")}).catch(t=>{this.$Progress.fail(),this.isDisabled=!1,this.loading=!1,f(t,"otp")})},isValidOtp(){return this.otp.length===6},onSubmit(){if(this.$store.dispatch("unsetValidationError"),!this.isValidOtp()){this.$store.dispatch("setValidationError",{otp:this.lang("otp_validation")});return}this.$Progress.start(),this.isDisabled=!0,this.loading=!0;const e={};e.otp=this.otp,e.token=this.$route.query.token,e.isVerifyingMobile=this.isVerifyingMobile,k.post("/api/verify-otp",e).then(t=>{if(this.$Progress.finish(),this.isDisabled=!1,this.loading=!1,O(t,"otp"),this.redirectUrl=t.data.data.redirect_url,this.redirectPath=localStorage.getItem("redirectPath"),this.redirectPath){const d=this.$store.getters.getLayoutData.system.url;window.location.href=d+"/mytickets"}else this.redirectUrl=="/"?window.location.href=this.auth.system_url:this.$router.push(this.redirectUrl)}).catch(t=>{this.$Progress.fail(),this.isDisabled=!1,this.loading=!1,this.otp="",f(t,"otp")})}},components:{VerificationProgress:Z,"form-helper":K,"number-field":E}},se={id:"content",class:"site-content col-md-12"},ie={id:"head3"},oe={key:0},ae={key:1},re={class:"row"},ne=["disabled"],le={class:"row ms-0 mt-1"},de={key:0},ue={key:1},pe={id:"h3"},he={key:0},ce={key:0},_e={key:0,class:"row"},me=["disabled"];function ge(e,t,d,T,s,o){const v=h("alert"),m=h("verification-progress"),g=h("number-field"),p=h("custom-loader"),w=h("form-helper"),P=h("loader"),C=M("focus-first-input");return a(),S(N,{name:"page",mode:"out-in"},{default:c(()=>[i("div",{class:D({fa_align:s.language==="ar"})},[i("div",se,[l(v,{componentName:"otp"}),s.isVerifyingMobile?(a(),S(m,{key:0,active:"otp-verify",token:s.token},null,8,["token"])):u("",!0),s.updateEmail?u("",!0):(a(),S(w,{key:1},{title:c(()=>[i("h3",ie,n(s.isVerifyingMobile?e.lang("mobile_verification_required"):e.lang("verify-otp")),1)]),fields:c(()=>[s.loading?u("",!0):q((a(),r("div",oe,[l(g,{slot:"fields",label:e.lang("enter_code"),value:s.otp,keyupListener:o.triggerEvent,type:"text",name:"otp",onChange:o.onChange,classname:"",required:!0,placeholder:e.lang("otp_placeholder")},null,8,["label","value","keyupListener","onChange","placeholder"]),i("p",null,[t[6]||(t[6]=i("i",{class:"fa fa-mobile-phone",style:{"font-size":"18px"}},null,-1)),_(" "+n(e.lang("verify-otp-message")),1)])])),[[C]]),s.loading?(a(),r("div",ae,[l(p,{"animation-duration":4e3,color:d.layout.portal.client_header_color,size:50},null,8,["color"])])):u("",!0)]),controls:c(()=>[i("div",re,[i("div",{class:D(["col-sm-12 offset-sm-12",{left:s.language==="ar"}])},[i("button",{class:"btn btn-custom btn-block btn-flat",onClick:t[0]||(t[0]=b=>o.onSubmit()),style:I(s.buttonStyle),disabled:!s.otp},[t[7]||(t[7]=i("i",{class:"fa fa-check"},null,-1)),_(" "+n(e.lang("verify")),1)],12,ne),i("div",le,[s.retry_after>0?(a(),r("div",de,[i("a",{id:"update_email",href:"javascript:void(0)",onClick:t[1]||(t[1]=b=>o.showField())},n(e.lang("update_mobile")),1),_(" | "+n(e.lang("retry_after"))+" ",1),i("b",null,n(s.retry_after)+" s ",1)])):(a(),r("div",ue,[i("a",{id:"update_email",href:"javascript:void(0)",onClick:t[2]||(t[2]=b=>o.showField())},n(e.lang("update_mobile")),1),t[8]||(t[8]=_(" | ")),i("a",{id:"resent_otp",href:"javascript:void(0)",onClick:t[3]||(t[3]=b=>o.resendOTP())},n(e.lang("resend_otp")),1)]))])],2)])]),_:1})),s.updateEmail?(a(),S(w,{key:2},{title:c(()=>[i("h3",pe,n(e.lang("update_mobile_and_send_OTP")),1),s.loading?u("",!0):(a(),r("p",he,n(e.lang("provide_the_mobile_number_to_verify_with_OTP")),1))]),fields:c(()=>[i("div",{class:D({left:s.language==="ar"})},[l(g,{slot:"fields",label:e.lang("mobile_number"),value:s.mobile,type:"text",name:"mobile",onChange:o.onChange,classname:"",required:!0},null,8,["label","value","onChange"])],2),s.loading?(a(),r("div",ce,[l(P,{"animation-duration":4e3,color:d.layout.portal.client_header_color,size:50},null,8,["color"])])):u("",!0)]),controls:c(()=>[s.loading?u("",!0):(a(),r("div",_e,[i("div",{class:D(["col-xs-12 col-sm-12 col-md-12",{left:s.language==="ar"}])},null,2),i("div",{class:D(["col-xs-12 col-sm-12 col-md-12",{left:s.language==="ar"}])},[i("button",{id:"update_btn2",class:"btn btn-custom btn-block btn-flat",onClick:t[4]||(t[4]=(...b)=>o.onSubmitUdateMobileAndResendOTP&&o.onSubmitUdateMobileAndResendOTP(...b)),style:I(s.buttonStyle),disabled:!s.mobile},n(e.lang("update_and_send_OTP")),13,me),i("div",null,[i("a",{id:"have_otp",href:"javascript:void(0)",onClick:t[5]||(t[5]=b=>o.showField(0))},n(e.lang("already_have_OTP_verify_here")),1)])],2)]))]),_:1})):u("",!0)])],2)]),_:1})}const fe=V(te,[["render",ge],["__scopeId","data-v-fd6b448d"]]),ve={name:"sms-otp-toggle",components:{TextField:$,Modal:F,"number-field":E},props:{data:{type:String,required:!0}},data(){return{isEnabled:!1,updating:!1,otpVerified:!1,showModal:!1,otp:"",isDisabled:!0,loading:!1,canTurnOn:!0,retry_after:60,intervalId:null}},created(){window.emitter.on("updateSmsToggleButton",e=>{this.canTurnOn=!e.is_2fa_enabled})},beforeMount(){this.optData=JSON.parse(this.data),this.getRequireOTPLoginStatus(),this.canTurnOn=!this.optData.twoFAStatus},methods:{onClose(){this.showModal=!1},onChange(e,t){this.otp=e,t==="otp"&&(this.isDisabled=e.length<6)},isValidOtp(){return this.otp.length===6},async verifyOtp(){if(this.$store.dispatch("unsetValidationError"),!this.isValidOtp()){this.$store.dispatch("setValidationError",{otp:this.lang("otp_validation")});return}try{const e=await k.post("api/verify-otp",{otp:this.otp});this.otpVerified=!0,this.showModal=!1,this.toggleOTPRequire()}catch(e){f(e,"otp_page")}this.isDisabled=!0,this.otp=""},async askToSendOTP(){try{this.showModal=!0,this.loading=!0;const e=await k.post("/api/resend-sms-otp");this.loading=!1,this.retry_after=e.data.data.retry_after,O(e,"otp_page"),this.setTimeIntervalForOTP()}catch(e){this.loading=!1,f(e,"otp_page")}},setTimeIntervalForOTP(){clearInterval(this.intervalId);let e=this.retry_after;const t=()=>{e=e-1,this.retry_after=e,e===0&&clearInterval(this.intervalId)};this.intervalId=setInterval(t,1e3)},toggleOTPRequire(e=1){if(e||(this.otpVerified=!1),e&&!this.otpVerified){this.askToSendOTP();return}this.updating=!0;const t={};t["require-otp-login"]=e,k.post("api/toggle-otp-login",t).then(d=>{this.isEnabled=e,this.updating=!1,window.emitter.emit("updateEditData"),O(d,this.optData.alert)}).catch(d=>{this.updating=!1,f(d,this.optData.alert)})},getRequireOTPLoginStatus(){k.get("api/get-otp-login-status").then(e=>{this.isEnabled=e.data.data.otp_required}).catch(e=>{f(e,this.optData.alert)})},triggerEvent(e){(e.which||e.keyCode)===13&&this.verifyOtp()}}},be={class:"row"},ye={class:"col-md-9"},ke={class:"col-md-3"},we=["disabled"],Ce={key:2,type:"button",class:"btn btn-primary float-end disabled"},Te={class:"modal-title"},Oe={key:0,class:"row"},Pe={key:1,class:"row"},De={class:"row ms-0"},Se={key:0},qe={key:1},Me=["disabled"],Ve={key:0,class:"row"};function Ee(e,t,d,T,s,o){const v=h("alert"),m=h("reuse-loader"),g=h("number-field"),p=h("modal"),w=M("tooltip"),P=M("focus-first-input");return a(),r("div",null,[t[9]||(t[9]=i("hr",null,null,-1)),i("div",be,[i("div",ye,[i("span",null,[t[4]||(t[4]=i("i",{class:"fas fa-sms fa-lg mx-1"},null,-1)),_(" "+n(e.lang("toggle_sms_otp_for_login")),1)])]),i("div",ke,[!s.isEnabled&&!s.updating?q((a(),r("button",{key:0,type:"button",class:"btn btn-primary float-end",onClick:t[0]||(t[0]=C=>o.toggleOTPRequire()),disabled:!s.canTurnOn},[t[5]||(t[5]=i("i",{class:"fas fa-toggle-on"},null,-1)),_(" "+n(e.lang("turn_on")),1)],8,we)),[[w,e.lang("sms_2fa_tooltip_for_status_"+s.canTurnOn)]]):u("",!0),s.isEnabled&&!s.updating?(a(),r("button",{key:1,type:"button",class:"btn btn-danger float-end",onClick:t[1]||(t[1]=C=>o.toggleOTPRequire(0))},[t[6]||(t[6]=i("i",{class:"fas fa-power-off"},null,-1)),_(" "+n(e.lang("turn_off")),1)])):u("",!0),s.updating?(a(),r("button",Ce,n(e.lang("updating")),1)):u("",!0),s.showModal?(a(),S(p,{key:3,showModal:s.showModal,onClose:o.onClose},{title:c(()=>[i("h4",Te,n(e.lang("otp_verification_modal")),1)]),alert:c(()=>[l(v,{componentName:"otp_page"})]),fields:c(()=>[s.loading?(a(),r("div",Oe,[l(m,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):q((a(),r("div",Pe,[l(g,{name:"otp",keyupListener:o.triggerEvent,value:s.otp,label:e.lang("otp_verification_in_profile"),type:"text",onChange:o.onChange,required:!0,classname:"col-sm-12",placeholder:e.lang("otp_placeholder")},null,8,["keyupListener","value","label","onChange","placeholder"])])),[[P]]),i("div",De,[s.retry_after>0?(a(),r("div",Se,[_(n(e.lang("retry_after"))+" ",1),i("b",null,n(s.retry_after),1),t[7]||(t[7]=_(" s "))])):(a(),r("div",qe,[i("a",{id:"resent_otp",href:"javascript:void(0)",onClick:t[2]||(t[2]=C=>o.askToSendOTP())},n(e.lang("resend_otp")),1)]))])]),controls:c(()=>[i("button",{type:"button",id:"submit_btn",onClick:t[3]||(t[3]=(...C)=>o.verifyOtp&&o.verifyOtp(...C)),class:"btn btn-primary",disabled:s.isDisabled},[t[8]||(t[8]=i("i",{class:"fas fa-check","aria-hidden":"true"},null,-1)),_(" "+n(e.lang("verify")),1)],8,Me)]),default:c(()=>[s.loading?(a(),r("div",Ve,[l(m,{"animation-duration":4e3,size:60,color:e.color},null,8,["color"])])):u("",!0)]),_:1},8,["showModal","onClose"])):u("",!0)])])])}const Ie=V(ve,[["render",Ee]]);const Re={name:"sms-otp-toggle",components:{"number-field":E,Modal:F},props:{data:{type:String,required:!0}},data(){return{isEnabled:!1,updating:!1,loading:!1,canTurnOn:!0,showModal:!1,otp:"",isDisabled:!0,otpVerified:!1,retry_after:0,intervalId:null}},created(){window.emitter.on("updateSmsToggleButton",e=>{this.canTurnOn=!e.is_2fa_enabled})},beforeMount(){this.optData=JSON.parse(this.data),this.getRequireOTPLoginStatus(),this.canTurnOn=!this.optData.user.user_data.is_2fa_enabled},methods:{onClose(){this.showModal=!1},onChange(e,t){this[t]=e,t==="otp"&&(this.isDisabled=e.length<6)},isValidOtp(){return this.otp.length===6},async verifyOtp(){if(this.$store.dispatch("unsetValidationError"),!this.isValidOtp()){this.$store.dispatch("setValidationError",{otp:this.lang("otp_validation")});return}try{const e=await k.post("api/verify-otp",{otp:this.otp});this.otpVerified=!0,this.showModal=!1,this.otp="",this.toggleOTPRequire()}catch(e){f(e,"otp_page")}this.isDisabled=!0,this.otp=""},async askToSendOTP(){try{this.showModal=!0,this.loading=!0;const e=await k.post("/api/resend-sms-otp");this.loading=!1,O(e,"otp_page"),this.retry_after=e.data.data.retry_after,this.setTimeIntervalForOTP()}catch(e){this.loading=!1,f(e,"otp_page")}},setTimeIntervalForOTP(){clearInterval(this.intervalId);let e=this.retry_after;const t=()=>{e=e-1,this.retry_after=e,e===0&&clearInterval(this.intervalId)};this.intervalId=setInterval(t,1e3)},toggleOTPRequire(e=1){if(e||(this.otpVerified=!1),e&&!this.otpVerified){this.askToSendOTP();return}this.updating=!0,this.loading=!0;const t={};t["require-otp-login"]=e,k.post("api/toggle-otp-login",t).then(d=>{this.isEnabled=e,this.updating=!1,this.loading=!1,window.emitter.emit("togglingSMS",e),O(d,this.optData.alert)}).catch(d=>{this.updating=!1,this.loading=!1,f(d,this.optData.alert)})},getRequireOTPLoginStatus(){this.loading=!0,k.get("api/get-otp-login-status").then(e=>{this.updating=!1,this.isEnabled=e.data.data.otp_required}).catch(e=>{this.updating=!1,f(e,this.optData.alert)})}}},Ne={class:"row"},Fe={key:0,class:"col-sm-12"},Le={class:"col-sm-9"},ze={class:"d_flex"},je={class:"col-sm-3"},Ae=["disabled"],Be={class:"modal-title"},Ue={key:0,class:"row"},He={key:1,class:"row"},Je={class:"row ms-3"},Ge={key:0},We={key:1},Xe=["disabled"],Ze={key:0,class:"row"};function Ke(e,t,d,T,s,o){const v=h("custom-loader"),m=h("alert"),g=h("reuse-loader"),p=h("number-field"),w=h("modal"),P=M("tooltip"),C=M("focus-first-input");return a(),r(L,null,[t[10]||(t[10]=i("hr",null,null,-1)),i("div",null,[i("div",Ne,[s.updating?(a(),r("div",Fe,[l(v,{duration:4e3})])):u("",!0),i("div",Le,[i("span",ze,[t[4]||(t[4]=i("i",{class:"fas fa-sms fa-lg"},null,-1)),_("  "+n(e.lang("toggle_sms_otp_for_login")),1)])]),i("div",je,[s.isEnabled?u("",!0):q((a(),r("button",{key:0,type:"button",class:"btn btn-custom pull-right",style:I({borderColor:this.optData.layout.portal.client_button_border_color,color:this.optData.portal.client_button_font_color+" !important",backgroundColor:this.optData.layout.portal.client_button_color}),onClick:t[0]||(t[0]=b=>o.toggleOTPRequire()),id:"otp_turn_on",disabled:!s.canTurnOn},[t[5]||(t[5]=i("i",{class:"fa fa-toggle-on"},null,-1)),_(" "+n(e.lang("turn_on")),1)],12,Ae)),[[P,e.lang("sms_2fa_tooltip_for_status_"+s.canTurnOn)]]),s.isEnabled?(a(),r("button",{key:1,type:"button",class:"btn btn-danger pull-right",onClick:t[1]||(t[1]=b=>o.toggleOTPRequire(0)),id:"otp_turn_off"},[t[6]||(t[6]=i("i",{class:"fa fa-power-off"},null,-1)),_(" "+n(e.lang("turn_off")),1)])):u("",!0)]),s.showModal?(a(),S(w,{key:1,showModal:s.showModal,onClose:o.onClose},{title:c(()=>[i("h4",Be,n(e.lang("otp_verification_modal")),1)]),alert:c(()=>[l(m,{componentName:"otp_page"})]),fields:c(()=>[s.loading?(a(),r("div",Ue,[l(g,{"animation-duration":4e3,color:"#1d78ff",size:"60"})])):q((a(),r("div",He,[l(p,{name:"otp",value:s.otp,label:e.lang("otp_verification_in_profile"),type:"text",onChange:o.onChange,required:!0,classname:"col-sm-12",placeholder:e.lang("otp_placeholder")},null,8,["value","label","onChange","placeholder"]),i("div",Je,[s.retry_after>0?(a(),r("div",Ge,[t[7]||(t[7]=_(" Retry after ")),i("b",null,n(s.retry_after),1),t[8]||(t[8]=_(" seconds "))])):(a(),r("div",We,[i("a",{id:"resent_otp",href:"javascript:void(0)",onClick:t[2]||(t[2]=b=>o.askToSendOTP())},n(e.lang("resend_otp")),1)]))])])),[[C]])]),controls:c(()=>[i("button",{type:"button",id:"submit_btn",onClick:t[3]||(t[3]=(...b)=>o.verifyOtp&&o.verifyOtp(...b)),class:"btn btn-primary",disabled:s.isDisabled},[t[9]||(t[9]=i("i",{class:"fas fa-check","aria-hidden":"true"},null,-1)),_(" "+n(e.lang("verify")),1)],8,Xe)]),default:c(()=>[s.loading?(a(),r("div",Ze,[l(g,{"animation-duration":4e3,size:60,color:"#1d78ff"})])):u("",!0)]),_:1},8,["showModal","onClose"])):u("",!0)])])],64)}const Qe=V(Re,[["render",Ke],["__scopeId","data-v-2e95602c"]]);function Ye(e){const{provider:t,mobile:d,auth_key:T,sender_id:s,route:o,owner_email:v,subacc:m,subacc_pass:g,smslive_sender_id:p,userid_gupshup:w,password_gupshup:P,vonage_api_key:C,vonage_api_secret:b}=e;var y={provider:[t,"isRequired"]};t&&t.name==="msg91.com"&&(y.auth_key=[T,"isRequired"],y.sender_id=[s,"isRequired"],y.route=[o,"isRequired"]),t&&t.name==="smslive247.com"&&(y.owner_email=[v,"isRequired","isEmail"],y.subacc=[m,"isRequired"],y.subacc_pass=[g,"isRequired"],y.smslive_sender_id=[p,"isRequired"]),t&&t.name==="gupshup.com"&&(y.userid_gupshup=[w,"isRequired"],y.password_gupshup=[P,"isRequired"]),t&&t.name==="vonage"&&(y.vonage_api_key=[C,"isRequired"],y.vonage_api_secret=[b,"isRequired"]),y.mobile=[d,"isRequired"];const j=new U(H),{errors:R,isValid:A}=j.validate(y);return B.dispatch("setValidationError",R),{errors:R,isValid:A}}const $e={name:"sms-provider-settings",data(){return{providerName:"",providers:[],providerData:{},loading:!0,hasDataPopulated:!1,pageLoad:!1,provider:"",mobile:"",auth_key:"",sender_id:"",route:"",owner_email:"",subacc:"",subacc_pass:"",smslive_sender_id:"",userid_gupshup:"",password_gupshup:"",vonage_api_key:"",vonage_api_secret:""}},beforeMount(){this.providerName=this.$route.params.provider,this.getValues()},methods:{setProviderConfigs(){this.provider={id:this.providerData.id,name:this.providerName},this.providerName=="msg91.com"&&(this.auth_key=this.providerData.auth_key,this.sender_id=this.providerData.sender_id,this.route=this.providerData.route),this.providerName=="smslive247.com"&&(this.owner_email=this.providerData.owner_email,this.subacc=this.providerData.subacc,this.subacc_pass=this.providerData.subacc_pass,this.smslive_sender_id=this.providerData.smslive_sender_id),this.providerName=="gupshup.com"&&(this.userid_gupshup=this.providerData.userid_gupshup,this.password_gupshup=this.providerData.password_gupshup),this.providerName=="vonage"&&(this.vonage_api_key=this.providerData.vonage_api_key,this.vonage_api_secret=this.providerData.vonage_api_secret)},getValues(){this.loading=!0,k.get("/sms/api/provider/settings/"+this.providerName).then(e=>{this.providerData=e.data.data.providersDetails,this.setProviderConfigs(),this.loading=!1,this.hasDataPopulated=!0}).catch(e=>{this.loading=!1,this.hasDataPopulated=!0,f(e,"sms-provider-settings")})},onChange(e,t){this[t]=e,e===null&&(this[t]="")},isValid(){const{errors:e,isValid:t}=Ye(this.$data);return t},onSubmit(){if(this.isValid()){this.pageLoad=!0;const e={};e.provider_id=this.provider.id,this.providerName=="msg91.com"&&(e.auth_key=this.auth_key,e.sender_id=this.sender_id,e.route=this.route),this.providerName=="smslive247.com"&&(e.owner_email=this.owner_email,e.subacc=this.subacc,e.subacc_pass=this.subacc_pass,e.smslive_sender_id=this.smslive_sender_id),this.providerName=="gupshup.com"&&(e.userid_gupshup=this.userid_gupshup,e.password_gupshup=this.password_gupshup),this.providerName==="vonage"&&(e.vonage_api_key=this.vonage_api_key,e.vonage_api_secret=this.vonage_api_secret),e.mobile=this.mobile,k.post("/sms/api/provider/settings",e).then(t=>{this.pageLoad=!1,this.hasDataPopulated=!1,this.mobile="",O(t,"sms-provider-settings"),this.getValues()}).catch(t=>{this.pageLoad=!1,f(t,"sms-provider-settings")})}}},components:{"text-field":J,"number-field":E,"dynamic-select":G}},xe={class:"col-sm-12"},et={key:0,class:"row"},tt={class:"card card-light"},st={class:"card-header"},it={class:"card-title"},ot={class:"card-body"},at={key:0,class:"row"},rt={key:0,class:"row"},nt={key:1,class:"row"},lt={key:2,class:"row"},dt={key:3,class:"row"},ut={class:"row"},pt={class:"card-footer"};function ht(e,t,d,T,s,o){const v=h("alert"),m=h("custom-loader"),g=h("reuse-loader"),p=h("text-field"),w=h("number-field");return a(),r("div",xe,[l(v,{componentName:"sms-provider-settings"}),s.pageLoad?(a(),r("div",et,[l(m,{duration:4e3})])):u("",!0),i("div",tt,[i("div",st,[i("h3",it,n(e.lang(s.providerName))+" "+n(e.lang("configurations")),1)]),i("div",ot,[!s.hasDataPopulated||s.loading?(a(),r("div",at,[l(g,{"animation-duration":4e3,size:60})])):u("",!0),s.hasDataPopulated?(a(),r(L,{key:1},[s.providerName=="msg91.com"?(a(),r("div",rt,[l(p,{label:e.trans("auth_key"),value:s.auth_key,type:"text",name:"auth_key",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("auth_key_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("sender_id"),value:s.sender_id,type:"text",name:"sender_id",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("sender_id_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("route"),value:s.route,type:"text",name:"route",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("route_placeholder")},null,8,["label","value","onChange","placehold"])])):u("",!0),s.providerName=="smslive247.com"?(a(),r("div",nt,[l(p,{label:e.trans("owner_email"),value:s.owner_email,type:"text",name:"owner_email",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("owner_email_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("subacc"),value:s.subacc,type:"text",name:"subacc",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("subacc_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("subacc_pass"),value:s.subacc_pass,type:"password",name:"subacc_pass",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("subacc_pass_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("smslive_sender_id"),value:s.smslive_sender_id,type:"text",name:"smslive_sender_id",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("smslive_sender_id_placeholder")},null,8,["label","value","onChange","placehold"])])):u("",!0),s.providerName=="gupshup.com"?(a(),r("div",lt,[l(p,{label:e.trans("userid_gupshup"),value:s.userid_gupshup,type:"text",name:"userid_gupshup",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("userid_gupshup_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("password_gupshup"),value:s.password_gupshup,type:"password",name:"password_gupshup",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("password_gupshup_placeholder")},null,8,["label","value","onChange","placehold"])])):u("",!0),s.providerName=="vonage"?(a(),r("div",dt,[l(p,{label:e.trans("vonage_api_key"),value:s.vonage_api_key,type:"text",name:"vonage_api_key",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("vonage_api_key_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("vonage_api_secret"),value:s.vonage_api_secret,type:"text",name:"vonage_api_secret",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("vonage_api_secret_placeholder")},null,8,["label","value","onChange","placehold"])])):u("",!0),i("div",ut,[l(w,{label:e.trans("mobile"),value:s.mobile,name:"mobile",classname:"col-sm-12",onChange:o.onChange,type:"number",required:!0,placeholder:e.trans("mobile-placeholder")},null,8,["label","value","onChange","placeholder"])])],64)):u("",!0)]),i("div",pt,[i("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=P=>o.onSubmit())},[t[1]||(t[1]=i("i",{class:"fas fa-save"},null,-1)),_(" "+n(e.trans("save")),1)])])])])}const ct=V($e,[["render",ht]]),_t={name:"provider-actions",description:"Providers Action",props:{data:{type:Object,required:!0}},data(){return{loading:!1,showModal:!1,isDisabled:!1,containerStyle:{width:"650px"}}},methods:{onClose(){this.showModal=!1,window.emitter.emit("refreshData")},onSubmit(){axios.post("sms/api/provider/"+this.data.name+"/"+(this.data.status?"deactivate":"activate")).then(e=>{O(e,"providers-index"),this.onClose()}).catch(e=>{this.showModal=!1,f(e,"providers-index")})},redirectToSettingPages(){this.$router.push(`settings/${this.data.name}`)}},components:{}},mt={key:0},gt={class:"modal-title"},ft={key:0},vt={key:1,class:"row"},bt=["disabled"];function yt(e,t,d,T,s,o){const v=h("reuse-loader"),m=h("modal"),g=M("tooltip");return d.data?(a(),r("div",mt,[q((a(),r("span",null,[i("button",{class:"btn btn-light table_btn",onClick:t[0]||(t[0]=p=>s.showModal=!0)},[i("i",{class:D(d.data.status?"fas fa-solid fa-xmark":"fas fa-check-circle")},null,2)])])),[[g,d.data.status?e.trans("deactivate"):e.trans("activate")]]),q((a(),r("span",null,[i("button",{class:"btn btn-light table_btn",onClick:t[1]||(t[1]=(...p)=>o.redirectToSettingPages&&o.redirectToSettingPages(...p))},t[3]||(t[3]=[i("i",{class:"fas fa-cog"},null,-1)]))])),[[g,e.trans("configure")]]),l(N,{name:"modal"},{default:c(()=>[s.showModal?(a(),S(m,{key:0,showModal:s.showModal,onClose:o.onClose,"container-style":s.containerStyle},{title:c(()=>[i("h4",gt,n(d.data.status?e.trans("deactivate"):e.trans("activate")),1)]),fields:c(()=>[s.loading?u("",!0):(a(),r("div",ft,[i("span",null,n(e.trans("are_you_sure")),1)])),s.loading?(a(),r("div",vt,[l(v,{"animation-duration":4e3,size:60})])):u("",!0)]),controls:c(()=>[i("button",{type:"button",onClick:t[2]||(t[2]=(...p)=>o.onSubmit&&o.onSubmit(...p)),class:D(d.data.status?"btn btn-danger":"btn btn-primary"),disabled:s.isDisabled},[t[4]||(t[4]=i("i",{class:"fas fa-check"},null,-1)),_(" "+n(d.data.status?e.trans("deactivate"):e.trans("activate")),1)],10,bt)]),_:1},8,["showModal","onClose","container-style"])):u("",!0)]),_:1})])):u("",!0)}const kt=V(_t,[["render",yt]]),wt={name:"providers-list",description:"providers List",data(){return{apiUrl:"sms/providers/list",columns:["name","status","actions"],options:{}}},setup(){const e=W();return{formattedTime:X(()=>e.getters.formattedTime)}},beforeMount(){const e=this;this.options={headings:{name:this.trans("name"),status:this.trans("status")},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{name:function(t,d){return d.name},status:function(t,d){let T=e.h("span",{class:d.status===1?"btn btn-success btn-sm":"btn btn-danger btn-sm"},d.status===1?this.lang("active"):this.lang("inactive"));return e.h("a",{},[T])},actions:(t,d)=>e.h(kt,{data:d})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{paginate:1,"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"asc":"desc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}},orderBy:{column:"id",ascending:!0}}},components:{}},Ct={class:"col-sm-12"},Tt={class:"card card-light"},Ot={class:"card-header"},Pt={id:"contract-type-list",class:"card-title"},Dt={class:"card-body"};function St(e,t,d,T,s,o){const v=h("alert"),m=h("data-table");return a(),r("div",Ct,[l(v,{componentName:"providers-index"}),i("div",Tt,[i("div",Ot,[i("h3",Pt,n(e.lang("providers_list")),1)]),i("div",Dt,[l(m,{url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"contract-type-list"},null,8,["url","dataColumns","option"])])])])}const qt=V(wt,[["render",St]]);z("otp-box-profile",Ie,"profile-box-mounted","profile-view-boxes");z("otp-box-profile-client",Qe,"2step-box-mounted","2step-boxes");Q.addRoute({path:"/verify-otp",component:Y,name:"VerifyOtpMain",redirect:"/verify-otp",children:[{path:"",component:fe,name:"VerifyOTP",meta:{breadcrumb:[{text:"verify_mobile_number"}]}}]});x.addRoute({path:"/sms",component:ee,name:"SMS",redirect:"/sms/providers/list",children:[{path:"providers/settings/:provider",component:ct,name:"SMSProviderSettings",meta:{title:"SMS",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"providers",to:"/sms"},active:"provider"}}},{path:"providers/list",component:qt,name:"SMSProviderIndex",meta:{title:"sms_providers",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"sms_providers"}}}]});
