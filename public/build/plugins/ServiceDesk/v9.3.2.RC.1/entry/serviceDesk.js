import{ad as Ue,a2 as Ce,s as Fe,_ as P,Z as re,c as z,B as T,ah as pe,C as K,E as O,T as Ae,D as fe,aS as Ft,k as u,W,o,l,F as _,q as c,t as Q,v as n,x as r,L as S,m as k,G as w,I as v,b3 as Xe,a5 as Xt,b6 as Zt,a3 as Ze,a1 as X,J as U,aQ as ra,f as Re,ao as Ge,K as $,b2 as da,e as se,u as we,$ as Qe,A as Ot,b0 as Qt,P as cs,M as ut,an as pn,bm as _n,ap as Ie,N as ca,g as ua,j as es,aV as at,af as Mt,ag as qt,aW as It,aN as vt,b5 as At,a4 as We,a6 as nt,a8 as wt,aX as kt,z as fn,aZ as gn,y as bn,X as ct,R as mt,ak as ls,H as Wt,w as Ps,V as ma,Y as yn,ae as ts,bn as rs,ay as us,aI as Ts,h as vn,aD as Vs,S as wn,aR as kn,aj as Cn,O as Ye,ab as Dn,bo as Ls}from"../../../../v9.4.0.5/chunks/bootstrap.js";import{R as De,u as ha,a as Sn}from"../../../../v9.4.0.5/chunks/vue-router.js";import{C as pa}from"../../../../v9.4.0.5/chunks/Checkbox.js";import{C as ms,e as Mn,_ as _a}from"../../../../v9.4.0.5/chunks/SDReports.js";import{r as Fn,a as Us}from"../../../../v9.4.0.5/chunks/clientRouter.js";import{U as Pt,b as Tt,f as In,d as fa,g as An,c as Pn,S as Ns,e as Tn,C as Vn,v as Ln,r as Un,A as Ct}from"../../../../v9.4.0.5/chunks/agentRouter.js";import{a as qe,T as hs,N as ps,S as _s,b as ot,e as Nn,C as En,c as xn}from"../../../../v9.4.0.5/chunks/DataTableActions.js";import{n as fs,R as ga,C as ba,S as On,D as qn}from"../../../../v9.4.0.5/chunks/FormGenerator.js";import{C as ya}from"../../../../v9.4.0.5/chunks/Loader.js";import{C as jn}from"../../../../v9.4.0.5/chunks/ChangeCustomFields.js";import{T as Rn}from"../../../../v9.4.0.5/chunks/TaskActionButtons.js";import{M as Bn,_ as zn,d as Kn,v as Hn,r as Yn,A as Te,e as $t,S as Jt}from"../../../../v9.4.0.5/chunks/adminRouter.js";import{c as $n,b as Wn}from"../../../../v9.4.0.5/chunks/CurrencySelect.js";import"../../../../v9.4.0.5/chunks/PermaLink.js";import"../../../../v9.4.0.5/chunks/approvalTicketRules.js";import"../../../../v9.4.0.5/chunks/BarcodeModal.js";import"../../../../v9.4.0.5/chunks/index.js";import"../../../../v9.4.0.5/chunks/HelpSection.js";import"../../../../v9.4.0.5/chunks/AdminNavigationBar.js";import"../../../../v9.4.0.5/chunks/EleaTicketThreadSummary.js";function Jn(e){const{subject:t,identifier:s,from:d,department_id:a,impact_id:i,status_type_id:m,priority_id:h,description:b}=e;var f={subject:[t,"isRequired",{"max(50)":"The subject should be less than 50 characters."}],identifier:[s,{"max(45)":"The identifier should be less than 45 characters."}],from:[d,"isRequired"],department_id:[a,"isRequired"],impact_id:[i,"isRequired"],status_type_id:[m,"isRequired"],priority_id:[h,"isRequired"],description:[b,"isRequired"]};const g=new Ue(Ce),{errors:D,isValid:M}=g.validate(f);return Fe.dispatch("setValidationError",D),{errors:D,isValid:M}}const Gn={setup(){const e=re();return{getStoredTicketId:z(()=>e.getters.getStoredTicketId)}},props:{box_class:{type:String,default:"card card-light "},title_val:{type:String,default:""},closePopup:{type:Function},alert:{type:String,default:"problem"}},data(){return{title:"create_problem",iconClass:"fas fa-save",btnName:"submit",hasDataPopulated:!1,loading:!1,problem_id:"",subject:"",identifier:"",description:"",from:"",department_id:"",impact_id:"",status_type_id:"",location_id:"",priority_id:"",assigned_id:"",asset_ids:[],attachment:"",deleteUrl:"",apiUrl:"",show_attach_assets:!0,selectedFile:"",attachment_delete:!1}},beforeMount(){const e=window.location.pathname;this.getValues(e)},mounted(){this.getActions()},methods:{getActions(){T.get("/service-desk/get/permissions").then(e=>{this.show_attach_assets=e.data.data.actions.attach_asset}).catch(e=>{})},getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.title="edit_problem",this.iconClass="fas fa-sync-alt",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0,this.subject=this.box_class==="problem_card"?this.title_val:"")},getInitialValues(e){this.loading=!0,T.get("/service-desk/api/problem/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.problem_id=t.data.data.id,this.updateStatesWithData(t.data.data),this.asset_ids=t.data.data.assets,this.from=t.data.data.requester_id}).catch(t=>{this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])}),this.attachment&&(this.attachment.link="/service-desk/download/"+this.attachment.id+"/sd_problem:"+this.problem_id+"/attachment")},isValid(){const{errors:e,isValid:t}=Jn(this.$data);return!!t},onFileSelected(e,t,s){this.selectedFile=e[0],this.attachment_delete=s},onChange(e,t){this[t]=e,e===null&&(this[t]="")},onSubmit(){if(this.apiUrl=this.box_class==="problem_card"?"/service-desk/api/problem?ticket_id="+this.getStoredTicketId:"/service-desk/api/problem/",this.isValid()){this.loading=!0;var e=new FormData;if(this.problem_id!=""&&e.append("id",this.problem_id),e.append("subject",this.subject),e.append("identifier",this.identifier),e.append("description",this.description),e.append("requester_id",this.from.id),e.append("department_id",this.department_id.id),e.append("impact_id",this.impact_id.id),e.append("status_type_id",this.status_type_id.id),e.append("priority_id",this.priority_id.id),this.asset_ids.length)for(var t in this.asset_ids)e.append("asset_ids["+t+"]",this.asset_ids[t].id);else e.append("asset_ids","");e.append("location_id",this.location_id?this.location_id.id:""),e.append("assigned_id",this.assigned_id?this.assigned_id.id:""),this.selectedFile&&e.append("attachment",this.selectedFile),this.attachment&&!this.attachment_delete&&!this.selectedFile&&e.append("attachment_ids[0]",this.attachment.id),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete);const s={headers:{"Content-Type":"multipart/form-data"}};T.post(this.apiUrl,e,s).then(d=>{this.loading=!1,K(d,this.alert),window.emitter.emit("updateAgentSidebar"),this.problem_id===""&&this.box_class!=="problem_card"?setTimeout(()=>{let a=d.data.data.id;this.$router.push("/service-desk/problem/"+a+"/show")},3e3):this.getInitialValues(this.problem_id),this.box_class==="problem_card"?this.actionMethod():window.scrollTo(0,0)}).catch(d=>{window.scrollTo(0,0),this.loading=!1,O(d,"problem")})}},actionMethod(){this.closePopup(),window.emitter.emit("actionDone","external")}},components:{"text-field":Ae,"dynamic-select":fe,"file-upload":Ft}},Xn={key:0,class:"row"},Zn={key:0,class:"card-header"},Qn={class:"card-title"},eo={key:0,class:"card-tools"},to={class:"card-body"},so={class:"row"},ao={class:"row"},no={class:"row"},oo={class:"row"},io={class:"row"},lo={class:"ml_7"},ro={class:"row"},co={key:1,class:"card-footer"};function uo(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("router-link"),f=u("text-field"),g=u("dynamic-select"),D=u("tiny-editor"),M=u("file-upload"),x=W("tooltip"),R=W("focus-first-input");return o(),l("div",{class:Q({"col-sm-12":s.box_class!="problem_card"})},[a.hasDataPopulated===!1||a.loading===!0?(o(),l("div",Xn,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"problem"}),a.hasDataPopulated===!0?(o(),l("div",{key:1,class:Q(s.box_class)},[s.box_class!=="problem_card"?(o(),l("div",Zn,[n("h3",Qn,r(e.lang(a.title)),1),a.problem_id!==""?(o(),l("div",eo,[S((o(),k(b,{class:"btn btn-tool",id:"view_problem",to:"/service-desk/problem/"+a.problem_id+"/show"},{default:w(()=>t[1]||(t[1]=[n("i",{class:"fas fa-eye"},null,-1)])),_:1},8,["to"])),[[x,e.lang("view")]])])):c("",!0)])):c("",!0),n("div",to,[S((o(),l("div",so,[_(f,{label:e.lang("subject"),value:a.subject,type:"text",name:"subject",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),_(f,{label:e.lang("identifier"),value:a.identifier,type:"text",name:"identifier",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6"},null,8,["label","value","onChange","placehold"])])),[[R]]),n("div",ao,[_(g,{label:e.lang("requester"),multiple:!1,name:"from",classname:"col-sm-6",apiEndpoint:"/api/dependency/users?meta=true",value:a.from,onChange:i.onChange,required:!0,strlength:"40"},null,8,["label","value","onChange"]),_(g,{label:e.lang("department"),multiple:!1,name:"department_id",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",value:a.department_id,onChange:i.onChange,required:!0,strlength:"40"},null,8,["label","value","onChange"])]),n("div",no,[_(g,{label:e.lang("impact"),multiple:!1,name:"impact_id",strlength:"40",classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/impacts",value:a.impact_id,onChange:i.onChange,required:!0},null,8,["label","value","onChange"]),_(g,{label:e.lang("status"),multiple:!1,name:"status_type_id",strlength:40,classname:"col-sm-6",apiEndpoint:"/service-desk/api/status/list?module=1",value:a.status_type_id,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])]),n("div",oo,[_(g,{label:e.lang("location"),multiple:!1,name:"location_id",prePopulate:!1,strlength:"40",classname:"col-sm-6",apiEndpoint:"/api/dependency/locations",value:a.location_id,onChange:i.onChange},null,8,["label","value","onChange"]),_(g,{label:e.lang("priority"),multiple:!1,name:"priority_id",strlength:"40",classname:"col-sm-6",apiEndpoint:"/api/dependency/priorities",value:a.priority_id,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])]),n("div",io,[_(g,{label:e.lang("assigned-to"),multiple:!1,name:"assigned_id",strlength:"40",classname:"col-sm-6",apiEndpoint:"/api/dependency/agents?meta=true",value:a.assigned_id,onChange:i.onChange},null,8,["label","value","onChange"]),a.show_attach_assets?(o(),k(g,{key:0,label:e.lang("attach_assets"),multiple:!0,name:"asset_ids",strlength:"40",classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/assets",value:a.asset_ids,onChange:i.onChange},null,8,["label","value","onChange"])):c("",!0)]),n("div",lo,[_(D,{value:a.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en",id:"problem_editor"},null,8,["value","onChange","label"])]),n("div",ro,[_(M,{label:e.lang("attachments"),value:a.attachment,formType:"service_desk",name:"attachment",onChange:i.onFileSelected,classname:"col-sm-6",id:a.problem_id},null,8,["label","value","onChange","id"])])]),s.box_class!=="problem_card"?(o(),l("div",co,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=V=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])])):c("",!0)],2)):c("",!0)],2)}const mo=P(Gn,[["render",uo]]);const ho={name:"problem-modal",description:"Problem Modal component",props:{showModal:{type:Boolean,default:!1},title:{type:String,default:""},onClose:{type:Function},data:{type:[Object,String],required:!0}},data:()=>({isDisabled:!1,containerStyle:{width:"850px"},loading:!1,size:60,classname:"",createLoader:!1,problem:""}),watch:{problem(e,t){return this.isDisabled=!(this.title==="attach_existing_problem"&&e!==""),e}},computed:{titleParsed(){return JSON.parse(this.data).title},ticketId(){return JSON.parse(this.data).id},alertName(){return JSON.parse(this.data).alertName?JSON.parse(this.data).alertName:"problem-modal"}},beforeMount(){this.isDisabled=this.title==="attach_existing_problem"&&this.problem==="",this.title=="attach_new_problem"&&(this.classname="problem_fileds",this.createLoader=!0,setTimeout(()=>{this.createLoader=!1},1e3))},methods:{onSubmit(){this.title==="attach_new_problem"?this.$refs.create_problem.onSubmit():(this.loading=!0,T.post("/service-desk/api/problem-attach-ticket/"+this.ticketId+"/"+this.problem.id).then(e=>{K(e,this.alertName),this.loading=!1,window.emitter.emit("actionDone","external"),this.onClose()}).catch(e=>{O(e,this.alertName),this.loading=!1}))},onChange(e,t){this[t]=e}},components:{problem:mo,"dynamic-select":fe}},po={class:"modal-title"},_o={key:0},fo={key:0,class:"row",id:"load_margin"},go={key:1},bo={key:1,class:"row"},yo={key:2,class:"row"},vo=["disabled"];function wo(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("problem"),b=u("dynamic-select"),f=u("custom-loader"),g=u("modal");return s.showModal?(o(),k(g,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle,modalBodyClass:e.classname},{title:w(()=>[n("h4",po,r(e.lang(s.title)),1)]),fields:w(()=>[s.title==="attach_new_problem"?(o(),l("div",_o,[e.createLoader?(o(),l("div",fo,[_(m,{duration:4e3})])):(o(),l("div",go,[_(h,{box_class:"problem_card",title_val:i.titleParsed,closePopup:s.onClose,ref:"create_problem",alert:"timeline"},null,8,["title_val","closePopup"])]))])):c("",!0),s.title==="attach_existing_problem"?(o(),l("div",bo,[_(b,{label:e.lang("problems"),multiple:!1,name:"problem",classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/problems",value:e.problem,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])])):c("",!0),e.loading===!0?(o(),l("div",yo,[_(f,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=(...D)=>i.onSubmit&&i.onSubmit(...D)),class:"btn btn-primary",disabled:e.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(e.lang("attach")),1)],8,vo)]),_:1},8,["showModal","onClose","containerStyle","modalBodyClass"])):c("",!0)}const ko=P(ho,[["render",wo]]);const Co={name:"create-problem-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},data:{type:[Object,String],required:!0}},data(){return{formUniqueKey:"",submitFormInProgress:!1,scenario:"create",panel:"agent",page:"add_ticket_with_form",fetchFormFieldApi:"/api/form/render/",selectedForm:"",formSelected:!1}},mixins:[Xe],beforeMount(){this.getDefaultFormValue()},methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/problem").then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},popUpSubmit(){document.getElementById("create-problem-submit").click()},formSubmit(e,t){this.onSubmit()},afterSubmit(e){setTimeout(()=>{window.emitter.emit("AssociatedProblemrefreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose()},1e3)}},beforeDestroy(){this.$store.dispatch("unsetAlert")},components:{Modal:Xt,FormWithCaptcha:Zt,FormRenderer:Ze}},Do={class:"attach-new-problem"},So={key:1,id:"problem_modal_body"},Mo=["disabled"];function Fo(e,t,s,d,a,i){const m=u("custom-loader"),h=u("loader"),b=u("alert"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FormWithCaptcha"),M=u("Modal");return o(),l("div",Do,[a.submitFormInProgress?(o(),k(m,{key:0})):c("",!0),s.showModal?(o(),k(M,{key:1,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",null,r(e.trans("attach_new_problem")),1)]),fields:w(()=>[e.showLoader?(o(),k(h,{key:0})):c("",!0),a.formUniqueKey&&a.formSelected?(o(),l("div",So,[_(b,{componentName:"faveo-form"}),_(D,{loading:!e.showLoader,btnClass:"btn btn-primary float-end",btnName:"submit",page:"problem_add_agent",componentName:"faveo-form",btn_id:"create-problem-submit",formSubmit:i.formSubmit,recaptchaContainerClass:"mt-2",disableSubmit:a.submitFormInProgress},{fields:w(()=>[_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:a.scenario,category:"problem",panel:a.panel},null,8,["fetchFormFieldApi","formUniqueKey","scenario","panel"]))]),_:1},512)]),_:1},8,["loading","formSubmit","disableSubmit"])])):c("",!0)]),controls:w(()=>[e.showLoader?c("",!0):(o(),l("button",{key:0,type:"submit",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=x=>i.popUpSubmit())},[t[1]||(t[1]=n("i",{class:"fas fa-save"},null,-1)),v("  "+r(e.trans("save")),1)],8,Mo))]),_:1},8,["showModal","onClose"])):c("",!0)])}const Io=P(Co,[["render",Fo],["__scopeId","data-v-725cfe66"]]);const Ao={props:{actions:{type:Object,default:()=>{}},data:{type:[Object,String],required:!0}},data(){return{showModal:!1,title:"",showNewProblemModal:!1}},methods:{showModalMethod(e){this.currentModal=e,this.title=e==="attach_new"?"attach_new_problem":"attach_existing_problem",this.showModal=!0},onClose(){this.showModal=!1,this.showNewProblemModal=!1,this.$store.dispatch("unsetValidationError")}},components:{AttachNewProblemModal:Io,"problem-modal":ko}},Po={class:"btn-group"},To={type:"button",class:"btn btn-xs btn-light dropdown-toggle","data-bs-toggle":"dropdown"},Vo={class:"dropdown-menu"};function Lo(e,t,s,d,a,i){const m=u("problem-modal"),h=u("AttachNewProblemModal");return o(),l("div",Po,[n("button",To,[t[2]||(t[2]=n("i",{class:"fas fa-bug"},null,-1)),v(" "+r(e.lang("problem")),1)]),n("div",Vo,[s.actions.show_attach_new_problem?(o(),l("a",{key:0,class:"dropdown-item",onClick:t[0]||(t[0]=b=>a.showNewProblemModal=!0),id:"attach_new"},[t[3]||(t[3]=n("i",{class:"fas fa-bug"},null,-1)),v(" "+r(e.lang("attach_new_problem")),1)])):c("",!0),s.actions.show_attach_existing_problem?(o(),l("a",{key:1,class:"dropdown-item",onClick:t[1]||(t[1]=b=>i.showModalMethod("attach_exists")),id:"attach_exists"},[t[4]||(t[4]=n("i",{class:"fas fa-bug"},null,-1)),v(" "+r(e.lang("attach_existing_problem")),1)])):c("",!0)]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showModal,title:a.title,data:s.data},null,8,["onClose","showModal","title","data"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showNewProblemModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showNewProblemModal,data:s.data},null,8,["onClose","showModal","data"])):c("",!0)]),_:1})])}const Uo=P(Ao,[["render",Lo],["__scopeId","data-v-4ed5bad8"]]),No={name:"delete-modal",description:"Delete Modal component",setup(){const e=re();return{getStoredTicketId:z(()=>e.getters.getStoredTicketId)}},props:{showModal:{type:Boolean,default:!1},assetId:{type:Number,default:0},onClose:{type:Function},from:{type:String,default:""},problemId:{type:[Number,String],default:""},data:{type:[Object,String],default:""},alert:{type:String,default:""}},data:()=>({isDisabled:!1,containerStyle:{width:"500px"},loading:!1,size:60,lang_locale:"",ticketId:0,apiUrl:""}),computed:{alertName(){return JSON.parse(this.data).alertName?JSON.parse(this.data).alertName:"problem-modal"}},created(){this.lang_locale=localStorage.getItem("LANGUAGE"),this.ticketId=this.getStoredTicketId},methods:{onSubmit(){this.apiUrl=this.from!=="modal"?"/service-desk/api/detach-asset/"+this.ticketId+"/"+this.assetId:"/service-desk/api/problem-detach-ticket/"+this.problemId+"/"+this.ticketId,this.loading=!0,this.isDisabled=!0,T.delete(this.apiUrl).then(e=>{this.from!=="modal"?(this.alert=="timeline"?(K(e,this.alert),window.emitter.emit("AssetListrefreshData")):(K(e,"dataTableModal"),window.emitter.emit("refreshData")),this.onClose()):(K(e,this.alertName),this.actionMethod()),this.loading=!1,this.isDisabled=!0}).catch(e=>{O(e,"dataTableModal"),this.onClose()})},actionMethod(){window.emitter.emit("actionDone","external"),this.onClose()}}},Eo={class:"modal_title"},xo={key:0},Oo={key:1,class:"row"},qo=["disabled"];function jo(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:w(()=>[n("h4",Eo,r(e.lang("detach")),1)]),fields:w(()=>[e.loading?c("",!0):(o(),l("div",xo,[n("span",null,r(e.lang("are_you_sure")),1)])),e.loading?(o(),l("div",Oo,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:e.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("detach")),1)],8,qo)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const va=P(No,[["render",jo]]);const Ro={name:"asset-list-with-checkbox",description:"Assets table component",setup(){const e=re();return{getStoredTicketId:z(()=>e.getters.getStoredTicketId)}},props:{apiUrl:{type:String,default:""},tickets:{type:Function,default:()=>{}},componentTitle:{type:String,default:""},from:{type:String,default:""}},data:()=>({columns:["id","name","used_by","managed_by","contract"],options:{}}),beforeMount(){const e=this;this.options={texts:{filter:"",limit:""},headings:{id:this.trans("id"),name:this.trans("name"),used_by:this.trans("used_by"),managed_by:this.trans("managed_by"),contract:this.trans("contract")},columnsClasses:{id:"asset-check-id",name:"asset-check-name",used_by:"asset-check-used",managed_by:"asset-check-manage",contract:"asset-check-contract"},templates:{used_by(t,s){var d,a;return((a=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},managed_by(t,s){var d,a;return((a=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},contract:function(t,s){return s.contract&&!Array.isArray(s.contract)?e.from=="admin"?e.h("a",{href:e.basePath()+"/panel/service-desk/contracts/"+s.contract.id+"/show",style:"color:#007bff !important",target:"_blank"},s.contract.name):e.h(De,{to:"/service-desk/contracts/"+s.contract.id+"/show",style:"color:#007bff !important",target:"_blank"},s.contract.name):"--"}},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(s=>(s.detach=!0,s)),count:t.data.total}},orderBy:{column:"name",ascending:!0}}}},Bo={id:"asset-checkbox"};function zo(e,t,s,d,a,i){const m=u("data-table");return o(),l("div",Bo,[_(m,{url:s.apiUrl,dataColumns:e.columns,option:e.options,tickets:s.tickets,componentTitle:s.componentTitle,scroll_to:"asset-checkbox"},null,8,["url","dataColumns","option","tickets","componentTitle"])])}const ht=P(Ro,[["render",zo]]);const Ko={name:"asset-attach-modal",description:"Attach asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},data:{type:[Object,String],required:!0},from:{type:String,default:""},alert:{type:String,default:"attach-asset-modal"}},data:()=>({used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,asset_types:[],asset_type:"",apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"AttachAsset"}),watch:{assetIds(e){this.isDisabled=!(e.length>0)}},computed:{ticketId(){return JSON.parse(this.data).id}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?ticket_id="+this.ticketId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.ticket_id=this.ticketId,e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};T.post("/service-desk/api/ticket-attach-assets",e,t).then(s=>{this.loading=!1,K(s,this.alert),window.emitter.emit("AssetListrefreshData"),this.onClose()}).catch(s=>{this.loading=!1,O(s,"attach-asset-modal")})}}},components:{"asset-list-with-checkbox":ht,"dynamic-select":fe}},Ho={class:"modal-title"},Yo={class:"attach-asset"},$o={class:"row"},Wo={class:"col-sm-12"},Jo={class:"height-limit"},Go={key:0,class:"row"},Xo=["disabled"];function Zo(e,t,s,d,a,i){const m=u("alert"),h=u("dynamic-select"),b=u("asset-list-with-checkbox"),f=u("custom-loader"),g=u("modal");return s.showModal?(o(),k(g,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{alert:w(()=>[_(m,{componentName:"attach-asset-modal"})]),title:w(()=>[n("h4",Ho,r(e.lang("attach_assets")),1)]),fields:w(()=>[n("div",Yo,[n("div",$o,[_(h,{label:e.lang("asset_types"),multiple:!1,name:"asset_type_ids",classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:e.asset_type_ids,onChange:i.onChange,clearable:!!e.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(h,{label:e.lang("used_by"),multiple:!1,name:"used_by_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:e.used_by_ids,onChange:i.onChange,clearable:!!e.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(h,{label:e.lang("managed_by"),multiple:!1,name:"managed_by_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:e.managed_by_ids,onChange:i.onChange,clearable:!!e.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(h,{label:e.lang("organizations"),multiple:!1,name:"org_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:e.org_ids,onChange:i.onChange,clearable:!!e.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),n("div",Wo,[n("button",{id:"apply-btn",class:"btn btn-primary round-btn float-start",type:"button",onClick:t[0]||(t[0]=D=>i.onApply())},[t[2]||(t[2]=n("span",{class:"fas fa-check"},null,-1)),v("  "+r(e.lang("apply")),1)])])]),t[3]||(t[3]=n("br",null,null,-1)),n("div",Jo,[e.apiUrl?(o(),k(b,{key:0,apiUrl:e.apiUrl,tickets:i.assetsData,componentTitle:e.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)])]),e.loading===!0?(o(),l("div",Go,[_(f,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=D=>i.onSubmit()),class:"btn btn-primary",disabled:e.isDisabled},[t[4]||(t[4]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.lang("attach")),1)],8,Xo)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Qo=P(Ko,[["render",Zo]]);const ei={name:"attach-change-modal",description:"Attach change Modal component",props:{showModal:{type:Boolean,default:!1},title:{type:String,default:""},type:{type:String,default:""},onClose:{type:Function},data:{type:[Object,String],required:!0}},data(){return{isDisabled:!1,containerStyle:{width:"850px"},loading:!1,change:"",createLoader:!1,classname:""}},computed:{ticketId(){return JSON.parse(this.data).id}},beforeMount(){this.isDisabled=this.title==="link_to_an_existing_change"&&!this.change,this.title=="create_a_change_to_this_ticket"&&(this.classname="create-box",this.createLoader=!0,setTimeout(()=>{this.createLoader=!1},1e3))},methods:{onSubmit(){if(this.title==="link_to_an_existing_change"){this.loading=!0;const e={};e.ticket_id=this.ticketId,e.change_id=this.change.id,e.type=this.type,T.post("/service-desk/api/attach-change/ticket",e).then(t=>{K(t,"timeline"),this.onCompleted()}).catch(t=>{O(t,"change-attach-modal"),this.loading=!1})}},onCompleted(){this.loading=!1,window.emitter.emit("AssociatedChangerefreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose()},onChange(e,t){this[t]=e,this.isDisabled=!e}},components:{"dynamic-select":fe}},ti={class:"modal-title"},si={key:0,class:"row"},ai={key:1,class:"row"},ni=["disabled"];function oi(e,t,s,d,a,i){const m=u("alert"),h=u("dynamic-select"),b=u("custom-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle,modalBodyClass:a.classname},{title:w(()=>[n("h4",ti,r(e.lang(s.title)),1)]),fields:w(()=>[s.title==="link_to_an_existing_change"?(o(),l("div",si,[_(h,{label:e.lang("changes"),multiple:!1,name:"change",classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/changes_based_on_ticket?meta=true&ticket_id="+i.ticketId,value:a.change,onChange:i.onChange,required:!0,clearable:!!a.change},null,8,["label","apiEndpoint","value","onChange","clearable"])])):c("",!0),a.loading?(o(),l("div",ai,[_(b,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=(...g)=>i.onSubmit&&i.onSubmit(...g)),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.lang("attach")),1)],8,ni)]),default:w(()=>[_(m,{componentName:"change-attach-modal"})]),_:1},8,["showModal","onClose","containerStyle","modalBodyClass"])):c("",!0)}const ii=P(ei,[["render",oi]]);const li={name:"create-change-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},data:{type:[Object,String],required:!0}},data(){return{formUniqueKey:"",submitFormInProgress:!1,scenario:"create",panel:"agent",page:"add_ticket_with_form",fetchFormFieldApi:"/api/form/render/",selectedForm:"",formSelected:!1}},mixins:[Xe],beforeMount(){this.getDefaultFormValue()},methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/changes").then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},popUpSubmit(){document.getElementById("create-change-submit").click()},formSubmit(e,t){this.onSubmit()},afterSubmit(e){setTimeout(()=>{window.emitter.emit("AssociatedChangerefreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose()},1e3)}},beforeDestroy(){this.$store.dispatch("unsetAlert")},components:{FormWithCaptcha:Zt,FormRenderer:Ze}},ri={class:"attach-new-change"},di={key:1,id:"change_modal_body"},ci=["disabled"];function ui(e,t,s,d,a,i){const m=u("custom-loader"),h=u("loader"),b=u("alert"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FormWithCaptcha"),M=u("modal");return o(),l("div",ri,[a.submitFormInProgress?(o(),k(m,{key:0})):c("",!0),s.showModal?(o(),k(M,{key:1,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",null,r(e.trans("create_a_change_to_this_ticket")),1)]),fields:w(()=>[e.showLoader?(o(),k(h,{key:0})):c("",!0),a.formUniqueKey&&a.formSelected?(o(),l("div",di,[_(b,{componentName:"faveo-form"}),_(D,{loading:!e.showLoader,btnClass:"btn btn-primary float-end",btnName:"submit",page:"change_add_agent",componentName:"faveo-form",btn_id:"create-change-submit",formSubmit:i.formSubmit,recaptchaContainerClass:"mt-2",disableSubmit:a.submitFormInProgress},{fields:w(()=>[_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:a.scenario,category:"changes",panel:a.panel},null,8,["fetchFormFieldApi","formUniqueKey","scenario","panel"]))]),_:1},512)]),_:1},8,["loading","formSubmit","disableSubmit"])])):c("",!0)]),controls:w(()=>[e.showLoader?c("",!0):(o(),l("button",{key:0,type:"submit",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=x=>i.popUpSubmit())},[t[1]||(t[1]=n("i",{class:"fas fa-save"},null,-1)),v("  "+r(e.trans("save")),1)],8,ci))]),_:1},8,["showModal","onClose"])):c("",!0)])}const mi=P(li,[["render",ui],["__scopeId","data-v-cf654384"]]);const hi={props:{actions:{type:Object,default:()=>{}},data:{type:[Object,String],required:!0}},data(){return{showModal:!1,showNewChangeModal:!1,title:"",type:""}},methods:{showModalMethod(e){this.currentModal=e,this.title=e==="attach_new"?"create_a_change_to_this_ticket":"link_to_an_existing_change",this.type=e==="attach_initiating"?"initiating":"initiated",this.showModal=!0},onClose(){this.showModal=!1,this.showNewChangeModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"change-attach-modal":ii,"change-new-modal":mi}},pi={class:"btn-group"},_i={type:"button",class:"btn btn-xs btn-light dropdown-toggle change-btn","data-bs-toggle":"dropdown"},fi={class:"dropdown-menu dropdown-menu-right"},gi={class:"dropdown-item dropdown-header"},bi={class:"ml-15"},yi={class:"ml-15"};function vi(e,t,s,d,a,i){const m=u("change-attach-modal"),h=u("change-new-modal");return o(),l("div",pi,[n("button",_i,[t[3]||(t[3]=n("i",{class:"fas fa-sync-alt"},null,-1)),v(" "+r(e.lang("attach_change")),1)]),n("div",fi,[s.actions.attach_change_initiated?(o(),l(U,{key:0},[n("span",gi,r(e.lang("change_initiated_by_this_ticket")),1),n("a",{class:"dropdown-item",onClick:t[0]||(t[0]=b=>a.showNewChangeModal=!0),id:"attach_new",href:"javascript:;"},[n("span",bi,[t[4]||(t[4]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.lang("new_change")),1)])]),n("a",{class:"dropdown-item",onClick:t[1]||(t[1]=b=>i.showModalMethod("attach_exists")),id:"attach_exists",href:"javascript:;"},[n("span",yi,[t[5]||(t[5]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.lang("existing_change")),1)])])],64)):c("",!0),s.actions.attach_change_initiating?(o(),l("a",{key:1,class:"dropdown-item",onClick:t[2]||(t[2]=b=>i.showModalMethod("attach_initiating")),href:"javascript:;",id:"attach_initiating"},[t[6]||(t[6]=n("i",{class:"fas fa-sync-alt"},null,-1)),v(" "+r(e.lang("change_initiating_this_ticket")),1)])):c("",!0)]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showModal,title:a.title,data:s.data,type:a.type},null,8,["onClose","showModal","title","data","type"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showNewChangeModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showNewChangeModal,data:s.data},null,8,["onClose","showModal","data"])):c("",!0)]),_:1})])}const wi=P(hi,[["render",vi],["__scopeId","data-v-1f9cfc7f"]]);const ki={name:"sd-ticket-actions",description:"Contains ticket actions on timline page, specific to Service Desk",setup(){const e=re();return{ticketActions:z(()=>e.getters.getTicketActions)}},props:{data:{type:[String,Object],required:!0}},data(){return{showModal:!1,modals:["attach_asset","detach_modal"],currentModal:""}},watch:{currentModal(e,t){return e}},computed:{currentModalComponent(){return this.currentModal==="attach_asset"?"attach-asset-modal":this.currentModal==="detach_modal"?"detach-modal":""},problemId(){if(JSON.parse(this.data).associated_problem)return JSON.parse(this.data).associated_problem.id},showProblem(){return this.ticketActions.show_attach_new_problem||this.ticketActions.show_attach_existing_problem},associateChange(){return this.ticketActions.attach_change_initiated||this.ticketActions.attach_change_initiating}},methods:{modalMethod(e){this.showModal=!0,this.currentModal=e},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"attach-problem":Uo,"detach-modal":va,"attach-asset-modal":Qo,"attach-change":wi}},Ci={id:"sd-ticket-actions"};function Di(e,t,s,d,a,i){const m=u("attach-problem"),h=u("attach-change");return o(),l("div",Ci,[d.ticketActions.show_attach_assets?(o(),l("button",{key:0,id:"attach-assets",onClick:t[0]||(t[0]=b=>i.modalMethod("attach_asset")),class:"btn btn-xs btn-light"},[t[2]||(t[2]=n("i",{class:"fas fa-server"},null,-1)),v(" "+r(e.lang("attach_assets")),1)])):c("",!0),i.showProblem?(o(),k(m,{key:1,data:s.data,actions:d.ticketActions},null,8,["data","actions"])):c("",!0),d.ticketActions.show_detach_problem?(o(),l("button",{key:2,id:"detach-problem",onClick:t[1]||(t[1]=b=>i.modalMethod("detach_modal")),class:"btn btn-xs btn-light"},[t[3]||(t[3]=n("i",{class:"fas fa-unlink"},null,-1)),v(" "+r(e.lang("detach_problem")),1)])):c("",!0),i.associateChange?(o(),k(h,{key:3,data:s.data,actions:d.ticketActions},null,8,["data","actions"])):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(ra(i.currentModalComponent),{key:0,onClose:i.onClose,showModal:a.showModal,from:"modal",problemId:i.problemId,data:s.data,alert:"timeline"},null,40,["onClose","showModal","problemId","data"])):c("",!0)]),_:1})])}const Si=P(ki,[["render",Di]]);const Mi={name:"sdesk-data-table-action",description:"Contains detach button which can be used as a component as whole. It is built basically for displaying deatch button in a datable.",props:{data:{type:Object,required:!0}},data(){return{showModal:!1,disabled:""}},created(){this.alertName=this.data.alertName?this.data.alertName:"",this.disabled=Re(this.data.is_default)},watch:{data(e,t){return this.disabled=Re(e.is_default),e}},methods:{onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"detach-modal":va}},Fi={class:"btn-group"},Ii=["title","disabled"];function Ai(e,t,s,d,a,i){const m=u("detach-modal");return o(),l("div",Fi,[s.data.detach?(o(),l("a",{key:0,id:"detach-button",onClick:t[0]||(t[0]=()=>a.showModal=!0),href:"javascript:;"},[n("span",{title:e.trans("detach"),class:"btn btn-primary",id:"detach_btn",disabled:a.disabled},t[1]||(t[1]=[n("i",{class:"fa fa-unlink"},null,-1)]),8,Ii)])):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showModal,assetId:s.data.id,alert:e.alertName},null,8,["onClose","showModal","assetId","alert"])):c("",!0)]),_:1})])}const Pi=P(Mi,[["render",Ai]]),Ti={name:"asset-name",description:"Asset name component.",props:{data:{type:Object,required:!0}},data(){return{url:"/service-desk/assets/"+this.data.id+"/show"}}};function Vi(e,t,s,d,a,i){const m=u("router-link"),h=W("tooltip");return o(),k(m,{id:"asset-name",to:a.url,target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(s.data.name),1)])),[[h,s.data.name]])]),_:1},8,["to"])}const Li=P(Ti,[["render",Vi]]);const Ui={name:"associated-assets",description:"Associated Assets table component",setup(){const e=re();return{getStoredTicketId:z(()=>e.getters.getStoredTicketId)}},props:{data:{type:[Object,String],default:()=>{}},alertName:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data:()=>({base:window.axios.defaults.baseURL,columns:[],options:{},apiUrl:""}),watch:{getStoredTicketId(e,t){this.apiUrl="/service-desk/api/asset-list?"+Ge({ticket_ids:e})}},beforeMount(){const e=this,t=JSON.parse(this.data);if(t.from){let s="/service-desk/api/asset-list",d=t.from==="user"?{used_by_ids:t.user_id}:{org_ids:t.org_id};this.apiUrl=s+"?"+Ge(d)}else this.apiUrl="/service-desk/api/asset-list?"+Ge({ticket_ids:this.getStoredTicketId});this.columns=JSON.parse(this.data).show_detach_asset?["name","managed_by","used_by","contract","action"]:["name","managed_by","used_by","contract"],this.options={texts:{filter:"",limit:""},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),action:this.lang("action")},columnsClasses:{name:"asset-name",managed_by:"asset-manage",used_by:"asset-used",contract:"asset-contract",action:"asset-action"},templates:{name:(s,d)=>e.h(Li,{data:d}),managed_by(s,d){var a,i;return((i=(a=d.managed_by)==null?void 0:a.full_name)==null?void 0:i.replace(/<[^>]+>/g,""))??"--"},used_by(s,d){var a,i;return((i=(a=d.used_by)==null?void 0:a.full_name)==null?void 0:i.replace(/<[^>]+>/g,""))??"--"},contract:function(s,d){return d.contract&&!Array.isArray(d.contract)?e.h(De,{to:"/service-desk/contracts/"+d.contract.id+"/show",target:"_blank"},d.contract.name):"--"},action:(s,d)=>e.h(Pi,{data:d})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(s){return{"sort-field":s.orderBy?s.orderBy:"name","sort-order":s.ascending?"desc":"asc","search-query":s.query.trim(),page:s.page,limit:s.limit}},responseAdapter({data:s}){return{data:s.data.data.map(d=>(d.detach=!0,d.alertName=e.alertName,d)),count:s.data.total}},orderBy:{column:"name",ascending:!0}}},methods:{handelLoader(e){this.$emit("assetLoaderValue",e)}}},Ni={class:"asset-list"};function Ei(e,t,s,d,a,i){const m=u("data-table");return o(),l("div",Ni,[_(m,{url:e.apiUrl,dataColumns:e.columns,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:e.options,scroll_to:"associated-asset-list",componentTitle:"AssetList"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])])}const xi=P(Ui,[["render",Ei]]);const Oi={name:"associated_assets",description:"Associated assets data table page",props:{data:{type:[String,Object]},from:{type:String,default:""},alert:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_assets",loading:!1}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},components:{"associated-assets":xi}},qi={id:"associated-asset-list"},ji={key:0,class:"card-header"},Ri={class:"card-title"};function Bi(e,t,s,d,a,i){const m=u("alert"),h=u("associated-assets");return o(),l("div",qi,[_(m,{componentName:"dataTableModal"}),n("div",{class:Q([{"card card-light ":!s.from}])},[s.from!="tab"?(o(),l("div",ji,[n("h3",Ri,r(e.lang("associated_assets")),1)])):c("",!0),n("div",{class:Q([{"card-body":!s.from}])},[a.loading?c("",!0):(o(),k(h,{key:0,data:s.data,disableLoader:s.disableLoader,onAssetLoaderValue:i.handelLoader,alertName:s.alert},null,8,["data","disableLoader","onAssetLoaderValue","alertName"]))],2)],2)])}const zi=P(Oi,[["render",Bi],["__scopeId","data-v-156334e0"]]),Ki={name:"contract-name",description:"Contract name component.",props:{data:{type:Object,required:!0}},data(){return{url:"/service-desk/contracts/"+this.data.id+"/show"}}};function Hi(e,t,s,d,a,i){const m=u("router-link");return o(),k(m,{id:"contract-name",to:a.url,target:"_blank"},{default:w(()=>[v(r(s.data.name),1)]),_:1},8,["to"])}const Es=P(Ki,[["render",Hi]]);const Yi={name:"associated_contracts",description:"Associated contracts data table page",setup(){const e=re();return{getStoredTicketId:z(()=>e.getters.getStoredTicketId),formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{data:{type:[String,Object],default:""},from:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_contracts",loading:!1,apiUrl:null,columns:null,options:null}},watch:{getStoredTicketId(e,t){this.apiUrl="/service-desk/api/contract/ticket/"+e+"?"+Ge()}},beforeMount(){const e=JSON.parse(this.data);e&&e.from==="org"?this.apiUrl="/service-desk/contract/organization/"+e.org_id+"?"+Ge():e&&e.from==="user"?this.apiUrl="/service-desk/api/contract-list?"+Ge({user_ids:e.user_id}):this.apiUrl="/service-desk/api/contract/ticket/"+this.getStoredTicketId+"?"+Ge();const t=this;this.columns=["name","cost","contract_start_date","contract_end_date"],this.options={texts:{filter:"",limit:""},headings:{name:this.trans("name"),cost:this.trans("cost"),contract_start_date:this.trans("contract_start_date"),contract_end_date:this.trans("contract_end_date")},columnsClasses:{name:"contract-name",cost:"contract-cost",contract_start_date:"contract-start",contract_end_date:"contract-end"},templates:{name:(s,d)=>t.h(Es,{data:d}),contract_start_date:function(s,d){return t.formattedTime(d.contract_start_date)},contract_end_date:function(s,d){return t.formattedTime(d.contract_end_date)}},sortable:["name","cost","contract_start_date","contract_end_date"],pagination:{chunk:5,nav:"scroll"},requestAdapter(s){return{"sort-field":s.orderBy?s.orderBy:"name","sort-order":s.ascending?"desc":"asc","search-query":s.query.trim(),page:s.page,limit:s.limit}},responseAdapter({data:s}){return{data:e.from=="user"?s.data.contracts:s.data.data,count:s.data.total}},orderBy:{column:"name",ascending:!0}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},components:{"contract-name":Es}},$i={id:"associated-contracts"},Wi={key:0,class:"card-header"},Ji={class:"card-title"};function Gi(e,t,s,d,a,i){const m=u("data-table");return o(),l("div",$i,[n("div",{class:Q([{"card card-light":!s.from}])},[s.from!="tab"?(o(),l("div",Wi,[n("h3",Ji,r(e.lang("associated_contracts")),1)])):c("",!0),n("div",{class:Q([[{"card-body":!s.from}],"my_contracts"])},[_(m,{url:a.apiUrl,dataColumns:a.columns,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:a.options,scroll_to:"associated-contracts"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])],2)],2)])}const Xi=P(Yi,[["render",Gi]]),Zi={name:"detach-change-modal",description:"Detach Change Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},ticketId:{type:[String,Number],default:""},type:{type:String,default:""},onClose:{type:Function},alert:{type:String,default:"AssociatedChange"}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/detach-change/ticket",{params:{ticket_id:this.ticketId,change_id:this.changeId,type:this.type}}).then(e=>{K(e,this.alert),window.emitter.emit("AssociatedChangerefreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,O(e,this.alert)})}}},Qi={class:"modal-title"},el={key:0},tl={key:1,class:"row"},sl=["disabled"];function al(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",Qi,r(e.lang("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",el,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",tl,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fa fa-unlink"},null,-1)),v(" "+r(e.lang("detach")),1)],8,sl)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const nl=P(Zi,[["render",al]]);const ol={name:"associated_contracts",description:"Associated contracts data table page",setup(){const e=re();return{getStoredTicketId:z(()=>e.getters.getStoredTicketId)}},props:{data:{type:[String,Object]},from:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_changes",loading:!1,apiUrl:"",columns:["change_number","subject","type"],options:null,changeId:"",change_type:"",showModal:!1}},watch:{getStoredTicketId(e,t){this.apiUrl="/service-desk/api/attached-change/ticket?"+Ge({ticket_id:e})}},beforeMount(){const e=this;this.apiUrl="/service-desk/api/attached-change/ticket?"+Ge({ticket_id:this.getStoredTicketId}),this.columns.push("action"),this.options={texts:{filter:"",limit:""},headings:{change_number:this.lang("change_number"),subject:this.lang("subject"),type:this.lang("type"),action:this.lang("action")},columnsClasses:{change_number:"changes-number",subject:"changes-subject",type:"changes-created",action:"changes-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},templates:{subject(t,s){return e.h(De,{to:"/service-desk/changes/"+s.id+"/show",target:"_blank"},s.subject)},action(t,s){var d=JSON.parse(e.data);let a=e.h("i",{class:"fa fa-unlink"});return e.h("a",{class:"btn btn-primary",title:this.trans("detach"),disabled:!d.detach_change,href:"javascript:;",onClick:function(){e.onDetach(s.id,s.type,d.detach_change)}},[a])}},sortable:["subject","created_at"],filterable:["subject","created_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc",search_query:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.changes,count:t.data.total}},orderBy:{column:"id",ascending:!0}}},methods:{onDetach(e,t,s){s&&(this.changeId=e,this.change_type=t,this.showModal=!0)},onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},components:{"change-detach-modal":nl}},il={id:"associated-changes"},ll={key:0,class:"card-header"},rl={class:"card-title"};function dl(e,t,s,d,a,i){const m=u("alert"),h=u("data-table"),b=u("change-detach-modal");return o(),l("div",il,[_(m,{componentName:"AssociatedChange"}),n("div",{class:Q([{"card card-light":!s.from}])},[s.from!="tab"?(o(),l("div",ll,[n("h3",rl,r(e.lang("associated_changes")),1)])):c("",!0),n("div",{class:Q([[{"card-body":!s.from}],"changes-list"])},[_(h,{url:a.apiUrl,dataColumns:a.columns,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:a.options,componentTitle:"AssociatedChange",scroll_to:"associated-changes"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])],2)],2),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showModal,ticketId:d.getStoredTicketId,changeId:a.changeId,type:a.change_type,alert:"timeline"},null,8,["onClose","showModal","ticketId","changeId","type"])):c("",!0)]),_:1})])}const cl=P(ol,[["render",dl]]),ul={name:"license-name",description:"License name component.",props:{data:{type:Object,required:!0}},data(){return{url:"/service-desk/software/license/"+this.data.id+"/show"}}};function ml(e,t,s,d,a,i){const m=u("router-link");return o(),k(m,{id:"license-name",to:a.url,target:"_blank"},{default:w(()=>[v(r(s.data.name),1)]),_:1},8,["to"])}const Gt=P(ul,[["render",ml]]),hl={name:"AssociatedLicenseList",description:"Associated contracts data table page",setup(){const e=re();return{formattedDate:z(()=>e.getters.formattedDate),formattedTime:z(()=>e.getters.formattedTime)}},props:{data:{type:[String,Object,Number],default:""},from:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_license",apiUrl:null,columns:null,options:null}},beforeMount(){const e=JSON.parse(this.data);this.apiUrl="/service-desk/api/software-license-list?"+Ge({used_by_ids:e.user_id});const t=this;this.columns=["name","license_key","purchase_order_number","licensed_to_email","version","purchase_date","renewal_date","expiration_date"],this.options={texts:{filter:"",limit:""},headings:{name:this.trans("name"),license_key:this.trans("license_key"),purchase_order_number:this.trans("purchase_order_number"),licensed_to_email:this.trans("licensed_to_email"),version:this.trans("version"),purchase_date:this.trans("purchase_date"),renewal_date:this.trans("renewal_date"),expiration_date:this.trans("expiration_date")},columnsClasses:{name:"license-name",license_key:"license-key",purchase_order_number:"license-purchase-order",licensed_to_email:"licensed-email",version:"license-version",purchase_date:"license-purchase-date",renewal_date:"license-renewal-date",expiration_date:"license-expiration-date"},templates:{name:(s,d)=>t.h(Gt,{data:d}),license_key:(s,d)=>d.license_key?d.license_key:"--",purchase_order_number:(s,d)=>d.purchase_order_number?d.purchase_order_number:"--",licensed_to_email:(s,d)=>d.licensed_to_email?d.licensed_to_email:"--",version:(s,d)=>d.version?d.version:"--",purchase_date:function(s,d){return t.formattedTime(d.purchase_date)},renewal_date:function(s,d){return t.formattedTime(d.renewal_date)},expiration_date:function(s,d){return t.formattedTime(d.expiration_date)}},filterable:["name"],sortable:["name","license_key","purchase_order_number","licensed_to_email","version","purchase_date","renewal_date","expiration_date"],pagination:{chunk:5,nav:"scroll"},requestAdapter(s){return{"sort-field":s.orderBy?s.orderBy:"name","sort-order":s.ascending?"desc":"asc","search-query":s.query.trim(),page:s.page,limit:s.limit}},responseAdapter({data:s}){return{data:s.data.data,count:s.data.total}},orderBy:{column:"name",ascending:!0}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},components:{"license-name":Gt}},pl={id:"associated-license"};function _l(e,t,s,d,a,i){const m=u("data-table");return o(),l("div",pl,[_(m,{url:a.apiUrl,dataColumns:a.columns,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:a.options,scroll_to:"associated-license"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])])}const fl=P(hl,[["render",_l]]);const gl={name:"ticket-associated-list",description:"Tickets Assocites List",props:{data:{type:[String,Object]}},data(){return{tabs:[{id:"assets",title:"associated_assets"},{id:"changes",title:"associated_changes"},{id:"contracts",title:"associated_contracts"}],category:"assets",alertName:"",loading:!0,cardOpen:!1,loaderState:""}},beforeMount(){this.loaderState=JSON.parse(this.data).disableLoader,JSON.parse(this.data).from==="org"?(this.tabs=[{id:"assets",title:"associated_assets"},{id:"contracts",title:"associated_contracts"}],this.alertName=""):JSON.parse(this.data).from==="user"?(this.tabs=[{id:"assets",title:"associated_assets"},{id:"contracts",title:"associated_contracts"},{id:"license",title:"associated_license"}],this.alertName=""):this.alertName="timeline"},created(){window.emitter.on("TicketChanged",this.associateMethod)},computed:{currentComponent(){let e=this.category,t;switch(e){case"assets":t="associated-asset-list";break;case"changes":t="associated-changes";break;case"contracts":t="associated-contracts";break;case"license":t="associated-license-list";break}return t},componentData(){return this.data}},methods:{toggleCard(){this.cardOpen=!this.cardOpen},associateMethod(){this.category="assets",this.loading=!0,setTimeout(()=>{this.associates(this.category)},3e3)},refreshAssociates(){this.category="assets",window.emitter.emit("AssetListrefreshData")},associates(e){this.category!==e&&(this.loading=!0,this.category=e)},handelLoader(e){this.loading=e}},components:{"associated-asset-list":zi,"associated-contracts":Xi,"associated-changes":cl,"associated-license-list":fl}},bl={class:"card card-light"},yl={class:"card-title"},vl={class:"card-tools"},wl={type:"button",class:"btn btn-tool"},kl={key:0,class:"card-body",id:"associated_tasks"},Cl={id:"ticket-associated-list",class:"card card-light card-tabs"},Dl={class:"card-header p-0 pt-1"},Sl={class:"nav nav-tabs",role:"tablist"},Ml={class:"nav-item"},Fl=["onClick"],Il={class:"nav-item ms-auto mt-04"},Al={class:"card-body"},Pl={class:"tab-content"},Tl={class:"active tab-pane",role:"tabpanel"};function Vl(e,t,s,d,a,i){const m=W("tooltip");return o(),l("div",bl,[n("div",{class:"card-header pointer",onClick:t[0]||(t[0]=(...h)=>i.toggleCard&&i.toggleCard(...h))},[n("h3",yl,r(e.lang("sd_associates")),1),n("div",vl,[n("button",wl,[n("i",{class:Q([{"fas fa-angle-up":a.cardOpen,"fas fa-angle-down":!a.cardOpen},"fs-25"])},null,2)])])]),a.cardOpen?(o(),l("div",kl,[n("div",Cl,[n("div",Dl,[n("ul",Sl,[(o(!0),l(U,null,$(a.tabs,h=>(o(),l("li",Ml,[n("a",{class:Q(["nav-link",{active:a.category===h.id}]),"data-bs-toggle":"pill",role:"tab",href:"javascript:;",onClick:b=>i.associates(h.id)},r(e.lang(h.title)),11,Fl)]))),256)),n("li",Il,[S((o(),l("a",{class:Q(["btn-tool",a.loading?"rotating":""]),onClick:t[1]||(t[1]=(...h)=>i.refreshAssociates&&i.refreshAssociates(...h)),href:"javascript:;"},t[2]||(t[2]=[n("i",{class:"fas fa-sync-alt"},null,-1)]),2)),[[m,e.lang("refresh")]])])])]),n("div",Al,[n("div",Pl,[n("div",Tl,[(o(),k(ra(i.currentComponent),{data:i.componentData,from:"tab",alert:a.alertName,onLoaderValue:i.handelLoader,disableLoader:a.loaderState},null,40,["data","alert","onLoaderValue","disableLoader"]))])])])])])):c("",!0)])}const gs=P(gl,[["render",Vl],["__scopeId","data-v-8333cd0b"]]);const Ll={name:"associated-problem",description:"Shows associated problem related to the ticket",props:{data:{type:[String,Object],required:!0}},computed:{showAssociatedProblem(){return JSON.parse(this.data).associated_problem!=null},associatedProblem(){return JSON.parse(this.data).associated_problem}}},Ul={key:0,id:"associated-problem",class:"d-flex row info-flex"},Nl={class:"col-md-6"},El={class:"col-sm-6"};function xl(e,t,s,d,a,i){const m=u("router-link"),h=W("tooltip");return i.showAssociatedProblem?(o(),l("div",Ul,[n("div",Nl,[n("label",null,r(e.lang("associated_problem")),1)]),n("div",El,[S((o(),k(m,{id:"associated-problem-link",to:i.associatedProblem.redirect_to.replace(e.basePath(),"")},{default:w(()=>[v(r(i.associatedProblem.name),1)]),_:1},8,["to"])),[[h,i.associatedProblem.name]])])])):c("",!0)}const Ol=P(Ll,[["render",xl],["__scopeId","data-v-ca556653"]]);const ql={name:"restor-modal",description:"Restore Modal component",props:{showModal:{type:Boolean,default:!1},userId:{type:[String,Number],default:""},onClose:{type:Function,default:()=>{}},permissions:{type:Array,default:()=>[]}},data(){return{isDisabled:!1,containerStyle:{width:"800px"},loading:!1,permissionsList:[]}},beforeMount(){this.getInitialValues()},methods:{getInitialValues(){this.loading=!0,this.isDisabled=!0,T.get("/service-desk/get/permissions?limit=all&role=user").then(e=>{this.permissionsList=da(e.data),this.updatePermissions(),this.checkExistingPermissions()}).catch(e=>{this.loading=!1,this.isDisabled=!1,O(e)})},updatePermissions(){this.permissionsList.forEach(function(e){e.checked=!1,e.disabled=!1,e.title=""})},checkExistingPermissions(){var e=this;this.permissions.forEach(function(t,s,d){e.checkBoxOperations(!0,t.key,!0)}),this.loading=!1,this.isDisabled=!1},checkBoxOperations(e,t,s){this.permissionsList.forEach(function(d){if(d.key==t){d.checked=e;return}})},onSubmit(){this.loading=!0,this.isDisabled=!0;let e={};e.user_id=this.userId,e.permission_ids=this.permissionsList.filter(t=>t.checked).map(t=>t.id),e._method="PATCH",T.post("/api/user/attach-permissions",e).then(t=>{window.emitter.emit("refreshUserData"),window.emitter.emit("refreshUserActions"),K(t,"user-view"),this.loading=!1,this.isDisabled=!1,this.onClose()}).catch(t=>{this.loading=!1,this.isDisabled=!1,O(t,"user-view"),this.onClose()})}},components:{checkbox:pa}},jl={class:"modal-title"},Rl={key:0,class:"user_permission_box"},Bl={class:"row"},zl={key:1,class:"row"},Kl=["disabled"];function Hl(e,t,s,d,a,i){const m=u("checkbox"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",jl,r(e.lang("user_permissions")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",Rl,[n("div",Bl,[(o(!0),l(U,null,$(a.permissionsList,f=>(o(),l("div",{class:"col-sm-4",style:{},key:f.id},[_(m,{name:f.key,value:f.checked,disabled:f.disabled,label:f.key,title:"",onChange:i.checkBoxOperations,id:f.key,hint:e.lang("view_assets_perm_tooltip")},null,8,["name","value","disabled","label","onChange","id","hint"])]))),128))])])),a.loading?(o(),l("div",zl,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",onClick:t[0]||(t[0]=(...f)=>i.onSubmit&&i.onSubmit(...f)),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.lang("update")),1)],8,Kl)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Yl=P(ql,[["render",Hl],["__scopeId","data-v-f72aaf64"]]);const $l={name:"user-permissions",props:{data:{type:[String,Object],required:!0}},data(){return{showModal:!1}},computed:{userId(){return JSON.parse(this.data).user_id},permissions(){return JSON.parse(this.data).permissions}},methods:{onClose(){this.showModal=!1}},components:{"permission-modal":Yl}},Wl={class:"sd-user-permissions-block"};function Jl(e,t,s,d,a,i){const m=u("permission-modal");return o(),l("span",Wl,[n("button",{type:"button",class:"btn btn-xs btn-light mt_5",onClick:t[0]||(t[0]=h=>a.showModal=!0)},[t[1]||(t[1]=n("i",{class:"fas fa-book-reader"},"  ",-1)),v(r(e.trans("update_permissions")),1)]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showModal,userId:i.userId,permissions:i.permissions},null,8,["onClose","showModal","userId","permissions"])):c("",!0)]),_:1})])}const Gl=P($l,[["render",Jl],["__scopeId","data-v-a67fb50e"]]),Xl={class:"card card-light dashboard-widget-box"},Zl={class:"card-header"},Ql={class:"card-title"},er={class:"card-tools"},tr=["disabled"],sr={key:0,class:"card-body scrollable-area"},ar={__name:"DashboardChartBox",props:{item:{type:Object,default:()=>{}},from:{type:String,default:""}},setup(e){let s=e.item;const d=se(!1),a=i=>{d.value=!0,axios.get("/service-desk/api/get/dashboard-charts/"+i).then(m=>{s=m.data.data[0],setTimeout(()=>{d.value=!1},1e3)}).catch(m=>{O(m),d.value=!1})};return(i,m)=>(o(),l("div",Xl,[n("div",Zl,[n("h3",Ql,[m[1]||(m[1]=n("i",{class:"fas fa-desktop","aria-hidden":"true"},null,-1)),v(" "+r(we(s).name),1)]),n("div",er,[n("button",{type:"button",class:"btn btn-tool","data-card-widget":"refresh",onClick:m[0]||(m[0]=h=>a(we(s).id)),disabled:d.value},[n("i",{class:Q(["fas fa-sync-alt",d.value?"fa-spin":""])},null,2)],8,tr)])]),d.value?c("",!0):(o(),l("div",sr,[_(ms,{chartData:we(s),from:e.from,type:we(s).chart_type==="bar_chart"?"bar":"doughnut",showTitle:!1,redirectUrls:we(s).result.map(h=>h.redirect_url)},null,8,["chartData","from","type","redirectUrls"])]))]))}},nr={class:"row"},or={class:"col-sm-6"},ir={__name:"DashboardCharts",setup(e){const t=se([]);Qe(()=>{s()});const s=()=>{axios.get("/service-desk/api/get/dashboard-charts").then(d=>{t.value=d.data.data}).catch(d=>{t.value=[]})};return(d,a)=>(o(),l("div",nr,[(o(!0),l(U,null,$(t.value,i=>(o(),l("div",or,[(o(),k(ar,{from:"dashboard",key:i.id,item:i},null,8,["item"]))]))),256))]))}},lr={name:"sd-agent-permission",description:"Service desk permission list box component",data:()=>({permissionsListSD:[],showSelectAll:!1,selectAll:!1}),props:{data:{type:String}},beforeMount(){this.getpermissonListApi(),(this.$route.name==="personal_access_token.create"||this.$route.name==="personal_access_token.edit")&&(this.showSelectAll=!0)},methods:{selectAllPermissions(){this.selectAll?this.permissionsListSD.forEach(function(s){s.checked=!0}):this.permissionsListSD.forEach(function(s){s.checked=!1});let e=this.permissionsListSD.filter(s=>s.checked).map(s=>s.id),t=this.permissionsListSD.filter(s=>s.checked).map(s=>s.key);this.showSelectAll?window.emitter.emit("selected-permission-list",{permissions:t,all_selected:this.selectAll}):window.emitter.emit("selected-permission-list",e)},getpermissonListApi(){T.get("service-desk/get/permissions",{}).then(e=>{this.permissionsListSD=da(e.data.permissions),this.permissionsListSD.forEach(function(t){t.checked=!1}),this.data!="undefined"&&this.selectCheckboxInEdit()}).catch(e=>{O(e)})},selectCheckboxInEdit(){let e=this,t=JSON.parse(this.data);t=this.showSelectAll?t.data:t,this.showSelectAll&&(this.selectAll=JSON.parse(this.data).all_sd_permission_selected),t.forEach(function(s){e.checkBoxOperationsSD(!0,s.id)})},checkBoxOperationsSD(e,t){e||(this.selectAll=!1),this.permissionsListSD.forEach(function(a){if(a.id==t){a.checked=e;return}});let s=this.permissionsListSD.filter(a=>a.checked).map(a=>a.id),d=this.permissionsListSD.filter(a=>a.checked).map(a=>a.key);this.showSelectAll?window.emitter.emit("selected-permission-list",{permissions:d,all_selected:this.selectAll}):window.emitter.emit("selected-permission-list",s)}},components:{checkbox:pa,"tool-tip":Ot}},rr={class:"card-tools"},dr={class:"form-check"},cr={class:"form-check-label",for:"select-all-sd"},ur={class:"row"};function mr(e,t,s,d,a,i){const m=u("tool-tip"),h=u("checkbox"),b=u("faveo-box");return o(),k(b,{title:e.lang("service-desk-permissions"),boxClass:"card-light"},Qt({headerTooltip:w(()=>[_(m,{message:e.lang("view_is_mandatory_to_perform_all_actions"),size:"medium"},null,8,["message"])]),default:w(()=>[n("div",ur,[(o(!0),l(U,null,$(e.permissionsListSD,f=>(o(),l("div",{class:"col-sm-3",id:"assign_groups",style:{},key:f.id},[_(h,{name:f.id,value:f.checked,label:e.lang(f.key),title:f.name,onChange:i.checkBoxOperationsSD,id:f.id},null,8,["name","value","label","title","onChange","id"])]))),128))])]),_:2},[e.showSelectAll?{name:"customActions",fn:w(()=>[n("div",rr,[n("div",dr,[S(n("input",{type:"checkbox",class:"form-check-input",id:"select-all-sd","onUpdate:modelValue":t[0]||(t[0]=f=>e.selectAll=f),onChange:t[1]||(t[1]=(...f)=>i.selectAllPermissions&&i.selectAllPermissions(...f))},null,544),[[cs,e.selectAll]]),n("label",cr,r(e.trans("select_all")),1)])])]),key:"0"}:void 0]),1032,["title"])}const hr=P(lr,[["render",mr]]),pr={name:"create-form-group-button",data:()=>({base:window.axios.defaults.baseURL})},_r={id:"create-form-group-button"};function fr(e,t,s,d,a,i){const m=u("router-link");return o(),l("span",_r,[_(m,{class:"dropdown-item",to:"/service-desk/form-group/create/asset"},{default:w(()=>[v(r(e.lang("new_asset_form_group")),1)]),_:1}),_(m,{class:"dropdown-item",to:"/service-desk/form-group/create/change"},{default:w(()=>[v(r(e.lang("new_change_form_group")),1)]),_:1})])}const gr=P(pr,[["render",fr]]),br={name:"filter-dropdown",components:{"dynamic-select":fe},props:{metaData:{type:Array,required:!0}},data(){return{componentMetaData:this.metaData,selectedFilterObj:{}}},methods:{onChange(e,t){this.selectedFilterObj[t]=e,this.$emit("onChangeFilter",this.selectedFilterObj)}},computed:{getClassname:function(){const e=this.componentMetaData.length;let t="col-md-12";return e===2?t="col-md-6":e>2&&(t="col-md-4"),t}}},yr={class:"row"};function vr(e,t,s,d,a,i){const m=u("dynamic-select");return o(),l("div",yr,[(o(!0),l(U,null,$(a.componentMetaData,h=>(o(),k(m,{key:h.key,id:h.key,name:h.key,apiEndpoint:h.apiEndpoint,elements:h.elements,multiple:h.multiple,label:e.trans(h.label),value:h.value,onChange:i.onChange,classname:i.getClassname,strlength:17},null,8,["id","name","apiEndpoint","elements","multiple","label","value","onChange","classname"]))),128))])}const wr=P(br,[["render",vr]]);const kr={name:"dynamic-select-with-filter",props:{node:{type:Object,required:!0},filterApiEndpoint:{type:String,required:!0},multiple:{type:Boolean,default:!1},onChange:{type:Function,required:!0},selectedAssets:{type:Array,required:!1},clearSelectedValue:{type:Function,required:!1},changeSelectedAsset:{type:Function,required:!1},isInlineForm:{type:Boolean,default:!0},showDivClass:{type:Boolean,default:!0}},data:()=>({showFilterPopup:!1,isLoading:!1,filterOptions:[],apiParameters:{},filterParams:{},selectedFilters:{},formattedFilterString:""}),computed:{apiEndpoint:function(){let e=ut.convertStringOfPropertiesToObject(this.node.api_info).url;return!e&&this.formField.api_info&&(e=this.formField.api_info+"?mode=render"),e},optionLabel(){return ut.convertStringOfPropertiesToObject(this.node.api_info).url.split("?").includes("extra_format=1")?"format":"name"},apiParams(){return Object.keys(this.filterParams).length?this.filterParams:this.apiParameters},...pn(["getReporter"])},watch:{getReporter(e,t){e?(this.apiParameters={"used_by_ids[n]":e},this.$store.dispatch("setSelectedValues",[]),this.clearSelectedValue()):this.apiParameters={}}},methods:{openFilterPopup(){this.showFilterPopup=!0,this.filterOptions.length===0&&(this.isLoading=!0,T.get(this.filterApiEndpoint).then(e=>{this.filterOptions=e.data.data}).catch(e=>{console.error(e)}).finally(()=>{this.isLoading=!1}))},applyFilter(){this.filterOptions.map(t=>t.value=this.selectedFilters[t.key]);const e=_n(this.filterOptions);this.formattedFilterString=e.formatedText,this.filterParams=e.apiParams,this.showFilterPopup=!1,this.changeSelectedAsset()},onChangeFilter(e){this.selectedFilters={...this.selectedFilters,...e}}},components:{modal:Xt,"dynamic-select":fe,"filter-dropdowns":wr}},Cr=["innerHTML"],Dr={class:"ds-filter-modal"};function Sr(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("loader"),b=u("filter-dropdowns"),f=u("modal"),g=W("tooltip");return o(),l("div",{class:Q(s.showDivClass?"row":"")},[n("div",{class:Q(s.showDivClass?"dynamic-select-with-filter-container col-md-12":"")},[_(m,{id:s.node.key,name:s.node.key,"api-endpoint":i.apiEndpoint,"api-parameters":i.apiParams,multiple:s.multiple,value:s.selectedAssets,required:!!s.node.required,label:s.node.label,onChange:s.onChange,isInlineForm:s.isInlineForm,actionBtn:{text:"filter",isFor:"requester",action:i.openFilterPopup},"tip-rule":s.node.show_description,hint:s.node.description,optionLabel:i.optionLabel},{dsHelpText:w(()=>[n("small",null,[S(n("span",{innerHTML:e.formattedFilterString},null,8,Cr),[[g,{content:e.formattedFilterString,html:!0}]])])]),_:1},8,["id","name","api-endpoint","api-parameters","multiple","value","required","label","onChange","isInlineForm","actionBtn","tip-rule","hint","optionLabel"])],2),_(X,{name:"modal"},{default:w(()=>[e.showFilterPopup?(o(),k(f,{key:0,showModal:e.showFilterPopup,onClose:()=>e.showFilterPopup=!1,containerStyle:{width:"800px"}},{title:w(()=>[n("h4",null,r(e.trans("filter")),1)]),fields:w(()=>[n("div",Dr,[e.isLoading?(o(),k(h,{key:0,"animation-duration":4e3,size:60})):c("",!0),e.isLoading?c("",!0):(o(),k(b,{key:1,metaData:e.filterOptions,onOnChangeFilter:i.onChangeFilter},null,8,["metaData","onOnChangeFilter"]))])]),controls:w(()=>[n("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=D=>i.applyFilter())},r(e.trans("apply")),1)]),_:1},8,["showModal","onClose"])):c("",!0)]),_:1})],2)}const Mr=P(kr,[["render",Sr]]),Fr={props:{data:{type:String,required:!0}},data:()=>({nodeData:null,selectedAssets:[]}),beforeMount(){this.nodeData=JSON.parse(this.data),(this.nodeData.scenario==="edit"&&this.nodeData.category==="changes"||this.nodeData.scenario==="recur"&&this.nodeData.recur_mode==="edit"||this.nodeData.scenario==="template"&&this.nodeData.template_mode==="edit")&&(this.selectedAssets=this.$store.getters.getSelectedValues)},computed:{apiEndpoint:function(){return ut.convertStringOfPropertiesToObject(this.nodeData.node.api_info).url},optionLabel(){return ut.convertStringOfPropertiesToObject(this.nodeData.node.api_info).url.split("?").includes("extra_format=1")?"format":"name"}},methods:{clearSelectedValue(){this.selectedAssets=[]},changeSelectedAsset(){if(this.selectedAssets=[],this.$store.getters.getSelectedValues.length>0)for(let e in this.$store.getters.getSelectedValues)this.selectedAssets.push(this.$store.getters.getSelectedValues[e])},onChange(e){const t={id:this.nodeData.node.key,isDefault:!!this.nodeData.node.default,formUniqueKey:this.nodeData.formUniqueKey,selectedValue:e};this.$store.dispatch("setFormData",t),this.changeSelectedAsset()}},components:{"dynamic-select-with-filter":Mr,"dynamic-select":fe}},Ir={key:0},Ar={key:1};function Pr(e,t,s,d,a,i){const m=u("dynamic-select-with-filter"),h=u("dynamic-select");return e.nodeData?(o(),l("div",Ir,[e.nodeData.showFilter?(o(),k(m,{key:0,node:e.nodeData.node,multiple:!0,isInlineForm:e.nodeData.isInlineForm??!0,showDivClass:e.nodeData.showDivClass,selectedAssets:e.selectedAssets,changeSelectedAsset:i.changeSelectedAsset,clearSelectedValue:i.clearSelectedValue,"filter-api-endpoint":"/service-desk/api/module-filter-structure/asset","on-change":i.onChange},null,8,["node","isInlineForm","showDivClass","selectedAssets","changeSelectedAsset","clearSelectedValue","on-change"])):(o(),l("div",Ar,[_(h,{id:e.nodeData.node.key,name:e.nodeData.node.key,"api-endpoint":e.isUserLoggedIn?i.apiEndpoint:"",multiple:!0,value:e.nodeData.node.value,required:e.nodeData.node.required,label:e.nodeData.node.label,onChange:i.onChange,isInlineForm:e.nodeData.isInlineForm??!0,"tip-rule":e.nodeData.node.show_description_under_form_field,hint:e.nodeData.node.description,optionLabel:i.optionLabel},null,8,["id","name","api-endpoint","value","required","label","onChange","isInlineForm","tip-rule","hint","optionLabel"])]))])):c("",!0)}const Tr=P(Fr,[["render",Pr]]),Vr={name:"create-workflow-button"},Lr={id:"create-workflow-button"};function Ur(e,t,s,d,a,i){const m=u("router-link");return o(),l("span",Lr,[_(m,{class:"dropdown-item",to:"/service-desk/workflow/create?page_type=change"},{default:w(()=>[v(r(e.lang("new_change_workflow")),1)]),_:1})])}const Nr=P(Vr,[["render",Ur]]),Er={name:"create-listener-button"},xr={id:"create-listener-button"};function Or(e,t,s,d,a,i){const m=u("router-link");return o(),l("span",xr,[_(m,{class:"dropdown-item",to:"/service-desk/listener/create?page_type=change"},{default:w(()=>[v(r(e.lang("new_change_listener")),1)]),_:1})])}const qr=P(Er,[["render",Or]]);function wa(e){const{comment:t}=e;let s={};e.action!=="approve"&&(s.comment=[t,{isRequired:Ce("comment_is_mandatory_for_cab_deny_action")}]);const d=new Ue(Ce),{errors:a,isValid:i}=d.validate(s);return Fe.dispatch("setValidationError",a),{errors:a,isValid:i}}const jr={name:"change-conversation",description:"Change Conversation Component",props:{layout:{type:Object,default:()=>{}},auth:{type:Object,default:()=>{}}},setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{changeDetails:"",loading:!0,hasDataPopulated:!1,isDisabled:!1,comment:"",lang_locale:this.layout.language,hash:"",statusText:"",shallShowApprovalAction:!0}},beforeMount(){this.$Progress.start(),this.getInitialValues()},methods:{getHashFromUrl(e){let t=e.split("/");return t[t.length-1]},getInitialValues(){const e=window.location.pathname;this.hash=this.getHashFromUrl(e),T.get("/service-desk/api/change-conversation/"+this.hash).then(t=>{this.changeDetails=t.data.data.change,this.loading=!1,this.hasDataPopulated=!0,this.$Progress.finish(),K(t,"change-converstaion")}).catch(t=>{this.statusText=t.response.data.message,this.$store.dispatch("updateStatusText",this.statusText),this.hasDataPopulated=!0,this.loading=!1,this.$Progress.fail(),this.$router.push({path:"/not-found",name:"NotFound"})})},isValid(){const{errors:e,isValid:t}=wa(this.$data);return t?!0:(this.$refs.textarea.focus(),!1)},onChange(e,t){this[t]=e},renderStatus(e){return`<i class="${e.icon_class}" style="color:${e.icon_color}"></i> ${e.name}`},onSubmit(e){e==="deny"&&!this.isValid()||(this.loading=!0,this.isDisabled=!0,this.$Progress.start(),T.post("/service-desk/api/approval-action/"+this.hash,{action_type:e,comment:this.comment}).then(t=>{K(t,"change-converstaion"),this.loading=!1,this.isDisabled=!1,this.comment="",this.shallShowApprovalAction=!1,this.$Progress.finish()}).catch(t=>{O(t,"change-converstaion"),this.loading=!1,this.isDisabled=!1,this.shallShowApprovalAction=!0,this.$Progress.fail()}))}},components:{"text-field":Ae}},Rr={class:"change-conversation"},Br={key:0,class:"row"},zr={id:"content",class:"site-content col-sm-12 userContent"},Kr={class:"entry-header"},Hr=["title"],Yr={key:0},$r=["innerHTML"],Wr={class:"row"},Jr={id:"box",class:"col-md-7 p-3 me-4 rounded"},Gr={class:"row"},Xr={class:"col boxChange"},Zr=["innerHTML"],Qr={class:"col boxChange"},ed=["innerHTML"],td={class:"row"},sd={class:"col mt-2 boxChange"},ad=["innerHTML"],nd={class:"col mt-2 boxChange"},od=["innerHTML"],id={class:"input-group"},ld={class:"input-group-addon"},rd={class:"fa fa-info-circle userIcon"},dd={class:"btns"},cd=["disabled"],ud=["disabled"],md={key:1,id:"loader",class:"row"};function hd(e,t,s,d,a,i){const m=u("meta-component"),h=u("alert"),b=u("text-field"),f=u("reuse-loader"),g=W("tooltip"),D=W("focus-first-input");return o(),l("div",Rr,[_(m,{dynamic_title:e.lang("approval_settings-page-title"),dynamic_description:e.lang("approval_settings-page-description"),layout:s.layout},null,8,["dynamic_title","dynamic_description","layout"]),_(h,{componentName:"change-converstaion"}),a.statusText===""&&a.hasDataPopulated?(o(),l("div",Br,[n("div",zr,[n("header",Kr,[n("h3",{class:Q(["entry-title",{align1:a.lang_locale=="ar"}]),title:a.changeDetails.subject},[t[2]||(t[2]=n("i",{class:"fas fa-exchange-alt"},null,-1)),v(" "+r(a.changeDetails.subject),1)],10,Hr)]),n("div",{class:Q(["entry-content clearfix",{align1:a.lang_locale=="ar"}])},[a.changeDetails.description?(o(),l("div",Yr,[n("label",null,[n("b",null,r(e.lang("description")),1)]),n("div",{innerHTML:a.changeDetails.description,class:"description",style:{width:"610px"}},null,8,$r)])):c("",!0),n("div",Wr,[n("div",Jr,[n("div",Gr,[n("div",Xr,[n("label",null,[n("b",null,r(e.lang("identifier"))+":",1)]),n("div",{innerHTML:a.changeDetails.identifier},null,8,Zr)]),n("div",Qr,[n("label",null,[n("b",null,r(e.lang("status"))+":",1)]),n("div",{innerHTML:i.renderStatus(a.changeDetails.status)},null,8,ed)])]),n("div",td,[n("div",sd,[n("label",null,[n("b",null,r(e.lang("change_raised_on"))+":",1)]),n("div",{innerHTML:d.formattedTime(a.changeDetails.change_raised_on)},null,8,ad)]),n("div",nd,[n("label",null,[n("b",null,r(e.lang("updated_at"))+":",1)]),n("div",{innerHTML:d.formattedTime(a.changeDetails.updated_at)},null,8,od)])])])])],2),!a.loading&&a.shallShowApprovalAction?(o(),l("div",{key:0,id:"approval-action-form",class:Q({align1:a.lang_locale=="ar"})},[S((o(),l("div",id,[_(b,{id:"textarea",label:e.lang("comment"),value:a.comment,type:"textarea",placehold:e.lang("enter_a_comment"),name:"comment",onChange:i.onChange,classname:"col-xs-12",style:{width:"57%"}},null,8,["label","value","placehold","onChange"]),n("span",ld,[S(n("i",rd,null,512),[[g,e.trans("comment_is_mandatory_for_cab_deny_action"),void 0,{top:!0,right:!0}]])])])),[[D]]),n("div",dd,[n("button",{id:"approve",onClick:t[0]||(t[0]=M=>i.onSubmit("approve")),class:"btn btn-primary",disabled:a.isDisabled},[t[3]||(t[3]=n("span",{class:"fa fa-check"},null,-1)),v(" "+r(e.lang("approve")),1)],8,cd),n("button",{id:"deny",onClick:t[1]||(t[1]=M=>i.onSubmit("deny")),class:"btn btn-light ms-2 deny",style:{width:"107px"},disabled:a.isDisabled},[t[4]||(t[4]=n("span",{class:"fa fa-times"},null,-1)),v(" "+r(e.lang("deny")),1)],8,ud)])],2)):c("",!0)])])):c("",!0),a.loading?(o(),l("div",md,[_(f,{"animation-duration":4e3,size:60,color:s.layout.portal.client_header_color},null,8,["color"])])):c("",!0)])}const pd=P(jr,[["render",hd],["__scopeId","data-v-4b399d42"]]);function _d(e){const{comment:t}=e;let s={comment:[t,"isRequired"]};const d=new Ue(Ce),{errors:a,isValid:i}=d.validate(s);return Fe.dispatch("setValidationError",a),{errors:a,isValid:i}}const fd={name:"contract-conversation",description:"Contract Conversation Component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{layout:{type:Object,default:()=>{}},auth:{type:Object,default:()=>{}}},data(){return{contractDetails:"",loading:!0,hasDataPopulated:!1,isDisabled:!1,lang_locale:this.layout.language,details:{},statusText:"",comment:"",shallShowApprovalAction:!0,actionType:""}},beforeMount(){this.$Progress.start(),this.getInitialValues()},methods:{subString(e,t=15){return Ie(e,t)},getHashFromUrl(e){let t={},s=e.split("/");return t.hash=s[s.length-2],t.id=s[s.length-1],t},isValid(){const{errors:e,isValid:t}=_d(this.$data);return t},onChange(e,t){this[t]=e},onClick(e){this.actionType=e,e=="reject"?this.isValid()&&this.onSubmit():this.onSubmit()},onSubmit(){this.loading=!0,this.isDisabled=!0,this.$Progress.start();let e={};e.actionType=this.actionType,this.actionType=="reject"&&(e.purpose_of_rejection=this.comment),this.actionType=="approve"&&(e.purpose_of_approval=this.comment),T.post("/service-desk/api/contract-approval/"+this.details.hash+"/"+this.details.id,e).then(t=>{K(t),this.loading=!1,this.isDisabled=!1,this.comment="",this.shallShowApprovalAction=!1,this.$Progress.finish(),setTimeout(()=>{this.$router.push({path:"/",name:"Home"})},2e3)}).catch(t=>{O(t),this.loading=!1,this.isDisabled=!1,this.shallShowApprovalAction=!0,this.$Progress.fail()})},getInitialValues(){const e=window.location.pathname;this.details=this.getHashFromUrl(e),T.get("/service-desk/api/contract-details/"+this.details.hash+"/"+this.details.id).then(t=>{this.contractDetails=t.data.data.contract,this.loading=!1,this.hasDataPopulated=!0,this.$Progress.finish()}).catch(t=>{this.statusText=t.response.data.message,this.hasDataPopulated=!0,this.loading=!1,this.$Progress.fail(),this.$router.push({path:"/not-found",name:"NotFound",params:{statusText:this.statusText}})})}},components:{"text-field":Ae}},gd={class:"contract-conversation"},bd={key:0,class:"row"},yd={id:"content",class:"site-content col-sm-12"},vd={class:"hentry"},wd={class:"entry-header"},kd={class:"h3 fw-700"},Cd={class:"row"},Dd={class:"col-md-12"},Sd={class:"alert alert-info"},Md={class:"row"},Fd={class:"col-md-4"},Id={class:"col-md-4"},Ad={class:"col-md-4"},Pd={class:"row"},Td={class:"col-md-6"},Vd={class:"table"},Ld={class:"col-md-6"},Ud={class:"table"},Nd={class:"col-sm-12"},Ed=["disabled"],xd=["disabled"],Od={key:1,id:"loader",class:"row"};function qd(e,t,s,d,a,i){const m=u("meta-component"),h=u("alert"),b=u("text-field"),f=u("reuse-loader"),g=W("tooltip"),D=W("focus-first-input");return o(),l("div",gd,[_(m,{dynamic_title:e.trans("approval_settings-page-title"),dynamic_description:e.trans("approval_settings-page-description"),layout:s.layout},null,8,["dynamic_title","dynamic_description","layout"]),_(h),a.statusText===""&&a.hasDataPopulated?(o(),l("div",bd,[n("div",yd,[n("article",vd,[n("header",wd,[n("h3",{class:Q(["entry-title",{align1:a.lang_locale=="ar"}])},[t[2]||(t[2]=n("i",{class:"fas fa-file-contract pe-1"},null,-1)),S((o(),l("span",kd,[v(r(a.contractDetails.name),1)])),[[g,a.contractDetails.name]])],2)]),n("div",{class:Q(["entry-content clearfix",{align1:a.lang_locale=="ar"}])},[n("div",Cd,[n("div",Dd,[n("div",Sd,[n("div",Md,[n("div",Fd,[n("b",null,r(e.trans("start_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.contractDetails.contract_start_date)),1)])),[[g,d.formattedTime(a.contractDetails.contract_start_date)]])]),n("div",Id,[n("b",null,r(e.trans("expiry_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.contractDetails.contract_end_date)),1)])),[[g,d.formattedTime(a.contractDetails.contract_end_date)]])]),n("div",Ad,[n("b",null,r(e.trans("contract_type"))+" : ",1),S((o(),l("span",null,[v(r(a.contractDetails.contractType?i.subString(a.contractDetails.contractType.name,20):"---"),1)])),[[g,a.contractDetails.contractType?a.contractDetails.contractType.name:"---"]])])])])])]),n("div",Pd,[n("div",Td,[n("table",Vd,[n("tbody",null,[n("tr",null,[n("td",null,[n("b",null,r(e.trans("vendor"))+" :",1)]),n("td",null,[S((o(),l("span",null,[v(r(a.contractDetails.vendor?i.subString(a.contractDetails.vendor.name):"---"),1)])),[[g,a.contractDetails.vendor?a.contractDetails.vendor.name:"---"]])])]),n("tr",null,[n("td",null,[n("b",null,r(e.trans("contract_status"))+" :",1)]),n("td",null,[S((o(),l("span",null,[v(r(i.subString(a.contractDetails.status.name)),1)])),[[g,a.contractDetails.status.name]])])]),n("tr",null,[n("td",null,[n("b",null,r(e.trans("license_type"))+" :",1)]),n("td",null,[S((o(),l("span",null,[v(r(a.contractDetails.licence?i.subString(a.contractDetails.licence.name):"---"),1)])),[[g,a.contractDetails.licence?a.contractDetails.licence.name:"---"]])])])])]),t[3]||(t[3]=n("div",{class:"clearfix"},null,-1))]),n("div",Ld,[n("table",Ud,[n("tbody",null,[n("tr",null,[n("td",null,[n("b",null,r(e.trans("cost"))+" :",1)]),n("td",null,[S((o(),l("span",null,[v(r(a.contractDetails.cost),1)])),[[g,a.contractDetails.cost.toString()]])])]),n("tr",null,[n("td",null,[n("b",null,r(e.trans("contract_creator"))+" :",1)]),n("td",null,[S((o(),l("span",null,[v(r(a.contractDetails.owner?i.subString(a.contractDetails.owner.name):"---"),1)])),[[g,a.contractDetails.owner?a.contractDetails.owner.name:"---"]])])]),n("tr",null,[n("td",null,[n("b",null,r(e.trans("license_count"))+" :",1)]),n("td",null,[S((o(),l("span",null,[v(r(a.contractDetails.licensce_count?i.subString(a.contractDetails.licensce_count):"---"),1)])),[[g,a.contractDetails.licensce_count?a.contractDetails.licensce_count.toString():"---"]])])])])]),t[4]||(t[4]=n("div",{class:"clearfix"},null,-1))])])],2)]),!a.loading&&a.shallShowApprovalAction?S((o(),l("div",{key:0,id:"approval-action-form",class:Q({align1:a.lang_locale=="ar"})},[_(b,{id:"textarea",label:e.trans("comment"),value:a.comment,type:"textarea",name:"comment",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12",hint:e.trans("contarct_approval_comment")},null,8,["label","value","onChange","placehold","hint"]),n("div",Nd,[n("button",{id:"approve",onClick:t[0]||(t[0]=M=>i.onClick("approve")),class:"btn btn-success",disabled:a.isDisabled},[t[5]||(t[5]=n("span",{class:"fas fa-check"},null,-1)),v(" "+r(e.trans("approve")),1)],8,Ed),n("button",{id:"deny",onClick:t[1]||(t[1]=M=>i.onClick("reject")),class:"btn btn-secondary",disabled:a.isDisabled},[t[6]||(t[6]=n("span",{class:"fas fa-times"},null,-1)),v(" "+r(e.trans("reject")),1)],8,xd)])],2)),[[D]]):c("",!0)])])):c("",!0),a.loading?(o(),l("div",Od,[_(f,{"animation-duration":4e3,size:60,color:s.layout.portal.client_header_color},null,8,["color"])])):c("",!0)])}const jd=P(fd,[["render",qd],["__scopeId","data-v-1c0bed7a"]]);const Rd={class:"col-sm-12"},Bd={key:1},zd={class:"card-header"},Kd={class:"card-title"},Hd={class:"card-body"},Yd={class:"table-responsive"},$d={class:"table"},Wd={id:"report-icon",style:{width:"1%"}},Jd={class:"fa-stack fa-2x"},Gd={id:"report-description",style:{width:"100%"}},Xd={class:"text-uppercase"},Zd={class:"text-overflow"},Qd={class:"float-end report-modify"},ec={id:"report-label",style:{width:"9%"}},tc={key:0,class:"badge text-bg-info"},sc=["onClick"],ac={__name:"ReportEntry",setup(e){const t=se([]),s=se(!1);Qe(()=>{d()});const d=()=>{s.value=!0,T.get("/service-desk/api/sd-reports/list").then(m=>{t.value=m.data.data}).catch(m=>{O(m,"report-home-page")}).finally(()=>{s.value=!1})},a=m=>{confirm("Are you sure you want to delete this report?")&&(s.value=!0,T.delete("api/report/"+m).then(b=>{d(),K(b,"report-home-page")}).catch(b=>{O(b,"report-home-page"),s.value=!1}))},i=m=>({1:"problem-report",2:"change-report",3:"release-report",4:"asset-report",5:"contract-report",7:"software-license-report"})[m]||"report";return(m,h)=>{const b=u("alert"),f=u("custom-loader"),g=u("router-link"),D=W("tooltip");return o(),l("div",Rd,[_(b,{componentName:"report-home-page"}),s.value?(o(),k(f,{key:0,duration:4e3})):c("",!0),t.value?(o(),l("div",Bd,[(o(!0),l(U,null,$(t.value,(M,x)=>(o(),l("div",{class:"card card-light",key:x},[n("div",zd,[n("h3",Kd,r(m.lang(x)),1)]),n("div",Hd,[n("div",Yd,[n("table",$d,[n("tbody",null,[(o(!0),l(U,null,$(M,R=>(o(),l("tr",{class:"default",key:R.id},[n("td",Wd,[n("span",Jd,[n("i",{class:Q(R.icon_class+" fa-stack-1x")},null,2)])]),n("td",Gd,[n("dl",null,[n("dt",Xd,[_(g,{to:"/service-desk/reports/"+i(R.module)+"/"+R.module+"/"+R.id,class:"fw-500"},{default:w(()=>[v(r(R.report),1)]),_:2},1032,["to"])]),n("dd",Zd,[v(r(R.description)+" ",1),h[0]||(h[0]=n("br",null,null,-1)),n("small",Qd,[v(r(m.lang("last_modified_on"))+": ",1),n("strong",null,r(R.updated_at),1)])])])]),n("td",ec,[R.is_default?(o(),l("div",tc,r(m.trans("default")),1)):S((o(),l("button",{key:1,class:"btn btn-secondary me-6",onClick:V=>a(R.id)},h[1]||(h[1]=[n("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)]),8,sc)),[[D,m.trans("delete")]])])]))),128))])])])])]))),128))])):c("",!0)])}}},nc=P(ac,[["__scopeId","data-v-4227496f"]]);const oc={name:"report-list",description:"Report lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data:()=>({columns:["name","description","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/reports"}),beforeMount(){const e=this;this.options={headings:{name:this.trans("name"),description:this.trans("description"),created_at:this.trans("created_at"),updated_at:this.trans("updated_at"),action:this.trans("actions")},columnsClasses:{name:"report-name",description:"report-desc",created_at:"report-time",updated_at:"report-time",action:"report-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(qe,{data:s})},sortable:["name","description","created_at","updated_at"],filterable:["name","description"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.reports.data.map(s=>(s.from="agent",s.view_url="/service-desk/reports/assets/"+s.id,s.edit_url="/service-desk/reports/assets/edit/"+s.id,s.delete_url=e.basePath()+"/service-desk/api/reports/"+s.id,s)),count:t.data.reports.total}},orderBy:{column:"id",ascending:!0}}}},ic={class:"col-sm-12"},lc={class:"card card-light"},rc={class:"card-header"},dc={id:"report-list",class:"card-title"},cc={class:"card-tools"},uc={class:"card-body",id:"my_asset_report_list"};function mc(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",ic,[_(m,{componentName:"dataTableModal"}),n("div",lc,[n("div",rc,[n("h3",dc,r(e.lang("assets_reports")),1),n("div",cc,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/reports/assets/create"},{default:w(()=>t[0]||(t[0]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_asset_report")]])])]),n("div",uc,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"report-list"},null,8,["url","dataColumns","option"])])])])}const hc=P(oc,[["render",mc]]);function pc(e){const{name:t}=e;var s={name:[t,"isRequired","max(25)"]};const d=new Ue(Ce),{errors:a,isValid:i}=d.validate(s);return Fe.dispatch("setValidationError",a),{errors:a,isValid:i}}const _c={name:"agent-asset-list",description:"Agent asset lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{from:{type:String,default:""},ApiUrl:{type:String,default:"/service-desk/api/asset-list?config=true&"}},data(){return{columns:[],options:{},apiUrl:this.ApiUrl}},watch:{ApiUrl(e,t){return t}},computed:{columnsValues(){return this.$emit("columns-list",this.columns.filter(e=>e.display).map(e=>e.key)),this.columns.filter(e=>e.display).map(e=>e.key)},isSingleDisplayTrue(){return this.columns.filter(e=>e.display).length===1}},beforeMount(){this.getColumns();const e=this;this.options={headings:{name:this.trans("name"),used_by:this.trans("used_by"),managed_by:this.trans("managed_by"),action:this.trans("actions"),identifier:this.trans("identifier"),created_at:this.trans("created_at"),updated_at:this.trans("updated_at"),asset_type:this.trans("asset_type"),asset_status:this.trans("asset_status")},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{assigned_on(t,s){return e.formattedTime(s.assigned_on)},created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},managed_by(t,s){var d,a;return((a=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,a;return((a=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},attachment(t,s){return s.attachment?e.h("a",{href:e.basePath()+"/uploads/service-desk/attachments/"+s.attachment.value,target:"_blank"},Ce("click_to_see_attachment")):"--"},name(t,s){return e.h(De,{to:"/service-desk/assets/"+s.asset_id+"/show"},s.name)},asset_type(t,s){return s.asset_type?s.asset_type.name:"--"},asset_status(t,s){return s.asset_status?s.asset_status.name:"--"},department(t,s){return s.department?e.h("a",{href:e.basePath()+"/admin/department/"+s.department.id,target:"_blank"},s.department.name.replace(/<[^>]+>/g,"")):"--"},impact_type(t,s){return s.impact_type?s.impact_type.name:"--"},location(t,s){return s.location?s.location.name:"--"},organization(t,s){return s.organization?e.h(De,{to:"/organizations/"+s.organization.id},s.organization.name.replace(/<[^>]+>/g,"")):"--"},product(t,s){return s.product?e.h("a",{href:e.basePath()+"/admin/service-desk/products/"+s.product.id+"/show",target:"_blank"},s.product.name):"--"}},sortable:["asset_id","name","identifier","assigned_on","created_at","updated_at"],filterable:["name","identifier","assigned_on","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.$emit("asset-report-data",t.data.data),{data:t.data.data,count:t.data.total}},orderBy:{column:"id",ascending:!0}}},methods:{columnToggle(e){this.columns[e].display=!this.columns[e].display},getColumns(){const e=window.location.pathname,t=pe(e),s=t?"/service-desk/api/asset-list?column=true&filter_id="+t:"/service-desk/api/asset-list?column=true";T.get(s).then(d=>{this.columns=d.data.data.asset_columns}).catch(d=>{this.columns=[]})}}},fc={class:"card-body"},gc={key:0,class:"column-list-right"},bc={class:"btn btn-light dropdown-toggle mt-10",type:"button","data-bs-toggle":"dropdown"},yc={class:"dropdown-menu dropdown-menu-right",id:"cols"},vc={key:0,class:"dropdown-item asset-col",href:"javascript:;"},wc={class:"label_align"},kc=["onClick","disabled","onUpdate:modelValue"],Cc={class:"agent-asset-table"};function Dc(e,t,s,d,a,i){const m=u("alert"),h=u("data-table");return o(),l("div",fc,[_(m,{componentName:"dataTableModal"}),s.from!="view"?(o(),l("div",gc,[t[2]||(t[2]=v("    ")),n("button",bc,[t[0]||(t[0]=n("i",{class:"fas fa-columns"},null,-1)),v(" "+r(e.lang("columns")),1)]),n("div",yc,[(o(!0),l(U,null,$(a.columns,(b,f)=>(o(),l(U,null,[b.key!="id"&&b.key!="description"?(o(),l("a",vc,[n("label",wc,[S(n("input",{class:"checkbox_align",type:"checkbox",onClick:g=>i.columnToggle(f),disabled:i.isSingleDisplayTrue&&b.display,"onUpdate:modelValue":g=>b.display=g},null,8,kc),[[cs,b.display]]),t[1]||(t[1]=n("span",{class:"checkbox-label-space me-2"},null,-1)),v(r(e.lang(b.value)),1)])])):c("",!0)],64))),256))])])):c("",!0),n("div",Cc,[_(h,{url:s.ApiUrl,dataColumns:i.columnsValues,option:a.options,scroll_to:"asset-list"},null,8,["url","dataColumns","option"])])])}const bs=P(_c,[["render",Dc]]);const Sc={name:"custom-filter",description:"Custom Fields Filter Component",props:{updateFilterFields:{type:Function,default:()=>{}},selectedFilterFields:{type:Array,default:()=>[]},endPoint:{type:String,required:!0},defaultFiltersObj:{type:Object,default:()=>{}}},data(){return{customFields:[],loading:!0,selectedFields:this.selectedFilterFields,search:"",locale:"",hasMoreData:!0,page:1}},created(){window.emitter.on("clearCustomFields",this.clearFields)},computed:{filteredList(){return this.customFields.filter(e=>e.label.toLowerCase().includes(this.search.toLowerCase()))}},methods:{clearAndCall(){this.customFields=[],this.loading=!0,this.search="",this.page=1,this.hasMoreData=!0,this.getFields()},handleFilterScroll:fs.debounce(function(){const e=document.getElementById("filter-dropdown"),t=e.scrollHeight,s=e.scrollTop,d=e.clientHeight;s+d>=t-100&&!this.loading&&this.hasMoreData&&this.getFields()},200),clearFields(){this.selectedFields=[]},subString(e){return Ie(e,30)},onCancel(){var e=document.getElementById("filter-div");e.classList.remove("open")},onClick(e){if(this.selectedFields.map(s=>s.id).includes(e.id)){for(var t in this.selectedFields)if(this.selectedFields[t].id===e.id){this.selectedFields.splice(t,1);break}}else e.name="custom_"+e.id,e.isCustom=!0,e.value="",e.className="col-sm-4",this.selectedFields.push(e);this.updateFilterFields(this.selectedFields)},async getFields(){try{this.loading=!0;let e={page:this.page,time:Date.now()};this.defaultFiltersObj.hasOwnProperty("asset_type_ids")&&this.defaultFiltersObj.asset_type_ids&&this.defaultFiltersObj.asset_type_ids.forEach((s,d)=>{e[`asset_type_ids[${d}]`]=s.id});const t=await T.get(this.endPoint,{params:e});t.data.data.data.length>0?(this.customFields=[...this.customFields,...t.data.data.data],this.page++):(this.hasMoreData=!1,this.checkPresentFields())}catch(e){console.error("Error fetching data:",e)}finally{this.loading=!1}},getCustomFields(e,t){this.customFields=[],this.selectedFields=[],T.get(e).then(s=>{let d=s.data.data.data;if(this.page++,d.length){for(var a in d){if(t.length)for(var i in t)t[i].key===d[a].key&&(d[a].name=t[i].key,d[a].isCustom=!0,d[a].className="col-sm-4",d[a].value||(d[a].data_type==="checkbox"?d[a].value=t[i].value.split(","):d[a].value=t[i].value,this.selectedFields.push(d[a]),this.selectedFields.length===t.length&&this.updateFilterFields(this.selectedFields)));for(var m in this.selectedFields)this.selectedFields[m].id===d[a].id&&(d[a].value=this.selectedFields[m].value)}this.customFields=d,this.checkPresentFields()}}).catch(s=>{})},checkPresentFields(){let e=this.customFields.map(t=>t.key);this.selectedFields.forEach(t=>{e.includes(t.key)||(t.selected=0,this.selectedFields=this.selectedFields.filter(function(s){return s.id!==t.id}))}),this.updateFilterFields(this.selectedFields)}}},Mc={id:"filter-div",class:"card-tools"},Fc={key:0,class:"nav-item"},Ic={class:"form-group has-feedback has-search filter_div"},Ac=["placeholder"],Pc=["onClick"],Tc={key:0,class:"fa fa-check field_select"},Vc={id:"field_title"},Lc={key:1},Uc={class:"text-center"},Nc={key:2,class:"field_loader nav-item"};function Ec(e,t,s,d,a,i){const m=u("loader"),h=W("tooltip");return o(),l("div",Mc,[S((o(),l("button",{type:"button",class:"btn btn-tool dropdown-toggle","data-bs-toggle":"dropdown",id:"labels-button",onClick:t[0]||(t[0]=b=>i.clearAndCall())},t[4]||(t[4]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)]))),[[h,e.trans("add_custom_field")]]),n("ul",{id:"filter-dropdown",class:"dropdown-menu dropdown-menu-right filter_menu",onClick:t[2]||(t[2]=b=>b.stopPropagation()),onScroll:t[3]||(t[3]=b=>i.handleFilterScroll())},[a.loading?c("",!0):(o(),l("li",Fc,[n("div",Ic,[S(n("input",{type:"text",class:"form-control",name:"label",placeholder:e.trans("search"),"onUpdate:modelValue":t[1]||(t[1]=b=>a.search=b)},null,8,Ac),[[ca,a.search]])])])),(o(!0),l(U,null,$(i.filteredList,b=>S((o(),l("li",{class:"nav-item fields",onClick:f=>i.onClick(b)},[n("a",{class:Q(["nav-link custom-filter-nav-item",{active:a.selectedFields.map(f=>f.id).includes(b.id)}]),href:"javascript:;"},[a.selectedFields.map(f=>f.id).includes(b.id)?(o(),l("i",Tc)):c("",!0),n("span",Vc,r(i.subString(b.label)),1)],2)],8,Pc)),[[h,b.hover?b.hover:e.trans(b.label)]])),256)),!a.loading&&a.customFields.length===0?(o(),l("li",Lc,[n("p",Uc,r(e.trans("no_results_found")),1)])):c("",!0),a.loading?(o(),l("li",Nc,[_(m,{size:30,duration:4e3,color:"#1d78ff"})])):c("",!0)],32)])}const xc=P(Sc,[["render",Ec],["__scopeId","data-v-b6306cf9"]]),Oc={name:"custom-asset-form-fields",props:{formField:{type:Object,required:!0},allFields:{type:Array,default:()=>[]},classname:{type:String,default:"col-sm-6"}},data(){return{selectedVal:this.formField.value,uniqueId:this.formField.key,updatedFields:this.allFields,dropdownOptions:[],dropdownLabel:"label",country_code:null,showMobileField:!1}},watch:{allFields(e,t){this.updatedFields=e},formField(e,t){if(this.uniqueId=e.key,this.selectedVal=e.value,e.data_type==="checkbox"&&(this.selectedVal=Array.isArray(this.selectedVal)?this.selectedVal:this.selectedVal.split(",")),e.data_type==="mobile"&&this.selectedVal&&this.selectedVal.includes(" ")){const s=this.selectedVal.split(" ");s.length>1&&(s.shift(),this.selectedVal=s.join(" "))}}},beforeMount(){this.formField.data_type==="mobile"&&this.formField.value&&this.formField.value.includes(" ")?(this.country_code=this.formField.value.split(" ")[0],this.showMobileField=!0):this.showMobileField=!0},computed:{apiInfoUrl(){let e=ut.convertStringOfPropertiesToObject(this.formField.api_info).url;return!e&&this.formField.api_info&&(e=this.formField.api_info),e},dropdownKey(){return ut.convertStringOfPropertiesToObject(this.formField.api_info).key||"label"},selectedValue(){let e=this.updatedFields.findIndex(t=>t.key==this.uniqueId);if(e!=-1){if(this.formField.data_type==="mobile"&&this.selectedVal&&this.selectedVal.includes(" ")){const t=this.selectedVal.split(" ");if(t.length>1)return t.shift(),t.join(" ")}if(Array.isArray(this.selectedVal)&&this.selectedVal!=null){let t=[];return this.selectedVal.forEach(s=>{typeof s=="object"?t.push(s.label):t.push(s)}),this.updatedFields[e].value=t.map(s=>s).toString(),this.updatedFields[e].options.filter(s=>t.includes(s.label))}else if(Re(this.updatedFields[e].options)){let t="";return typeof this.selectedVal=="object"?t=this.selectedVal.label:t=this.selectedVal,this.updatedFields[e].options.find(s=>s.label===t)}else return this.selectedVal?this.selectedVal:""}else return this.selectedVal}},methods:{keypressEvent(e,t,s){if(s==="number"||s==="mobile"){e=e||window.event;var d=e.which?e.which:e.keyCode;if(d>31&&(d<48||d>57))e.preventDefault();else return!0}else if(s==="float"||s==="decimal"){e=e||window.event;var d=e.which?e.which:e.keyCode;if(d>=48&&d<=57||d==46)return!0;e.preventDefault()}},pasteEvent(e,t,s){if(s==="number"||s==="mobile")e=e||window.event,e.clipboardData.getData("Text").match(/[^\d]/)&&e.preventDefault();else if(s==="float"||s==="decimal"){e=e||window.event;var d=e.clipboardData||window.clipboardData,a=d.getData("Text");/^\d*\.\d*$/.test(a)||e.preventDefault()}},onCountryCodeUpdate(e,t){this[t]=e},onChange(e,t){this.formField.data_type==="number"&&e===0&&(e="0");let s=this.updatedFields.findIndex(d=>d.key==t);Array.isArray(e)&&e!=null?(this.updatedFields[s].value=e.map(d=>d.label).toString(),this.selectedVal=e):typeof e=="object"&&e!=null?(this.updatedFields[s].value=e[this.dropdownLabel],this.selectedVal=e):this.formField.data_type==="mobile"?(this.updatedFields[s].value=e?this.country_code+" "+e:"",this.selectedVal=e?this.country_code+" "+e:""):(this.updatedFields[s].value=e||"",this.selectedVal=e||""),this.$emit("updated",this.updatedFields)}},components:{MobileField:ua,"dynamic-select":fe,"text-field":Ae,"radio-field":ga,"checkbox-field":ba,"date-time-field":es}};function qc(e,t,s,d,a,i){const m=u("date-time-field"),h=u("dynamic-select"),b=u("text-field"),f=u("radio-field"),g=u("checkbox-field"),D=u("MobileField");return o(),l("div",{class:Q(s.classname)},[s.formField.data_type==="date"?(o(),k(m,{key:0,type:s.formField.request_time_information?"datetime":"date",label:s.formField.label,value:i.selectedValue,id:s.formField.key,required:!1,name:s.formField.key,onChange:i.onChange,format:s.formField.request_time_information?"MMMM DD YYYY HH:mm:ss":"MMMM DD YYYY",clearable:!0,outputFormat:"YYYY-MM-DD HH:mm:ss"},null,8,["type","label","value","id","name","onChange","format"])):c("",!0),s.formField.data_type==="select"?(o(),k(h,{key:1,id:s.formField.key,label:s.formField.label,multiple:!1,name:s.formField.key,apiEndpoint:i.apiInfoUrl,value:i.selectedValue,onChange:i.onChange,optionLabel:a.dropdownLabel},null,8,["id","label","name","apiEndpoint","value","onChange","optionLabel"])):c("",!0),s.formField.data_type==="text"||s.formField.data_type==="textarea"||s.formField.data_type==="number"||s.formField.data_type==="decimal"||s.formField.data_type==="email"?(o(),k(b,{key:2,id:s.formField.key,label:s.formField.label,type:s.formField.data_type,name:s.formField.key,value:i.selectedValue,onChange:i.onChange,from:"filter",keypressEvt:i.keypressEvent,pasteEvt:i.pasteEvent},null,8,["id","label","type","name","value","onChange","keypressEvt","pasteEvt"])):c("",!0),s.formField.data_type==="radio"?(o(),k(f,{key:3,name:s.formField.key,label:s.formField.label,options:s.formField.options,value:i.selectedValue,onChange:i.onChange,from:"filter"},null,8,["name","label","options","value","onChange"])):c("",!0),s.formField.data_type==="checkbox"?(o(),k(g,{key:4,name:s.formField.key,label:s.formField.label,options:s.formField.options,value:i.selectedValue,onChange:i.onChange,from:"filter"},null,8,["name","label","options","value","onChange"])):c("",!0),a.showMobileField&&s.formField.data_type==="mobile"?(o(),k(D,{key:5,fieldFor:"automator",id:s.formField.key,label:s.formField.label,type:s.formField.data_type,name:s.formField.key,value:i.selectedValue,onChange:i.onChange,isInlineForm:!1,countryCode:a.country_code,onCountryCode:t[0]||(t[0]=M=>i.onCountryCodeUpdate(M,"country_code")),keypressEvt:i.keypressEvent,pasteEvt:i.pasteEvent,extensionEnabled:0,ext:[]},null,8,["id","label","type","name","value","onChange","countryCode","keypressEvt","pasteEvt"])):c("",!0)],2)}const jc=P(Oc,[["render",qc]]);const Rc={name:"table-filter",description:"Table filter component",props:{titleText:String,metaData:{type:Array,required:!0},appliedFilters:{type:Object,default:()=>{}},parsedUrlParams:{type:Object,default:()=>{}},from:{type:String,default:""},showCustomFilter:{type:Boolean,default:!1},updateFields:{type:Function,default:()=>{}},selectedFields:{type:Array,default:()=>[]},endPoint:{type:String,default:""},saveFilter:{type:Boolean,default:!1},filterFor:{type:String,default:""},filterNum:{type:[String,Number],default:""},redirectTo:{type:String,default:""},deleteUrl:{type:String,default:""},closeFilter:{type:Function,default:()=>{}},save_endpoint:{type:String,default:""}},data(){return{selectedFilters:this.appliedFilters,close_on_select:!this.multiple,isShowFilter:!1,componentMetaData:this.metaData,loading:!1,formStyle:{width:"49.5%"},numberStyle:{width:"20%"},showModal:!1,filterName:"",selectedFilterId:this.filterNum,departments:[],agents:[],filterMode:"",icon_class:"",dashboardWidget:!1,isDefault:!1,icon_color:""}},beforeMount(){this.updateSelectedFieldValues();const e=at();this.filterNum?this.getFilterValue("/service-desk/api/agent/sd-filter/"+this.selectedFilterId,"filter"):e&&e.hasOwnProperty("filter-by-url")&&this.getFilterValue("/service-desk/api/filter-dependencies","urlFilter")},methods:{updatedCustomFields(e){for(var t in e)this.onChange(e[t].value,e[t].name)},updateSelectedFieldValues(){this.updateFields(this.selectedFields);for(var e in this.selectedFields)this.onChange(this.selectedFields[e].value,this.selectedFields[e].name)},onChange(e,t){this.selectedFilters[t]=e,window.emitter.emit("onFilterSelected",this.selectedFilters)},onCancel(){this.$emit("selectedFilters","closeEvent")},onApply(){this.$emit("selectedFilters",this.selectedFilters)},onSave(e){this.filterMode=e,this.showModal=!0},toggleFilterPopUp(e){this.showModal=e},onReset(){this.selectedFilters={},this.loading=!0,setTimeout(()=>{this.loading=!1},1e3),this.$emit("selectedFilters","resetEvent"),window.emitter.emit("onFilterSelected",this.selectedFilters)},getFilterValue(e,t){this.loading=!0,axios.get(e,{params:this.parsedUrlParams}).then(s=>{this.loading=!1;let d={},a=[];this.isDefault=s.data.data.is_default,(t==="filter"?s.data.data.fields:s.data.data).map(m=>{m.key.indexOf("custom_")!==-1?(a.push(m),d[m.key]=m.value):d[m.key]=m.value_meta}),a.length&&this.appendCustomFieldFilter(a),this.selectedFilters=d,this.componentMetaData.map(function(m){m.section.map(function(h){d.hasOwnProperty(h.name)&&(h.value=d[h.name])})}),this.selectedFilterId=s.data.data.id,this.filterName=this.isDefault?"":s.data.data.name,this.icon_class=!this.isDefault&&s.data.data.icon_class?{icon_class:s.data.data.icon_class}:"",this.departments=s.data.data.departments,this.agents=s.data.data.agents,this.dashboardWidget=s.data.data.is_dashboard_widget,this.icon_color=this.isDefault?"#00C0EF":s.data.data.icon_color,window.emitter.emit("onFilterSelected",this.selectedFilters)}).catch(s=>{this.loading=!1})},appendCustomFieldFilter(e){this.$refs.custom_table_filter.getCustomFields(this.endPoint,e)}},components:{"custom-form-fields":jc,"custom-filter":xc,"dynamic-select":fe,"date-time-field":hs,"number-range-field":ps,"text-field":Ae,"save-table-filter":_s}},Bc={key:0,class:"card-body"},zc={class:"row"},Kc={key:1,id:"table-filter"},Hc={class:"row"},Yc={class:"card-footer"};function $c(e,t,s,d,a,i){const m=u("custom-filter"),h=u("custom-loader"),b=u("custom-form-fields"),f=u("dynamic-select"),g=u("number-range-field"),D=u("text-field"),M=u("date-time-field"),x=u("save-table-filter"),R=u("faveo-box");return o(),k(R,{"box-class":"card card-light ",title:e.lang("filter")},{customActions:w(()=>[s.showCustomFilter?(o(),k(m,{key:0,updateFilterFields:s.updateFields,selectedFilterFields:s.selectedFields,endPoint:s.endPoint,ref:"custom_table_filter",defaultFiltersObj:a.selectedFilters},null,8,["updateFilterFields","selectedFilterFields","endPoint","defaultFiltersObj"])):c("",!0)]),actions:w(()=>[n("div",Yc,[n("button",{id:"filter-apply-btn",class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=(...V)=>i.onApply&&i.onApply(...V))},[t[6]||(t[6]=n("span",{class:"fas fa-check"},null,-1)),v("  "+r(e.lang("apply")),1)]),s.saveFilter?(o(),l(U,{key:0},[s.filterNum&&!a.isDefault&&!a.loading?(o(),l(U,{key:0},[n("button",{id:"filter-upd",class:"btn btn-primary",type:"button",onClick:t[1]||(t[1]=V=>i.onSave("update"))},[t[7]||(t[7]=n("span",{class:"fas fa-sync"},null,-1)),v("  "+r(e.lang("update")),1)]),n("button",{id:"filetr-del",class:"btn btn-secondary",type:"button",onClick:t[2]||(t[2]=V=>i.onSave("delete"))},[t[8]||(t[8]=n("span",{class:"fas fa-trash-alt"},null,-1)),v("  "+r(e.lang("delete")),1)])],64)):(o(),l("button",{key:1,id:"filetr-save",class:"btn btn-primary",type:"button",onClick:t[3]||(t[3]=V=>i.onSave("save"))},[t[9]||(t[9]=n("span",{class:"fas fa-save"},null,-1)),v("  "+r(e.lang("save")),1)]))],64)):c("",!0),n("button",{id:"reset-btn",class:"btn btn-primary",type:"button",onClick:t[4]||(t[4]=(...V)=>i.onReset&&i.onReset(...V))},[t[10]||(t[10]=n("span",{class:"fas fa-undo"},null,-1)),v("  "+r(e.lang("reset")),1)]),s.from!=="report"?(o(),l("button",{key:1,id:"filter-cancel-btn",class:"btn btn-secondary",type:"button",onClick:t[5]||(t[5]=(...V)=>i.onCancel&&i.onCancel(...V))},[t[11]||(t[11]=n("span",{class:"fas fa-times"},null,-1)),v("  "+r(e.lang("cancel")),1)])):c("",!0)])]),default:w(()=>[a.loading?(o(),l("div",Bc,[n("div",zc,[_(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])])):(o(),l("div",Kc,[(o(!0),l(U,null,$(a.componentMetaData,V=>(o(),l("div",Hc,[(o(!0),l(U,null,$(V.section,N=>(o(),l(U,null,[N.isCustom?(o(),k(b,{key:0,formField:N,allFields:s.selectedFields,onUpdated:i.updatedCustomFields,classname:N.className},null,8,["formField","allFields","onUpdated","classname"])):(o(),l(U,{key:1},[N.type!=="date"&&N.type!=="number"&&N.type!=="text"?(o(),k(f,{key:N.name,id:N.name,name:N.name,apiEndpoint:N.url,classname:N.className,elements:N.elements,multiple:N.isMultiple,label:e.lang(N.label),value:N.value,onChange:i.onChange,strlength:"35",hint:e.lang(N.hint)},null,8,["id","name","apiEndpoint","classname","elements","multiple","label","value","onChange","hint"])):c("",!0),N.type==="number"?(o(),k(g,{label:e.lang(N.label),formStyle:a.formStyle,value:N.value,key:N.name,id:N.name,name:N.name,classname:N.className,type:"text",onChange:i.onChange,min_placeholder:N.min_placeholder,max_placeholder:N.max_placeholder,required:!1},null,8,["label","formStyle","value","id","name","classname","onChange","min_placeholder","max_placeholder"])):c("",!0),N.type==="text"?(o(),k(D,{label:e.lang(N.label),value:N.value,key:N.name,id:N.name,name:N.name,onChange:i.onChange,classname:N.className,required:!1},null,8,["label","value","id","name","onChange","classname"])):c("",!0),N.type==="date"?(o(),k(M,{label:N.label,value:N.value,type:"datetime",key:N.name,id:N.name,name:N.name,onChange:i.onChange,range:N.range,required:!1,format:"MMMM DD YYYY, h:mm a",classname:N.className,clearable:!1,disabled:!1,editable:!0,pickers:N.pickers,currentYearDate:!1,"time-picker-options":N.timeOptions,isDateSelector:!1,numberStyle:a.numberStyle,confirm:!0},null,8,["label","value","id","name","onChange","range","classname","pickers","time-picker-options","numberStyle"])):c("",!0)],64))],64))),256))]))),256))])),a.showModal?(o(),k(x,{key:2,filterName:a.filterName,icon:a.icon_class,filterValues:a.selectedFilters,filterId:a.selectedFilterId,toggleFilterPopUp:i.toggleFilterPopUp,source:s.filterFor,filterArray:a.componentMetaData,intitialDepartments:a.departments,initialAgents:a.agents,mode:a.filterMode,is_default:a.isDefault,redirectTo:s.redirectTo,onUpdateFilterData:i.onApply,deleteUrl:s.deleteUrl,closeFilter:s.closeFilter,"title-text":e.mode==="save"?e.trans("save_filter"):e.mode==="update"?e.trans("update_filter"):e.trans("delete_filter"),save_endpoint:s.save_endpoint,dashboardWidget:a.dashboardWidget,icon_color:a.icon_color},null,8,["filterName","icon","filterValues","filterId","toggleFilterPopUp","source","filterArray","intitialDepartments","initialAgents","mode","is_default","redirectTo","onUpdateFilterData","deleteUrl","closeFilter","title-text","save_endpoint","dashboardWidget","icon_color"])):c("",!0)]),_:1},8,["title"])}const ka=P(Rc,[["render",$c]]);const Wc={name:"report-nested-filter",description:"Report Nested Filter component",data(){return{title:"create_asset_report",iconClass:"fas fa-save",btnName:"save",filter_id:"",editData:"",apiUrl:"",name:"",description:"",selectedFilters:{},componentMetaData:[{section:[{name:"asset_ids",url:"/service-desk/api/asset-list?meta=true",label:"assets"},{name:"asset_type_ids",url:"/service-desk/api/dependency/asset_types",label:"asset_types"},{name:"used_by_ids",url:"api/dependency/users?meta=true",label:"used_by"}]},{section:[{name:"managed_by_ids",url:"api/dependency/agents?meta=true",label:"managed_by"},{name:"location_ids",url:"api/dependency/locations",label:"location"},{name:"dept_ids",url:"api/dependency/departments",label:"departments"}]},{section:[{name:"org_ids",url:"api/dependency/organizations",label:"organizations"},{name:"product_ids",url:"/service-desk/api/dependency/products",label:"products"},{name:"ticket_ids",url:"api/dependency/tickets",label:"ticket"}]},{section:[{name:"impact_type_ids",url:"/service-desk/api/dependency/impacts",label:"impact_types"},{name:"assigned_on",type:"date",label:["assigned_on","assigned_on"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"}}]}],sections:[1,2,3],loading:!0,fieldsArr:[],chart_types:[{id:"bar",name:"Bar"},{id:"pie",name:"Pie"},{id:"horizontal",name:"Horizontal Bar"},{id:"doughnut",name:"Doughnut"}],chart_type:"bar",showChart:!1,chartData:"",chartApiUrl:"",columns:"",reset:!1}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{selectedFiltersMethod(e){return e==="resetEvent"?this.onReset():this.applyFilter(e)},getColumns(e){this.columns=e},getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.title="edit_asset_report",this.iconClass="fas fa-sync",this.btnName="update",this.getInitialValues(t)):(this.apiUrl="/service-desk/api/asset-list?config=true&",this.chartApiUrl="/service-desk/api/asset-list?count=true&",this.filterData(),this.getChartData(),this.loading=!1,this.reset=!1)},getInitialValues(e){this.loading=!0,this.reset=!0,T.get("/service-desk/api/reports/"+e).then(t=>{this.loading=!1,this.reset=!1,this.editData=t.data.data.report_filter,this.filter_id=this.editData.id,this.name=this.editData.name,this.description=this.editData.description,this.filterData(this.editData.filter_meta);for(var s in this.editData.filter_meta)this.selectedFilters[this.editData.filter_meta[s].key]=this.editData.filter_meta[s].value_meta;this.applyFilter(this.selectedFilters)}).catch(t=>{this.loading=!1,this.reset=!1})},onChange(e,t){this.selectedFilters[t]=e},onFieldChange(e,t){this[t]=e,t==="chart_type"&&e&&(this.showChart=!1,this.getChartData())},isValid(){const{errors:e,isValid:t}=pc(this.$data);return!!t},filterAction(e){this.isValid()&&this.storeFields(this.selectedFilters)},applyFilter(e){this.selectedFilters=e,this.loading=!0;let t="/service-desk/api/asset-list?config=true&";this.chartApiUrl="/service-desk/api/asset-list?count=true&";let s=this.commonMethod(e,"apply");s[s.length-1]==="&"&&(s=s.slice(0,-1)),this.apiUrl=t+s,this.chartApiUrl=this.chartApiUrl+s,this.getChartData(this.chartApiUrl),this.loading=!1},commonMethod(e,t){let s="";for(var d in this.componentMetaData)for(var a in this.componentMetaData[d].section)if(e[this.componentMetaData[d].section[a].name])if(this.componentMetaData[d].section[a].value=e[this.componentMetaData[d].section[a].name],t==="apply")if(this.componentMetaData[d].section[a].name==="assigned_on"){let i=e.assigned_on;const m=i.includes("last::")||i.includes("date::")?`${e.assigned_on}`:"date::"+i.map(h=>Mt(h).format("YYYY-MM-DD HH:mm:ss")).join("~");s+=this.componentMetaData[d].section[a].name+"="+m+"&"}else e[this.componentMetaData[d].section[a].name].forEach(function(i,m){s+=this.componentMetaData[d].section[a].name+"["+m+"]="+i.id+"&"},this);else{let i=this.componentMetaData[d].section[a],m=i.name==="assigned_on",h=i.value.includes("last::")||i.value.includes("date::"),b=m?h?i.value:"date::"+i.value.map(g=>Mt(g).format("YYYY-MM-DD HH:mm:ss")).join("~"):i.value.map(g=>g.id),f=m?h?i.value:b:i.value;this.fieldsArr.push({key:i.name,value:b,value_meta:f})}return s},storeFields(e){this.loading=!0,this.commonMethod(e,"store");const t={};t.name=this.name,t.description=this.description,t.type="asset",t.fields=this.fieldsArr,t.report_column_keys=this.columns,this.filter_id!=""&&(t.id=this.filter_id),T.post("/service-desk/api/reports/create",t).then(s=>{this.loading=!1,K(s),this.filter_id||setTimeout(()=>{this.$router.push({name:"SD Reports Index"})},3e3)}).catch(s=>{this.loading=!1,O(s)})},onReset(){this.fieldsArr=[],this.selectedFilters={},this.apiUrl="/service-desk/api/asset-list?config=true&",this.chartApiUrl="/service-desk/api/asset-list?count=true&",this.getChartData(this.chartApiUrl),this.componentMetaData=this.componentMetaData.map(function(e){return e.section.map(function(t){t.elements=[],t.isMultiple=!0,t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e},this)},getChartData(){this.showChart=!1,T.get(this.chartApiUrl).then(e=>{this.showChart=!0,this.chartData=e.data}).catch(e=>{this.showChart=!0})},filterData(e){this.componentMetaData.map(function(t){t.section.map(function(s){e?e.map(function(d){d.key===s.name&&(s.value=d.value_meta)}):s.value="",s.elements=[],s.isMultiple=!0,s.isPrepopulate=!1,s.className="col-sm-4"})}),this.loading=!1}},components:{"dynamic-select":fe,"static-select":qt,"agent-asset-index":bs,"asset-filter":ka,"text-field":Ae,chart:ms}},Jc={class:"col-sm-12"},Gc={key:0,class:"row"},Xc={class:"card card-light"},Zc={class:"card-header"},Qc={class:"card-title"},eu={class:"card-body"},tu={class:"card card-light"},su={class:"card-header"},au={class:"card-title"},nu={class:"card-body"},ou={class:"row"},iu={class:"card card-light"},lu={class:"card-header"},ru={class:"card-title"},du={class:"card card-light"},cu={class:"card-header"},uu={class:"card-title"},mu={class:"card-body"},hu={class:"row"},pu={class:"card card-light"},_u={class:"card-header"},fu={class:"card-title"},gu={class:"card-footer"};function bu(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("text-field"),f=u("asset-filter"),g=u("static-select"),D=u("chart"),M=u("agent-asset-index"),x=W("focus-first-input");return o(),l("div",Jc,[a.loading?(o(),l("div",Gc,[_(m,{duration:4e3})])):c("",!0),_(h),n("div",Xc,[n("div",Zc,[n("h3",Qc,r(e.lang(a.title)),1)]),n("div",eu,[n("div",tu,[n("div",su,[n("h3",au,r(e.lang("report_info")),1)]),n("div",nu,[S((o(),l("div",ou,[_(b,{label:e.lang("name"),value:a.name,type:"text",name:"name",onChange:i.onFieldChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12",required:!0},null,8,["label","value","onChange","placehold"]),_(b,{label:e.lang("description"),value:a.description,type:"textarea",name:"description",onChange:i.onFieldChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12"},null,8,["label","value","onChange","placehold"])])),[[x]])])]),n("div",iu,[n("div",lu,[n("h3",ru,r(e.lang("report_filter")),1)]),a.reset?c("",!0):(o(),k(f,{key:0,id:"filter-box",metaData:a.componentMetaData,onSelectedFilters:i.selectedFiltersMethod,appliedFilters:a.selectedFilters,from:"report"},null,8,["metaData","onSelectedFilters","appliedFilters"]))]),n("div",du,[n("div",cu,[n("h3",uu,r(e.lang("graph")),1)]),n("div",mu,[n("div",hu,[_(g,{label:e.lang("select_chart_type"),elements:a.chart_types,name:"chart_type",value:a.chart_type,classname:"col-sm-6",onChange:i.onFieldChange,hideEmptySelect:!0},null,8,["label","elements","value","onChange"]),a.showChart?(o(),k(D,{key:0,chartData:a.chartData,type:a.chart_type},null,8,["chartData","type"])):c("",!0)])])]),n("div",pu,[n("div",_u,[n("h3",fu,r(e.lang("list_of_assets")),1)]),a.apiUrl?(o(),k(M,{key:0,onColumnsList:i.getColumns,ApiUrl:a.apiUrl},null,8,["onColumnsList","ApiUrl"])):c("",!0)])]),n("div",gu,[n("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=R=>i.filterAction("save")),type:"button"},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])])])])}const xs=P(Wc,[["render",bu],["__scopeId","data-v-97942134"]]);const yu={name:"report-view",description:"Report view component",beforeMount(){let e="";this.apiUrl="/service-desk/api/asset-list?config=true&",this.chartApiUrl="/service-desk/api/asset-list?count=true&",T.get("service-desk/api/reports/"+this.getIDfromURL()).then(t=>{this.reportData=t.data.data.report_filter;for(const s of t.data.data.report_filter.filter_meta)s.key==="assigned_on"?e+=s.key==="assigned_on"?"assigned_on="+s.value_meta+"&":"":s.value.forEach((d,a)=>{e+=s.key+"["+a+"]="+d+"&"}),this.chartApiUrl+=e,this.apiUrl+=e;e="",this.chartApiUrl.charAt(this.chartApiUrl.length-1)==="&"&&(this.chartApiUrl=this.chartApiUrl.slice(0,-1)),this.getChartData(),this.apiUrl.charAt(this.apiUrl.length-1)==="&"&&(this.apiUrl=this.apiUrl.slice(0,-1))}).catch(t=>{console.log(t)})},data(){return{layout:{portal:{client_header_color:"#009aba",client_button_color:"#009aba",client_button_border_color:"#00c0ef",client_input_fild_color:"#d2d6de"}},chart_types:[{id:"bar",name:"Bar"},{id:"pie",name:"Pie"},{id:"horizontal",name:"Horizontal Bar"},{id:"doughnut",name:"Doughnut"}],chart_type:"bar",reportData:"",apiUrl:"",chartApiUrl:"",filterName:"",filterDescription:"",selectedFilters:{},close_on_select:!this.multiple,isShowFilter:!1,showChart:!1,chartData:"",columns:"",table:""}},methods:{getColumns(e){this.columns=e},getTableData(e){this.table=e},onChange(e,t){this.selectedFilters[t]=e},getChartData(){this.showChart=!1,T.get(this.chartApiUrl).then(e=>{this.showChart=!0,this.chartData=e.data}).catch(e=>{this.showChart=!0})},onFieldChange(e,t){this[t]=e,t==="chart_type"&&e&&(this.showChart=!1,this.getChartData())},getIDfromURL(){let e=window.location.pathname.split("/");return e[e.length-1]},deleteReport(){let e="/service-desk/api/reports/"+this.getIDfromURL();T.delete(e).then(t=>{t&&(K(t,"report-view"),setTimeout(()=>{this.$router.push({name:"SD Reports Index"})},3e3))}).catch(t=>console.log(t))},exportAs(e){window.open(this.basePath()+"/service-desk/api/export/"+e+"?filter_id="+this.getIDfromURL())}},components:{"agent-asset-index":bs,"static-select":qt,chart:ms}},vu={class:"col-sm-12"},wu={class:"card card-light"},ku={class:"card-header"},Cu={class:"card-title"},Du={class:"card-tools"},Su={class:"btn-group",id:"export"},Mu={class:"btn btn-tool dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},Fu={class:"dropdown-menu dropdown-menu-right"},Iu={class:"card-body"},Au={key:0,class:"text-muted well well-sm no-shadow",id:"rep_desc"},Pu={class:"card card-light"},Tu={class:"card-header"},Vu={class:"card-title"},Lu={class:"card-body"},Uu={class:"row"},Nu={key:1,class:"row",id:"reset"},Eu={class:"row mt-2"},xu={class:"col-sm-12"};function Ou(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("static-select"),f=u("chart"),g=u("reuse-loader"),D=u("agent-asset-index"),M=W("tooltip");return o(),l("div",vu,[_(m,{componentName:"report-view"}),n("div",wu,[n("div",ku,[n("h3",Cu,r(a.reportData.name),1),n("div",Du,[S((o(),l("button",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...x)=>i.deleteReport&&i.deleteReport(...x))},t[3]||(t[3]=[n("i",{class:"fa fa-trash"},null,-1)]))),[[M,e.lang("delete")]]),S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/reports/assets/edit/"+i.getIDfromURL()},{default:w(()=>t[4]||(t[4]=[n("i",{class:"fas fa-edit"},null,-1)])),_:1},8,["to"])),[[M,e.lang("edit")]]),n("div",Su,[S((o(),l("button",Mu,t[5]||(t[5]=[n("i",{class:"fas fa-download"},null,-1)]))),[[M,e.lang("export")]]),n("div",Fu,[n("a",{href:"javascript:;",class:"dropdown-item text-dark",onClick:t[1]||(t[1]=x=>i.exportAs("csv"))},r(e.lang("csv")),1),n("a",{href:"javascript:;",class:"dropdown-item text-dark",onClick:t[2]||(t[2]=x=>i.exportAs("excel"))},r(e.lang("xlsx")),1)])])])]),n("div",Iu,[a.reportData.description?(o(),l("p",Au,[t[6]||(t[6]=n("strong",null,"Description ",-1)),v(" : "+r(a.reportData.description),1)])):c("",!0),n("div",Pu,[n("div",Tu,[n("h3",Vu,r(e.lang("graph")),1)]),n("div",Lu,[n("div",Uu,[_(b,{label:e.lang("select_chart_type"),elements:a.chart_types,name:"chart_type",value:a.chart_type,classname:"col-sm-6",onChange:i.onFieldChange,hideEmptySelect:!0},null,8,["label","elements","value","onChange"]),a.showChart?(o(),k(f,{key:0,chartData:a.chartData,type:a.chart_type},null,8,["chartData","type"])):(o(),l("div",Nu,[_(g,{"animation-duration":4e3,size:60})]))])])]),n("div",Eu,[n("div",xu,[_(D,{ApiUrl:a.apiUrl,onColumnsList:i.getColumns,onAssetReportData:i.getTableData,from:"view"},null,8,["ApiUrl","onColumnsList","onAssetReportData"])])])])])])}const qu=P(yu,[["render",Ou],["__scopeId","data-v-e057322e"]]);const ju={name:"Asset-list",description:"Asset lists table component",props:{filterIndex:{type:Boolean,default:!1}},data:()=>({parsedUrlParams:"",assetIds:[],columns:[],visibleColumns:{},appliedFilters:{},staticColumns:["id","asset_image","actions"],hasDataPopulated:!1,apiUrl:"/service-desk/api/asset-list",filterOptions:[{section:[{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets",isCustom:!1},{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems",isCustom:!1},{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes",isCustom:!1}]},{section:[{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases",isCustom:!1},{name:"contract_ids",url:"/service-desk/api/dependency/contracts",label:"contracts",isCustom:!1},{name:"asset_type_ids",url:"/service-desk/api/dependency/asset_types",label:"asset_types",isCustom:!1}]},{section:[{name:"used_by_ids",url:"api/dependency/users?meta=true",label:"used_by",isCustom:!1},{name:"managed_by_ids",url:"api/dependency/agents?meta=true",label:"managed_by",isCustom:!1},{name:"location_ids",url:"api/dependency/locations",label:"location",isCustom:!1}]},{section:[{name:"dept_ids",url:"api/dependency/departments",label:"departments",isCustom:!1},{name:"org_ids",url:"api/dependency/organizations",label:"organizations",isCustom:!1},{name:"product_ids",url:"/service-desk/api/dependency/products",label:"products",isCustom:!1}]},{section:[{name:"assigned_on",type:"date",label:["assigned_on","assigned_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0}]},{section:[{name:"impact_type_ids",url:"/service-desk/api/dependency/impacts",label:"impact_types",isCustom:!1},{name:"ticket_ids",url:"/api/dependency/tickets",label:"ticket",isCustom:!1},{name:"asset_status_ids",url:"/service-desk/api/status/list?module=4",label:"asset_status",isCustom:!1}]},{section:[{name:"depreciation_ids",url:"/service-desk/api/dependency/depreciation",label:"Depreciation",isCustom:!1}]},{section:[]}],assetFilterId:"",isShowFilter:!1,customFields:[],showIcon:!1,columnData:null,reportType:"asset",assetData:null,exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[]}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},computed:{fieldsEndPoint(){let e=location.search.substring(1),t,s;e&&(t=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"').replace(/%2F/g,"/")+'"}')),t&&(s=Object.keys(t).find(i=>i.includes("custom_")));let d={category:"asset",type:"asset",module:"filter",filter_id:this.assetFilterId||"",filter_key:s||""};return"/custom-field-flattened?"+Object.entries(d).map(([i,m])=>`${encodeURIComponent(i)}=${encodeURIComponent(m)}`).join("&")}},beforeMount(){const e=window.location.pathname;this.assetFilterId=pe(e);const t=at();t&&t.hasOwnProperty("filter-by-url")?(this.parsedUrlParams=t,It("/service-desk/api/filter-dependencies",t,{},a=>{a&&this.applyFilter(a,"dependencyFilter")},a=>{O(a)})):this.apiUrl=this.filterIndex?"/service-desk/api/asset-list?filter_id="+this.assetFilterId:"/service-desk/api/asset-list",this.filterData(),this.getAssetData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name==s.name&&(s.value=e.value)})})},getAssetData(){this.hasDataPopulated=!1,T.get("api/agent/report-config/asset-report").then(e=>{this.assetData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],O(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{Re(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.type=="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[7].section=e},generateLabel(){let e="/service-desk/generate-barcode?",t="";if(this.assetIds.length!=0){for(let d in this.assetIds)t+="ids["+d+"]="+this.assetIds[d]+"&";let s=e+t;this.redirect(s)}else alert(this.lang("barcode_no_asset"))},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/asset-list?filter_id="+this.assetFilterId:"/service-desk/api/asset-list",this.updateFilterFields([]),window.emitter.emit("clearCustomFields"),this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e,t=""){this.appliedFilters=e;for(var s in this.customFields)this.customFields[s].value=e[this.customFields[s].name];let d="/service-desk/api/asset-list?",a=new URLSearchParams(vt(this.filterOptions,e));t==="dependencyFilter"&&Object.entries(e).forEach(([f,g])=>{f.includes("custom_")&&(a+=`${encodeURIComponent(f)}=${encodeURIComponent(g)}&`)});const m=a,h=new URLSearchParams(m),b={};for(const[f,g]of h)b[f]=g;a[a.length-1]==="&"&&(a=a.slice(0,-1)),this.apiUrl=d+a,this.exportData=this.reformatExportData(b)},assetsData(e){this.assetIds=e},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[a,i,m]=d;t[i]=t[i]||[],t[i][m]=parseInt(e[s],10)}else t[s]=e[s].trim()}return t},exportReport(){this.loading=!0;let e={};this.filterIndex&&(e.filter_id=this.assetFilterId);const t={...this.exportData,total:this.dataCount},s={...this.exportData,...e,total:this.dataCount};T.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:t).then(d=>{K(d,"dataTableModal")}).catch(d=>{O(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.assetFilterId};this.$router.push({path:"/reports/schedule/add/"+this.assetData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{"user-column-list":Pt,"dynamic-datatable":Tt,"asset-filter":ka,"asset-list-with-checkbox":ht}},Ru={class:"col-sm-12"},Bu={key:0,class:"card card-light"},zu={class:"card-header"},Ku={id:"asset-list",class:"card-title"},Hu={class:"card-tools"},Yu={class:"card-body",id:"asset_index"};function $u(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("asset-filter"),f=u("user-column-list"),g=u("dynamic-datatable"),D=W("tooltip");return o(),l("div",Ru,[_(m,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",Bu,[n("div",zu,[n("h3",Ku,r(e.lang("list_of_assets")),1),n("div",Hu,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/assets/create"},{default:w(()=>t[4]||(t[4]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[D,e.lang("create_asset")]]),S((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...M)=>i.toggleFilterView&&i.toggleFilterView(...M)),href:"javascript:;"},t[5]||(t[5]=[n("span",{class:"glyphicon glyphicon-filter"},null,-1)]))),[[D,e.lang("filter")]]),S((o(),l("button",{class:"btn btn-tool label-btn",onClick:t[1]||(t[1]=(...M)=>i.generateLabel&&i.generateLabel(...M)),href:"javascript:;"},t[6]||(t[6]=[n("i",{class:"fas fa-print","aria-hidden":"true"},null,-1)]))),[[D,e.lang("generate_label")]]),e.showIcon?S((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[2]||(t[2]=M=>i.exportReport()),href:"javascript:;"},t[7]||(t[7]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.lang("export")]]):c("",!0),e.showIcon?S((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[3]||(t[3]=M=>i.scheduleList()),href:"javascript:;"},t[8]||(t[8]=[n("i",{class:"fas fa-calendar"},null,-1)]))),[[D,e.lang("schedule")]]):c("",!0)])]),n("div",Yu,[e.isShowFilter?(o(),k(b,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:i.fieldsEndPoint,saveFilter:!0,filterFor:"asset",filterNum:e.assetFilterId,redirectTo:"/service-desk/assets",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.assetFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter",parsedUrlParams:e.parsedUrlParams},{default:w(()=>t[9]||(t[9]=[v(" > ")])),_:1},8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","endPoint","filterNum","deleteUrl","closeFilter","parsedUrlParams"])):c("",!0),(o(!0),l(U,null,$(e.columnData,M=>(o(),l("section",{key:M},[_(f,{"table-columns":M.columns,reportId:M.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),k(g,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:M.columns,staticColumns:e.staticColumns,show_pagination:e.showPagination,tickets:i.assetsData},null,8,["data-url","columns","columnsMeta","staticColumns","show_pagination","tickets"])):c("",!0)]))),128))])])):c("",!0)])}const Os=P(ju,[["render",$u]]),Wu={name:"asset-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[Xe],beforeMount(){if(this.mode==="edit"){const e=pe(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-asset/"+e,this.editId=pe(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=At(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/assets/"+s+"/show")},1e3)}},components:{Alert:We,CustomLoader:nt,FormRenderer:Ze,FaveoBox:wt}},Ju={key:0,class:"col-sm-12"},Gu={key:0,class:"pull-right"},Xu={key:0,class:"form-group row mt-3"},Zu={class:"col-md-12"},Qu=["disabled"],em={key:0},tm={key:1};function sm(e,t,s,d,a,i){const m=u("Alert"),h=u("CustomLoader"),b=u("router-link"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FaveoBox"),M=W("tooltip");return a.formUniqueKey&&a.formSelected?(o(),l("div",Ju,[_(D,{title:e.lang(i.mode)},{headerMenu:w(()=>[s.showViewButton?(o(),l("span",Gu,[S((o(),k(b,{to:"/service-desk/assets/"+a.editId+"/show",class:"btn btn-tool has-tooltip"},{default:w(()=>t[1]||(t[1]=[n("span",null,[n("i",{class:"fas fa-eye"})],-1)])),_:1},8,["to"])),[[M,e.trans("view")]])])):c("",!0)]),default:w(()=>[_(m,{componentName:"faveo-form"}),e.showLoader||a.submitFormInProgress?(o(),k(h,{key:0,duration:4e3})):c("",!0),_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:a.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",Xu,[n("div",Zu,[n("button",{type:"button",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=N=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",em,t[2]||(t[2]=[n("i",{class:"fas fa-sync"},null,-1)]))):(o(),l("span",tm,t[3]||(t[3]=[n("i",{class:"fas fa-save"},null,-1)]))),v(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,Qu)])]))]),_:1},512)]),_:1},8,["title"])])):c("",!0)}const qs=P(Wu,[["render",sm]]);const am={name:"asset-description",description:"Asset description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},nm={class:"modal-title"},om={id:"log_desc"},im=["innerHTML"];function lm(e,t,s,d,a,i){const m=u("modal");return s.showModal?(o(),k(m,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",nm,r(e.trans("description")),1)]),fields:w(()=>[n("div",om,[n("span",{innerHTML:s.description},null,8,im)])]),_:1},8,["showModal","onClose"])):c("",!0)}const Ca=P(am,[["render",lm],["__scopeId","data-v-74397061"]]),rm={name:"asset-associate-modal",description:"Asset Associates Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},assetId:{type:[String,Number],default:""},associate:{type:String,default:""}},data(){return{associated:[],loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getAssetAssociateCategory},computed:{endPoint(){let e=this.associate=="tickets"?"assets":this.associate=="contracts"?"attachAsset":"attachAssets",t=this.associate=="tickets"?"type_id":"asset_id";return"/service-desk/api/dependency/"+this.associate+"?supplements[relation_name]="+e+"&supplements[attribute_name]="+t+"&supplements[attribute_value]="+this.assetId}},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0;let e="";this.associate=="tickets"?e="tickets":this.associate=="problems"?e="sd_problem":e="sd_"+this.associate;let t={};var s=[];for(var d in this.associated)s.push(this.associated[d].id);t.type=e,t.type_ids=s,T.post("/service-desk/api/attach-asset-services/"+this.assetId,t).then(a=>{this.loading=!1,this.onClose(),K(a,"asset-view"),window.emitter.emit("updateAssetAssociates");let i=this.associate.replace(/s$/,"");this.category==="activity"?window.emitter.emit("updateAssetActivity"):window.emitter.emit("Asset"+i+"refreshData")}).catch(a=>{this.loading=!1,this.onClose(),O(a,"asset-view")})}},components:{"dynamic-select":fe}},dm={class:"modal-title"},cm={key:0},um={class:"row"},mm={key:1,class:"row"},hm=["disabled"];function pm(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",dm,r(e.trans("attach")+" "+e.trans(s.associate)),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",cm,[n("div",um,[_(m,{label:e.trans(s.associate),multiple:!0,name:"associated",prePopulate:!1,classname:"col-sm-12",apiEndpoint:i.endPoint,value:a.associated,onChange:i.onChange,required:!0},null,8,["label","apiEndpoint","value","onChange"])])])),a.loading?(o(),l("div",mm,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:!(a.associated.length>0)},[t[1]||(t[1]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.trans("attach")),1)],8,hm)]),_:1},8,["showModal","onClose"])):c("",!0)}const _m=P(rm,[["render",pm]]),fm={name:"asset-actions",description:"Asset actions component",props:{asset:{type:Object,default:()=>{}},actionsData:{type:Object,default:()=>{}}},data(){return{showDeleteModal:!1,showAssociateModal:!1,associate:"",showUninstallAgentModal:!1}},methods:{associateMethod(e){this.showAssociateModal=!0,this.associate=e},onClose(){this.showDeleteModal=!1,this.showAssociateModal=!1,this.showUninstallAgentModal=!1},changeOverwriteStatus(e){T.post("service-desk/api/update-overwrite-status/"+this.asset.id,{status:e}).then(t=>{K(t,"asset-view")}).catch(t=>{var s,d;(d=(s=t==null?void 0:t.response)==null?void 0:s.data)!=null&&d.message&&O(t,"asset-view")})},changeOverwriteStatusForAgentSoftware(e){T.post("service-desk/api/update-agent-overwrite-status/"+this.asset.id,{status:e}).then(t=>{K(t,"asset-view")}).catch(t=>{var s,d;(d=(s=t==null?void 0:t.response)==null?void 0:s.data)!=null&&d.message&&O(t,"asset-view")})}},components:{StatusSwitch:On,"delete-modal":ot,"asset-associate-modal":_m}},gm={class:"card-tools"},bm={key:0,class:"btn-group text-small me-2"},ym={key:1,class:"btn-group text-small me-2"},vm={class:"btn-group"},wm={type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},km={class:"dropdown-menu"};function Cm(e,t,s,d,a,i){var g,D,M;const m=u("status-switch"),h=u("router-link"),b=u("delete-modal"),f=u("asset-associate-modal");return o(),l("div",gm,[(g=s.asset)!=null&&g.show_overwrite_button?(o(),l("div",bm,[_(m,{name:"network_status",value:s.asset.is_network_enabled,title:e.trans("overwrite_with_network_discovery"),onChange:i.changeOverwriteStatus},null,8,["value","title","onChange"])])):c("",!0),(D=s.asset)!=null&&D.show_agent_overwrite_button?(o(),l("div",ym,[_(m,{name:"agent_status",value:s.asset.is_agent_sync_enabled,title:e.trans("overwrite_with_agent_software"),onChange:i.changeOverwriteStatusForAgentSoftware},null,8,["value","title","onChange"])])):c("",!0),(M=s.asset)!=null&&M.show_uninstall_agent_button?(o(),l("button",{key:2,class:"btn btn-tool btn-tool-rounded",onClick:t[0]||(t[0]=x=>a.showUninstallAgentModal=!0)},[t[7]||(t[7]=n("i",{class:"fas fa-ban"},null,-1)),v(" "+r(e.trans("uninstall_agent")),1)])):c("",!0),n("div",vm,[n("button",wm,[t[8]||(t[8]=n("i",{class:"fas fa-link"},null,-1)),v(" "+r(e.trans("associate")),1)]),n("div",km,[n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=x=>i.associateMethod("tickets"))},[t[9]||(t[9]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.trans("attach_tickets")),1)]),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[2]||(t[2]=x=>i.associateMethod("problems"))},[t[10]||(t[10]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.trans("attach_problems")),1)]),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=x=>i.associateMethod("changes"))},[t[11]||(t[11]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.trans("attach_changes")),1)]),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[4]||(t[4]=x=>i.associateMethod("releases"))},[t[12]||(t[12]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.trans("attach_releases")),1)]),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[5]||(t[5]=x=>i.associateMethod("contracts"))},[t[13]||(t[13]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.trans("attach_contracts")),1)])])]),s.actionsData.edit_asset?(o(),k(h,{key:3,to:"/service-desk/assets/"+s.asset.id+"/edit",class:"btn btn-tool btn-tool-rounded"},{default:w(()=>[t[14]||(t[14]=n("i",{class:"fas fa-edit"},null,-1)),v(" "+r(e.trans("edit")),1)]),_:1},8,["to"])):c("",!0),s.actionsData.delete_asset?(o(),l("button",{key:4,class:"btn btn-tool btn-tool-rounded",onClick:t[6]||(t[6]=x=>a.showDeleteModal=!0)},[t[15]||(t[15]=n("i",{class:"fas fa-trash"},null,-1)),v(" "+r(e.trans("delete")),1)])):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showDeleteModal?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showDeleteModal,alertComponentName:"asset-view",deleteUrl:"/service-desk/api/asset-delete/"+s.asset.id,redirectUrl:"/service-desk/assets/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAssociateModal?(o(),k(f,{key:0,onClose:i.onClose,showModal:a.showAssociateModal,assetId:s.asset.id,associate:a.associate},null,8,["onClose","showModal","assetId","associate"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showUninstallAgentModal?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showUninstallAgentModal,alertComponentName:"asset-view",deleteUrl:"/service-desk/uninstall/agent/"+s.asset.id,from:"agent","modal-message":"uninstall_agent_confirm",buttonText:e.lang("uninstall"),header:e.lang("uninstall_agent")},null,8,["onClose","showModal","deleteUrl","buttonText","header"])):c("",!0)]),_:1})])}const Dm=P(fm,[["render",Cm]]);const Sm={name:"asset-details",description:"Asset details Component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{assetId:{type:[String,Number],required:!0},actionsData:{type:Object,default:{}}},data(){return{purchaseDate:"",purchaseCost:"",depreciationId:0,bookValue:"",currency:"",assetData:"",loading:!0,showDescription:!1,showImage:!1}},beforeMount(){this.getData()},methods:{getData(){T.get("/service-desk/api/asset/"+this.assetId).then(e=>{this.loading=!1,this.assetData=e.data.data,this.depreciationId=e.data.data.depreciation_id,this.currency=e.data.data.currency}).catch(e=>{this.loading=!1})},subString(e,t=15){return Ie(e,t)},onClose(){this.showDescription=!1,this.showImage=!1},downloadFile(e){window.open(this.basePath()+"/service-desk/download/"+e+"/sd_assets:"+this.assetData.id+"/attachment")}},components:{AssetImageModal:In,"asset-description":Ca,"asset-actions":Dm}},Mm={class:"card card-light"},Fm={class:"card-header"},Im={class:"card-title"},Am={class:"card-body"},Pm={class:"row mb-3"},Tm={class:"col-md-12"},Vm={class:"callout callout-info"},Lm={class:"row"},Um={class:"col-md-3"},Nm={class:"col-md-3"},Em={key:1},xm={class:"col-md-3"},Om={class:"col-md-3"},qm={class:"col-md-12"},jm={class:"row mx-1"},Rm={key:0,class:"col-md-6 d-flex me-4"},Bm={class:"col-md-6"},zm={class:"col-md-6"},Km={key:0},Hm=["src"],Ym={key:1},$m={key:1,class:"col-md-6 info-row d-flex"},Wm={class:"col-md-6"},Jm={class:"col-md-6"},Gm={key:2,class:"col-md-6 info-row d-flex"},Xm={class:"col-md-6"},Zm={class:"col-md-6"},Qm={class:"col-md-6 info-row d-flex"},eh={class:"col-md-6"},th={class:"col-md-6"},sh={key:3,class:"col-md-6 info-row d-flex"},ah={class:"col-md-6"},nh={key:0,class:"col-md-6"},oh={key:4,class:"col-md-6 info-row d-flex"},ih={class:"col-md-6"},lh={key:0,class:"col-md-6"},rh={key:5,class:"col-md-6 info-row d-flex"},dh={class:"col-md-6"},ch={class:"col-md-6"},uh={class:"text-primary"},mh={key:6,class:"col-md-6 info-row d-flex"},hh={class:"col-md-6"},ph={class:"col-md-6"},_h={class:"text-primary"},fh={key:7,class:"col-md-6 info-row d-flex"},gh={class:"col-md-6"},bh={class:"col-md-6"},yh={key:8,class:"col-md-6 info-row d-flex"},vh={class:"col-md-6"},wh={class:"col-md-6"},kh={key:9,class:"col-md-6 info-row d-flex"},Ch={class:"col-md-6"},Dh={class:"col-md-6"},Sh={key:10,class:"col-md-6 info-row d-flex"},Mh={class:"col-md-6"},Fh={class:"col-md-6"},Ih={class:"text-primary"},Ah={key:11,class:"col-md-6 info-row d-flex"},Ph={class:"col-md-6"},Th={class:"col-md-6"},Vh={class:"text-primary"},Lh={key:12,class:"col-md-6 info-row d-flex"},Uh={class:"col-md-6"},Nh={class:"col-md-6"},Eh={class:"text-primary"},xh={key:13,class:"col-md-6 info-row d-flex"},Oh={class:"col-md-6"},qh={class:"col-md-6"},jh={class:"text-primary"},Rh={key:14,class:"col-md-6 info-row d-flex"},Bh={class:"col-md-6"},zh={class:"col-md-6"},Kh={class:"col-md-6 info-row d-flex"},Hh={class:"col-md-6"},Yh={class:"col-md-6"},$h={key:0},Wh={key:0},Jh={key:16,class:"col-md-6 info-row d-flex",id:"vendor"},Gh={class:"col-md-6"},Xh={class:"col-md-6"},Zh={class:"text-primary"},Qh={key:0,class:"card card-secondary"},ep={class:"card-header"},tp={class:"card-title"},sp={class:"card-body"},ap={class:"col-md-12 asset_row"},np={class:"row mx-1"},op={class:"col-md-6 info-row d-flex"},ip={class:"col-md-6"},lp={class:"col-md-6"},rp={key:0},dp={onClick:"return false",class:"text-primary"},cp={key:0},up={key:1,onClick:"return false",class:"text-primary"},mp={key:1,class:"card card-secondary"},hp={class:"card-header"},pp={class:"card-title"},_p={class:"card-body"},fp={class:"col-sm-12 asset_row"},gp={class:"row mx-1"},bp={class:"col-md-6 info-row d-flex"},yp={class:"col-md-6"},vp={class:"col-md-6"},wp={key:0},kp={onClick:"return false",class:"text-primary"},Cp={key:0},Dp={key:1,onClick:"return false",class:"text-primary"},Sp=["onClick"],Mp={class:"card-title"},Fp={class:"card-tools"},Ip={type:"button",class:"btn btn-tool"},Ap={class:"card-body"},Pp={class:"col-md-12 asset_row"},Tp={class:"row mx-1"},Vp={class:"col-md-6 info-row d-flex"},Lp={class:"col-md-6"},Up={class:"col-md-6"},Np={key:0},Ep={key:0},xp={key:1,class:"card-body",id:"loader_margin"};function Op(e,t,s,d,a,i){const m=u("asset-actions"),h=u("router-link"),b=u("asset-description"),f=u("asset-image-modal"),g=u("reuse-loader"),D=W("tooltip");return o(),l("div",Mm,[!a.loading&&a.assetData?(o(),l(U,{key:0},[n("div",Fm,[S((o(),l("h3",Im,[v(r(i.subString(a.assetData.name,50)),1)])),[[D,a.assetData.name]]),_(m,{asset:a.assetData,actionsData:s.actionsData},null,8,["asset","actionsData"])]),n("div",Am,[n("div",Pm,[n("div",Tm,[n("div",Vm,[n("div",Lm,[n("div",Um,[n("b",null,r(e.trans("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.assetData.created_at)),1)])),[[D,d.formattedTime(a.assetData.created_at)]])]),n("div",Nm,[n("b",null,r(e.trans("department"))+" : ",1),S((o(),l("span",null,[a.assetData.department?(o(),k(h,{key:0,class:"text-decoration-none",to:a.assetData.department.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[v(r(i.subString(a.assetData.department.name)),1)]),_:1},8,["to"])):(o(),l("span",Em,"---"))])),[[D,a.assetData.department?a.assetData.department.name:"---"]])]),n("div",xm,[n("b",null,r(e.trans("asset_type"))+" : ",1),S((o(),l("span",null,[_(h,{class:"text-decoration-none",to:a.assetData.asset_type.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[v(r(i.subString(a.assetData.asset_type.name)),1)]),_:1},8,["to"])])),[[D,a.assetData.asset_type.name]])]),n("div",Om,[n("b",null,r(e.trans("source"))+" : ",1),S((o(),l("span",null,[v(r(i.subString(a.assetData.source)),1)])),[[D,a.assetData.source]])])])])])]),n("div",qm,[n("div",jm,[a.assetData.asset_image?(o(),l("div",Rm,[n("div",Bm,[n("label",null,r(e.trans("asset_image")),1)]),n("div",zm,[n("a",{href:"javascript:;",onClick:t[0]||(t[0]=M=>a.showImage=!0),class:"text-primary custom-class"},[a.assetData.asset_image?(o(),l("div",Km,[n("img",{src:a.assetData.asset_image.view_url,class:"asset-image-details"},null,8,Hm)])):(o(),l("div",Ym,r("---")))])])])):c("",!0),a.assetData.asset_status?(o(),l("div",$m,[n("div",Wm,[n("label",null,r(e.trans("asset_status")),1)]),n("div",Jm,[_(h,{class:"text-primary",to:a.assetData.asset_status.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.assetData.asset_status.name)),1)])),[[D,a.assetData.asset_status.name]])]),_:1},8,["to"])])])):c("",!0),a.assetData.organization?(o(),l("div",Gm,[n("div",Xm,[n("label",null,r(e.trans("organization")),1)]),n("div",Zm,[_(h,{class:"text-primary",to:a.assetData.organization.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.assetData.organization.name,20)),1)])),[[D,a.assetData.organization.name]])]),_:1},8,["to"])])])):c("",!0),n("div",Qm,[n("div",eh,[n("label",null,r(e.trans("description")),1)]),n("div",th,[n("a",{href:"javascript:;",class:"btn btn-info btn-sm",onClick:t[1]||(t[1]=M=>a.showDescription=!0)},[t[2]||(t[2]=n("i",{class:"fas fa-file-code"},"  ",-1)),v(r(e.trans("show_description")),1)])])]),a.assetData.managed_by?(o(),l("div",sh,[n("div",ah,[n("label",null,r(e.trans("managed_by")),1)]),a.assetData.managed_by?(o(),l("div",nh,[_(h,{class:"text-primary",to:a.assetData.managed_by.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(a.assetData.managed_by.full_name?i.subString(a.assetData.managed_by.full_name):a.assetData.managed_by.meta_name),1)])),[[D,a.assetData.managed_by.full_name?a.assetData.managed_by.full_name:a.assetData.managed_by.meta_name]])]),_:1},8,["to"])])):c("",!0)])):c("",!0),a.assetData.used_by?(o(),l("div",oh,[n("div",ih,[n("label",null,r(e.trans("used_by")),1)]),a.assetData.used_by?(o(),l("div",lh,[_(h,{class:"text-primary",to:a.assetData.used_by.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(a.assetData.used_by.full_name?i.subString(a.assetData.used_by.full_name):a.assetData.used_by.meta_name),1)])),[[D,a.assetData.used_by.full_name?a.assetData.used_by.full_name:a.assetData.used_by.meta_name]])]),_:1},8,["to"])])):c("",!0)])):c("",!0),a.assetData.identifier?(o(),l("div",rh,[n("div",dh,[n("label",null,r(e.trans("identifier")),1)]),n("div",ch,[S((o(),l("a",uh,[v(r(a.assetData.identifier?i.subString(a.assetData.identifier,35):"---"),1)])),[[D,a.assetData.identifier?a.assetData.identifier:"---"]])])])):c("",!0),a.assetData.eol?(o(),l("div",mh,[n("div",hh,[n("label",null,r(e.trans("end-of-life")),1)]),n("div",ph,[S((o(),l("a",_h,[v(r(a.assetData.eol),1)])),[[D,a.assetData.eol]])])])):c("",!0),a.assetData.product?(o(),l("div",fh,[n("div",gh,[n("label",null,r(e.trans("product")),1)]),n("div",bh,[_(h,{class:"text-primary",to:a.assetData.product.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.assetData.product.name)),1)])),[[D,a.assetData.product.name]])]),_:1},8,["to"])])])):c("",!0),a.assetData.impact_type?(o(),l("div",yh,[n("div",vh,[n("label",null,r(e.trans("impact_type")),1)]),n("div",wh,[_(h,{class:"text-primary",to:a.assetData.impact_type.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.assetData.impact_type.name)),1)])),[[D,a.assetData.impact_type.name]])]),_:1},8,["to"])])])):c("",!0),a.assetData.location?(o(),l("div",kh,[n("div",Ch,[n("label",null,r(e.trans("location")),1)]),n("div",Dh,[_(h,{class:"text-primary",to:a.assetData.location.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.assetData.location.name)),1)])),[[D,a.assetData.location.name]])]),_:1},8,["to"])])])):c("",!0),a.assetData.purchase_date?(o(),l("div",Sh,[n("div",Mh,[n("label",null,r(e.trans("purchase_date")),1)]),n("div",Fh,[S((o(),l("a",Ih,[v(r(a.assetData.purchase_date?a.assetData.purchase_date:"---"),1)])),[[D,a.assetData.purchase_date?a.assetData.purchase_date:"---"]])])])):c("",!0),a.assetData.purchase_cost?(o(),l("div",Ah,[n("div",Ph,[n("label",null,r(e.trans("purchase_cost")),1)]),n("div",Th,[S((o(),l("a",Vh,[v(r(a.assetData.purchase_cost?a.assetData.purchase_cost+" "+a.currency:"---"),1)])),[[D,a.assetData.purchase_cost?a.assetData.purchase_cost+" "+a.currency:"---"]])])])):c("",!0),a.assetData.book_value?(o(),l("div",Lh,[n("div",Uh,[n("label",null,r(e.trans("book_value")),1)]),n("div",Nh,[S((o(),l("a",Eh,[v(r(a.assetData.book_value?a.assetData.book_value+" "+a.currency:"---"),1)])),[[D,a.assetData.book_value?a.assetData.book_value+" "+a.currency:"---"]])])])):c("",!0),a.assetData.salvage?(o(),l("div",xh,[n("div",Oh,[n("label",null,r(e.trans("salvage")),1)]),n("div",qh,[S((o(),l("a",jh,[v(r(a.assetData.salvage?a.assetData.salvage+" "+a.currency:"---"),1)])),[[D,a.assetData.salvage?a.assetData.salvage+" "+a.currency:"---"]])])])):c("",!0),a.assetData.depreciation?(o(),l("div",Rh,[n("div",Bh,[n("label",null,r(e.trans("depreciation")),1)]),n("div",zh,[_(h,{class:"text-primary",to:a.assetData.depreciation.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(a.assetData.depreciation.name),1)])),[[D,a.assetData.depreciation.name]])]),_:1},8,["to"])])])):c("",!0),a.assetData.custom_field_values&&a.assetData.custom_field_values.length>0?(o(!0),l(U,{key:15},$(a.assetData.custom_field_values,M=>(o(),l("div",Kh,[n("div",Hh,[n("label",null,r(M.label),1)]),n("div",Yh,[Array.isArray(M.value)?(o(),l("div",$h,[(o(!0),l(U,null,$(M.value,(x,R)=>(o(),k(h,{class:"text-primary",to:M.href[R].replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(x)),1)])),[[D,x]]),R!=Object.keys(M.value).length-1?(o(),l("span",Wh,",")):c("",!0),t[3]||(t[3]=v("  "))]),_:2},1032,["to"]))),256))])):(o(),l(U,{key:1},[M.field_type==="date"?(o(),k(h,{key:0,class:"text-primary",to:M.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(M.value),1)])),[[D,M.value]])]),_:2},1032,["to"])):(o(),k(h,{key:1,class:"text-primary",to:M.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(M.value)),1)])),[[D,{content:M.value?M.value.replace(/\r?\n/g,"<br />"):"---",html:!0}]])]),_:2},1032,["to"]))],64))])]))),256)):c("",!0),a.assetData.vendor?(o(),l("div",Jh,[n("div",Gh,[n("label",null,r(e.trans("vendor")),1)]),n("div",Xh,[S((o(),l("a",Zh,[v(r(a.assetData.vendor.name),1)])),[[D,a.assetData.vendor.name]])])])):c("",!0)])]),t[7]||(t[7]=n("hr",null,null,-1)),a.assetData.custom_field_values_for_asset_type&&a.assetData.custom_field_values_for_asset_type.length>0?(o(),l("div",Qh,[n("div",ep,[n("h3",tp,r(a.assetData.asset_type.name+" "+e.trans("properties")),1)]),n("div",sp,[n("div",ap,[n("div",np,[(o(!0),l(U,null,$(a.assetData.custom_field_values_for_asset_type,M=>(o(),l("div",op,[n("div",ip,[n("label",null,r(M.label),1)]),n("div",lp,[Array.isArray(M.value)?(o(),l("div",rp,[(o(!0),l(U,null,$(M.value,(x,R)=>S((o(),l("a",dp,[v(r(i.subString(x)),1),R!=Object.keys(M.value).length-1?(o(),l("span",cp,",")):c("",!0),t[4]||(t[4]=v("  "))])),[[D,x]])),256))])):S((o(),l("a",up,[v(r(M.field_type=="date"?M.value:i.subString(M.value)),1)])),[[D,(M.field_type=="date",M.value)]])])]))),256))])])])])):c("",!0),a.assetData.custom_field_values_for_department&&a.assetData.custom_field_values_for_department.length>0?(o(),l("div",mp,[n("div",hp,[n("h3",pp,r(a.assetData.department.name+" "+e.trans("properties")),1)]),n("div",_p,[n("div",fp,[n("div",gp,[(o(!0),l(U,null,$(a.assetData.custom_field_values_for_department,M=>(o(),l("div",bp,[n("div",yp,[n("label",null,r(M.label),1)]),n("div",vp,[Array.isArray(M.value)?(o(),l("div",wp,[(o(!0),l(U,null,$(M.value,(x,R)=>S((o(),l("a",kp,[v(r(i.subString(x)),1),R!=Object.keys(M.value).length-1?(o(),l("span",Cp,",")):c("",!0),t[5]||(t[5]=v("  "))])),[[D,x]])),256))])):S((o(),l("a",Dp,[v(r(M.field_type=="date"?M.value:i.subString(M.value)),1)])),[[D,(M.field_type=="date",M.value)]])])]))),256))])])])])):c("",!0),a.assetData.asset_types&&a.assetData.asset_types.length?(o(!0),l(U,{key:2},$(a.assetData.asset_types,(M,x)=>(o(),l(U,{key:x},[M.custom_field_values.length?(o(),l("div",{key:0,class:Q(["card card-light",{"collapsed-card":M.collapsed}])},[n("div",{class:"card-header pointer","data-lte-toggle":"card-collapse",onClick:R=>M.collapsed=!M.collapsed},[n("h3",Mp,r(M.name),1),n("div",Fp,[n("button",Ip,[n("i",{class:Q(M.collapsed?"fas fa-angle-up":"fas fa-angle-down")},null,2)])])],8,Sp),n("div",Ap,[n("div",Pp,[n("div",Tp,[(o(!0),l(U,null,$(M.custom_field_values,R=>(o(),l("div",Vp,[n("div",Lp,[n("label",null,r(R.label),1)]),n("div",Up,[Array.isArray(R.value)?(o(),l("div",Np,[(o(!0),l(U,null,$(R.value,(V,N)=>(o(),k(h,{class:"text-primary",to:R.href[N].replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(V)),1)])),[[D,V]]),N!=Object.keys(R.value).length-1?(o(),l("span",Ep,",")):c("",!0),t[6]||(t[6]=v("  "))]),_:2},1032,["to"]))),256))])):(o(),l(U,{key:1},[R.field_type==="date"?(o(),k(h,{key:0,class:"text-primary",to:R.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(R.value),1)])),[[D,R.value]])]),_:2},1032,["to"])):(o(),k(h,{key:1,class:"text-primary",to:R.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(R.value)),1)])),[[D,{content:R.value?R.value.replace(/\r?\n/g,"<br />"):"---",html:!0}]])]),_:2},1032,["to"]))],64))])]))),256))])])])],2)):c("",!0)],64))),128)):c("",!0)]),a.showDescription?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showDescription,description:a.assetData.description},null,8,["onClose","showModal","description"])):c("",!0),a.showImage&&a.assetData.asset_image?(o(),k(f,{key:1,onClose:i.onClose,showModal:a.showImage,imageSrc:a.assetData.asset_image.view_url},null,8,["onClose","showModal","imageSrc"])):c("",!0)],64)):c("",!0),a.loading?(o(),l("div",xp,[_(g,{"animation-duration":4e3,size:60})])):c("",!0)])}const qp=P(Sm,[["render",Op],["__scopeId","data-v-ea1544f6"]]);const jp={name:"asset-activity",description:"Asset activity page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{assetId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/asset-log/"+this.assetId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},created(){window.emitter.on("updateAssetActivity",()=>this.refreshActivity=!0)},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},filtering(e){this.$emit("loaderValue",e)},loading(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){T.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.asset_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.asset_activity_logs.total,this.perPage=t.data.data.asset_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){let t="",s="";return e&&(t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at)),!e||t!=s},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":kt}},Rp={class:"row",id:"activity_log_div"},Bp={class:"col-sm-12 mb-2"},zp={key:0,id:"select_limit"},Kp={type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},Hp={class:"dropdown-menu"},Yp={key:1,id:"choose_order"},$p={id:"sort_btn",type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},Wp={class:"dropdown-menu",style:{"z-index":"9999"}},Jp={key:2,id:"page_div"},Gp={class:"col-md-12"},Xp={key:0,class:"timeline"},Zp={key:0,class:"time-label"},Qp={class:"text-bg-light border"},e_={class:"asset-activity"},t_={class:"timeline-item"},s_={class:"time"},a_={key:0,class:"timeline-header"},n_={class:"timeline-body break"},o_={key:1},i_={key:1,class:"float-end",id:"page_div"},l_={key:0,class:"col-sm-12"},r_={class:"text-center"};function d_(e,t,s,d,a,i){const m=u("uib-pagination"),h=u("faveo-image-element"),b=u("router-link"),f=u("activity-parser");return o(),l("div",Rp,[n("div",Bp,[!a.loading&&a.activity_log.length>0?(o(),l("div",zp,[n("button",Kp,r(a.perPage),1),n("div",Hp,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=g=>i.logLimit(10))},"10"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[1]||(t[1]=g=>i.logLimit(25))},"25"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=g=>i.logLimit(50))},"50"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[3]||(t[3]=g=>i.logLimit(100))},"100")])])):c("",!0),!a.loading&&a.activity_log.length>0?(o(),l("div",Yp,[n("button",$p,r(e.lang("created_time"))+" - "+r(e.lang(a.sort_key)),1),n("div",Wp,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[4]||(t[4]=g=>i.orderBy("asc"))},[t[8]||(t[8]=n("i",{class:"fas fa-sort-amount-up"},null,-1)),v(" "+r(e.lang("asc")),1)]),n("a",{href:"javascript:;",onClick:t[5]||(t[5]=g=>i.orderBy("desc")),class:"dropdown-item"},[t[9]||(t[9]=n("i",{class:"fas fa-sort-amount-down"},null,-1)),v(" "+r(e.lang("desc")),1)])])])):c("",!0),!a.loading&&a.total>10?(o(),l("div",Jp,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[6]||(t[6]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),n("div",Gp,[!a.loading&&a.activity_log.length>0?(o(),l("div",Xp,[(o(!0),l(U,null,$(a.activity_log,(g,D)=>(o(),l(U,null,[i.checkDate(D)?(o(),l("div",Zp,[n("span",Qp,r(d.formattedDate(g.created_at)),1)])):c("",!0),n("div",e_,[t[11]||(t[11]=n("i",{class:"far fa-dot-circle timeline-icon"},null,-1)),n("div",t_,[n("span",s_,[t[10]||(t[10]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(g.created_at)),1)]),g.creator?(o(),l("h3",a_,[_(h,{id:"asset_img","source-url":g.creator.profile_pic,classes:["img-circle","img-bordered-sm","img-rounder"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),_(b,{to:"/user/"+g.creator.id},{default:w(()=>[v(" "+r(g.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),n("div",n_,[_(f,{data:g.name},null,8,["data"])])])]),i.showThreadEnd(D)?(o(),l("div",o_,t[12]||(t[12]=[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),256))])):c("",!0),!a.loading&&a.total>10?(o(),l("div",i_,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[7]||(t[7]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!a.filtering&&!a.loading&&a.activity_log.length===0?(o(),l("div",l_,[n("h6",r_,r(e.lang("no_data_found")),1)])):c("",!0)])}const c_=P(jp,[["render",d_],["__scopeId","data-v-1b260725"]]),u_={name:"asset-associate-detach",description:"Asset Associate Detach Modal component",props:{showModal:{type:Boolean,default:!1},assetId:{type:[String,Number],default:""},associateId:{type:[String,Number],default:""},category:{type:String,default:""},onClose:{type:Function},compName:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;let e="";this.category=="ticket"?e="tickets":this.category=="problem"?e="sd_problem":e="sd_"+this.category+"s";const t={type:e,type_ids:this.associateId};T.delete("/service-desk/api/detach-asset-services/"+this.assetId,{data:t}).then(s=>{K(s,"asset-view"),window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(s=>{this.loading=!1,this.isDisabled=!1,this.onClose(),O(s,"asset-view")})}}},m_={class:"modal-title"},h_={key:0},p_={key:1,class:"row"},__=["disabled"];function f_(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",m_,r(e.trans("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",h_,[n("span",null,r(e.trans("are_you_sure")),1)])),a.loading?(o(),l("div",p_,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink"},null,-1)),v(" "+r(e.trans("detach")),1)],8,__)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const g_=P(u_,[["render",f_]]);const b_={name:"asset-associate-table",description:"Asset associates table page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{assetId:{type:[String,Number],default:""},category:{type:String,default:""},componentTitle:{type:String,default:""},columns:{type:Array,default:()=>[]},sortable:{type:Array,default:()=>[]},filterable:{type:Array,default:()=>[]},disableLoader:{type:Boolean,default:!1}},data(){return{options:{},showModal:!1,associateId:"",totalCount:"",searchTerm:""}},computed:{apiEndPoint(){let e=this.category=="ticket"?"asset-ids[]=":"asset_ids[]=";return"/service-desk/api/"+this.category+"-list?"+e+this.assetId}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{title:this.lang("subject"),status_type_id:this.lang("status"),assignedTo:this.lang("assigned_to"),identifier:this.lang("identifier"),subject:this.lang("subject"),requester:this.lang("requester"),priority:this.lang("priority"),department:this.lang("department"),status:this.lang("status"),planned_start_date:this.lang("planned_start_date"),planned_end_date:this.lang("planned_end_date"),action:this.lang("action"),ticket_number:this.lang("ticket_number"),release_type:this.lang("release_type"),created_at:this.lang("created_at"),expiry:this.lang("expiry"),contract_status:this.lang("contract_status"),contract_renewal_status:this.lang("contract_renewal_status"),vendor:this.lang("vendor"),contract_type:this.lang("contract_type"),assigned:this.lang("assigned"),name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),id:"Id",cost:this.lang("cost"),expiration:this.lang("expiration"),license_key:this.lang("license_key")},texts:{filter:"",limit:""},templates:{subject:function(t,s){let d=e.category=="problem"?"problem":e.category+"s";return e.h(De,{to:"/service-desk/"+d+"/"+s.id+"/show"},s.subject)},name:function(t,s){return e.h(De,{to:"/service-desk/contracts/"+s.id+"/show"},s.name)},requester:function(t,s){var d,a;return s.requester?e.h(De,{to:"/user/"+s.requester.id},((a=(d=s.requester)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??s.requester.email):"---"},department:function(t,s){var d,a,i,m,h,b;return s.department?(a=(d=s.department)==null?void 0:d.name)!=null&&a.includes("href=https://")?e.h("a",{href:e.basePath()+"/admin/department/"+s.department.id,target:"_blank"},(m=(i=s.department)==null?void 0:i.name)==null?void 0:m.replace(/<[^>]+>/g,"")):(b=(h=s.department)==null?void 0:h.name)==null?void 0:b.replace(/<[^>]+>/g,""):"---"},status:function(t,s){return s.status?e.h("span",{},[e.h("i",{class:s.status.icon_class,style:{color:s.status.icon_color,marginRight:"5px"}})],s.status.name):"---"},priority(t,s){return s.priority?s.priority.name?s.priority.name:s.priority.priority:"---"},planned_start_date(t,s){return s.planned_start_date&&s.planned_start_date!="0000-00-00 00:00:00"?e.formattedTime(s.planned_start_date):"---"},planned_end_date(t,s){return s.planned_end_date&&s.planned_end_date!="0000-00-00 00:00:00"?e.formattedTime(s.planned_end_date):"---"},status_type_id:function(t,s){return s.status?e.h("span",{},[e.h("i",{class:s.status.icon_class,style:{color:s.status.icon_color,marginRight:"5px"}})],s.status.name):"---"},assignedTo:function(t,s){var d,a;return s.assignedTo?e.h(De,{to:"/user/"+s.assignedTo.id},((a=(d=s.assignedTo)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??s.assignedTo.email):"--"},release_type(t,s){return s.release_type?s.release_type.name:"---"},created_at(t,s){return e.formattedTime(s.created_at)},expiry(t,s){return s.expiry&&s.expiry.title?e.h("span",{title:s.expiry.timestamp?e.formattedTime(s.expiry.timestamp):""},s.expiry.title):"---"},contract_status:function(t,s){return s.contract_status?e.h("span",{},[e.h("i",{class:s.contract_status.icon_class,style:{color:s.contract_status.icon_color,marginRight:"5px"}})],s.contract_status.name):"---"},contract_renewal_status(t,s){return s.contract_renewal_status?Ce(s.contract_renewal_status.name):"---"},vendor(t,s){return s.vendor?e.h("a",{href:e.basePath()+"/service-desk/vendor/"+s.id+"/show"},s.vendor.name):"---"},contract_type(t,s){return s.contract_type?s.contract_type.name:"---"},title:function(t,s){return e.h(De,{to:"/thread/"+s.id},s.title)},ticket_number:function(t,s){return e.h(De,{to:"/thread/"+s.id},"#"+s.ticket_number)},assigned(t,s){return s.assigned?s.assigned.full_name:"---"},action(t,s){let d=e.h("i",{class:"fa fa-unlink"});return e.h("a",{class:"btn btn-primary",title:this.trans("detach"),href:"javascript:;",onClick(){e.onDetach(s.id)}},[d])},identifier:function(t,s){let d=e.category=="problem"?"problem":e.category+"s";return e.h(De,{to:"/service-desk/"+d+"/"+s.id+"/show"},s.identifier)}},sortable:e.sortable,filterable:e.filterable,pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return e.searchTerm=t.query.trim(),{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data[e.category+"s"],count:e.totalCount}},orderBy:{column:"id",ascending:!0}}},methods:{onDetach(e){this.associateId=e,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){!this.searchTerm&&e===0&&(window.emitter.emit("updateAssetTables"),window.emitter.emit("updateAssetAssociates"))},searchTerm(e){this.searchTerm=e}},components:{"asset-associate-detach":g_}},y_={id:"asset_associates"};function v_(e,t,s,d,a,i){const m=u("data-table"),h=u("asset-associate-detach");return o(),l("div",y_,[_(m,{url:i.apiEndPoint,dataColumns:s.columns,option:a.options,scroll_to:"asset-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,associateId:a.associateId,assetId:s.assetId,category:s.category,compName:s.componentTitle},null,8,["onClose","showModal","associateId","assetId","category","compName"])):c("",!0)]),_:1})])}const w_=P(b_,[["render",v_]]);function k_(e){const{assets:t,forward_relation:s,inverse_relation:d}=e;let a={assets:[t,"isRequired"]},i,m;i=C_(s,d);const b=new Ue(Ce).validate(a);return m=b.errors,i=i&&b.isValid,Fe.dispatch("setValidationError",m),{errors:m,isValid:i}}function C_(e,t){let s=0;if(!e&&!t){let d=Ce("atleast_one_frelation_is_required_to_create_relationship");s++,Fe.dispatch("setAlert",{type:"danger",message:d,component_name:"asset-relation-modal"})}return!(s>0)}const D_={name:"asset-relation-modal",description:"Asset Relation Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},assetId:{type:[String,Number],default:""},pivotId:{type:[String,Number],default:""},onComplete:{type:Function,default:()=>{}},parentValue:{type:[String,Number],default:""}},data(){return{inverse_relation:"",forward_relation:"",assets:[],loading:!1}},computed:{endPoint(){return"/service-desk/api/dependency/assets?supplements[asset_id]="+(this.parentValue?this.parentValue:this.assetId)}},methods:{onChange(e,t){this[t]=e,this.forward_relation=this.inverse_relation?"":this.forward_relation,this.inverse_relation=this.forward_relation?"":this.inverse_relation},isValid(){const{errors:e,isValid:t}=k_(this.$data);return t},onSubmit(){if(this.isValid()){this.loading=!0;let e=[];for(let s in this.assets)e.push(this.assets[s].id);const t={};t.relation=this.forward_relation?"forward":"inverse",t.child_asset_ids=e,t.parent_asset_id=this.parentValue?this.parentValue:this.assetId,t.cmdb_id=this.forward_relation?this.forward_relation.id:this.inverse_relation.id,T.post("/service-desk/api/make-cmdb",t).then(s=>{this.loading=!1,this.onClose(),this.onComplete(),K(s,"assetAssociates")}).catch(s=>{this.loading=!1,O(s,"asset-relation-modal")})}}},components:{"dynamic-select":fe}},S_={class:"modal-title"},M_={key:0},F_={class:"row"},I_={key:1,class:"row"},A_=["disabled"];function P_(e,t,s,d,a,i){const m=u("alert"),h=u("dynamic-select"),b=u("reuse-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",S_,r(e.trans("add_relationship")),1)]),alert:w(()=>[_(m,{componentName:"asset-relation-modal"})]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",M_,[n("div",F_,[a.inverse_relation?c("",!0):(o(),k(h,{key:0,label:e.trans("forward_relation"),multiple:!1,name:"forward_relation",prePopulate:!1,classname:a.forward_relation?"col-sm-6":"col-sm-4",apiEndpoint:"/service-desk/api/dependency/forward_relations",value:a.forward_relation,onChange:i.onChange,required:!0},null,8,["label","classname","value","onChange"])),a.forward_relation?c("",!0):(o(),k(h,{key:1,label:e.trans("inverse_relation"),multiple:!1,name:"inverse_relation",prePopulate:!1,classname:a.inverse_relation?"col-sm-6":"col-sm-4",apiEndpoint:"/service-desk/api/dependency/inverse_relations",value:a.inverse_relation,onChange:i.onChange,required:!0},null,8,["label","classname","value","onChange"])),_(h,{name:"assets",apiEndpoint:i.endPoint,label:e.trans("assets"),value:a.assets,required:!0,classname:!a.forward_relation&&!a.inverse_relation?"col-sm-4":"col-sm-6",multiple:!0,onChange:i.onChange,strlength:30},null,8,["apiEndpoint","label","value","classname","onChange"])])])),a.loading?(o(),l("div",I_,[_(b,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=g=>i.onSubmit()),class:"btn btn-primary",disabled:a.loading},[t[1]||(t[1]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.trans("attach")),1)],8,A_)]),_:1},8,["showModal","onClose"])):c("",!0)}const Da=P(D_,[["render",P_]]);var Sa={exports:{}};(function(e,t){(function(d,a){e.exports=a(fn)})(typeof self<"u"?self:gn,function(s){return function(){var d={679:function(h,b){var f,g,D;(function(M,x){g=[],f=x,D=typeof f=="function"?f.apply(b,g):f,D!==void 0&&(h.exports=D)})(typeof self<"u"?self:this,function(){function M(){var x=Object.getOwnPropertyDescriptor(document,"currentScript");if(!x&&"currentScript"in document&&document.currentScript||x&&x.get!==M&&document.currentScript)return document.currentScript;try{throw new Error}catch(Ke){var R=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,V=/@([^@]*):(\d+):(\d+)\s*$/ig,N=R.exec(Ke.stack)||V.exec(Ke.stack),j=N&&N[1]||!1,Y=N&&N[2]||!1,ae=document.location.href.replace(document.location.hash,""),ne,_e,Oe,ve=document.getElementsByTagName("script");j===ae&&(ne=document.documentElement.outerHTML,_e=new RegExp("(?:[^\\n]+?\\n){0,"+(Y-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),Oe=ne.replace(_e,"$1").trim());for(var Pe=0;Pe<ve.length;Pe++)if(ve[Pe].readyState==="interactive"||ve[Pe].src===j||j===ae&&ve[Pe].innerHTML&&ve[Pe].innerHTML.trim()===Oe)return ve[Pe];return null}}return M})},744:function(h,b){b.Z=(f,g)=>{const D=f.__vccOpts||f;for(const[M,x]of g)D[M]=x;return D}},203:function(h){h.exports=s}},a={};function i(h){var b=a[h];if(b!==void 0)return b.exports;var f=a[h]={exports:{}};return d[h].call(f.exports,f,f.exports,i),f.exports}(function(){i.d=function(h,b){for(var f in b)i.o(b,f)&&!i.o(h,f)&&Object.defineProperty(h,f,{enumerable:!0,get:b[f]})}})(),function(){i.o=function(h,b){return Object.prototype.hasOwnProperty.call(h,b)}}(),function(){i.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})}}(),function(){i.p=""}();var m={};return function(){i.d(m,{default:function(){return hn}});var h={};if(i.r(h),i.d(h,{forceCenter:function(){return D},forceCollide:function(){return St},forceLink:function(){return ns},forceManyBody:function(){return Ka},forceRadial:function(){return Ha},forceSimulation:function(){return za},forceX:function(){return Ya},forceY:function(){return $a}}),typeof window<"u"){var b=window.document.currentScript;{var f=i(679);b=f(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:f})}var g=b&&b.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);g&&(i.p=g[1])}function D(p,y){var C;p==null&&(p=0),y==null&&(y=0);function F(){var A,I=C.length,L,E=0,q=0;for(A=0;A<I;++A)L=C[A],E+=L.x,q+=L.y;for(E=E/I-p,q=q/I-y,A=0;A<I;++A)L=C[A],L.x-=E,L.y-=q}return F.initialize=function(A){C=A},F.x=function(A){return arguments.length?(p=+A,F):p},F.y=function(A){return arguments.length?(y=+A,F):y},F}function M(p){return function(){return p}}function x(){return(Math.random()-.5)*1e-6}function R(p){var y=+this._x.call(null,p),C=+this._y.call(null,p);return V(this.cover(y,C),y,C,p)}function V(p,y,C,F){if(isNaN(y)||isNaN(C))return p;var A,I=p._root,L={data:F},E=p._x0,q=p._y0,H=p._x1,le=p._y1,de,Z,he,J,G,te,oe,be;if(!I)return p._root=L,p;for(;I.length;)if((G=y>=(de=(E+H)/2))?E=de:H=de,(te=C>=(Z=(q+le)/2))?q=Z:le=Z,A=I,!(I=I[oe=te<<1|G]))return A[oe]=L,p;if(he=+p._x.call(null,I.data),J=+p._y.call(null,I.data),y===he&&C===J)return L.next=I,A?A[oe]=L:p._root=L,p;do A=A?A[oe]=new Array(4):p._root=new Array(4),(G=y>=(de=(E+H)/2))?E=de:H=de,(te=C>=(Z=(q+le)/2))?q=Z:le=Z;while((oe=te<<1|G)===(be=(J>=Z)<<1|he>=de));return A[be]=I,A[oe]=L,p}function N(p){var y,C,F=p.length,A,I,L=new Array(F),E=new Array(F),q=1/0,H=1/0,le=-1/0,de=-1/0;for(C=0;C<F;++C)isNaN(A=+this._x.call(null,y=p[C]))||isNaN(I=+this._y.call(null,y))||(L[C]=A,E[C]=I,A<q&&(q=A),A>le&&(le=A),I<H&&(H=I),I>de&&(de=I));if(q>le||H>de)return this;for(this.cover(q,H).cover(le,de),C=0;C<F;++C)V(this,L[C],E[C],p[C]);return this}function j(p,y){if(isNaN(p=+p)||isNaN(y=+y))return this;var C=this._x0,F=this._y0,A=this._x1,I=this._y1;if(isNaN(C))A=(C=Math.floor(p))+1,I=(F=Math.floor(y))+1;else{for(var L=A-C,E=this._root,q,H;C>p||p>=A||F>y||y>=I;)switch(H=(y<F)<<1|p<C,q=new Array(4),q[H]=E,E=q,L*=2,H){case 0:A=C+L,I=F+L;break;case 1:C=A-L,I=F+L;break;case 2:A=C+L,F=I-L;break;case 3:C=A-L,F=I-L;break}this._root&&this._root.length&&(this._root=E)}return this._x0=C,this._y0=F,this._x1=A,this._y1=I,this}function Y(){var p=[];return this.visit(function(y){if(!y.length)do p.push(y.data);while(y=y.next)}),p}function ae(p){return arguments.length?this.cover(+p[0][0],+p[0][1]).cover(+p[1][0],+p[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ne(p,y,C,F,A){this.node=p,this.x0=y,this.y0=C,this.x1=F,this.y1=A}function _e(p,y,C){var F,A=this._x0,I=this._y0,L,E,q,H,le=this._x1,de=this._y1,Z=[],he=this._root,J,G;for(he&&Z.push(new ne(he,A,I,le,de)),C==null?C=1/0:(A=p-C,I=y-C,le=p+C,de=y+C,C*=C);J=Z.pop();)if(!(!(he=J.node)||(L=J.x0)>le||(E=J.y0)>de||(q=J.x1)<A||(H=J.y1)<I))if(he.length){var te=(L+q)/2,oe=(E+H)/2;Z.push(new ne(he[3],te,oe,q,H),new ne(he[2],L,oe,te,H),new ne(he[1],te,E,q,oe),new ne(he[0],L,E,te,oe)),(G=(y>=oe)<<1|p>=te)&&(J=Z[Z.length-1],Z[Z.length-1]=Z[Z.length-1-G],Z[Z.length-1-G]=J)}else{var be=p-+this._x.call(null,he.data),ue=y-+this._y.call(null,he.data),je=be*be+ue*ue;if(je<C){var Ne=Math.sqrt(C=je);A=p-Ne,I=y-Ne,le=p+Ne,de=y+Ne,F=he.data}}return F}function Oe(p){if(isNaN(le=+this._x.call(null,p))||isNaN(de=+this._y.call(null,p)))return this;var y,C=this._root,F,A,I,L=this._x0,E=this._y0,q=this._x1,H=this._y1,le,de,Z,he,J,G,te,oe;if(!C)return this;if(C.length)for(;;){if((J=le>=(Z=(L+q)/2))?L=Z:q=Z,(G=de>=(he=(E+H)/2))?E=he:H=he,y=C,!(C=C[te=G<<1|J]))return this;if(!C.length)break;(y[te+1&3]||y[te+2&3]||y[te+3&3])&&(F=y,oe=te)}for(;C.data!==p;)if(A=C,!(C=C.next))return this;return(I=C.next)&&delete C.next,A?(I?A.next=I:delete A.next,this):y?(I?y[te]=I:delete y[te],(C=y[0]||y[1]||y[2]||y[3])&&C===(y[3]||y[2]||y[1]||y[0])&&!C.length&&(F?F[oe]=C:this._root=C),this):(this._root=I,this)}function ve(p){for(var y=0,C=p.length;y<C;++y)this.remove(p[y]);return this}function Pe(){return this._root}function Ke(){var p=0;return this.visit(function(y){if(!y.length)do++p;while(y=y.next)}),p}function it(p){var y=[],C,F=this._root,A,I,L,E,q;for(F&&y.push(new ne(F,this._x0,this._y0,this._x1,this._y1));C=y.pop();)if(!p(F=C.node,I=C.x0,L=C.y0,E=C.x1,q=C.y1)&&F.length){var H=(I+E)/2,le=(L+q)/2;(A=F[3])&&y.push(new ne(A,H,le,E,q)),(A=F[2])&&y.push(new ne(A,I,le,H,q)),(A=F[1])&&y.push(new ne(A,H,L,E,le)),(A=F[0])&&y.push(new ne(A,I,L,H,le))}return this}function Vt(p){var y=[],C=[],F;for(this._root&&y.push(new ne(this._root,this._x0,this._y0,this._x1,this._y1));F=y.pop();){var A=F.node;if(A.length){var I,L=F.x0,E=F.y0,q=F.x1,H=F.y1,le=(L+q)/2,de=(E+H)/2;(I=A[0])&&y.push(new ne(I,L,E,le,de)),(I=A[1])&&y.push(new ne(I,le,E,q,de)),(I=A[2])&&y.push(new ne(I,L,de,le,H)),(I=A[3])&&y.push(new ne(I,le,de,q,H))}C.push(F)}for(;F=C.pop();)p(F.node,F.x0,F.y0,F.x1,F.y1);return this}function ye(p){return p[0]}function Se(p){return arguments.length?(this._x=p,this):this._x}function Ve(p){return p[1]}function me(p){return arguments.length?(this._y=p,this):this._y}function et(p,y,C){var F=new Dt(y??ye,C??Ve,NaN,NaN,NaN,NaN);return p==null?F:F.addAll(p)}function Dt(p,y,C,F,A,I){this._x=p,this._y=y,this._x0=C,this._y0=F,this._x1=A,this._y1=I,this._root=void 0}function Be(p){for(var y={data:p.data},C=y;p=p.next;)C=C.next={data:p.data};return y}var Le=et.prototype=Dt.prototype;Le.copy=function(){var p=new Dt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),y=this._root,C,F;if(!y)return p;if(!y.length)return p._root=Be(y),p;for(C=[{source:y,target:p._root=new Array(4)}];y=C.pop();)for(var A=0;A<4;++A)(F=y.source[A])&&(F.length?C.push({source:F,target:y.target[A]=new Array(4)}):y.target[A]=Be(F));return p},Le.add=R,Le.addAll=N,Le.cover=j,Le.data=Y,Le.extent=ae,Le.find=_e,Le.remove=Oe,Le.removeAll=ve,Le.root=Pe,Le.size=Ke,Le.visit=it,Le.visitAfter=Vt,Le.x=Se,Le.y=me;function pt(p){return p.x+p.vx}function Lt(p){return p.y+p.vy}function St(p){var y,C,F=1,A=1;typeof p!="function"&&(p=M(p==null?1:+p));function I(){for(var q,H=y.length,le,de,Z,he,J,G,te=0;te<A;++te)for(le=et(y,pt,Lt).visitAfter(L),q=0;q<H;++q)de=y[q],J=C[de.index],G=J*J,Z=de.x+de.vx,he=de.y+de.vy,le.visit(oe);function oe(be,ue,je,Ne,He){var Ee=be.data,$e=be.r,xe=J+$e;if(Ee){if(Ee.index>de.index){var rt=Z-Ee.x-Ee.vx,dt=he-Ee.y-Ee.vy,st=rt*rt+dt*dt;st<xe*xe&&(rt===0&&(rt=x(),st+=rt*rt),dt===0&&(dt=x(),st+=dt*dt),st=(xe-(st=Math.sqrt(st)))/st*F,de.vx+=(rt*=st)*(xe=($e*=$e)/(G+$e)),de.vy+=(dt*=st)*xe,Ee.vx-=rt*(xe=1-xe),Ee.vy-=dt*xe)}return}return ue>Z+xe||Ne<Z-xe||je>he+xe||He<he-xe}}function L(q){if(q.data)return q.r=C[q.data.index];for(var H=q.r=0;H<4;++H)q[H]&&q[H].r>q.r&&(q.r=q[H].r)}function E(){if(y){var q,H=y.length,le;for(C=new Array(H),q=0;q<H;++q)le=y[q],C[le.index]=+p(le,q,y)}}return I.initialize=function(q){y=q,E()},I.iterations=function(q){return arguments.length?(A=+q,I):A},I.strength=function(q){return arguments.length?(F=+q,I):F},I.radius=function(q){return arguments.length?(p=typeof q=="function"?q:M(+q),E(),I):p},I}var ze="$";function _t(){}_t.prototype=jt.prototype={constructor:_t,has:function(p){return ze+p in this},get:function(p){return this[ze+p]},set:function(p,y){return this[ze+p]=y,this},remove:function(p){var y=ze+p;return y in this&&delete this[y]},clear:function(){for(var p in this)p[0]===ze&&delete this[p]},keys:function(){var p=[];for(var y in this)y[0]===ze&&p.push(y.slice(1));return p},values:function(){var p=[];for(var y in this)y[0]===ze&&p.push(this[y]);return p},entries:function(){var p=[];for(var y in this)y[0]===ze&&p.push({key:y.slice(1),value:this[y]});return p},size:function(){var p=0;for(var y in this)y[0]===ze&&++p;return p},empty:function(){for(var p in this)if(p[0]===ze)return!1;return!0},each:function(p){for(var y in this)y[0]===ze&&p(this[y],y.slice(1),this)}};function jt(p,y){var C=new _t;if(p instanceof _t)p.each(function(E,q){C.set(q,E)});else if(Array.isArray(p)){var F=-1,A=p.length,I;if(y==null)for(;++F<A;)C.set(F,p[F]);else for(;++F<A;)C.set(y(I=p[F],F,p),I)}else if(p)for(var L in p)C.set(L,p[L]);return C}var ft=jt;function Rt(){}var tt=ft.prototype;Rt.prototype={constructor:Rt,has:tt.has,add:function(p){return p+="",this[ze+p]=p,this},remove:tt.remove,clear:tt.clear,values:tt.keys,size:tt.size,empty:tt.empty,each:tt.each};function as(p){return p.index}function Bt(p,y){var C=p.get(y);if(!C)throw new Error("missing: "+y);return C}function ns(p){var y=as,C=le,F,A=M(30),I,L,E,q,H=1;p==null&&(p=[]);function le(G){return 1/Math.min(E[G.source.index],E[G.target.index])}function de(G){for(var te=0,oe=p.length;te<H;++te)for(var be=0,ue,je,Ne,He,Ee,$e,xe;be<oe;++be)ue=p[be],je=ue.source,Ne=ue.target,He=Ne.x+Ne.vx-je.x-je.vx||x(),Ee=Ne.y+Ne.vy-je.y-je.vy||x(),$e=Math.sqrt(He*He+Ee*Ee),$e=($e-I[be])/$e*G*F[be],He*=$e,Ee*=$e,Ne.vx-=He*(xe=q[be]),Ne.vy-=Ee*xe,je.vx+=He*(xe=1-xe),je.vy+=Ee*xe}function Z(){if(L){var G,te=L.length,oe=p.length,be=ft(L,y),ue;for(G=0,E=new Array(te);G<oe;++G)ue=p[G],ue.index=G,typeof ue.source!="object"&&(ue.source=Bt(be,ue.source)),typeof ue.target!="object"&&(ue.target=Bt(be,ue.target)),E[ue.source.index]=(E[ue.source.index]||0)+1,E[ue.target.index]=(E[ue.target.index]||0)+1;for(G=0,q=new Array(oe);G<oe;++G)ue=p[G],q[G]=E[ue.source.index]/(E[ue.source.index]+E[ue.target.index]);F=new Array(oe),he(),I=new Array(oe),J()}}function he(){if(L)for(var G=0,te=p.length;G<te;++G)F[G]=+C(p[G],G,p)}function J(){if(L)for(var G=0,te=p.length;G<te;++G)I[G]=+A(p[G],G,p)}return de.initialize=function(G){L=G,Z()},de.links=function(G){return arguments.length?(p=G,Z(),de):p},de.id=function(G){return arguments.length?(y=G,de):y},de.iterations=function(G){return arguments.length?(H=+G,de):H},de.strength=function(G){return arguments.length?(C=typeof G=="function"?G:M(+G),he(),de):C},de.distance=function(G){return arguments.length?(A=typeof G=="function"?G:M(+G),J(),de):A},de}var Ut={value:function(){}};function zt(){for(var p=0,y=arguments.length,C={},F;p<y;++p){if(!(F=arguments[p]+"")||F in C||/[\s.]/.test(F))throw new Error("illegal type: "+F);C[F]=[]}return new B(C)}function B(p){this._=p}function ee(p,y){return p.trim().split(/^|\s+/).map(function(C){var F="",A=C.indexOf(".");if(A>=0&&(F=C.slice(A+1),C=C.slice(0,A)),C&&!y.hasOwnProperty(C))throw new Error("unknown type: "+C);return{type:C,name:F}})}B.prototype=zt.prototype={constructor:B,on:function(p,y){var C=this._,F=ee(p+"",C),A,I=-1,L=F.length;if(arguments.length<2){for(;++I<L;)if((A=(p=F[I]).type)&&(A=ce(C[A],p.name)))return A;return}if(y!=null&&typeof y!="function")throw new Error("invalid callback: "+y);for(;++I<L;)if(A=(p=F[I]).type)C[A]=ke(C[A],p.name,y);else if(y==null)for(A in C)C[A]=ke(C[A],p.name,null);return this},copy:function(){var p={},y=this._;for(var C in y)p[C]=y[C].slice();return new B(p)},call:function(p,y){if((A=arguments.length-2)>0)for(var C=new Array(A),F=0,A,I;F<A;++F)C[F]=arguments[F+2];if(!this._.hasOwnProperty(p))throw new Error("unknown type: "+p);for(I=this._[p],F=0,A=I.length;F<A;++F)I[F].value.apply(y,C)},apply:function(p,y,C){if(!this._.hasOwnProperty(p))throw new Error("unknown type: "+p);for(var F=this._[p],A=0,I=F.length;A<I;++A)F[A].value.apply(y,C)}};function ce(p,y){for(var C=0,F=p.length,A;C<F;++C)if((A=p[C]).name===y)return A.value}function ke(p,y,C){for(var F=0,A=p.length;F<A;++F)if(p[F].name===y){p[F]=Ut,p=p.slice(0,F).concat(p.slice(F+1));break}return C!=null&&p.push({name:y,value:C}),p}var ge=zt,Me=0,lt=0,Nt=0,ws=1e3,Kt,Et,Ht=0,gt=0,Yt=0,xt=typeof performance=="object"&&performance.now?performance:Date,ks=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(p){setTimeout(p,17)};function Cs(){return gt||(ks(Na),gt=xt.now()+Yt)}function Na(){gt=0}function os(){this._call=this._time=this._next=null}os.prototype=Ds.prototype={constructor:os,restart:function(p,y,C){if(typeof p!="function")throw new TypeError("callback is not a function");C=(C==null?Cs():+C)+(y==null?0:+y),!this._next&&Et!==this&&(Et?Et._next=this:Kt=this,Et=this),this._call=p,this._time=C,is()},stop:function(){this._call&&(this._call=null,this._time=1/0,is())}};function Ds(p,y,C){var F=new os;return F.restart(p,y,C),F}function Ea(){Cs(),++Me;for(var p=Kt,y;p;)(y=gt-p._time)>=0&&p._call.call(null,y),p=p._next;--Me}function Ss(){gt=(Ht=xt.now())+Yt,Me=lt=0;try{Ea()}finally{Me=0,Oa(),gt=0}}function xa(){var p=xt.now(),y=p-Ht;y>ws&&(Yt-=y,Ht=p)}function Oa(){for(var p,y=Kt,C,F=1/0;y;)y._call?(F>y._time&&(F=y._time),p=y,y=y._next):(C=y._next,y._next=null,y=p?p._next=C:Kt=C);Et=p,is(F)}function is(p){if(!Me){lt&&(lt=clearTimeout(lt));var y=p-gt;y>24?(p<1/0&&(lt=setTimeout(Ss,p-xt.now()-Yt)),Nt&&(Nt=clearInterval(Nt))):(Nt||(Ht=xt.now(),Nt=setInterval(xa,ws)),Me=1,ks(Ss))}}function qa(p){return p.x}function ja(p){return p.y}var Ra=10,Ba=Math.PI*(3-Math.sqrt(5));function za(p){var y,C=1,F=.001,A=1-Math.pow(F,1/300),I=0,L=.6,E=ft(),q=Ds(le),H=ge("tick","end");p==null&&(p=[]);function le(){de(),H.call("tick",y),C<F&&(q.stop(),H.call("end",y))}function de(J){var G,te=p.length,oe;J===void 0&&(J=1);for(var be=0;be<J;++be)for(C+=(I-C)*A,E.each(function(ue){ue(C)}),G=0;G<te;++G)oe=p[G],oe.fx==null?oe.x+=oe.vx*=L:(oe.x=oe.fx,oe.vx=0),oe.fy==null?oe.y+=oe.vy*=L:(oe.y=oe.fy,oe.vy=0);return y}function Z(){for(var J=0,G=p.length,te;J<G;++J){if(te=p[J],te.index=J,te.fx!=null&&(te.x=te.fx),te.fy!=null&&(te.y=te.fy),isNaN(te.x)||isNaN(te.y)){var oe=Ra*Math.sqrt(J),be=J*Ba;te.x=oe*Math.cos(be),te.y=oe*Math.sin(be)}(isNaN(te.vx)||isNaN(te.vy))&&(te.vx=te.vy=0)}}function he(J){return J.initialize&&J.initialize(p),J}return Z(),y={tick:de,restart:function(){return q.restart(le),y},stop:function(){return q.stop(),y},nodes:function(J){return arguments.length?(p=J,Z(),E.each(he),y):p},alpha:function(J){return arguments.length?(C=+J,y):C},alphaMin:function(J){return arguments.length?(F=+J,y):F},alphaDecay:function(J){return arguments.length?(A=+J,y):+A},alphaTarget:function(J){return arguments.length?(I=+J,y):I},velocityDecay:function(J){return arguments.length?(L=1-J,y):1-L},force:function(J,G){return arguments.length>1?(G==null?E.remove(J):E.set(J,he(G)),y):E.get(J)},find:function(J,G,te){var oe=0,be=p.length,ue,je,Ne,He,Ee;for(te==null?te=1/0:te*=te,oe=0;oe<be;++oe)He=p[oe],ue=J-He.x,je=G-He.y,Ne=ue*ue+je*je,Ne<te&&(Ee=He,te=Ne);return Ee},on:function(J,G){return arguments.length>1?(H.on(J,G),y):H.on(J)}}}function Ka(){var p,y,C,F=M(-30),A,I=1,L=1/0,E=.81;function q(Z){var he,J=p.length,G=et(p,qa,ja).visitAfter(le);for(C=Z,he=0;he<J;++he)y=p[he],G.visit(de)}function H(){if(p){var Z,he=p.length,J;for(A=new Array(he),Z=0;Z<he;++Z)J=p[Z],A[J.index]=+F(J,Z,p)}}function le(Z){var he=0,J,G,te=0,oe,be,ue;if(Z.length){for(oe=be=ue=0;ue<4;++ue)(J=Z[ue])&&(G=Math.abs(J.value))&&(he+=J.value,te+=G,oe+=G*J.x,be+=G*J.y);Z.x=oe/te,Z.y=be/te}else{J=Z,J.x=J.data.x,J.y=J.data.y;do he+=A[J.data.index];while(J=J.next)}Z.value=he}function de(Z,he,J,G){if(!Z.value)return!0;var te=Z.x-y.x,oe=Z.y-y.y,be=G-he,ue=te*te+oe*oe;if(be*be/E<ue)return ue<L&&(te===0&&(te=x(),ue+=te*te),oe===0&&(oe=x(),ue+=oe*oe),ue<I&&(ue=Math.sqrt(I*ue)),y.vx+=te*Z.value*C/ue,y.vy+=oe*Z.value*C/ue),!0;if(Z.length||ue>=L)return;(Z.data!==y||Z.next)&&(te===0&&(te=x(),ue+=te*te),oe===0&&(oe=x(),ue+=oe*oe),ue<I&&(ue=Math.sqrt(I*ue)));do Z.data!==y&&(be=A[Z.data.index]*C/ue,y.vx+=te*be,y.vy+=oe*be);while(Z=Z.next)}return q.initialize=function(Z){p=Z,H()},q.strength=function(Z){return arguments.length?(F=typeof Z=="function"?Z:M(+Z),H(),q):F},q.distanceMin=function(Z){return arguments.length?(I=Z*Z,q):Math.sqrt(I)},q.distanceMax=function(Z){return arguments.length?(L=Z*Z,q):Math.sqrt(L)},q.theta=function(Z){return arguments.length?(E=Z*Z,q):Math.sqrt(E)},q}function Ha(p,y,C){var F,A=M(.1),I,L;typeof p!="function"&&(p=M(+p)),y==null&&(y=0),C==null&&(C=0);function E(H){for(var le=0,de=F.length;le<de;++le){var Z=F[le],he=Z.x-y||1e-6,J=Z.y-C||1e-6,G=Math.sqrt(he*he+J*J),te=(L[le]-G)*I[le]*H/G;Z.vx+=he*te,Z.vy+=J*te}}function q(){if(F){var H,le=F.length;for(I=new Array(le),L=new Array(le),H=0;H<le;++H)L[H]=+p(F[H],H,F),I[H]=isNaN(L[H])?0:+A(F[H],H,F)}}return E.initialize=function(H){F=H,q()},E.strength=function(H){return arguments.length?(A=typeof H=="function"?H:M(+H),q(),E):A},E.radius=function(H){return arguments.length?(p=typeof H=="function"?H:M(+H),q(),E):p},E.x=function(H){return arguments.length?(y=+H,E):y},E.y=function(H){return arguments.length?(C=+H,E):C},E}function Ya(p){var y=M(.1),C,F,A;typeof p!="function"&&(p=M(p==null?0:+p));function I(E){for(var q=0,H=C.length,le;q<H;++q)le=C[q],le.vx+=(A[q]-le.x)*F[q]*E}function L(){if(C){var E,q=C.length;for(F=new Array(q),A=new Array(q),E=0;E<q;++E)F[E]=isNaN(A[E]=+p(C[E],E,C))?0:+y(C[E],E,C)}}return I.initialize=function(E){C=E,L()},I.strength=function(E){return arguments.length?(y=typeof E=="function"?E:M(+E),L(),I):y},I.x=function(E){return arguments.length?(p=typeof E=="function"?E:M(+E),L(),I):p},I}function $a(p){var y=M(.1),C,F,A;typeof p!="function"&&(p=M(p==null?0:+p));function I(E){for(var q=0,H=C.length,le;q<H;++q)le=C[q],le.vy+=(A[q]-le.y)*F[q]*E}function L(){if(C){var E,q=C.length;for(F=new Array(q),A=new Array(q),E=0;E<q;++E)F[E]=isNaN(A[E]=+p(C[E],E,C))?0:+y(C[E],E,C)}}return I.initialize=function(E){C=E,L()},I.strength=function(E){return arguments.length?(y=typeof E=="function"?E:M(+E),L(),I):y},I.y=function(E){return arguments.length?(p=typeof E=="function"?E:M(+E),L(),I):p},I}var ie=i(203);const Wa=["width","height"],Ja={id:"l-links",class:"links"},Ga=["id","d","onClick","onTouchstartPassive"],Xa={key:0,id:"l-nodes",class:"nodes"},Za=["viewBox","width","height","x","y","title","onClick","onTouchendPassive","onMousedown","onTouchstart","innerHTML"],Qa=["r","cx","cy","title","onClick","onTouchendPassive","onMousedown","onTouchstart"],en={key:1,id:"link-labels",class:"labels"},tn=["xlink:href"],sn={key:2,id:"node-labels",class:"labels"},an=["x","y","font-size","stroke-width"];function nn(p,y,C,F,A,I){return(0,ie.openBlock)(),(0,ie.createElementBlock)("svg",{ref:"svg",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:C.size.w,height:C.size.h,class:"net-svg",onMouseup:y[0]||(y[0]=L=>I.emit("dragEnd",[L])),onTouchendPassive:y[1]||(y[1]=L=>I.emit("dragEnd",[L]))},[(0,ie.createElementVNode)("g",Ja,[((0,ie.openBlock)(!0),(0,ie.createElementBlock)(ie.Fragment,null,(0,ie.renderList)(C.links,L=>((0,ie.openBlock)(),(0,ie.createElementBlock)("path",(0,ie.mergeProps)({key:L.id,id:L.id,d:I.linkPath(L)},I.linkAttrs(L),{class:I.linkClass(L.id),style:I.linkStyle(L),onClick:E=>I.emit("linkClick",[E,L]),onTouchstartPassive:E=>I.emit("linkClick",[E,L])}),null,16,Ga))),128))]),C.noNodes?(0,ie.createCommentVNode)("",!0):((0,ie.openBlock)(),(0,ie.createElementBlock)("g",Xa,[((0,ie.openBlock)(!0),(0,ie.createElementBlock)(ie.Fragment,null,(0,ie.renderList)(C.nodes,(L,E)=>((0,ie.openBlock)(),(0,ie.createElementBlock)(ie.Fragment,{key:E},[I.svgIcon(L)?((0,ie.openBlock)(),(0,ie.createElementBlock)("svg",(0,ie.mergeProps)({key:0,viewBox:I.svgIcon(L).attrs.viewBox,width:I.getNodeSize(L,"width"),height:I.getNodeSize(L,"height"),x:L.x-I.getNodeSize(L,"width")/2,y:L.y-I.getNodeSize(L,"height")/2,style:I.nodeStyle(L),title:L.name,class:I.nodeClass(L,["node-svg"])},L._svgAttrs,{onClick:q=>I.emit("nodeClick",[q,L]),onTouchendPassive:q=>I.emit("nodeClick",[q,L]),onMousedown:(0,ie.withModifiers)(q=>I.emit("dragStart",[q,E]),["prevent"]),onTouchstart:(0,ie.withModifiers)(q=>I.emit("dragStart",[q,E]),["prevent"]),innerHTML:I.svgIcon(L).data}),null,16,Za)):((0,ie.openBlock)(),(0,ie.createElementBlock)("circle",(0,ie.mergeProps)({key:1,r:I.getNodeSize(L)/2,cx:L.x,cy:L.y,style:I.nodeStyle(L),title:L.name,class:I.nodeClass(L)},L._svgAttrs,{onClick:q=>I.emit("nodeClick",[q,L]),onTouchendPassive:q=>I.emit("nodeClick",[q,L]),onMousedown:(0,ie.withModifiers)(q=>I.emit("dragStart",[q,E]),["prevent"]),onTouchstart:(0,ie.withModifiers)(q=>I.emit("dragStart",[q,E]),["prevent"])}),null,16,Qa))],64))),128))])),C.linkLabels?((0,ie.openBlock)(),(0,ie.createElementBlock)("g",en,[((0,ie.openBlock)(!0),(0,ie.createElementBlock)(ie.Fragment,null,(0,ie.renderList)(C.links,L=>((0,ie.openBlock)(),(0,ie.createElementBlock)("text",{key:L.id,class:"link-label",fontSize:"fontSize"},[(0,ie.createElementVNode)("textPath",{"xlink:href":"#"+L.id,startOffset:"50%"},(0,ie.toDisplayString)(L.name),9,tn)]))),128))])):(0,ie.createCommentVNode)("",!0),C.nodeLabels?((0,ie.openBlock)(),(0,ie.createElementBlock)("g",sn,[((0,ie.openBlock)(!0),(0,ie.createElementBlock)(ie.Fragment,null,(0,ie.renderList)(C.nodes,L=>((0,ie.openBlock)(),(0,ie.createElementBlock)("text",{key:L.id,class:(0,ie.normalizeClass)(["node-label",L._labelClass?L._labelClass:""]),x:L.x+I.getNodeSize(L)/2+C.fontSize/2,y:L.y+C.labelOffset.y,"font-size":C.fontSize,"stroke-width":C.fontSize/8},(0,ie.toDisplayString)(L.name),11,an))),128))])):(0,ie.createCommentVNode)("",!0)],40,Wa)}var Je={NS:"http://www.w3.org/2000/svg",export(p,y){let C=null;if(this.isSvgData(p)){C=p.cloneNode(!0);let F=p.parentNode.querySelectorAll("*"),A={},I=this.getcssRules();for(let E of F){let q=I;y||(q=I.filter(H=>E.matches(H.selectorText)));for(let H of q)A[H.selectorText]=H.cssText}let L=Object.values(A).join(`
`);if(L){let E=document.createElementNS(this.NS,"style");E.type="text/css",C.insertBefore(E,C.childNodes[0]),E.innerHTML=L,C.appendChild(E)}}return C},makeCanvas(p,y,C){let F=document.createElement("canvas");F.width=p,F.height=y;let A=F.getContext("2d");return A.fillStyle=C||"white",A.fillRect(0,0,F.width,F.height),F},serialize(p){return new XMLSerializer().serializeToString(p)},svgToImg(p,y,C){let F=this.serialize(p),A=new Image,I=y.getContext("2d");A.onload=function(){I.drawImage(this,0,0);let L=y.toDataURL("image/png");C(null,L,I)},A.onerror=function(L){C(L)},A.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(F)))},save(p){return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(this.serialize(p))},getcssRules(){let p=[];for(let y of document.styleSheets){let C=this.readRules(y);for(let F of C)F&&F.cssText&&p.push(F)}return p},readRules(p){try{if(!p.cssRules)return p.rules||[]}catch(y){if(y.name!=="SecurityError")throw y;return[]}return p.cssRules},toDom(p){let y=document.createElement("div");return y.innerHTML=p,y.firstChild||null},toObject(p){if(p){let y={};if(p.attributes)for(let F=p.attributes.length;F>=0;F--){let A=p.attributes[F];A&&(y[A.name]=A.value)}let C=p.innerHTML;if(C)return{attrs:y,data:C}}return null},svgElFromString(p){let y=this.toDom(p);if(this.isSvgData(y))return y.setAttribute("xmlns","http://www.w3.org/2000/svg"),y},svgDataToUrl(p,y){if(typeof y=="object")for(let F in y){let A=y[F]?y[F]:"";p.setAttribute(F,A)}let C=this.export(p);return C?this.svgToUrl(this.serialize(C)):null},isSvgData(p){return p.firstChild?p.firstChild.parentNode.nodeName==="svg":!1},svgToUrl(p){let y=new Blob([p],{type:"image/svg+xml"});return URL.createObjectURL(y)}},on={name:"SvgRenderer",props:["size","nodes","noNodes","selected","linksSelected","links","nodeSize","padding","fontSize","strLinks","linkWidth","nodeLabels","linkLabels","labelOffset","nodeSym"],computed:{nodeSvg(){return this.nodeSym?Je.toObject(this.nodeSym):null}},methods:{getNodeSize(p,y){let C=p._size||this.nodeSize;return y&&(C=p["_"+y]||C),C},svgIcon(p){return p.svgObj||this.nodeSvg},emit(p,y){this.$emit("action",p,y)},svgScreenShot(p,y,C,F){let A=Je.export(this.$refs.svg,F);if(y)p(null,Je.save(A));else{C||(C=this.searchBackground());let I=Je.makeCanvas(this.size.w,this.size.h,C);Je.svgToImg(A,I,(L,E)=>{L?p(L):p(null,E)})}},linkClass(p){let y=["link"];return this.linksSelected.hasOwnProperty(p)&&y.push("selected"),this.strLinks||y.push("curve"),y},linkPath(p){let y={M:[p.source.x|0,p.source.y|0],X:[p.target.x|0,p.target.y|0]};return this.strLinks?"M "+y.M.join(" ")+" L"+y.X.join(" "):(y.Q=[p.source.x,p.target.y],"M "+y.M+" Q "+y.Q.join(" ")+" "+y.X)},nodeStyle(p){return p._color?"fill: "+p._color:""},linkStyle(p){let y={};return p._color&&(y.stroke=p._color),y},nodeClass(p,y=[]){let C=p._cssClass?p._cssClass:[];return Array.isArray(C)||(C=[C]),C.push("node"),y.forEach(F=>C.push(F)),this.selected[p.id]&&C.push("selected"),(p.fx||p.fy)&&C.push("pinned"),C},searchBackground(){let p=this;for(;p.$parent;){let C=window.getComputedStyle(p.$el).getPropertyValue("background-color");if(C.replace(/[^\d,]/g,"").split(",").reduce((I,L)=>parseInt(I)+parseInt(L),0)>0)return C;p=p.$parent}return"white"},spriteSymbol(){let p=this.nodeSym;if(p)return Je.toSymbol(p)},linkAttrs(p){let y=p._svgAttrs||{};return y["stroke-width"]=y["stroke-width"]||this.linkWidth,y}}},Ms=i(744),Fs=(0,Ms.Z)(on,[["render",nn]]);const ln=["width","height"];function rn(p,y,C,F,A,I){const L=(0,ie.resolveDirective)("render-canvas");return(0,ie.withDirectives)(((0,ie.openBlock)(),(0,ie.createElementBlock)("canvas",{id:"canvas",ref:"canvas",width:C.size.w,height:C.size.h,style:(0,ie.normalizeStyle)(I.canvasStyle),onMouseup:y[0]||(y[0]=(0,ie.withModifiers)((...E)=>I.canvasClick&&I.canvasClick(...E),["prevent"])),onMousedown:y[1]||(y[1]=(0,ie.withModifiers)((...E)=>I.canvasClick&&I.canvasClick(...E),["prevent"])),onTouchstart:y[2]||(y[2]=(0,ie.withModifiers)((...E)=>I.canvasClick&&I.canvasClick(...E),["prevent"])),onTouchendPassive:y[3]||(y[3]=(...E)=>I.canvasClick&&I.canvasClick(...E))},null,44,ln)),[[L,{links:C.links,nodes:C.nodes}]])}var dn={background:{_cssClass:"net-svg",fillStyle:"white"},node:{_cssClass:"node",fillStyle:"green",strokeStyle:"orange",lineWidth:2},link:{_cssClass:"link",strokeStyle:"blue",lineWidth:1},labels:{_cssClass:"node-label",_svgElement:"text",fillStyle:"black",fontFamily:"Arial"},nodeSelected:{_cssClass:"node selected",fillStyle:"red",strokeStyle:"orange",lineWidth:2},linkSelected:{_cssClass:"link selected",strokeStyle:"green",lineWidth:2},nodePinned:{_cssClass:"node pinned",fillStyle:"green",strokeStyle:"red"},nodeSelectedPinned:{_cssClass:"node selected pinned",fillStyle:"green",strokeStyle:"red"}},bt={randomId(){return Math.random().toString(36).substring(7)},fillStyle(p,y){let C=null,F="picker-"+this.randomId(),A=this.canvasPicker(p,F);y.appendChild(A);let I={fillStyle:"fill",strokeStyle:"stroke",lineWidth:"stroke-width",fontFamily:"font-family"};return p=this.mapStyle(F,I,p,C),y.removeChild(A),p},mapStyle(p,y,C,F,A){let I=window.getComputedStyle(document.getElementById(p),F);A=A||["lineWidth"];for(let L in y){let E=I.getPropertyValue(y[L]);A.indexOf(L)>-1&&(E=parseInt(E,10)),E&&(C[L]=E)}return C},canvasPicker(p,y){let C=p._svgAttrs||{},F=p._svgElement||"circle";if(!p._svgAttrs)switch(F){case"text":C={x:10,y:10,fontSize:20};break;case"circle":C={cx:10,cy:10,r:10};break}return C.class=p._cssClass,C.id=y,this.svgCreate(F,C)},compColor(p){let y=document.createElement("div");y.style.backgroundColor=p,document.body.appendChild(y);let C=window.getComputedStyle(y,null).getPropertyValue("background-color");return document.body.removeChild(y),C},svgCreate(p,y){let C=document.createElementNS("http://www.w3.org/2000/svg",p);for(let F in y)C.setAttributeNS(null,F,y[F]);return C},create(p,y,C){C=C||"body";let F=document.createElement(p),A=y||"";return A+=this.randomId(),F.setAttribute("id",A),document[C].appendChild(F),F}},cn={name:"CanvasRenderer",directives:{renderCanvas:{mounted(p,y,C){let F=y.value.nodes,A=y.value.links;C.context.draw(F,A,p)}}},props:["size","offset","padding","nodes","selected","linksSelected","links","nodeSize","fontSize","strLinks","linkWidth","nodeLabels","labelOffset","canvasStyles","nodeSym","noNodes"],data(){return{hitCanvas:null,shapes:{},drag:null,stylesReady:!1,CssStyles:!0,styles:dn,sprites:{}}},computed:{nodeSvg(){return this.nodeSym},canvasStyle(){let p=this.padding.x+"px",y=this.padding.y+"px";return{left:p,top:y}}},watch:{nodeSize(){this.resetSprites()},canvasStyles(){this.resetSprites()}},created(){if(this.canvasStyles)for(let p in this.canvasStyles)this.styles[p]=this.canvasStyles[p]},mounted(){let p=this;this.$nextTick(()=>{p.hitCanvas.width=p.size.w,p.hitCanvas.height=p.size.h})},methods:{canvasScreenShot(p,y){let C=this.$refs.canvas,F=document.createElement("canvas");F.width=C.width,F.height=C.height;let A=this.styles.background;y&&(A=this.getCssColor(y));let I=F.getContext("2d");I=this.setCtx(I,A),I.fillRect(0,0,F.width,F.height),I.drawImage(C,0,0);let L=F.toDataURL("image/png");L?p(null,L):p(new Error("error generating canvas image"))},emit(p,y){this.$emit("action",p,y)},canvasInit(){let p=document.createElement("canvas");p.width=this.size.w,p.height=this.size.h,p.top=this.offset.y,p.left=this.offset.x,p.id="hit-canvas",this.hitCanvas=p,this.resetSprites()},resetSprites(){this.sprites={};let p=["node","nodeSelected","nodePinned","nodeSelectedPinned"];for(let y of p)this.sprites[y]=this.nodeSprite(this.styles[y])},canvasClick(p){let y=this.hitCanvas.getContext("2d"),C=p.touches?p.touches[0]||p.changedTouches[0]:p,F=document.body.scrollTop,A=document.body.scrollLeft,I=C.clientX+A-this.padding.x,L=C.clientY+F-this.padding.y,E=y.getImageData(I,L,1,1).data,q=`rgb(${E[0]},${E[1]},${E[2]})`,H=this.shapes[q];if(H){let le=H.type+"s",de=this[le][H.index];de&&(p.type==="mouseup"||p.type==="touchend"?(this.drag&&(this.drag=null,this.emit("dragEnd")),this.emit(H.type+"Click",[p,de])):(p.type==="mousedown"||p.type==="touchstart")&&(this.drag=de,this.emit("dragStart",[p,de.index])))}},drawNode(p,y){p.beginPath(),p.arc(y.x,y.y,this.nodeSize/2,0,2*Math.PI,!1);let C=p.fillStyle,F=p.strokeStyle;y._color&&(p.fillStyle=y._color),y._borderColor&&(p.strokeStyle=y._borderColor),p.fill(),p.stroke(),p.closePath(),p.fillStyle=C,p.strokeStyle=F},drawLink(p,y){p.beginPath(),p.moveTo(y.source.x,y.source.y),p.lineTo(y.target.x,y.target.y),p.lineWidth=this.linkWidth,p.strokeStyle=y._color?y._color:y.color,p.stroke()},drawText(p,y,C,F){y=this.setCtx(y,C),this.fontSize&&(y.font=this.fontSize+"px "+C.fontFamily);let A=F?p[F]:p.name,I=p.x+this.labelOffset.x,L=p.y+this.labelOffset.y;y.fillText(A,I,L)},draw(p,y,C){this.hitCanvas||this.canvasInit();let F=C.getContext("2d"),A=this.hitCanvas.getContext("2d");!this.stylesReady&&this.CssStyles&&(this.getCssStyles(),this.resetSprites()),F.clearRect(0,0,this.size.w,this.size.h),F=this.setCtx(F,this.styles.link);for(let I of y)this.linksSelected[I.id]||this.drawLink(F,I),this.mapShape(I,"link",this.drawLink,A);F=this.setCtx(F,this.styles.linkSelected);for(let I in this.linksSelected){let L=this.linksSelected[I];this.isOnView(L.source)&&this.isOnView(L.target)&&this.drawLink(F,L)}F=this.setCtx(F,this.styles.node);for(let I of p)if(this.isOnView(I)){if(!this.noNodes){let L=this.getNodeSprite(I);F.drawImage(L,I.x-L.width/2,I.y-L.height/2),this.mapShape(I,"node",this.drawNode,A)}this.nodeLabels&&(I.size=this.nodeSize,this.drawText(I,F,this.labelStyle(I)))}F=this.setCtx(F,this.styles.nodeSelected);for(let I in this.selected){let L=this.selected[I];if(this.isOnView(L)){let E=this.getNodeSprite(L);F.drawImage(E,L.x-E.width/2,L.y-E.height/2)}}},getNodeSprite(p){let y=this.nodeSpriteName(p),C=this.sprites[y];if(!C){let F=this.loadNodeStyle(p);C=this.nodeSprite(F),this.sprites[y]=C}return C},nodeSpriteName(p){let y="node";return this.selected[p.id]&&(y+="Selected"),p.pinned&&(y+="Pinned"),p._cssClass&&(y+="-"+p._cssClass),p._color&&(y+="-"+bt.compColor(p._color)),y},nodeSprite(p){let y=this.nodeSize+this.styles.node.lineWidth,C=this.nodeSvg?y:y*2,F=this.spriteCanvas(C),A=F.getContext("2d");if(this.nodeSvg){let I={width:y,height:y,class:p._cssClass||"",style:p._cssStyle||""},L=Je.svgDataToUrl(this.nodeSvg,I);if(L){let E=new Image;E.onload=()=>{A.drawImage(E,0,0),URL.revokeObjectURL(L)},E.onerror=q=>{console.log("error creating node image",q)},E.src=L}}else A=this.setCtx(A,p),this.drawNode(A,{x:y,y});return F},spriteCanvas(p){let y=document.createElement("canvas");return y.width=p,y.height=p,y},isOnView(p){return p.x>0&&p.y>0&&p.x<this.size.w&&p.y<this.size.h},mapShape(p,y,C,F){p.colorIndex||(p.colorIndex=this.newColorIndex());let A=Object.assign({},p);A.color=p.colorIndex.rgb,A.borderColor=p.colorIndex.rgb,A.type=y;let I=this.sprites[y];I?(I=this.cloneCanvas(I),I=this.fillCanvas(I,p.colorIndex),F.drawImage(I,p.x-I.width/2,p.y-I.height/2)):C(F,A),this.shapes[p.colorIndex.rgb]=A},fillCanvas(p,y){let C=p.getContext("2d"),F=C.getImageData(0,0,p.width,p.height),A=p.width*p.height*4;for(let I=3;I<=A;I+=4)F.data[I]>0&&(F.data[I]=255,F.data[I-3]=y.r,F.data[I-2]=y.g,F.data[I-1]=y.b);return C.putImageData(F,0,0),p},newColorIndex(){for(;;){let p=this.randomColor();if(!this.shapes[p.rgb])return p}},randomColor(){const p=Math.round(Math.random()*255),y=Math.round(Math.random()*255),C=Math.round(Math.random()*255);return{r:p,g:y,b:C,rgb:`rgb(${p},${y},${C})`}},setCtx(p,y){for(let C in y)p[C]=y[C];return p},cloneCanvas(p){let y=document.createElement("canvas"),C=y.getContext("2d");return y.width=p.width,y.height=p.height,C.drawImage(p,0,0),y},Sprite(p,y){return this.sprites[p]||(this.sprites[p]=y()),this.sprites[p]},getCssStyles(){let p=bt.create("svg","css-picker");for(let y in this.styles){let C=this.styles[y]||{};C=bt.fillStyle(C,p)}document.body.removeChild(p),this.stylesReady=!0},loadNodeStyle(p){let y="node",C=this.selected[p.id];if(C&&(y="nodeSelected"),p.pinned&&(y="nodePinned"),C&&p.pinned&&(y="nodeSelectedPinned"),p._cssClass){let A=y+"-"+p._cssClass;if(!this.styles[A]){let I=Object.assign({},this.styles[y]||{});I._cssClass=I._cssClass||"",I._cssClass+=" "+p._cssClass,this.updateStyle(A,I)}y=A}let F=Object.assign({},this.styles[y]||this.updateStyle(y));return p._color&&(F.fillStyle=p._color,F._cssStyle="fill:"+p._color),p._cssClass&&(F._cssClass+=" "+p._cssClass),F},updateStyle(p,y){y=y||this.styles[p]||{};let C=bt.create("svg","css-picker");return y=bt.fillStyle(y,C),this.styles[p]=y,document.body.removeChild(C),y},getCssColor(p){let y=bt.create("div","color-picker"),C=y.id;y.setAttribute("style","background-color:"+p);let F=bt.mapStyle(C,{fillStyle:"background-color"},[]);return document.body.removeChild(y),F},labelStyle(p){let y=this.styles.labels,C=p._labelClass;if(C){let F="labels-"+C,A=this.styles[F];A||(A=Object.assign({},y),A._cssClass+=" "+C,A=this.updateStyle(F,A)),y=A}return y}}},Is=(0,Ms.Z)(cn,[["render",rn]]),As={save(p,y){p&&(p=this.dataURIToBlob(p,C=>{let F=URL.createObjectURL(C);this.download(F,y)}))},dataURIToBlob(p,y){let C=atob(p.split(",")[1]),F=C.length,A=new Uint8Array(F);for(var I=0;I<F;I++)A[I]=C.charCodeAt(I);y(new Blob([A]))},download(p,y){y=y||"";let C=document.createElement("a");C.setAttribute("href",p),C.setAttribute("download",y);let F=document.body.appendChild(C);C.click(),document.body.removeChild(F)}};const yt=Object.assign({},h);var un={name:"D3Network",components:{canvasRenderer:Is,svgRenderer:Fs},props:{netNodes:{type:Array},netLinks:{type:Array},options:{type:Object},nodeSym:{type:String},nodeCb:{type:Function},linkCb:{type:Function},simCb:{type:Function},customForces:{type:Object},selection:{type:Object,default:()=>({nodes:{},links:{}})}},emits:["node-click","link-click"],data(){return{canvas:!1,nodes:[],links:[],size:{w:500,h:500},offset:{x:0,y:0},clientOffset:{x:0,y:0},force:500,forces:{Center:!1,X:.5,Y:.5,ManyBody:!0,Link:!0},noNodes:!1,strLinks:!0,fontSize:10,dragging:!1,linkWidth:1,nodeLabels:!1,linkLabels:!1,nodeSize:5,mouseOfst:{x:0,y:0},padding:{x:0,y:0},simulation:null,nodeSvg:null,resizeListener:!0}},computed:{selected(){return this.selection.nodes},linksSelected(){return this.selection.links},center(){return{x:this.size.w/2+this.size.w/200+this.offset.x,y:this.size.h/2+this.size.h/200+this.offset.y}},labelOffset(){return{x:this.nodeSize/2+this.fontSize/2,y:this.fontSize/2}}},watch:{netNodes(p){this.buildNodes(p),this.reset()},netLinks(p,y){this.links=this.buildLinks(p),this.reset()},nodeSym(){this.updateNodeSvg()},options(p,y){this.updateOptions(p),y.size&&p.size&&(y.size.w!==p.size.w||y.size.h!==p.size.h)&&this.onResize(),this.animate()}},created(){this.updateOptions(this.options),this.buildNodes(this.netNodes),this.links=this.buildLinks(this.netLinks),this.updateNodeSvg()},mounted(){this.onResize(),this.$nextTick(()=>{this.animate()}),this.resizeListener&&window.addEventListener("resize",this.onResize)},beforeUnmount(){this.resizeListener&&window.removeEventListener("resize",this.onResize)},methods:{updateNodeSvg(){let p=null;this.nodeSym&&(p=Je.svgElFromString(this.nodeSym)),this.nodeSvg=p},methodCall(p,y){let C=this[p];C&&typeof C=="function"&&(y?C(...y):C())},onResize(){var C,F;let p=this.options.size;(!p||!p.w)&&(this.size.w=this.$el.clientWidth),(!p||!p.h)&&(this.size.h=this.$el.clientHeight),this.padding.x=0,this.padding.y=0;let y=this;for(;y.$parent;)this.padding.x+=((C=y.$el)==null?void 0:C.offsetLeft)||0,this.padding.y+=((F=y.$el)==null?void 0:F.offsetTop)||0,y=y.$parent;this.animate()},updateOptions(p){for(let y in p)typeof this[y]<"u"&&(this[y]=p[y])},buildNodes(p){this.nodes=p.map((y,C)=>(y=this.itemCb(this.nodeCb,y),!y.id&&y.id!==0&&(y.id=C),y.x||(y.x=0),y.y||(y.y=0),!y.name&&y.name!=="0"&&(y.name="node "+y.id),y.svgSym&&(y.svgIcon=Je.svgElFromString(y.svgSym),!this.canvas&&y.svgIcon&&!y.svgObj&&(y.svgObj=Je.toObject(y.svgIcon))),y))},buildLinks(p){return p.concat().map((y,C)=>(y=this.itemCb(this.linkCb,y),y.source=y.sid,y.target=y.tid,y.id||(y.id="link-"+C),y))},itemCb(p,y){return p&&typeof p=="function"&&(y=p(y)),y},simulate(p,y){let C=this.forces,F=yt.forceSimulation().stop().alpha(.5).nodes(p);return C.Center!==!1&&F.force("center",yt.forceCenter(this.center.x,this.center.y)),C.X!==!1&&F.force("X",yt.forceX(this.center.x).strength(C.X)),C.Y!==!1&&F.force("Y",yt.forceY(this.center.y).strength(C.Y)),C.ManyBody!==!1&&F.force("charge",yt.forceManyBody().strength(-this.force)),C.Link!==!1&&F.force("link",yt.forceLink(y).id(function(A){return A.id})),F=this.setCustomForces(F),F=this.itemCb(this.simCb,F),F},setCustomForces(p){let y=this.customForces;if(y)for(let C in y){let F=this.getD3Func("force"+C);if(F){let A=y[C];p.force("custom"+C,F(...A))}}return p},getD3Func(p){let y=yt[p];return y&&typeof y=="function"?y:null},animate(){this.simulation&&this.simulation.stop(),this.forces.Link!==!1?this.simulation=this.simulate(this.nodes,this.links):this.simulation=this.simulate(this.nodes),this.simulation.restart()},reset(){this.animate(),this.nodes=this.simulation.nodes(),this.forces.links&&(this.links=this.simulation.force("link").links())},move(p){let y=this.clientPos(p);this.dragging!==!1&&this.nodes[this.dragging]&&(this.simulation.restart(),this.simulation.alpha(.5),this.nodes[this.dragging].fx=y.x-this.mouseOfst.x,this.nodes[this.dragging].fy=y.y-this.mouseOfst.y)},clientPos(p){let y=p.touches?p.touches[0].clientX:p.clientX,C=p.touches?p.touches[0].clientY:p.clientY;return y=y||0,C=C||0,{x:y,y:C}},dragStart(p,y){this.dragging=y===!1?!1:y,this.setMouseOffset(p,this.nodes[y]),this.dragging===!1&&(this.simulation.alpha(.1),this.simulation.restart(),this.setMouseOffset())},dragEnd(){let p=this.nodes[this.dragging];p&&!p.pinned&&(p.fx=null,p.fy=null),this.dragStart(!1)},nodeClick(p,y){this.$emit("node-click",p,y)},linkClick(p,y){this.$emit("link-click",p,y)},setMouseOffset(p,y){let C=0,F=0;if(p&&y){let A=this.clientPos(p);C=A.x?A.x-y.x:y.x,F=A.y?A.y-y.y:y.y}this.mouseOfst={x:C,y:F}},screenShot(p,y,C,F){let A,I=[];this.canvas?(C=!1,A=this.$refs.canvas.canvasScreenShot,I=[y]):(A=this.$refs.svg.svgScreenShot,I=[C,y,F]),C&&(p=p||"export.svg"),A((L,E)=>{L||(C?As.download(E,p):As.save(E,p)),this.$emit("screen-shot",L)},...I)}},render(){let p="svg",y={},C=Fs,F=["size","nodes","links","selected","linksSelected","strLinks","linkWidth","nodeLabels","linkLabels","fontSize","labelOffset","offset","padding","nodeSize","noNodes"];for(let A of F)y[A]=this[A];return y.nodeSym=this.nodeSvg,this.canvas&&(C=Is,p="canvas",y.canvasStyles=this.options.canvasStyles),(0,ie.h)("div",{class:["net"],onMousemove:this.move,onTouchmove:this.move},[(0,ie.h)(C,{...y,ref:p,onAction:this.methodCall})])}},mn=un,hn=mn}(),m=m.default,m}()})})(Sa);var T_=Sa.exports;const V_=bn(T_);const L_={name:"map-view",description:"Map View Representation",props:{assetId:{type:[String,Number],default:""},gridArr:{type:[String,Object],default:()=>{}},onComplete:{type:Function,default:()=>{}}},data(){return{showModal:!1,paramsObj:{},parentId:"",pivotId:"",dialog:void 0,nodes:[],links:[],nodeSize:15,canvas:!1}},beforeMount(){this.updateData()},computed:{options(){return{force:6e3,nodeSize:this.nodeSize,nodeLabels:!0,linkLabels:!0,canvas:this.canvas,linkWidth:2,strLinks:!1}},dialogStyle(){let{dialog:e}=this,t={};if(e){let{x:s,y:d}=e;t.left=`${s+35}px`,t.top=`${d+95}px`}return t}},methods:{updateData(){for(let e in this.gridArr.nodes)this.gridArr.nodes[e].id==this.assetId&&(this.gridArr.nodes[e]._size=25,this.gridArr.nodes[e]._labelClass="text-bold");this.nodes=this.gridArr.nodes;for(let e in this.gridArr.edges)this.gridArr.edges[e].sid=this.gridArr.edges[e].parent_asset_id,this.gridArr.edges[e].tid=this.gridArr.edges[e].child_asset_id,this.gridArr.edges[e].name=this.gridArr.edges[e].relation_name;this.links=this.gridArr.edges},lcb(e){return e._svgAttrs={"marker-end":"url(#m-end)"},e},showDialog(e,t){this.dialog=Object.assign({},t)},addNode(e){this.parentId=e.id,this.showModal=!0,this.dialog=void 0},onClose(){this.showModal=!1,this.showDeleteModal=!1},onDone(){this.onComplete()}},components:{D3Network:V_,"asset-relation-modal":Da}},U_={class:"grid-view-rel"},N_={key:0,class:"container tree-container"},E_={class:"btn-group"};function x_(e,t,s,d,a,i){const m=u("router-link"),h=u("d3-network"),b=u("asset-relation-modal"),f=W("tooltip");return o(),l("div",U_,[s.gridArr?(o(),l("div",N_,[a.dialog?(o(),l("div",{key:0,class:"dialog",style:ct(i.dialogStyle)},[n("div",E_,[S((o(),l("button",{class:"btn btn-outline-primary",onClick:t[0]||(t[0]=g=>i.addNode(a.dialog))},t[2]||(t[2]=[n("i",{class:"fas fa-plus"},null,-1)]))),[[f,e.trans("add_relationship")]]),S((o(),k(m,{class:"btn btn-outline-info",to:"/service-desk/assets/"+a.dialog.id+"/show",target:"_blank"},{default:w(()=>t[3]||(t[3]=[n("i",{class:"fas fa-eye"},null,-1)])),_:1},8,["to"])),[[f,e.trans("view_asset")]])]),S(n("span",{class:"fas fa-times-circle pointer absolute",onClick:t[1]||(t[1]=()=>a.dialog=void 0)},null,512),[[f,e.trans("close")]])],4)):c("",!0),_(h,{ref:"net","net-nodes":a.nodes,"net-links":a.links,options:i.options,"link-cb":i.lcb,onNodeClick:i.showDialog},null,8,["net-nodes","net-links","options","link-cb","onNodeClick"]),t[4]||(t[4]=n("svg",null,[n("defs",null,[n("marker",{id:"m-end",markerWidth:"10",markerHeight:"10",refX:"14",refY:"3",orient:"auto",markerUnits:"userSpaceOnUse"},[n("path",{d:"M0,0 L0,6 L9,3 z"})])])],-1))])):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showModal,parentValue:a.parentId,assetId:s.assetId,onComplete:i.onDone},null,8,["onClose","showModal","parentValue","assetId","onComplete"])):c("",!0)]),_:1})])}const O_=P(L_,[["render",x_]]),q_={name:"delete-relation-modal",description:"Delete Relation Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},onDone:{type:Function,default:()=>{}},params:{type:Object,default:()=>{}}},data:()=>({containerStyle:{width:"500px"},loading:!1}),methods:{onSubmit(){this.loading=!0,T.delete("/service-desk/api/remove-cmdb",{data:this.params}).then(e=>{K(e,"assetAssociates"),this.onDone(),this.onClose()}).catch(e=>{O(e,"assetAssociates"),this.onClose()})}}},j_={class:"modal_title"},R_={key:0},B_={key:1,class:"row"},z_=["disabled"];function K_(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:w(()=>[n("h4",j_,r(e.trans("delete_relationship")),1)]),fields:w(()=>[e.loading?c("",!0):(o(),l("div",R_,[n("span",null,r(e.trans("are_you_sure")),1)])),e.loading?(o(),l("div",B_,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:e.loading},[t[1]||(t[1]=n("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)),v(" "+r(e.trans("delete")),1)],8,z_)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const H_=P(q_,[["render",K_]]),Y_={name:"list-view-relation",props:{assetId:{type:[String,Number],default:""},listArr:{type:[String,Object],default:()=>{}},onComplete:{type:Function,default:()=>{}}},data(){return{showModal:!1,paramsObj:{}}},methods:{deleteRelation(e,t,s){let d=[];d.push(t),this.paramsObj.child_asset_ids=d,this.paramsObj.parent_asset_id=this.assetId,this.paramsObj.cmdb_id=e,this.paramsObj.relation=s,this.showModal=!0},onClose(){this.showModal=!1},onDone(){this.onComplete()}},components:{"delete-relation-modal":H_}},$_={key:0},W_={class:"table table-bordered text-sm"},J_={style:{width:"40%"}},G_={style:{width:"50%"}},X_=["rowspan"],Z_=["onClick"],Q_=["onClick"];function ef(e,t,s,d,a,i){const m=u("router-link"),h=u("delete-relation-modal");return s.listArr.length?(o(),l("div",$_,[n("table",W_,[n("thead",null,[n("tr",null,[n("th",J_,r(e.trans("dependency")),1),n("th",G_,r(e.trans("asset")),1),n("th",null,r(e.trans("action")),1)])]),n("tbody",null,[(o(!0),l(U,null,$(s.listArr,b=>(o(),l(U,null,[n("tr",null,[n("td",{rowspan:b.child_assets.length},r(b.child_assets[0].pivot.relation=="forward"?b.forward_relation_name:b.inverse_relation_name),9,X_),n("td",null,[_(m,{to:"/service-desk/assets/"+b.child_assets[0].id+"/show",target:"_blank"},{default:w(()=>[v(r(b.child_assets[0].name),1)]),_:2},1032,["to"])]),n("td",null,[n("button",{type:"button",class:"btn btn-light table_btn btn-sm",onClick:f=>i.deleteRelation(b.id,b.child_assets[0].id,b.child_assets[0].pivot.relation)},t[0]||(t[0]=[n("i",{class:"fas fa-trash"},null,-1)]),8,Z_)])]),(o(!0),l(U,null,$(b.child_assets.slice(1),f=>(o(),l("tr",null,[n("td",null,[_(m,{to:"/service-desk/assets/"+f.id+"/show",target:"_blank"},{default:w(()=>[v(r(f.name),1)]),_:2},1032,["to"])]),n("td",null,[n("button",{type:"button",class:"btn btn-light table_btn btn-sm",onClick:g=>i.deleteRelation(b.id,f.id,f.pivot.relation)},t[1]||(t[1]=[n("i",{class:"fas fa-trash"},null,-1)]),8,Q_)])]))),256))],64))),256))]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,onDone:i.onDone,params:a.paramsObj},null,8,["onClose","showModal","onDone","params"])):c("",!0)]),_:1})])])):c("",!0)}const tf=P(Y_,[["render",ef]]);const sf={name:"asset-relation",description:"Asset relation page",props:{assetId:{type:[String,Number],default:""}},data(){return{showModal:!1,assetPopulated:!1,view_mode:"list",loading:!0,nodeConfig:[],treeConfig:[]}},beforeMount(){this.getCMDBDataByAssestId()},methods:{getCMDBDataByAssestId(){Promise.all([this.loadList(),this.loadGrid()]).then(e=>{[this.nodeConfig,this.treeConfig]=e,this.assetPopulated=!0,this.loading=!1}).catch(function(e){this.loading=!1,O(e,"assetAssociates")})},loadList(){return T.get("/service-desk/api/cmdb-asset-table/"+this.assetId).then(e=>e.data.data.cmdb_data)},loadGrid(){return T.get("/service-desk/api/cmdb-asset/"+this.assetId).then(e=>e.data.data)},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")},onComplete(){this.loading=!0,this.getCMDBDataByAssestId()}},watch:{loading(e){this.$emit("loaderValue",e)}},components:{"list-view":tf,"grid-view":O_,"asset-relation-modal":Da,"radio-button":mt}},af={class:"asset-relation"},nf={key:0},of={class:"card-header border-0"},lf={class:"card-tools m-0 pb-0 pt-0"},rf={class:"btn-group btn-group-toggle mt-1"},df={class:"card-body"},cf={key:1},uf={class:"text-center"};function mf(e,t,s,d,a,i){const m=u("list-view"),h=u("grid-view"),b=u("asset-relation-modal"),f=W("tooltip");return o(),l("div",af,[a.assetPopulated&&!a.loading?(o(),l(U,{key:0},[a.nodeConfig.length?(o(),l("div",nf,[n("div",of,[n("div",lf,[n("div",rf,[S((o(),l("label",{class:Q(["btn btn-sm",{"btn-primary active":a.view_mode=="list","bg-view":a.view_mode=="map"}])},[S(n("input",{class:"d-none",type:"radio",value:"list","onUpdate:modelValue":t[0]||(t[0]=g=>a.view_mode=g)},null,512),[[ls,a.view_mode]]),t[4]||(t[4]=n("span",{class:"hidden"},".",-1)),t[5]||(t[5]=n("i",{class:"fas fa-list"},null,-1)),t[6]||(t[6]=v()),t[7]||(t[7]=n("span",{class:"hidden"},".",-1))],2)),[[f,e.trans("list_view")]]),S((o(),l("label",{class:Q(["btn btn-sm",{"btn-primary active":a.view_mode=="map","bg-view":a.view_mode=="list"}])},[S(n("input",{class:"d-none",type:"radio",value:"map","onUpdate:modelValue":t[1]||(t[1]=g=>a.view_mode=g)},null,512),[[ls,a.view_mode]]),t[8]||(t[8]=n("span",{class:"hidden"},".",-1)),t[9]||(t[9]=v()),t[10]||(t[10]=n("i",{class:"fas fa-sitemap"},null,-1)),t[11]||(t[11]=v()),t[12]||(t[12]=n("span",{class:"hidden"},".",-1))],2)),[[f,e.trans("map_view")]])]),n("button",{class:"btn btn-primary btn-sm",onClick:t[2]||(t[2]=g=>a.showModal=!0)},[t[13]||(t[13]=n("i",{class:"glyphicon glyphicon-plus"},null,-1)),v(" "+r(e.trans("add_relationship")),1)])])]),n("div",df,[a.view_mode=="list"?(o(),k(m,{key:0,assetId:s.assetId,listArr:a.nodeConfig,onComplete:i.onComplete},null,8,["assetId","listArr","onComplete"])):c("",!0),a.view_mode=="map"?(o(),k(h,{key:1,assetId:s.assetId,gridArr:a.treeConfig,onComplete:i.onComplete},null,8,["assetId","gridArr","onComplete"])):c("",!0)])])):c("",!0),a.nodeConfig.length?c("",!0):(o(),l("div",cf,[n("p",uf,[v(r(e.trans("no_relationships_available"))+" ",1),n("a",{href:"javascript:;",onClick:t[3]||(t[3]=g=>a.showModal=!0)},r(e.trans("add_new")),1)])]))],64)):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showModal,assetId:s.assetId,onComplete:i.onComplete},null,8,["onClose","showModal","assetId","onComplete"])):c("",!0)]),_:1})])}const hf=P(sf,[["render",mf],["__scopeId","data-v-1f95b2fb"]]);const pf={name:"attachment-list",description:"Attachment List",props:{assetId:{type:[String,Number],default:""},disableLoader:{type:Boolean,default:!1}},setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{apiUrl:`service-desk/api/attachment-list/${this.assetId}`,columns:["name","size","type","created_at","action"],options:{},selectedFile:null,tableKey:0}},beforeMount(){const e=this;this.options={headings:{size:this.lang("size"),name:this.lang("attachment_name"),type:this.lang("type"),created_at:this.lang("created_at"),action:this.lang("actions")},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},columnsClasses:{owner:"attachment-owner",size:"attachment-size",value:"attachment-value",type:"attachment-type",created_at:"attachment-created",action:"attachment-action"},texts:{filter:"",limit:""},templates:{created_at(t,s){return e.formattedTime(s.created_at)},action:(t,s)=>{const{view_url:d,...a}=s;return a.client_view_url=s.view_url,e.h(qe,{data:a})}},sortable:["owner","size","name","type","created_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-by":t.orderBy,order:t.ascending?"asc":"desc","search-query":t.query.trim(),id:this.assetId,page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(d=>(d.delete_url=`service-desk/api/asset/attachment-delete/${d.id}`,d)),count:t.data.total}}}},mounted(){this.$refs.uploadModal.addEventListener("hidden.bs.modal",()=>{this.selectedFile=null})},methods:{openUploadModal(){this.$refs.uploadModal.classList.add("show"),this.$refs.uploadModal.style.display="block"},closeUploadModal(){this.$refs.uploadModal.classList.remove("show"),this.$refs.uploadModal.style.display="none",this.selectedFile=null,this.$refs.fileInput.value=""},handleFileUpload(e){this.selectedFiles=Array.from(e.target.files)},uploadFile(){if(this.selectedFiles.length>0){const e=new FormData;for(let t=0;t<this.selectedFiles.length;t++)e.append("attachments[]",this.selectedFiles[t]);T.post(`service-desk/api/attach-asset-attachment/${this.assetId}`,e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{K(t,"asset-view"),this.closeUploadModal(),this.selectedFiles=[],this.$refs.fileInput.value="",this.tableKey++}).catch(t=>{this.closeUploadModal(),O(t,"asset-view"),console.error("Error uploading files",t)})}},handelLoader(e){this.$emit("loaderValue",e)}},components:{DataTableActions:qe}},_f={id:"org-list",class:"col-sm-12"},ff={class:"card card-light"},gf={class:"card-header"},bf={class:"card-title"},yf={class:"card-body",id:"my_attachments"},vf={class:"modal fade",ref:"uploadModal",id:"uploadModal",tabindex:"-1",role:"dialog","aria-labelledby":"uploadModalLabel","aria-hidden":"true"},wf={class:"modal-dialog pt-4",role:"document"},kf={class:"modal-content box-modal"},Cf={class:"modal-header"},Df={class:"modal-title",id:"uploadModalLabel"},Sf={class:"modal-body"},Mf={class:"modal-footer"};function Ff(e,t,s,d,a,i){const m=u("alert"),h=u("data-table");return o(),l("div",_f,[_(m,{componentName:"dataTableModal"}),n("div",ff,[n("div",gf,[n("h3",bf,r(e.lang("attachment_list")),1)]),n("div",yf,[n("a",{onClick:t[0]||(t[0]=(...b)=>i.openUploadModal&&i.openUploadModal(...b)),class:"btn btn-primary"},r(e.lang("upload_file")),1),n("div",vf,[n("div",wf,[n("div",kf,[n("div",Cf,[n("h5",Df,r(e.lang("upload_file")),1),n("button",{type:"button",class:Q(["close",["btn-close mb-3",{"ms-auto":e.language!=="ar","me-auto":e.language==="ar"}]]),"data-bs-dismiss":"modal","aria-label":"Close",onClick:t[1]||(t[1]=(...b)=>i.closeUploadModal&&i.closeUploadModal(...b))},null,2)]),n("div",Sf,[_(m,{componentName:"attachmentModal"}),n("input",{type:"file",ref:"fileInput",onChange:t[2]||(t[2]=(...b)=>i.handleFileUpload&&i.handleFileUpload(...b)),accept:"*",multiple:""},null,544)]),n("div",Mf,[n("button",{type:"button",class:"btn btn-secondary",onClick:t[3]||(t[3]=(...b)=>i.closeUploadModal&&i.closeUploadModal(...b))},r(e.lang("cancel")),1),n("button",{type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=(...b)=>i.uploadFile&&i.uploadFile(...b))},r(e.lang("upload")),1)])])])],512),t[5]||(t[5]=n("br",null,null,-1)),t[6]||(t[6]=n("br",null,null,-1)),(o(),k(h,{url:a.apiUrl,dataColumns:a.columns,option:a.options,scroll_to:"attachment_list",key:a.tableKey,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","onLoaderState","disableLoader"]))])])])}const If=P(pf,[["render",Ff],["__scopeId","data-v-6c27c263"]]),Af={name:"AssociatedLicenseList",description:"Associated contracts data table page",setup(){const e=re();return{formattedDate:z(()=>e.getters.formattedDate),formattedTime:z(()=>e.getters.formattedTime)}},props:{assetId:{type:[String,Number],default:""},disableLoader:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_license",apiUrl:null,columns:null,options:null}},beforeMount(){this.apiUrl="/service-desk/api/software-license-list?asset_ids="+this.assetId;const e=this;this.columns=["name","license_key","purchase_order_number","licensed_to_email","version","purchase_date","renewal_date","expiration_date"],this.options={texts:{filter:"",limit:""},headings:{name:this.lang("name"),license_key:this.lang("license_key"),purchase_order_number:this.lang("purchase_order_number"),licensed_to_email:this.lang("licensed_to_email"),version:this.lang("version"),purchase_date:this.lang("purchase_date"),renewal_date:this.lang("renewal_date"),expiration_date:this.lang("expiration_date")},columnsClasses:{name:"license-name",license_key:"license-key",purchase_order_number:"license-purchase-order",licensed_to_email:"licensed-email",version:"license-version",purchase_date:"license-purchase-date",renewal_date:"license-renewal-date",expiration_date:"license-expiration-date"},templates:{name:(t,s)=>e.h(Gt,{data:s}),license_key:(t,s)=>s.license_key?s.license_key:"--",purchase_order_number:(t,s)=>s.purchase_order_number?s.purchase_order_number:"--",licensed_to_email:(t,s)=>s.licensed_to_email?s.licensed_to_email:"--",version:(t,s)=>s.version?s.version:"--",purchase_date:function(t,s){return e.formattedTime(s.purchase_date)},renewal_date:function(t,s){return e.formattedTime(s.renewal_date)},expiration_date:function(t,s){return e.formattedTime(s.expiration_date)}},filterable:["name"],sortable:["name","license_key","purchase_order_number","licensed_to_email","version","purchase_date","renewal_date","expiration_date"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}},orderBy:{column:"name",ascending:!0}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},components:{"license-name":Gt}},Pf={id:"associated-contracts"};function Tf(e,t,s,d,a,i){const m=u("data-table");return o(),l("div",Pf,[_(m,{url:a.apiUrl,dataColumns:a.columns,option:a.options,scroll_to:"associated-contracts",onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","onLoaderState","disableLoader"])])}const Vf=P(Af,[["render",Tf]]);const Lf={name:"create-edit-asset-component-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},assetId:{type:[String,Number],default:""},assetCompId:{type:[String,Number],default:""},scenario:{type:String,default:"create"},reloadDetails:{type:Function},selectedCategoryValue:{type:Object,default:()=>{}}},data(){return{formUniqueKey:"",submitFormInProgress:!1,scenario:this.scenario,panel:"agent",selectedCategory:this.selectedCategoryValue,categorySelected:!1,fetchFormFieldApi:""}},beforeMount(){this.scenario==="edit"&&(this.fetchFormFieldApi="/service-desk/api/edit-associate-asset-components/"+this.assetCompId,this.categorySelected=!0)},mixins:[Xe],methods:{onChange(e,t){this[t]=e,this.categorySelected=!1,this.updateFetchApi()},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?category="+this.selectedCategory.category+"&mode=render&&panel=agent&model_id="+this.assetId,setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario}),this.categorySelected=!0},1)},popUpSubmit(){document.getElementById("asset-comp--submit").click()},formSubmit(e,t){this.$store.dispatch("setRecaptchaKey",t),this.onSubmit()},afterSubmit(e){window.emitter.emit("reset-captcha"),setTimeout(()=>{this.reloadDetails(),this.onClose()},1e3)}},beforeDestroy(){this.$store.dispatch("unsetAlert")},components:{DynamicSelect:fe,Alert:We,Modal:Xt,CustomLoader:nt,Loader:ya,FormWithCaptcha:Zt,FormRenderer:Ze}},Uf={class:"modal-title"},Nf={key:1,class:"form_select"},Ef={id:"ticket_modal_body"},xf=["disabled"];function Of(e,t,s,d,a,i){const m=u("CustomLoader"),h=u("Alert"),b=u("Loader"),f=u("DynamicSelect"),g=u("FormRenderer"),D=u("ValidationObserver"),M=u("FormWithCaptcha"),x=u("Modal");return o(),l("div",null,[a.submitFormInProgress?(o(),k(m,{key:0})):c("",!0),s.showModal?(o(),k(x,{key:1,showModal:s.showModal,onClose:s.onClose,containerStyle:{width:"1200px",maxWidth:"1200px !important"}},{title:w(()=>[n("h4",Uf,r(a.scenario==="create"?e.trans("add_new_component"):e.trans("edit_component")),1)]),alert:w(()=>[_(h,{componentName:"faveo-form"})]),fields:w(()=>[e.showLoader?(o(),k(b,{key:0})):c("",!0),!e.showLoader&&a.scenario==="create"?(o(),l("div",Nf,[_(f,{label:e.trans("select_category"),multiple:!1,name:"selectedCategory",apiEndpoint:"service-desk/api/asset-components/"+s.assetId,value:a.selectedCategory,onChange:i.onChange,clearable:!1},null,8,["label","apiEndpoint","value","onChange"])])):c("",!0),n("div",Ef,[a.formUniqueKey&&a.categorySelected&&a.fetchFormFieldApi?(o(),k(M,{key:0,loading:!e.showLoader,btnClass:"btn btn-primary pull-right",btnName:"submit",componentName:"faveo-form",page:"asset_add_agent",btn_id:"asset-comp--submit",formSubmit:i.formSubmit,recaptchaContainerClass:"mt-2",disableSubmit:a.submitFormInProgress},{fields:w(()=>[_(D,{ref:"faveoFormObserver"},{default:w(({values:R,errors:V,validate:N})=>[_(g,{category:a.selectedCategory.category,fetchFormFieldApi:a.fetchFormFieldApi,scenario:a.scenario,panel:a.panel,isInlineForm:!1,formUniqueKey:a.formUniqueKey,selectDependencyId:s.assetCompId,selectDependencyKey:"id"},null,8,["category","fetchFormFieldApi","scenario","panel","formUniqueKey","selectDependencyId"])]),_:1},512)]),_:1},8,["loading","formSubmit","disableSubmit"])):c("",!0)])]),controls:w(()=>[e.showLoader?c("",!0):(o(),l("button",{key:0,type:"button",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=R=>i.popUpSubmit())},[n("i",{class:Q(a.scenario==="create"?"fas fa-save":"fas fa-sync")},null,2),v(" "+r(a.scenario==="create"?e.trans("save"):e.trans("update")),1)],8,xf))]),_:1},8,["showModal","onClose"])):c("",!0)])}const qf=P(Lf,[["render",Of],["__scopeId","data-v-17e15083"]]);const jf={class:"asset-components"},Rf={id:"asset_components"},Bf={class:"row mb-3"},zf={class:"col-sm-2 add_comp"},Kf={class:"card"},Hf={class:"card-body"},Yf={key:0,class:"asset-comp"},$f={class:"table table-bordered"},Wf={key:0},Jf=["rowspan"],Gf={class:"custom-field-list"},Xf={class:"row"},Zf={class:"col-sm-11"},Qf={class:"comp-tools col-sm-1"},eg=["onClick"],tg=["onClick"],sg={class:"custom-field-list"},ag={class:"row"},ng={class:"col-sm-11"},og={class:"comp-tools col-sm-1"},ig=["onClick"],lg=["onClick"],rg={key:1,class:"no-asset-comp"},dg={class:"text-center text-muted"},cg={__name:"AssetComponentsIndex",props:{assetId:{type:[String,Number],default:""}},setup(e){const t=re(),s=e,d=se(!1),a=se([]),i=se(!1);let m=!0,h=1;const b=se(null),f=se("create"),g=se(null),D=(Y="",ae)=>{t.dispatch("unsetAlert"),g.value=Y.id,b.value=Y.category,f.value=ae,d.value=!0},M=()=>{g.value=null,b.value="",f.value="create",d.value=!1,N.value=!1},x=()=>{a.value=[],h=1,m=!0,R()},R=()=>{i.value=!0,T.get(`/service-desk/api/associate-asset-components/${s.assetId}?page=${h}`).then(Y=>{var ne,_e;const ae=(_e=(ne=Y==null?void 0:Y.data)==null?void 0:ne.data)==null?void 0:_e.data;Array.isArray(ae)&&ae.length>0?(a.value=a.value.concat(ae),h++):m=!1}).catch(Y=>{console.log("Error fetching data:",Y)}).finally(()=>{i.value=!1})},V=()=>{const Y=document.getElementById("comp-container"),ae=Y.scrollHeight,ne=Y.scrollTop,_e=Y.clientHeight;ne+_e>=ae-100&&!i.value&&m&&R()},N=se(!1),j=Y=>{t.dispatch("unsetAlert"),g.value=Y.id,N.value=!0};return Qe(()=>{R()}),window.emitter.on("entryDeleted",x),(Y,ae)=>{const ne=W("tooltip");return o(),l("div",jf,[_(We,{componentName:"asset-components"}),n("div",Rf,[n("div",Bf,[n("div",zf,[n("button",{type:"button",class:"btn btn-light",onClick:ae[0]||(ae[0]=Wt(_e=>D("","create"),["prevent"]))},[ae[2]||(ae[2]=n("i",{class:"glyphicon glyphicon-plus"},null,-1)),v(" "+r(Y.trans("add_component")),1)])]),ae[3]||(ae[3]=n("div",{class:"col-sm-10"},null,-1)),_(X,{name:"modal"},{default:w(()=>[d.value?(o(),k(qf,{key:0,onClose:M,showModal:d.value,assetId:e.assetId,selectedCategoryValue:b.value,scenario:f.value,assetCompId:g.value,reloadDetails:x},null,8,["showModal","assetId","selectedCategoryValue","scenario","assetCompId"])):c("",!0)]),_:1})]),n("div",Kf,[n("div",Hf,[n("div",{id:"comp-container",onScroll:V},[a.value.length>0?(o(),l("div",Yf,[n("table",$f,[(o(!0),l(U,null,$(a.value,(_e,Oe)=>(o(),l(U,{key:"comp_"+Oe},[_e.length?(o(),l("tr",Wf,[n("th",{class:"w_30",rowspan:_e.length},r(_e[0].name),9,Jf),n("td",Gf,[n("div",Xf,[n("div",Zf,[(o(!0),l(U,null,$(_e[0].custom_field_values,ve=>(o(),l(U,null,[n("strong",null,r(ve.label)+" : ",1),n("span",null,r(ve.value),1),ae[4]||(ae[4]=n("br",null,null,-1))],64))),256))]),n("div",Qf,[S(n("i",{class:"fas fa-trash comp-delete",onClick:ve=>j(_e[0]),"aria-hidden":"true"},null,8,eg),[[ne,Y.lang("remove")]]),ae[5]||(ae[5]=v("   ")),S(n("i",{class:"fas fa-pencil-alt pointer",onClick:ve=>D(_e[0],"edit"),"aria-hidden":"true"},null,8,tg),[[ne,Y.lang("edit")]])])])])])):c("",!0),_e.length>1?(o(!0),l(U,{key:1},$(_e.slice(1),ve=>(o(),l("tr",null,[n("td",sg,[n("div",ag,[n("div",ng,[(o(!0),l(U,null,$(ve.custom_field_values,Pe=>(o(),l(U,null,[n("strong",null,r(Pe.label)+" : ",1),n("span",null,r(Pe.value),1),ae[6]||(ae[6]=n("br",null,null,-1))],64))),256))]),n("div",og,[S(n("i",{class:"fas fa-trash comp-delete",onClick:Pe=>j(ve),"aria-hidden":"true"},null,8,ig),[[ne,Y.lang("remove")]]),ae[7]||(ae[7]=v("   ")),S(n("i",{class:"fas fa-pencil-alt",onClick:Pe=>D(ve,"edit"),"aria-hidden":"true"},null,8,lg),[[ne,Y.lang("edit")]])])])])]))),256)):c("",!0)],64))),128))])])):c("",!0),!a.value.length&&!i.value?(o(),l("div",rg,[n("h2",dg,r(Y.trans("no-components-found")),1),n("button",{type:"button",class:"btn btn-light mt-3",onClick:ae[1]||(ae[1]=Wt(_e=>D("","create"),["prevent"]))},r(Y.trans("add_component")),1)])):c("",!0)],32)])])]),N.value?(o(),k(ot,{key:0,onClose:M,showModal:N.value,deleteUrl:"/service-desk/api/associate-asset-components/"+g.value,alertComponentName:"asset-components","modal-message":"are_you_sure_you_want_to_delete"},null,8,["showModal","deleteUrl"])):c("",!0)])}}},ug=P(cg,[["__scopeId","data-v-717ad229"]]);const mg={name:"asset-associates",description:"Asset associates page",props:{assetId:{type:[String,Number],default:""}},data(){return{tabs:"",category:"activity",loading:!0,counter:0,dynamicKeys:{activity:1,relationships:1,attachment:1,license:1,components:1}}},beforeMount(){this.getActionsList()},created(){window.emitter.on("updateAssetAssociates",this.updateAssociates),window.emitter.on("updateAssetTables",()=>this.associates("activity")),this.$store.dispatch("setAssetAssociateCategory",this.category)},computed:{columns(){switch(this.category){case"problem":return["identifier","subject","requester","assignedTo","priority","department","status_type_id","action"];case"change":return["identifier","subject","requester","status","priority","department","created_at","action"];case"release":return["identifier","subject","release_type","priority","status","planned_start_date","planned_end_date","action"];case"contract":return["identifier","name","cost","expiry","contract_status","contract_renewal_status","vendor","contract_type","action"];case"ticket":return["ticket_number","title","assigned","action"]}},filterable(){switch(this.category){case"problem":return["subject","identifier"];case"change":return["identifier","subject","requester","status","priority","department"];case"release":return["identifier","subject","release_type","priority","status","planned_start_date","planned_end_date"];case"contract":return["identifier","name","cost","expiry","contract_status","contract_renewal_status","vendor","contract_type"];case"ticket":return["ticket_number"]}},sortable(){switch(this.category){case"problem":return["subject","identifier"];case"change":return["identifier","subject","created_at"];case"release":return["subject","identifier","planned_start_date","planned_end_date"];case"contract":return["identifier","name","contract_number","expiry","cost"];case"ticket":return["ticket_number"]}}},methods:{getActionsList(){T.get("/service-desk/api/asset-action/"+this.assetId).then(e=>{let t=e.data.data.asset_actions;this.$emit("actions-loaded",t),this.tabs=[{id:"activity",title:"activity_log",show:!0},{id:"attachment",title:"attachments",show:!0},{id:"relationships",title:this.trans("relationships"),show:!0},{id:"license",title:"associated_license",show:!0},{id:"components",title:"components",show:t.asset_component},{id:"problem",title:"associated_problems",show:t.associated_problems_tab_viewable},{id:"change",title:"associated_changes",show:t.associated_changes_tab_viewable},{id:"release",title:"associated_releases",show:t.associated_releases_tab_viewable},{id:"contract",title:"associated_contracts",show:t.associated_contracts_tab_viewable},{id:"ticket",title:"associated_tickets",show:t.associated_tickets_tab_viewable}]}).catch(e=>{this.tabs=[]})},updateAssociates(e){window.emitter.emit("updateAssetView")},associates(e){this.category!==e&&(this.loading=!0,this.category=e),this.updateKey(e)},handelLoader(e){this.loading=e},updateKey(e){this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setAssetAssociateCategory",e)}},components:{AssetAttachment:If,"asset-activity":c_,"asset-relation":hf,"asset-associate-table":w_,"asset-license-table":Vf,"asset-components":ug}},hg={class:"card-header p-0 pt-1"},pg={class:"nav nav-tabs"},_g={key:0,class:"nav-item"},fg=["onClick"],gg={key:0,class:"nav-item ms-auto mt-04"},bg={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},yg={class:"card-body"},vg={class:"tab-content"},wg={class:"active tab-pane",id:"activity"};function kg(e,t,s,d,a,i){const m=u("alert"),h=u("asset-components"),b=u("asset-activity"),f=u("asset-relation"),g=u("asset-attachment"),D=u("asset-license-table"),M=u("asset-associate-table");return a.tabs?(o(),l("div",{id:"asset-associates",class:"card card-light card-tabs",key:a.counter},[_(m,{componentName:"assetAssociates"}),n("div",hg,[n("ul",pg,[(o(!0),l(U,null,$(a.tabs,x=>(o(),l(U,null,[x.show?(o(),l("li",_g,[n("a",{id:"asset_tab",class:Q(["nav-link",{active:a.category===x.id}]),"data-bs-toggle":"pill",onClick:R=>i.associates(x.id)},r(e.trans(x.title)),11,fg)])):c("",!0)],64))),256)),a.category!=="components"?(o(),l("li",gg,[a.loading?(o(),l("a",bg,t[0]||(t[0]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])):c("",!0)])]),n("div",yg,[n("div",vg,[n("div",wg,[a.category==="components"?(o(),k(h,{assetId:s.assetId,onLoaderValue:i.handelLoader,key:"asset_components"+a.dynamicKeys.components},null,8,["assetId","onLoaderValue"])):a.category==="activity"?(o(),k(b,{assetId:s.assetId,onLoaderValue:i.handelLoader,key:"asset_activity"+a.dynamicKeys.activity},null,8,["assetId","onLoaderValue"])):a.category==="relationships"?(o(),k(f,{assetId:s.assetId,onLoaderValue:i.handelLoader,key:"asset_relation"+a.dynamicKeys.relationships},null,8,["assetId","onLoaderValue"])):a.category==="attachment"?(o(),k(g,{assetId:s.assetId,disableLoader:"true",onLoaderValue:i.handelLoader,key:"asset_attachment"+a.dynamicKeys.attachment},null,8,["assetId","onLoaderValue"])):a.category==="license"?(o(),k(D,{assetId:s.assetId,disableLoader:"true",onLoaderValue:i.handelLoader,key:"asset_license"+a.dynamicKeys.license},null,8,["assetId","onLoaderValue"])):(o(),k(M,{category:a.category,columns:i.columns,assetId:s.assetId,sortable:i.sortable,filterable:i.filterable,componentTitle:"Asset"+a.category,disableLoader:"true",onLoaderValue:i.handelLoader,key:"asset_associates"+a.category},null,8,["category","columns","assetId","sortable","filterable","componentTitle","onLoaderValue"]))])])])])):c("",!0)}const Cg=P(mg,[["render",kg],["__scopeId","data-v-1fad7061"]]);const Dg={name:"asset-view",description:"Asset view page",computed:{assetId(){return pe(this.currentPath())}},data(){return{loading:!1,counter:0,actionsData:{}}},created(){window.emitter.on("updateAssetView",()=>{this.counter++})},methods:{handelActions(e){this.actionsData=e}},components:{"asset-details":qp,"asset-associates":Cg}};function Sg(e,t,s,d,a,i){const m=u("alert"),h=u("asset-details"),b=u("asset-associates");return o(),l("div",{class:"col-sm-12",key:a.counter},[_(m,{componentName:"asset-view"}),_(h,{actionsData:a.actionsData,assetId:i.assetId},null,8,["actionsData","assetId"]),_(b,{actionsData:a.actionsData,onActionsLoaded:i.handelActions,assetId:i.assetId},null,8,["actionsData","onActionsLoaded","assetId"])])}const Mg=P(Dg,[["render",Sg]]);const Fg={id:"filter-div",class:"card-tools"},Ig={type:"button",class:"btn btn-tool dropdown-toggle","data-bs-toggle":"dropdown",id:"labels-button"},Ag={key:0,class:"nav-item"},Pg={class:"form-group has-feedback has-search filter_div"},Tg=["placeholder"],Vg=["onClick","id"],Lg={key:0,class:"fa fa-check field_select"},Ug={id:"field_title"},Ng={key:1},Eg={class:"text-center"},xg={key:2,class:"field_loader nav-item"},Og={__name:"ModuleCustomFieldFilter",props:{updateFilterFields:{type:Function,default:()=>{}},selectedFilterFields:{type:Array,default:()=>[]},endPoint:{type:String,required:!0},filterId:{type:[String,Number],default:""}},setup(e,{expose:t}){const s=e,d=se([]),a=se(!0);let i=s.selectedFilterFields;const m=se("");let h=!0,b=1,f=[];const g=z(()=>d.value.filter(j=>j.label.toLowerCase().includes(m.value.toLowerCase()))),D=fs.debounce(()=>{const j=document.getElementById("filter-dropdown"),Y=j.scrollHeight,ae=j.scrollTop,ne=j.clientHeight;ae+ne>=Y-100&&!a.value&&h&&V()},200),M=()=>{i=[]},x=j=>Ie(j,30),R=j=>{if(i.map(ae=>ae.id).includes(j.id)){for(var Y in i)if(i[Y].id===j.id){i.splice(Y,1);break}}else j.name="custom_"+j.id,j.isCustom=!0,j.value="",j.className="col-sm-4",i.push(JSON.parse(JSON.stringify(j)));s.updateFilterFields(i)},V=async()=>{try{a.value=!0;let ne=location.search.substring(1),_e,Oe;ne&&(_e=JSON.parse('{"'+decodeURI(ne).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"').replace(/%2F/g,"/")+'"}')),_e&&(Oe=Object.keys(_e).find(Ke=>Ke.includes("custom_")));let ve={page:b,time:Date.now(),module:"filter",filter_id:s.filterId,filter_key:Oe||""};const Pe=await T.get(s.endPoint,{params:ve});if(Pe.data.data.data.length>0){if(d.value=[...d.value,...Pe.data.data.data],d.value.length)for(var j in d.value){if(f.length)for(var Y in f)f[Y].key===d.value[j].key&&(d.value[j].name=f[Y].key,d.value[j].isCustom=!0,d.value[j].className="col-sm-4",d.value[j].value||(d.value[j].data_type==="checkbox"?d.value[j].value=f[Y].value.split(","):d.value[j].value=f[Y].value,i.some(Ke=>Ke.key===d.value[j].key)||i.push(d.value[j]),i.length===f.length&&s.updateFilterFields(i)));for(var ae in i)i[ae].id===d.value[j].id&&(d.value[j].value=i[ae].value)}b++}else h=!1}catch(ne){console.error("Error fetching data:",ne)}finally{a.value=!1}},N=j=>{f=j};return Qe(()=>{setTimeout(()=>{V()},1e3)}),t({getCustomFields:N}),window.emitter.on("clearCustomFields",M),(j,Y)=>{const ae=u("loader"),ne=W("tooltip");return o(),l("div",Fg,[S((o(),l("button",Ig,Y[3]||(Y[3]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)]))),[[ne,j.trans("add_custom_field")]]),n("ul",{id:"filter-dropdown",class:"dropdown-menu dropdown-menu-right filter_menu",onClick:Y[1]||(Y[1]=_e=>_e.stopPropagation()),onScroll:Y[2]||(Y[2]=_e=>we(D)())},[a.value?c("",!0):(o(),l("li",Ag,[n("div",Pg,[S(n("input",{type:"text",class:"form-control",name:"label",placeholder:j.trans("search"),"onUpdate:modelValue":Y[0]||(Y[0]=_e=>m.value=_e)},null,8,Tg),[[ca,m.value]])])])),(o(!0),l(U,null,$(g.value,(_e,Oe)=>S((o(),l("li",{class:"nav-item fields",onClick:ve=>R(_e),id:"filter-field-"+Oe},[n("a",{class:Q(["nav-link custom-filter-nav-item",{active:we(i).map(ve=>ve.id).includes(_e.id)}]),href:"javascript:;"},[we(i).map(ve=>ve.id).includes(_e.id)?(o(),l("i",Lg)):c("",!0),n("span",Ug,r(x(_e.label)),1)],2)],8,Vg)),[[ne,_e.hover?_e.hover:j.trans(_e.label)]])),256)),!a.value&&d.value.length===0?(o(),l("li",Ng,[n("p",Eg,r(j.trans("no_results_found")),1)])):c("",!0),a.value?(o(),l("li",xg,[_(ae,{size:30,duration:4e3,color:"#1d78ff"})])):c("",!0)],32)])}}},qg=P(Og,[["__scopeId","data-v-5f379551"]]),js="label",jg={__name:"ModuleCustomFields",props:{formField:{type:Object,required:!0},allFields:{type:Array,default:()=>[]},classname:{type:String,default:"col-sm-6"}},emits:["updated"],setup(e,{emit:t}){const s=e;let d=s.formField.value,a=s.formField.key,i=s.allFields;Ps(()=>s.allFields,(V,N)=>{i=V}),Ps(()=>s.formField,(V,N)=>{a=V.key,d=V.value,V.data_type==="checkbox"&&(d=Array.isArray(d)?d:d.split(","))});const m=z(()=>{var N;let V=(N=ut.convertStringOfPropertiesToObject(s.formField.api_info))==null?void 0:N.url;return!V&&s.formField.api_info&&(V=s.formField.api_info),V});z(()=>{var V;return((V=ut.convertStringOfPropertiesToObject(s.formField.api_info))==null?void 0:V.key)||"label"});const h=z(()=>{let V=i.findIndex(N=>N.key===a);if(s.formField.data_type==="mobile"&&d&&d.includes(" ")){const N=d.split(" ");if(N.length>1)return N.shift(),N.join(" ")}if(V!==-1)if(Array.isArray(d)&&d!=null){let N=[];return d.forEach(j=>{typeof j=="object"?N.push(j.label):N.push(j)}),i[V].value=N.map(j=>j).toString(),i[V].options.filter(j=>N.includes(j.label))}else if(Re(i[V].options)){let N="";return typeof d=="object"?N=d.label:N=d,i[V].options.find(j=>j.label===N)}else return d||"";else return d}),b=t,f=(V,N)=>{s.formField.data_type==="number"&&V===0&&(V="0");let j=i.findIndex(Y=>Y.key===N);Array.isArray(V)&&V!=null?(i[j].value=V.map(Y=>Y.label).toString(),d=V):typeof V=="object"&&V!=null?(i[j].value=V[js],d=V):s.formField.data_type==="mobile"?(i[j].value=V?M.value+" "+V:"",d=V?M.value+" "+V:""):(i[j].value=V||"",d=V||""),b("updated",i)},g=(V,N,j)=>{if(j==="number"||j==="mobile"){V=V||window.event;var Y=V.which?V.which:V.keyCode;if(Y>31&&(Y<48||Y>57))V.preventDefault();else return!0}else if(j==="float"||j==="decimal"){V=V||window.event;var Y=V.which?V.which:V.keyCode,ae=V.target.value;if(Y==46&&ae.indexOf(".")!==-1||Y==46&&ae.length===0)V.preventDefault();else{if(Y>=48&&Y<=57||Y==46)return!0;V.preventDefault()}}},D=(V,N,j)=>{if(j==="number"||j==="mobile")V=V||window.event,V.clipboardData.getData("Text").match(/[^\d]/)&&V.preventDefault();else if(j==="float"||j==="decimal"){V=V||window.event;var Y=V.clipboardData||window.clipboardData,ae=Y.getData("Text");/^[-]?\d*\.?\d*$/.test(ae)||V.preventDefault()}},M=se(null),x=se(!1),R=(V,N)=>{N==="country_code"&&(M.value=V)};return Qe(()=>{s.formField.data_type==="mobile"&&s.formField.value&&s.formField.value.includes(" ")&&(M.value=s.formField.value.split(" ")[0]),x.value=!0}),(V,N)=>(o(),l("div",{class:Q(e.classname)},[e.formField.data_type==="date"?(o(),k(es,{key:0,type:e.formField.request_time_information?"datetime":"date",label:e.formField.label,value:h.value,id:e.formField.key,required:!1,name:e.formField.key,onChange:f,format:e.formField.request_time_information?"MMMM DD YYYY HH:mm:ss":"MMMM DD YYYY",clearable:!0,outputFormat:"YYYY-MM-DD HH:mm:ss"},null,8,["type","label","value","id","name","format"])):c("",!0),e.formField.data_type==="select"?(o(),k(fe,{key:1,id:e.formField.key,label:e.formField.label,multiple:!1,name:e.formField.key,apiEndpoint:m.value,value:h.value,onChange:f,optionLabel:js},null,8,["id","label","name","apiEndpoint","value"])):c("",!0),e.formField.data_type==="text"||e.formField.data_type==="textarea"||e.formField.data_type==="number"||e.formField.data_type==="decimal"||e.formField.data_type==="email"?(o(),k(Ae,{key:2,id:e.formField.key,label:e.formField.label,type:e.formField.data_type,name:e.formField.key,value:h.value,onChange:f,from:"filter",keypressEvt:g,pasteEvt:D},null,8,["id","label","type","name","value"])):c("",!0),e.formField.data_type==="radio"?(o(),k(ga,{key:3,name:e.formField.key,label:e.formField.label,options:e.formField.options,value:h.value,onChange:f,from:"filter"},null,8,["name","label","options","value"])):c("",!0),e.formField.data_type==="checkbox"?(o(),k(ba,{key:4,name:e.formField.key,label:e.formField.label,options:e.formField.options,value:h.value,onChange:f,from:"filter"},null,8,["name","label","options","value"])):c("",!0),x.value&&e.formField.data_type==="mobile"?(o(),k(ua,{key:5,fieldFor:"automator",id:e.formField.key,label:e.formField.label,type:e.formField.data_type,name:e.formField.key,value:h.value,onChange:f,isInlineForm:!1,countryCode:M.value,onCountryCode:N[0]||(N[0]=j=>R(j,"country_code")),keypressEvt:g,pasteEvt:D,extensionEnabled:0,ext:[]},null,8,["id","label","type","name","value","countryCode"])):c("",!0)],2))}};const Rg={key:0,class:"card-body"},Bg={key:1,id:"module-table-filter"},zg={class:"row"},Kg={class:"card-footer"},ys={__name:"ModuleFilter",props:{metaData:{type:Array,required:!0},appliedFilters:{type:Object,default:()=>{}},from:{type:String,default:""},showCustomFilter:{type:Boolean,default:!1},updateFields:{type:Function,default:()=>{}},selectedFields:{type:Array,default:()=>[]},endPoint:{type:String,default:""},saveFilter:{type:Boolean,default:!1},filterFor:{type:String,default:""},filterNum:{type:[String,Number],default:""},redirectTo:{type:String,default:""},deleteUrl:{type:String,default:""},closeFilter:{type:Function,default:()=>{}},save_endpoint:{type:String,default:""},parsedUrlParams:{type:Object,default:()=>{}}},emits:["selectedFilters"],setup(e,{emit:t}){const s=e;let d=s.appliedFilters;s.multiple,se(!1);let a=s.metaData;const i=se(!1),m=se({width:"49.5%"}),h=se({width:"20%"}),b=se(!1),f=se("");let g=s.filterNum;const D=se([]),M=se([]),x=se(""),R=se(""),V=se(!1),N=ye=>{for(var Se in ye)Y(ye[Se].value,ye[Se].name)},j=()=>{s.updateFields(s.selectedFields);for(var ye in s.selectedFields)Y(s.selectedFields[ye].value,s.selectedFields[ye].name)},Y=(ye,Se)=>{d[Se]=ye},ae=t,ne=()=>{ae("selectedFilters","closeEvent")},_e=()=>{ae("selectedFilters",d)},Oe=ye=>{x.value=ye,b.value=!0},ve=ye=>{b.value=ye},Pe=()=>{d={},i.value=!0,setTimeout(()=>{i.value=!1},1e3),ae("selectedFilters","resetEvent")},Ke=(ye,Se)=>{i.value=!0,axios.get(ye,{params:s.parsedUrlParams}).then(Ve=>{let me={},et=[];(Se==="filter"?Ve.data.data.fields:Ve.data.data).map(Be=>{Be.key.indexOf("custom_")!==-1?(et.push(Be),me[Be.key]=Be.value):me[Be.key]=Be.value_meta}),et.length?Vt(et):i.value=!1,d=me,a.map(function(Be){Be.section.map(function(Le){me.hasOwnProperty(Le.name)&&(Le.value=me[Le.name])})}),V.value=Ve.data.data.is_default,g=Ve.data.data.id,f.value=V.value?"":Ve.data.data.name,R.value=!V.value&&Ve.data.data.icon_class?{icon_class:Ve.data.data.icon_class}:"",D.value=Ve.data.data.departments,M.value=Ve.data.data.agents}).catch(Ve=>{console.error(Ve),i.value=!1})},it=se(null),Vt=ye=>{it.value.getCustomFields(ye),setTimeout(()=>{i.value=!1},100)};return Qe(()=>{j();const ye=at();s.filterNum?Ke("/service-desk/api/agent/sd-filter/"+g,"filter"):ye&&ye.hasOwnProperty("filter-by-url")&&Ke("/service-desk/api/filter-dependencies","urlFilter")}),(ye,Se)=>(o(),k(wt,{"box-class":"card card-light ",title:ye.lang("filter")},{customActions:w(()=>[e.showCustomFilter?(o(),k(qg,{key:0,updateFilterFields:e.updateFields,selectedFilterFields:e.selectedFields,endPoint:e.endPoint,ref_key:"moduleTableFilter",ref:it,filterId:we(g)},null,8,["updateFilterFields","selectedFilterFields","endPoint","filterId"])):c("",!0)]),actions:w(()=>[n("div",Kg,[n("button",{id:"filter-apply-btn",class:"btn btn-primary",type:"button",onClick:_e},[Se[3]||(Se[3]=n("span",{class:"fas fa-check"},null,-1)),v("  "+r(ye.trans("apply")),1)]),e.saveFilter?(o(),l(U,{key:0},[e.filterNum&&!V.value&&!i.value?(o(),l(U,{key:0},[n("button",{id:"filter-upd",class:"btn btn-primary",type:"button",onClick:Se[0]||(Se[0]=Ve=>Oe("update"))},[Se[4]||(Se[4]=n("span",{class:"fas fa-sync"},null,-1)),v("  "+r(ye.trans("update")),1)]),n("button",{id:"filetr-del",class:"btn btn-secondary",type:"button",onClick:Se[1]||(Se[1]=Ve=>Oe("delete"))},[Se[5]||(Se[5]=n("span",{class:"fas fa-trash-alt"},null,-1)),v("  "+r(ye.trans("delete")),1)])],64)):(o(),l("button",{key:1,id:"filetr-save",class:"btn btn-primary",type:"button",onClick:Se[2]||(Se[2]=Ve=>Oe("save"))},[Se[6]||(Se[6]=n("span",{class:"fas fa-save"},null,-1)),v("  "+r(ye.trans("save")),1)]))],64)):c("",!0),n("button",{id:"reset-btn",class:"btn btn-primary",type:"button",onClick:Pe},[Se[7]||(Se[7]=n("span",{class:"fas fa-undo"},null,-1)),v("  "+r(ye.trans("reset")),1)]),e.from!=="report"?(o(),l("button",{key:1,id:"filter-cancel-btn",class:"btn btn-secondary",type:"button",onClick:ne},[Se[8]||(Se[8]=n("span",{class:"fas fa-times"},null,-1)),v("  "+r(ye.trans("cancel")),1)])):c("",!0)])]),default:w(()=>[i.value?(o(),l("div",Rg,[_(ya,{"animation-duration":4e3,color:"#1d78ff",size:60})])):(o(),l("div",Bg,[(o(!0),l(U,null,$(we(a),Ve=>(o(),l("div",zg,[(o(!0),l(U,null,$(Ve.section,me=>(o(),l(U,null,[me.isCustom?(o(),k(jg,{key:0,formField:me,allFields:e.selectedFields,onUpdated:N,classname:me.className},null,8,["formField","allFields","classname"])):(o(),l(U,{key:1},[me.type!=="date"&&me.type!=="number"&&me.type!=="text"?(o(),k(fe,{key:me.name,id:me.name,name:me.name,apiEndpoint:me.url,classname:me.className,elements:me.elements,multiple:me.isMultiple,label:ye.lang(me.label),value:me.value,onChange:Y,strlength:"35",hint:ye.trans(me.hint)},null,8,["id","name","apiEndpoint","classname","elements","multiple","label","value","hint"])):c("",!0),me.type==="number"?(o(),k(ps,{label:ye.trans(me.label),formStyle:m.value,value:me.value,key:me.name,id:me.name,name:me.name,classname:me.className,type:"text",onChange:Y,min_placeholder:me.min_placeholder,max_placeholder:me.max_placeholder,required:!1},null,8,["label","formStyle","value","id","name","classname","min_placeholder","max_placeholder"])):c("",!0),me.type==="text"?(o(),k(Ae,{label:ye.trans(me.label),value:me.value,key:me.name,id:me.name,name:me.name,onChange:Y,classname:me.className,required:!1},null,8,["label","value","id","name","classname"])):c("",!0),me.type==="date"?(o(),k(hs,{label:me.label,value:me.value,type:"datetime",key:me.name,id:me.name,name:me.name,onChange:Y,range:me.range,required:!1,format:"MMMM DD YYYY, h:mm a",classname:me.className,clearable:!1,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":me.timeOptions,isDateSelector:!1,numberStyle:h.value,confirm:!0},null,8,["label","value","id","name","range","classname","time-picker-options","numberStyle"])):c("",!0)],64))],64))),256))]))),256))])),b.value?(o(),k(_s,{key:2,filterName:f.value,icon:R.value,filterValues:we(d),filterId:we(g),toggleFilterPopUp:ve,source:e.filterFor,onUpdateFilterData:_e,filterArray:we(a),intitialDepartments:D.value,initialAgents:M.value,mode:x.value,redirectTo:e.redirectTo,deleteUrl:e.deleteUrl,closeFilter:e.closeFilter,save_endpoint:e.save_endpoint,is_default:V.value},null,8,["filterName","icon","filterValues","filterId","source","filterArray","intitialDepartments","initialAgents","mode","redirectTo","deleteUrl","closeFilter","save_endpoint","is_default"])):c("",!0)]),_:1},8,["title"]))}};const Hg={name:"problem-list",description:"Problem lists table component",props:{filterIndex:{type:Boolean,default:!1}},data:()=>({parsedUrlParams:"",columns:[],hasDataPopulated:!1,filterParams:{},visibleColumns:{},staticColumns:["actions"],apiUrl:"/service-desk/api/problem-list",reportType:"problems",filterOptions:[{section:[{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems",isCustom:!1},{name:"dept_ids",url:"api/dependency/departments",label:"departments",isCustom:!1},{name:"impact_ids",url:"/service-desk/api/dependency/impacts",label:"impact_type",isCustom:!1}]},{section:[{name:"problem_statuses",url:"/service-desk/api/status/list?module=1",label:"status",isCustom:!1},{name:"location_ids",url:"api/dependency/locations",label:"location",isCustom:!1},{name:"priority_ids",url:"api/dependency/priorities",label:"priority",isCustom:!1}]},{section:[{name:"assigned_ids",url:"api/dependency/agents?meta=true",label:"assigned",isCustom:!1},{name:"asset_ids",url:"/service-desk/api/asset-list?meta=true",label:"assets",isCustom:!1},{name:"ticket_ids",url:"api/dependency/tickets",label:"tickets",isCustom:!1}]},{section:[{name:"requester_ids",url:"/api/dependency/users?meta=true",label:"requester",isCustom:!1},{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes",isCustom:!1},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1}]},{section:[]}],isShowFilter:!1,appliedFilters:{},showIcon:!1,columnData:null,problemData:null,exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[],customFields:[],problemFilterId:""}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},beforeMount(){const e=window.location.pathname;this.problemFilterId=pe(e);const t=at();t&&t.hasOwnProperty("filter-by-url")?(this.parsedUrlParams=t,It("/service-desk/api/filter-dependencies",t,{},a=>{a&&this.applyFilter(a,"dependencyFilter")},a=>{O(a)})):this.apiUrl=this.filterIndex?"/service-desk/api/problem-list?filter_id="+this.problemFilterId:"/service-desk/api/problem-list",this.filterData(),this.getProblemData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name===s.name&&(s.value=e.value)})})},getProblemData(){this.hasDataPopulated=!1,T.get("api/agent/report-config/problem-report").then(e=>{this.problemData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],O(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{Re(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.data_type==="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[5].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/problem-list?filter_id="+this.problemFilterId:"/service-desk/api/problem-list",this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e,t=""){this.appliedFilters=e;for(var s in this.customFields)this.customFields[s].value=e[this.customFields[s].name];let d="/service-desk/api/problem-list?",a=new URLSearchParams(vt(this.filterOptions,e));t==="dependencyFilter"&&Object.entries(e).forEach(([f,g])=>{f.includes("custom_")&&(a+=`${encodeURIComponent(f)}=${encodeURIComponent(g)}&`)});const m=a,h=new URLSearchParams(m),b={};for(const[f,g]of h)b[f]=g;a[a.length-1]==="&"&&(a=a.slice(0,-1)),this.apiUrl=d+a,this.exportData=this.reformatExportData(b)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[a,i,m]=d;t[i]=t[i]||[],t[i][m]=parseInt(e[s],10)}else t[s]=e[s].trim()}return t},exportReport(){this.loading=!0;const e={...this.exportData,total:this.dataCount};let t={};this.filterIndex&&(t.filter_id=this.problemFilterId);const s={...this.exportData,...t,total:this.dataCount};T.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:e).then(d=>{K(d,"dataTableModal")}).catch(d=>{O(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.problemFilterId};this.$router.push({path:"/reports/schedule/add/"+this.problemData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{ModuleFilter:ys,"dynamic-datatable":Tt,"user-column-list":Pt}},Yg={class:"col-sm-12"},$g={key:0,class:"card card-light"},Wg={class:"card-header"},Jg={id:"problem-list",class:"card-title"},Gg={class:"card-tools"},Xg={class:"card-body",id:"problems_list"};function Zg(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("ModuleFilter"),f=u("user-column-list"),g=u("dynamic-datatable"),D=W("tooltip");return o(),l("div",Yg,[_(m,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",$g,[n("div",Wg,[n("h3",Jg,r(e.lang("list_of_problems")),1),n("div",Gg,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/problem/create"},{default:w(()=>t[3]||(t[3]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[D,e.lang("problem-add")]]),S((o(),l("a",{id:"advance-filter-btn",class:"btn btn-tool",onClick:t[0]||(t[0]=(...M)=>i.toggleFilterView&&i.toggleFilterView(...M)),href:"javascript:;"},t[4]||(t[4]=[n("span",{class:"glyphicon glyphicon-filter"},null,-1)]))),[[D,e.lang("filter")]]),e.showIcon?S((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=M=>i.exportReport()),href:"javascript:;"},t[5]||(t[5]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.lang("export")]]):c("",!0),e.showIcon?S((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=M=>i.scheduleList()),href:"javascript:;"},t[6]||(t[6]=[n("i",{class:"fas fa-calendar"},null,-1)]))),[[D,e.lang("schedule")]]):c("",!0)])]),n("div",Xg,[e.isShowFilter?(o(),k(b,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=problem&type=problem",saveFilter:!0,filterFor:"problem",filterNum:e.problemFilterId,redirectTo:"/service-desk/problem",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.problemFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter",parsedUrlParams:e.parsedUrlParams},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","filterNum","deleteUrl","closeFilter","parsedUrlParams"])):c("",!0),(o(!0),l(U,null,$(e.columnData,M=>(o(),l("section",{key:M},[_(f,{"table-columns":M.columns,reportId:M.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),k(g,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:M.columns,staticColumns:e.staticColumns,show_pagination:e.showPagination,"report-type":e.reportType},null,8,["data-url","columns","columnsMeta","staticColumns","show_pagination","report-type"])):c("",!0)]))),128))])])):c("",!0)])}const Rs=P(Hg,[["render",Zg]]),Qg={name:"problem-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[Xe],beforeMount(){if(this.mode==="edit"){const e=pe(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-problem/"+e,this.editId=pe(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=At(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/problem/"+s+"/show")},1e3)}},components:{FormRenderer:Ze,Alert:We,FaveoBox:wt,CustomLoader:nt}},eb={class:"col-sm-12"},tb={key:0,class:"pull-right"},sb={key:0,class:"form-group row mt-3"},ab={class:"col-md-12"},nb=["disabled"],ob={key:0},ib={key:1};function lb(e,t,s,d,a,i){const m=u("Alert"),h=u("CustomLoader"),b=u("router-link"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FaveoBox"),M=W("tooltip");return o(),l("div",eb,[a.formUniqueKey&&a.formSelected?(o(),k(D,{key:0,title:e.lang(i.mode)},{headerMenu:w(()=>[s.showViewButton?(o(),l("span",tb,[S((o(),k(b,{to:"/service-desk/problem/"+a.editId+"/show",class:"btn btn-tool has-tooltip"},{default:w(()=>t[1]||(t[1]=[n("span",null,[n("i",{class:"fas fa-eye"})],-1)])),_:1},8,["to"])),[[M,e.trans("view")]])])):c("",!0)]),default:w(()=>[_(m,{componentName:"faveo-form"}),_(m,{componentName:"form-renderer"}),e.showLoader||a.submitFormInProgress?(o(),k(h,{key:0,duration:4e3})):c("",!0),_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:a.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",sb,[n("div",ab,[n("button",{type:"button",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=N=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",ob,t[2]||(t[2]=[n("i",{class:"fas fa-sync"},null,-1)]))):(o(),l("span",ib,t[3]||(t[3]=[n("i",{class:"fas fa-save"},null,-1)]))),v(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,nb)])]))]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const Bs=P(Qg,[["render",lb]]);const rb={name:"problem-description",description:"Problem description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},db={class:"modal-title"},cb={id:"log_desc"},ub=["innerHTML"];function mb(e,t,s,d,a,i){const m=u("modal");return s.showModal?(o(),k(m,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",db,r(e.lang("description")),1)]),fields:w(()=>[n("div",cb,[n("span",{innerHTML:s.description},null,8,ub)])]),_:1},8,["showModal","onClose"])):c("",!0)}const hb=P(rb,[["render",mb],["__scopeId","data-v-55bdcb42"]]);function pb(e){const{solution_title:t,description:s}=e;var d={solution_title:[t,{"max(50)":"The title should be less than 50 characters."}],description:[s,"isRequired"]};const a=new Ue(Ce),{errors:i,isValid:m}=a.validate(d);return Fe.dispatch("setValidationError",i),{errors:i,isValid:m}}const _b={name:"problem-planning-modal",description:"Problem Planning Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},problemId:{type:[String,Number],default:""},identifier:{type:String,default:""},updateChangeData:{type:Function}},data(){return{attachment:"",description:"",isDisabled:!1,loading:!0,selectedFile:"",attachment_delete:!1,solution_title:"",category:""}},beforeMount(){this.getInitialValues(),this.category=this.$store.getters.getProblemAssociateCategory},methods:{getInitialValues(){T.get("/service-desk/api/general-popup/"+this.problemId+"/sd_problem/"+this.identifier).then(e=>{this.loading=!1,this.general_info=e.data.data.general_info,this.general_info&&(this.description=this.general_info.description,this.attachment=this.general_info.attachment,this.solution_title=this.general_info.title)}).catch(e=>{this.loading=!1})},addInlineStyles(){this.description=this.description.replace(/<td([^>]*)>/g,(e,t)=>{const s=/style\s*=\s*["']([^"']*)["']/.test(t),d=/padding\s*:\s*[^;]+/.test(t);return s?d?e:e.replace(/style\s*=\s*["']([^"']*)["']/,(a,i)=>`style="${i} padding: 6.4px;"`):`<td${t} style="padding: 6.4px;">`}).replace(/<table([^>]*)>/g,(e,t)=>{const s=/style\s*=\s*["']([^"']*)["']/.test(t),d=/border\s*=\s*["']([^"']*)["']/.test(t);return s?e.replace(/style\s*=\s*["']([^"']*)["']/,(a,i)=>`style="${i} border-collapse: collapse;" ${d?"":'border="1"'}`):`<table${t} style="border-collapse: collapse;" ${d?"":'border="1"'}>`})},onFileSelected(e,t,s){this.selectedFile=e,this.attachment_delete=s,this.attachment=this.selectedFile?this.selectedFile[0]:this.attachment},onChange(e,t){this[t]=e},isValid(){const{errors:e,isValid:t}=pb(this.$data);return t},onSubmit(){if(this.isValid()){this.addInlineStyles(),this.loading=!0,this.isDisabled=!0;var e=new FormData;e.append("identifier",this.identifier),e.append("description",this.description),this.identifier=="solution"&&e.append("title",this.solution_title),this.selectedFile&&e.append("attachment",this.selectedFile[0]?this.selectedFile[0]:""),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/general-popup/"+this.problemId+"/sd_problem",e,t).then(s=>{K(s,"problem-view"),this.loading=!1,this.isDisabled=!1,this.onClose(),this.category,window.emitter.emit("updateProblem"+this.category)}).catch(s=>{this.loading=!1,this.isDisabled=!1,O(s,"problem-planning")})}}},components:{"text-field":Ae,"file-upload":Ft}},fb={class:"modal-title"},gb={key:0},bb={class:"row"},yb={class:"row"},vb={key:1,class:"row"},wb=["disabled"];function kb(e,t,s,d,a,i){const m=u("alert"),h=u("text-field"),b=u("tiny-editor"),f=u("file-upload"),g=u("reuse-loader"),D=u("modal"),M=W("focus-first-input");return s.showModal?(o(),k(D,{key:0,showModal:s.showModal,onClose:s.onClose,modalBodyClass:a.loading?"":"problem_plan_div"},{alert:w(()=>[_(m,{componentName:"problem-planning"})]),title:w(()=>[n("h4",fb,r(e.lang(s.identifier)),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",gb,[S((o(),l("div",bb,[s.identifier=="solution"?(o(),k(h,{key:0,label:e.lang("solution_title"),value:a.solution_title,type:"text",name:"solution_title",onChange:i.onChange,classname:"col-sm-12",required:!1},null,8,["label","value","onChange"])):c("",!0),_(b,{value:a.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en",width:"100%",height:"300px",id:s.identifier=="solution"?"problem_solution":"focus_editor"},null,8,["value","onChange","label","id"])])),[[M]]),n("div",yb,[_(f,{label:e.lang("attachments"),value:a.attachment,name:"attachment",onChange:i.onFileSelected,classname:"col-sm-12"},null,8,["label","value","onChange"])])])),a.loading?(o(),l("div",vb,[_(g,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=x=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.lang("update")),1)],8,wb)]),_:1},8,["showModal","onClose","modalBodyClass"])):c("",!0)}const Ma=P(_b,[["render",kb]]);const Cb={name:"problem-assets",description:"Problem Asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},problemId:{type:[String,Number],default:""},updateChangeData:{type:Function}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"problemAssets",category:""}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?problem_id="+this.problemId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};T.post("/service-desk/api/problem-attach-assets/"+this.problemId,e,t).then(s=>{this.loading=!1,K(s,"problem-view"),window.emitter.emit(this.category==="activity"?"updateProblem"+this.category:this.componentTitle+"refreshData"),this.onClose()}).catch(s=>{this.loading=!1,O(s,"problem-view")})}}},components:{"asset-list-with-checkbox":ht,"dynamic-select":fe}},Db={class:"modal-title"},Sb={class:"row"},Mb={class:"col-sm-12"},Fb={class:"height-limit"},Ib={key:0,class:"row"},Ab=["disabled"];function Pb(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("asset-list-with-checkbox"),b=u("custom-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",Db,r(e.lang("attach_assets")),1)]),fields:w(()=>[n("div",Sb,[_(m,{label:e.lang("asset_types"),multiple:!1,name:"asset_type_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:a.asset_type_ids,onChange:i.onChange,clearable:!!a.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("used_by"),multiple:!1,name:"used_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:a.used_by_ids,onChange:i.onChange,clearable:!!a.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("managed_by"),multiple:!1,name:"managed_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:a.managed_by_ids,onChange:i.onChange,clearable:!!a.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("organizations"),multiple:!1,name:"org_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:a.org_ids,onChange:i.onChange,clearable:!!a.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),n("div",Mb,[n("button",{id:"apply-btn",class:"btn btn-primary round-btn float-start",type:"button",onClick:t[0]||(t[0]=g=>i.onApply())},[t[2]||(t[2]=n("span",{class:"fas fa-check"},null,-1)),v("  "+r(e.lang("apply")),1)])])]),t[3]||(t[3]=n("br",null,null,-1)),n("div",Fb,[a.apiUrl?(o(),k(h,{key:0,apiUrl:a.apiUrl,tickets:i.assetsData,componentTitle:a.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),a.loading===!0?(o(),l("div",Ib,[_(b,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=g=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[4]||(t[4]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.lang("attach")),1)],8,Ab)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Tb=P(Cb,[["render",Pb]]),Vb={name:"problem-ticket-associate",description:"Problem ticket associate Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},problemId:{type:[String,Number],default:""},associate:{type:String,default:""}},data(){return{ticket_ids:[],loading:!1,showAlert:!1,category:"",componentTitle:"ProblemTickets"}},beforeMount(){this.category=this.$store.getters.getAssociateCategory},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0;const e={};var t=[];for(var s in this.ticket_ids)t.push(this.ticket_ids[s].id);e.ticket_ids=t,T.post("/service-desk/api/problem-attach-ticket/"+this.problemId,e).then(d=>{this.loading=!1,this.ticket_ids=[],this.onClose(),window.emitter.emit(this.category==="activity"?"updateProblem"+this.category:this.componentTitle+"refreshData"),K(d,"problem-view")}).catch(d=>{this.loading=!1,this.showAlert=!0,O(d,"problem-ticket")})}},components:{"dynamic-select":fe}},Lb={class:"modal-title"},Ub={key:0},Nb={class:"row"},Eb={key:1,class:"row"},xb=["disabled"];function Ob(e,t,s,d,a,i){const m=u("alert"),h=u("dynamic-select"),b=u("reuse-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose},Qt({title:w(()=>[n("h4",Lb,r(e.lang("associate_tickets")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",Ub,[n("div",Nb,[_(h,{label:e.lang("tickets"),multiple:!0,name:"ticket_ids",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/tickets_based_on_problem?supplements="+s.problemId,value:a.ticket_ids,onChange:i.onChange,required:!0},null,8,["label","apiEndpoint","value","onChange"])])])),a.loading?(o(),l("div",Eb,[_(b,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=g=>i.onSubmit()),class:"btn btn-primary",disabled:!(a.ticket_ids.length>0)},[t[1]||(t[1]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.lang("attach")),1)],8,xb)]),_:2},[a.showAlert?{name:"alert",fn:w(()=>[_(m,{componentName:"problem-ticket"})]),key:"0"}:void 0]),1032,["showModal","onClose"])):c("",!0)}const qb=P(Vb,[["render",Ob]]);const jb={name:"problem-change-modal",description:"Problem Change Modal component",props:{showModal:{type:Boolean,default:!1},problemId:{type:[String,Number],default:""},onClose:{type:Function},type:{type:String,default:""},updateChangeData:{type:Function}},data(){return{isDisabled:this.type==="attach_existing_change",containerStyle:{width:this.type==="attach_existing_change"?"500px":"800px"},loading:!1,showLoader:!0,change:"",modalClass:"",category:""}},beforeMount(){this.updateLoader(),this.category=this.$store.getters.getProblemAssociateCategory},methods:{updateLoader(){this.type=="attach_new_change"&&setTimeout(()=>{this.showLoader=!1,this.modalClass="change_fields"},1e3)},onChange(e,t){this[t]=e,this.isDisabled=!e},onSubmit(){this.type==="attach_existing_change"&&(this.loading=!0,this.isDisabled=!0,T.post("/service-desk/api/problem-attach-change/"+this.problemId+"/"+this.change.id).then(e=>{K(e,"problem-view"),this.onClose(),this.updateChangeData(),this.category==="activity"&&window.emitter.emit("updateProblem"+this.category),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,O(e,"problem-view")}))},onCompleted(){this.onClose(),this.updateChangeData(),window.emitter.emit("updateProblemAssociates")}},components:{"dynamic-select":fe}},Rb={class:"modal-title"},Bb={key:0},zb={class:"row"},Kb={key:1,class:"row"},Hb=["disabled"];function Yb(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle,modalBodyClass:a.modalClass},{title:w(()=>[n("h4",Rb,r(e.lang(s.type)),1)]),fields:w(()=>[!a.loading&&s.type=="attach_existing_change"?(o(),l("div",Bb,[n("div",zb,[_(m,{label:e.lang("change"),multiple:!1,name:"change",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/changes",value:a.change,onChange:i.onChange,required:!0,clearable:!!a.change},null,8,["label","value","onChange","clearable"])])])):c("",!0),a.loading?(o(),l("div",Kb,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-check"},null,-1)),v(" "+r(e.lang("proceed")),1)],8,Hb)]),_:1},8,["showModal","onClose","containerStyle","modalBodyClass"])):c("",!0)}const $b=P(jb,[["render",Yb]]),Wb={name:"problem-detach-modal",description:"Problem Detach Modal component",props:{showModal:{type:Boolean,default:!1},assetId:{type:[String,Number],default:""},changeId:{type:[String,Number],default:""},compName:{type:String,default:""},alertCompName:{type:String,default:"problemAssociates"},problemId:{type:[String,Number],default:""},onClose:{type:Function},updateChangeData:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;let e=this.changeId?"/service-desk/api/problem-detach-change/"+this.problemId+"/"+this.changeId:"/service-desk/api/problem-detach-asset/"+this.problemId+"/"+this.assetId;T.delete(e).then(t=>{K(t,"problem-view"),this.changeId?this.category==="activity"?window.emitter.emit("updateProblemactivity"):this.category==="changes"&&window.emitter.emit("updateProblemTables"):window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!0,O(t,this.alertCompName)})}}},Jb={class:"modal-title"},Gb={key:0},Xb={key:1,class:"row"},Zb=["disabled"];function Qb(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",Jb,r(e.lang("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",Gb,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",Xb,[_(m,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("detach")),1)],8,Zb)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Fa=P(Wb,[["render",Qb]]),ey={name:"problem-status-modal",description:"Problem status Modal component",props:{showModal:{type:Boolean,default:!1},problemId:{type:[String,Number],default:""},onClose:{type:Function},updateChangeData:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.post("/service-desk/api/problem-close/"+this.problemId).then(e=>{K(e,"problem-view"),this.onClose(),this.updateChangeData(),window.emitter.emit(this.category==="activity"?"updateProblemactivity":""),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,O(e,"problem-view")})}}},ty={class:"modal-title"},sy={key:0},ay={key:1,class:"row"},ny=["disabled"];function oy(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",ty,r(e.lang("status")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",sy,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",ay,[_(m,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-check"},null,-1)),v(" "+r(e.lang("proceed")),1)],8,ny)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const iy=P(ey,[["render",oy]]);const ly={name:"problem-create-change-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},updateChangeData:{type:Function},problemId:{type:[String,Number],default:""}},data(){return{formUniqueKey:"",submitFormInProgress:!1,scenario:"create",panel:"agent",page:"add_id_with_form",form_id:this.problemId,category:"",fetchFormFieldApi:"/api/form/render/",selectedForm:"",formSelected:!1}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory,this.getDefaultFormValue()},mixins:[Xe],methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/changes").then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},popUpSubmit(){document.getElementById("problem-create-change-submit").click()},formSubmit(e,t){this.onSubmit()},afterSubmit(e){setTimeout(()=>{this.updateChangeData(),this.category==="activity"&&window.emitter.emit("updateProblem"+this.category),this.onClose()},1e3)}},beforeDestroy(){this.$store.dispatch("unsetAlert")},components:{FormWithCaptcha:Zt,FormRenderer:Ze}},ry={class:"prb-new-change"},dy={key:1,id:"change_modal_body"},cy=["disabled"];function uy(e,t,s,d,a,i){const m=u("custom-loader"),h=u("loader"),b=u("alert"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FormWithCaptcha"),M=u("modal");return o(),l("div",ry,[a.submitFormInProgress?(o(),k(m,{key:0})):c("",!0),s.showModal?(o(),k(M,{key:1,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",null,r(e.trans("attach_new_change")),1)]),fields:w(()=>[e.showLoader?(o(),k(h,{key:0})):c("",!0),a.formUniqueKey&&a.formSelected?(o(),l("div",dy,[_(b,{componentName:"faveo-form"}),_(D,{loading:!e.showLoader,btnClass:"btn btn-primary float-end",btnName:"submit",page:"problem_add_agent",componentName:"faveo-form",btn_id:"problem-create-change-submit",formSubmit:i.formSubmit,recaptchaContainerClass:"mt-2",disableSubmit:a.submitFormInProgress},{fields:w(()=>[_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:a.scenario,category:"changes",panel:a.panel},null,8,["fetchFormFieldApi","formUniqueKey","scenario","panel"]))]),_:1},512)]),_:1},8,["loading","formSubmit","disableSubmit"])])):c("",!0)]),controls:w(()=>[e.showLoader?c("",!0):(o(),l("button",{key:0,type:"submit",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=x=>i.popUpSubmit())},[t[1]||(t[1]=n("i",{class:"fas fa-save"},null,-1)),v("  "+r(e.trans("save")),1)],8,cy))]),_:1},8,["showModal","onClose"])):c("",!0)])}const my=P(ly,[["render",uy],["__scopeId","data-v-53b52f0c"]]);const hy={name:"problem-actions",description:"Problem actions component",props:{problem:{type:Object,default:()=>{}},updateChangeDetails:{type:Function}},data(){return{showPlanningModal:!1,showAttach:!1,showAttachTicket:!1,showChangeModal:!1,showDetachModal:!1,showProblemStatus:!1,showDeleteModal:!1,identifier:"",change_type:"",actions:"",showNewChangeModal:!1}},beforeMount(){this.getActions()},created(){window.emitter.on("updateProblemActions",this.getActions)},methods:{getActions(){this.actions="",T.get("/service-desk/api/problem-action/"+this.problem.id).then(e=>{this.actions=e.data.data.actions,window.emitter.emit("problemActionsList",this.actions)}).catch(e=>{this.actions=""})},subString(e,t=15){return Ie(e,t)},planningMethod(e){this.showPlanningModal=!0,this.identifier=e},problemChange(e){this.change_type=e,this.showChangeModal=!0},onClose(){this.showPlanningModal=!1,this.showAttach=!1,this.showAttachTicket=!1,this.showChangeModal=!1,this.showDeleteModal=!1,this.showDetachModal=!1,this.showProblemStatus=!1,this.showNewChangeModal=!1,this.getActions(),this.$store.dispatch("unsetValidationError")}},components:{"problem-planning-modal":Ma,"problem-assets":Tb,"problem-tickets":qb,"problem-change":$b,"problem-detach":Fa,"problem-status-modal":iy,"delete-modal":ot,"problem-new-change":my}},py={class:"card-tools"},_y={class:"btn-group"},fy={type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},gy={class:"dropdown-menu"},by={class:"btn-group"},yy={type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},vy={class:"dropdown-menu"},wy={class:"dropdown-item text-dark"},ky={key:0},Cy={class:"ml_10"},Dy={key:1},Sy={class:"ml_10"},My={class:"ml_10"},Fy={class:"btn-group"},Iy={type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},Ay={class:"dropdown-menu dropdown-menu-right"};function Py(e,t,s,d,a,i){const m=u("router-link"),h=u("reuse-loader"),b=u("problem-planning-modal"),f=u("problem-assets"),g=u("problem-tickets"),D=u("problem-change"),M=u("problem-new-change"),x=u("problem-detach"),R=u("problem-status-modal"),V=u("delete-modal"),N=W("tooltip");return o(),l("div",py,[n("div",_y,[n("button",fy,[t[11]||(t[11]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.lang("planning")),1)]),n("div",gy,[n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=j=>i.planningMethod("root-cause"))},r(e.lang("root_cause")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=j=>i.planningMethod("impact"))},r(e.lang("impact")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[2]||(t[2]=j=>i.planningMethod("symptoms"))},r(e.lang("symptoms")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=j=>i.planningMethod("solution"))},r(e.lang("solution")),1)])]),n("div",by,[n("button",yy,[t[12]||(t[12]=n("i",{class:"fas fa-link"},null,-1)),v(" "+r(e.lang("associate")),1)]),n("div",vy,[n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[4]||(t[4]=j=>a.showAttach=!0)},[t[13]||(t[13]=n("i",{class:"fas fa-server"},null,-1)),v(" "+r(e.lang("attach_asset")),1)]),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[5]||(t[5]=j=>a.showAttachTicket=!0)},[t[14]||(t[14]=n("i",{class:"fas fa-ticket"},null,-1)),v(" "+r(e.lang("attach_ticket")),1)]),n("a",wy,[t[15]||(t[15]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.lang("change")),1)]),a.actions.problem_change_detach?(o(),l("div",ky,[n("a",{href:"javascript:;",class:"dropdown-item text-dark",onClick:t[6]||(t[6]=j=>a.showDetachModal=!0)},[n("span",Cy,[t[16]||(t[16]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.lang("detach"))+" ",1),S((o(),l("b",null,[v(r(i.subString(s.problem.change.subject,10)),1)])),[[N,s.problem.change.subject]])])])])):(o(),l("div",Dy,[n("a",{href:"javascript:;",onClick:t[7]||(t[7]=j=>a.showNewChangeModal=!0),class:"dropdown-item text-dark"},[n("span",Sy,[t[17]||(t[17]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.lang("attach_new_change")),1)])]),n("a",{href:"javascript:;",onClick:t[8]||(t[8]=j=>i.problemChange("attach_existing_change")),class:"dropdown-item text-dark"},[n("span",My,[t[18]||(t[18]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.lang("attach_existing_change")),1)])])]))])]),n("div",Fy,[n("button",Iy,[t[19]||(t[19]=n("i",{class:"fa fa-cog"},null,-1)),v(" "+r(e.lang("more")),1)]),n("div",Ay,[a.actions.problem_edit?(o(),k(m,{key:0,class:"dropdown-item text-dark",to:"/service-desk/problem/"+s.problem.id+"/edit"},{default:w(()=>[v(r(e.lang("edit")),1)]),_:1},8,["to"])):c("",!0),a.actions.problem_delete?(o(),l("a",{key:1,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[9]||(t[9]=j=>a.showDeleteModal=!0)},r(e.lang("delete")),1)):c("",!0),a.actions.problem_close?(o(),l("a",{key:2,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[10]||(t[10]=j=>a.showProblemStatus=!0)},r(e.lang("close")),1)):c("",!0)])]),n("template",null,[_(h,{"animation-duration":4e3,size:0})]),_(X,{name:"modal"},{default:w(()=>[a.showPlanningModal?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showPlanningModal,identifier:a.identifier,problemId:s.problem.id,alertCompName:"problem-view",updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","identifier","problemId","updateChangeData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAttach?(o(),k(f,{key:0,onClose:i.onClose,showModal:a.showAttach,problemId:s.problem.id,updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","problemId","updateChangeData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAttachTicket?(o(),k(g,{key:0,onClose:i.onClose,showModal:a.showAttachTicket,problemId:s.problem.id,alertCompName:"problem-view",updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","problemId","updateChangeData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showChangeModal?(o(),k(D,{key:0,onClose:i.onClose,showModal:a.showChangeModal,problemId:s.problem.id,type:a.change_type,updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","problemId","type","updateChangeData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showNewChangeModal?(o(),k(M,{key:0,onClose:i.onClose,showModal:a.showNewChangeModal,updateChangeData:s.updateChangeDetails,problemId:s.problem.id},null,8,["onClose","showModal","updateChangeData","problemId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showDetachModal?(o(),k(x,{key:0,onClose:i.onClose,showModal:a.showDetachModal,changeId:s.problem.change.id,problemId:s.problem.id,alertCompName:"problem-view",updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","changeId","problemId","updateChangeData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showProblemStatus?(o(),k(R,{key:0,onClose:i.onClose,showModal:a.showProblemStatus,problemId:s.problem.id,updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","problemId","updateChangeData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showDeleteModal?(o(),k(V,{key:0,onClose:i.onClose,showModal:a.showDeleteModal,alertComponentName:"problem-view",deleteUrl:"/service-desk/api/problem-delete/"+s.problem.id,redirectUrl:"/service-desk/problem/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1})])}const Ty=P(hy,[["render",Py],["__scopeId","data-v-460608c9"]]);const Vy={name:"problem-details",description:"Problem details page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{problem:{type:Object,default:()=>{}},updateData:{type:Function}},data(){return{showDescription:!1,isOddCount:!1}},mounted(){this.checkOddItems()},computed:{icon(){var e=this.problem.attachment;if(e)switch(e.type){case"pdf":return"fas fa-file-pdf";case"xls":return"fas fa-file-excel";case"txt":case"text":return"fas fa-file-code";case"png":case"jpg":case"jpeg":case"gif":return"fas fa-file-image";default:return"fas fa-file-alt"}}},methods:{checkOddItems(){this.$nextTick(()=>{const e=this.$refs.problemDetails.querySelectorAll(".info-row").length;this.isOddCount=e%2!==0})},subString(e,t=15){return Ie(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")},downloadFile(e){window.open(e)}},components:{"problem-actions":Ty,"problem-description":hb}},Ly={class:"card card-light"},Uy={class:"card-header"},Ny={class:"card-title"},Ey={class:"card-body"},xy={class:"row mb-3"},Oy={class:"col-md-12"},qy={class:"callout callout-info"},jy={class:"row"},Ry={class:"col-md-4"},By={key:0,class:"col-md-4"},zy={key:1,class:"col-md-4"},Ky={class:"col-md-12"},Hy={class:"row mx-1",ref:"problemDetails"},Yy={key:0,class:"col-md-6 info-row d-flex"},$y={class:"col-md-6"},Wy={class:"col-md-6"},Jy={key:1,class:"col-md-6 info-row d-flex"},Gy={class:"col-md-6"},Xy={class:"col-md-6"},Zy={key:2,class:"col-md-6 info-row d-flex"},Qy={class:"col-md-6"},ev={class:"col-md-6"},tv={key:3,class:"col-md-6 info-row d-flex"},sv={class:"col-md-6"},av={class:"col-md-6"},nv={key:4,class:"col-md-6 info-row d-flex"},ov={class:"col-md-6"},iv={class:"col-md-6"},lv={class:"col-md-6 info-row d-flex"},rv={class:"col-md-6"},dv={class:"col-md-6"},cv={class:"col-md-6 info-row d-flex"},uv={class:"col-md-6"},mv={class:"col-md-6"},hv={key:0},pv={key:0},_v={key:6,class:"col-md-6 info-row d-flex"},fv={class:"col-md-6"},gv={class:"col-md-6"},bv={key:0},yv={class:"line"},vv=["src"],wv=["onClick"],kv={key:1},Cv={key:7,class:"col-md-6 info-row d-flex"};function Dv(e,t,s,d,a,i){const m=u("problem-actions"),h=u("router-link"),b=u("problem-description"),f=W("tooltip");return o(),l("div",Ly,[n("div",Uy,[S((o(),l("h3",Ny,[v(r(i.subString(s.problem.subject,50)),1)])),[[f,s.problem.subject]]),_(m,{problem:s.problem,updateChangeDetails:s.updateData},null,8,["problem","updateChangeDetails"])]),n("div",Ey,[n("div",xy,[n("div",Oy,[n("div",qy,[n("div",jy,[n("div",Ry,[n("b",null,r(e.lang("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(s.problem.created_at)),1)])),[[f,d.formattedTime(s.problem.created_at)]])]),s.problem.status_type_id?(o(),l("div",By,[n("b",null,r(e.lang("status"))+" : ",1),S((o(),l("span",{key:s.problem.status_type_id.name},[_(h,{class:"text-decoration-none",to:s.problem.status_type_id.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[v(r(i.subString(s.problem.status_type_id.name)),1)]),_:1},8,["to"])])),[[f,s.problem.status_type_id.name]])])):c("",!0),s.problem.requester_id?(o(),l("div",zy,[n("b",null,r(e.lang("requester"))+" : ",1),S((o(),l("span",null,[_(h,{class:"text-decoration-none",to:s.problem.requester_id.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[v(r(s.problem.requester_id.name?i.subString(s.problem.requester_id.name):i.subString(s.problem.requester_id.email)),1)]),_:1},8,["to"])])),[[f,s.problem.requester_id.name?s.problem.requester_id.name:s.problem.requester_id.email]])])):c("",!0)])])])]),n("div",Ky,[n("div",Hy,[s.problem.department_id?(o(),l("div",Yy,[n("div",$y,[n("label",null,r(e.lang("department")),1)]),n("div",Wy,[_(h,{class:"text-primary",to:s.problem.department_id.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.problem.department_id.name)),1)])),[[f,s.problem.department_id.name]])]),_:1},8,["to"])])])):c("",!0),s.problem.priority_id?(o(),l("div",Jy,[n("div",Gy,[n("label",null,r(e.lang("priority")),1)]),n("div",Xy,[_(h,{class:"text-primary",to:s.problem.priority_id.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.problem.priority_id.name)),1)])),[[f,s.problem.priority_id.name]])]),_:1},8,["to"])])])):c("",!0),s.problem.impact_id?(o(),l("div",Zy,[n("div",Qy,[n("label",null,r(e.lang("impact")),1)]),n("div",ev,[_(h,{class:"text-primary",to:s.problem.impact_id.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.problem.impact_id.name)),1)])),[[f,s.problem.impact_id.name]])]),_:1},8,["to"])])])):c("",!0),s.problem.location_id?(o(),l("div",tv,[n("div",sv,[n("label",null,r(e.lang("location")),1)]),n("div",av,[_(h,{class:"text-primary",to:s.problem.location_id.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.problem.location_id.name)),1)])),[[f,s.problem.location_id.name]])]),_:1},8,["to"])])])):c("",!0),s.problem.assigned_id?(o(),l("div",nv,[n("div",ov,[n("label",null,r(e.lang("assigned")),1)]),n("div",iv,[_(h,{class:"text-primary",to:s.problem.assigned_id.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.problem.assigned_id.name)),1)])),[[f,s.problem.assigned_id.name]])]),_:1},8,["to"])])])):c("",!0),n("div",lv,[n("div",rv,[n("label",null,r(e.lang("description")),1)]),n("div",dv,[n("a",{href:"javascript:;",class:"btn btn-info btn-sm",onClick:t[0]||(t[0]=g=>a.showDescription=!0)},[t[1]||(t[1]=n("i",{class:"fas fa-file-code"},"  ",-1)),v(r(e.lang("show_description")),1)])])]),s.problem.customFieldValues&&s.problem.customFieldValues.length>0?(o(!0),l(U,{key:5},$(s.problem.customFieldValues,g=>(o(),l("div",cv,[n("div",uv,[n("label",null,r(g.label),1)]),n("div",mv,[Array.isArray(g.value)?(o(),l("div",hv,[(o(!0),l(U,null,$(g.value,(D,M)=>(o(),k(h,{class:"text-primary",to:g.href[M].replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(D)),1)])),[[f,D]]),M!=Object.keys(g.value).length-1?(o(),l("span",pv,",")):c("",!0),t[2]||(t[2]=v("  "))]),_:2},1032,["to"]))),256))])):(o(),l(U,{key:1},[g.field_type==="date"?(o(),k(h,{key:0,class:"text-primary",to:g.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(g.value),1)])),[[f,g.value]])]),_:2},1032,["to"])):(o(),k(h,{key:1,class:"text-primary",to:g.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(g.value)),1)])),[[f,{content:g.value?g.value.replace(/\r?\n/g,"<br />"):"---",html:!0}]])]),_:2},1032,["to"]))],64))])]))),256)):c("",!0),s.problem.attachment.length>0?(o(),l("div",_v,[n("div",fv,[n("label",null,r(e.trans("attachments")),1)]),n("div",gv,[s.problem.attachment.length>0?(o(),l("span",bv,[(o(!0),l(U,null,$(s.problem.attachment,g=>(o(),l(U,null,[n("span",yv,[S((o(),l("span",null,[n("img",{src:g.thumbnail_url,class:"attach_img"},null,8,vv),v(" "+r(i.subString(g.name,15))+" "+r("("+g.size+")"),1)])),[[f,g.name]]),S((o(),l("a",{id:"download",onClick:D=>i.downloadFile(g.download_url),href:"javascript:;"},t[3]||(t[3]=[v("  "),n("i",{class:"fas fa-download"},null,-1)]),8,wv)),[[f,e.trans("download")]])]),t[4]||(t[4]=n("br",null,null,-1))],64))),256))])):(o(),l("span",kv,"---"))])])):c("",!0),a.isOddCount?(o(),l("div",Cv)):c("",!0)],512)])]),_(X,{name:"modal"},{default:w(()=>[a.showDescription?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showDescription,description:s.problem.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])}const Sv=P(Vy,[["render",Dv],["__scopeId","data-v-ac6e52c7"]]);const Mv={name:"problem-associated-assets",description:"Problem associated assets table page",props:{category:{type:String,default:"inbox"},apiUrl:{type:String,default:""},problemId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["name","managed_by","used_by","contract","action"],options:{},apiEndPoint:this.apiUrl,showModal:!1,assetId:"",totalCount:"",searchTerm:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",contract:"associate-contract",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){return e.h(De,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},managed_by(t,s){var d,a;return((a=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,a;return((a=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},contract:function(t,s){return s.contract&&!Array.isArray(s.contract)?e.h(De,{to:"/service-desk/contracts/"+s.contract.id+"/show"},s.contract.name):"--"},action:function(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.showModal=!0,e.assetId=s.id}},[d])}},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return e.searchTerm=t.query.trim(),{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.data.map(s=>(s.detach=!0,s.problem_id=e.problemId,s.compName=e.componentTitle,s)),count:e.totalCount}},orderBy:{column:"name",ascending:!0}}},methods:{onClose(){this.showModal=!1,window.emitter.emit("updateProblemActions")},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){!this.searchTerm&&e===0&&window.emitter.emit("updateProblemTables")},searchTerm(e){this.searchTerm=e}},components:{"problem-asset-detach":Fa}},Fv={id:"problem_assets"};function Iv(e,t,s,d,a,i){const m=u("data-table"),h=u("problem-asset-detach");return o(),l("div",Fv,[_(m,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,assetId:a.assetId,problemId:s.problemId,compName:s.componentTitle},null,8,["onClose","showModal","assetId","problemId","compName"])):c("",!0)]),_:1})])}const Av=P(Mv,[["render",Iv]]),Pv={name:"problem-updates-delte-modal",description:"Problem Updates Delete Modal component",props:{showModal:{type:Boolean,default:!1},problemId:{type:[String,Number],default:""},onClose:{type:Function},identifier:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/delete/general-popup/"+this.problemId+"/sd_problem/"+this.identifier).then(e=>{this.category,window.emitter.emit("updateProblem"+this.category),this.onClose(),K(e,"problem-view"),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,O(e,"problem-view"),this.onClose()})}}},Tv={class:"modal-title"},Vv={key:0},Lv={key:1,class:"row"},Uv=["disabled"];function Nv(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",Tv,r(e.lang("delete")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",Vv,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",Lv,[_(m,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("delete")),1)],8,Uv)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Ev=P(Pv,[["render",Nv]]);const xv={name:"problem-planning",description:"Problem planning component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{problemId:{type:[String,Number],default:""}},data(){return{problemUpdates:"",loading:!1,showProblemUpdate:!1,showUpdateDelete:!1,identifier:"",refreshPlanning:!1}},beforeMount(){this.getDetails()},created(){window.emitter.on("updateProblemdetails",()=>this.refreshPlanning=!0)},methods:{getDetails(){this.loading=!0,T.get("/service-desk/api/problem-planning/"+this.problemId).then(e=>{this.loading=!1,this.problemUpdates=e.data.data.planning_popups,this.problemUpdates.length===0&&(window.emitter.emit("updateProblemActions"),window.emitter.emit("updateProblemTables"))}).catch(e=>{this.loading=!1})},getFont(e){return e==="root-cause"?"ambulance":e==="impact"?"anchor":e==="symptoms"?"battery-empty":"thumbs-up"},getIcon(e){if(e)return e.type==="pdf"?"fas fa-file-pdf":e.type==="xls"?"fas fa-file-excel":e.type==="txt"||e.type==="text"?"fas fa-file-code":e.type==="png"||e.type==="jpg"||e.type==="jpeg"||e.type==="gif"||e.type==="PNG"||e.type==="JPG"||e.type==="JPEG"||e.type==="GIF"?"fas fa-file-image":"fas fa-file-alt"},formatBytes(e,t){if(e==0)return"0 Bytes";var s=1024,d=t||2,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(s));return parseFloat((e/Math.pow(s,i)).toFixed(d))+" "+a[i]},downloadFile(e,t){window.open(this.basePath()+"/service-desk/download/"+e+"/"+t+"/attachment")},updateMethod(e){this.showProblemUpdate=!0,this.identifier=e},deleteMethod(e){this.showUpdateDelete=!0,this.identifier=e},onClose(){this.showProblemUpdate=!1,this.showUpdateDelete=!1,window.emitter.emit("updateProblemActions"),this.$store.dispatch("unsetValidationError")}},watch:{loading(e){this.$emit("loaderValue",e)},refreshPlanning(e,t){e===!0&&this.getDetails(),this.refreshPlanning=!1}},components:{"problem-update-modal":Ma,"problem-update-delete-modal":Ev}},Ov={class:"prb-plan"},qv={key:0,class:"timeline"},jv={class:"time-label"},Rv={class:"text-bg-secondary"},Bv={class:"pln-details"},zv={class:"timeline-item"},Kv={class:"time float-start"},Hv={key:0,class:"solution_title"},Yv={class:"timeline-header pb-37"},$v=["onClick"],Wv=["onClick"],Jv={class:"timeline-body break"},Gv=["innerHTML"],Xv={key:0,class:"timeline-footer planning_footer"},Zv={class:"pln-attach"},Qv=["onClick"],e1={key:1,class:"text-center"};function t1(e,t,s,d,a,i){const m=u("problem-update-modal"),h=u("problem-update-delete-modal"),b=W("tooltip");return o(),l("div",Ov,[a.problemUpdates.length>0?(o(),l("div",qv,[(o(!0),l(U,null,$(a.problemUpdates,(f,g)=>(o(),l(U,null,[n("div",jv,[n("span",Rv,r(e.lang(f.key)),1)]),n("div",Bv,[n("i",{class:Q(["timeline-icon","fas fa-"+i.getFont(f.key)+" text-bg-blue"])},null,2),n("div",zv,[n("span",Kv,[f.title?(o(),l("span",Hv,r(f.title)+"   ",1)):c("",!0),t[0]||(t[0]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(f.updated_at)),1)]),n("h3",Yv,[n("button",{class:"btn btn-light btn-sm btn-right ms-1",onClick:D=>i.deleteMethod(f.key)},[t[1]||(t[1]=n("i",{class:"fas fa-trash"},null,-1)),v(" "+r(e.lang("delete")),1)],8,$v),n("button",{class:"btn btn-light btn-sm btn-right",onClick:D=>i.updateMethod(f.key)},[t[2]||(t[2]=n("i",{class:"fas fa-edit"},null,-1)),v(" "+r(e.lang("edit")),1)],8,Wv)]),n("div",Jv,[n("span",{class:"text-muted",id:"log_desc",innerHTML:f.description},null,8,Gv)]),f.attachment?(o(),l("div",Xv,[n("span",Zv,[S((o(),l("span",null,[n("i",{class:Q(i.getIcon(f.attachment))},null,2),v(" "+r(f.attachment.value)+" "+r("("+i.formatBytes(f.attachment.size)+")"),1)])),[[b,f.attachment.value]]),S((o(),l("a",{id:"download",onClick:D=>i.downloadFile(f.attachment.id,f.attachment.owner)},t[3]||(t[3]=[v("  "),n("i",{class:"fas fa-download"},null,-1)]),8,Qv)),[[b,e.lang("download")]])])])):c("",!0)])])],64))),256)),t[4]||(t[4]=n("div",{class:"prb-icon"},[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"})],-1))])):c("",!0),!a.loading&&a.problemUpdates.length===0?(o(),l("h6",e1,r(e.lang("no_data_found")),1)):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showProblemUpdate?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showProblemUpdate,identifier:a.identifier,problemId:s.problemId,alertCompName:"problem-view"},null,8,["onClose","showModal","identifier","problemId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showUpdateDelete?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showUpdateDelete,identifier:a.identifier,problemId:s.problemId,alertCompName:"problem-view"},null,8,["onClose","showModal","identifier","problemId"])):c("",!0)]),_:1})])}const s1=P(xv,[["render",t1],["__scopeId","data-v-4698236f"]]);const a1={name:"problem-activity",description:"Problem activity page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{problemId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/problem-log/"+this.problemId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},created(){window.emitter.on("updateProblemactivity",()=>this.refreshActivity=!0)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},loading(e){this.$emit("loaderValue",e)},filtering(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){T.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.problem_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.problem_activity_logs.total,this.perPage=t.data.data.problem_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":kt}},n1={class:"row",id:"activity_log_div"},o1={class:"col-sm-12 mb-2"},i1={key:0,id:"select_limit"},l1={type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},r1={class:"dropdown-menu"},d1={key:1,id:"choose_order"},c1={id:"sort_btn",type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},u1={class:"dropdown-menu",style:{"z-index":"9999"}},m1={key:2,id:"page_div"},h1={class:"col-md-12"},p1={key:0,class:"timeline"},_1={key:0,class:"time-label"},f1={class:"text-bg-light border"},g1={class:"timeline-item"},b1={class:"time"},y1={key:0,class:"timeline-header"},v1={class:"timeline-body break"},w1={key:1},k1={key:1,class:"float-end",id:"page_div"},C1={key:0,class:"col-sm-12"},D1={class:"text-center"};function S1(e,t,s,d,a,i){const m=u("uib-pagination"),h=u("faveo-image-element"),b=u("router-link"),f=u("activity-parser");return o(),l("div",n1,[n("div",o1,[!a.loading&&a.activity_log.length>0?(o(),l("div",i1,[n("button",l1,r(a.perPage),1),n("div",r1,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=g=>i.logLimit(10))},"10"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[1]||(t[1]=g=>i.logLimit(25))},"25"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=g=>i.logLimit(50))},"50"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[3]||(t[3]=g=>i.logLimit(100))},"100")])])):c("",!0),!a.loading&&a.activity_log.length>0?(o(),l("div",d1,[n("button",c1,r(e.lang("created_time"))+" - "+r(e.lang(a.sort_key)),1),n("div",u1,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[4]||(t[4]=g=>i.orderBy("asc"))},[t[8]||(t[8]=n("i",{class:"fas fa-sort-amount-up"},null,-1)),v(" "+r(e.lang("asc")),1)]),n("a",{href:"javascript:;",onClick:t[5]||(t[5]=g=>i.orderBy("desc")),class:"dropdown-item"},[t[9]||(t[9]=n("i",{class:"fas fa-sort-amount-down"},null,-1)),v(" "+r(e.lang("desc")),1)])])])):c("",!0),!a.loading&&a.total>10?(o(),l("div",m1,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[6]||(t[6]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),n("div",h1,[!a.loading&&a.activity_log.length>0?(o(),l("div",p1,[(o(!0),l(U,null,$(a.activity_log,(g,D)=>(o(),l(U,null,[i.checkDate(D)?(o(),l("div",_1,[n("span",f1,r(d.formattedDate(g.created_at)),1)])):c("",!0),n("div",null,[t[11]||(t[11]=n("i",{class:"far fa-dot-circle timeline-icon"},null,-1)),n("div",g1,[n("span",b1,[t[10]||(t[10]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(g.created_at)),1)]),g.creator?(o(),l("h3",y1,[_(h,{id:"problem_img","source-url":g.creator.profile_pic,classes:["img-circle","img-bordered-sm","img-rounder"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),_(b,{to:"/user/"+g.creator.id},{default:w(()=>[v(" "+r(g.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),n("div",v1,[_(f,{data:g.name},null,8,["data"])])])]),i.showThreadEnd(D)?(o(),l("div",w1,t[12]||(t[12]=[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),256))])):c("",!0),!a.loading&&a.total>10?(o(),l("div",k1,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[7]||(t[7]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!a.filtering&&!a.loading&&a.activity_log.length===0?(o(),l("div",C1,[n("h6",D1,r(e.lang("no_data_found")),1)])):c("",!0)])}const M1=P(a1,[["render",S1],["__scopeId","data-v-c73b6f83"]]);const F1={name:"problem-change-details",description:"Problem Change details page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{change:{type:[Array,Object],default:()=>[]}},methods:{subString(e,t=15){return Ie(e,t)}}},I1={class:"prb-change-details"},A1={key:0,class:"row mb-3"},P1={class:"col-md-12"},T1={class:"callout callout-info"},V1={class:"row"},L1={class:"col-md-4"},U1={class:"col-md-4"},N1={class:"col-md-4"},E1={key:1,class:"col-md-12"},x1={class:"row"},O1={class:"col-md-6 info-row d-flex"},q1={class:"col-md-6"},j1={class:"col-md-6"},R1={href:"javascript:void(0)"},B1={class:"col-md-6 info-row d-flex"},z1={class:"col-md-6"},K1={class:"col-md-6"},H1={href:"javascript:void(0)"},Y1={class:"col-md-6 info-row d-flex"},$1={class:"col-md-6"},W1={class:"col-md-6"},J1={href:"javascript:void(0)"},G1={class:"col-md-6 info-row d-flex"},X1={class:"col-md-6"},Z1={class:"col-md-6"},Q1={href:"javascript:void(0)"},ew={class:"col-md-6 info-row d-flex"},tw={class:"col-md-6"},sw={class:"col-md-6"},aw={class:"col-md-6 info-row d-flex"},nw={class:"col-md-6"},ow={class:"col-md-6"},iw={href:"javascript:void(0)"},lw={class:"col-md-6 info-row d-flex"},rw={class:"col-md-6"},dw={class:"col-md-6"},cw={href:"javascript:void(0)"},uw={key:2,class:"row"},mw={class:"text-center"};function hw(e,t,s,d,a,i){const m=W("tooltip");return o(),l("div",I1,[Array.isArray(s.change)?c("",!0):(o(),l("div",A1,[n("div",P1,[n("div",T1,[n("div",V1,[n("div",L1,[n("b",null,r(e.lang("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(s.change.created_at)),1)])),[[m,d.formattedTime(s.change.created_at)]])]),n("div",U1,[n("b",null,r(e.lang("status"))+" : ",1),S((o(),l("span",null,[v(r(i.subString(s.change.status.name)),1)])),[[m,s.change.status.name]])]),n("div",N1,[n("b",null,r(e.lang("requester"))+" : ",1),S((o(),l("span",null,[v(r(s.change.requester.full_name?i.subString(s.change.requester.full_name):i.subString(s.change.requester.email)),1)])),[[m,s.change.requester.full_name?s.change.requester.full_name:s.change.requester.email]])])])])])])),Array.isArray(s.change)?(o(),l("div",uw,[n("h4",mw,r(e.lang("no_data_found")),1)])):(o(),l("div",E1,[n("div",x1,[n("div",O1,[n("div",q1,[n("label",null,r(e.lang("subject")),1)]),n("div",j1,[S((o(),l("a",R1,[v(r(i.subString(s.change.subject)),1)])),[[m,s.change.subject]])])]),n("div",B1,[n("div",z1,[n("label",null,r(e.lang("change_type")),1)]),n("div",K1,[S((o(),l("a",H1,[v(r(s.change.change_type.name),1)])),[[m,s.change.change_type.name]])])]),n("div",Y1,[n("div",$1,[n("label",null,r(e.lang("impact")),1)]),n("div",W1,[S((o(),l("a",J1,[v(r(s.change.impact_type?i.subString(s.change.impact_type.name):"---"),1)])),[[m,s.change.impact_type?s.change.impact_type.name:"---"]])])]),n("div",G1,[n("div",X1,[n("label",null,r(e.lang("location")),1)]),n("div",Z1,[S((o(),l("a",Q1,[v(r(s.change.location?i.subString(s.change.location.title):"---"),1)])),[[m,s.change.location?s.change.location.title:"---"]])])]),n("div",ew,[n("div",tw,[n("label",null,r(e.lang("department")),1)]),n("div",sw,[S((o(),l("a",null,[v(r(s.change.department?i.subString(s.change.department.name):"---"),1)])),[[m,s.change.department?s.change.department.name:"---"]])])]),n("div",aw,[n("div",nw,[n("label",null,r(e.lang("team")),1)]),n("div",ow,[S((o(),l("a",iw,[v(r(s.change.team?i.subString(s.change.team.name):"---"),1)])),[[m,s.change.team?s.change.team.name:"---"]])])]),n("div",lw,[n("div",rw,[n("label",null,r(e.lang("priority")),1)]),n("div",dw,[S((o(),l("a",cw,[v(r(s.change.priority?i.subString(s.change.priority.name):"---"),1)])),[[m,s.change.priority?s.change.priority.name:"---"]])])])])]))])}const pw=P(F1,[["render",hw],["__scopeId","data-v-1dc9d354"]]);const zs=()=>({description:"",attachments:[],inline:[],isDisabled:!0,loading:!1,selectedFile:"",showError:!1,status:"",priority:"",assign_to:"",assign:"agents",radioOptions:[{name:"agent",value:"agents"},{name:"team",value:"teams"},{name:"assign_to_me",value:"assign_to_me"}],assignChange:!1}),_w={name:"problem-bulk-action-modal",components:{DynamicSelect:fe,RadioButton:mt,AddMedia:fa},props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},identifier:{type:String,default:""},tickets:{type:Array,required:!0},componentTitle:{type:String,required:!0},componentNameToRefresh:{type:String,default:""}},data(){return zs()},computed:{getApiParameters(){return{"supplements[ticket_id]":this.tickets,"supplements[no_email]":1}},assignLabel(){return this.lang(`problem_bulk_select_${this.assign}`)}},methods:{getAttachments(e){this.attachments=e},onChange(e,t){this[t]=e,t==="assign"&&(this.assignChange=!0,setTimeout(()=>{this.assignChange=!1},1),this.assign_to=e!="assign_to_me"?"":{id:sessionStorage.getItem("user_id")},this.isDisabled=e!="assign_to_me"),["assign_to","status","priority","description"].includes(t)&&(this.isDisabled=!e)},detectIsDisabled(){switch(this.identifier){case"change_status":return!this.status;case"change_priority":return!this.priority;case"reply":return!this.description;case"assign":return!this.assign_to}},async onSubmit(){this.loading=!0,this.isDisabled=!0;let e;switch(this.identifier){case"change_status":e={type:"status",value:this.status};break;case"change_priority":e={type:"priority",value:this.priority};break;case"assign":e={type:"assign",value:{assigneeType:this.assign,assigneeInfo:this.assign_to}};break;case"reply":e={type:"reply",value:{text:this.description,attachments:this.attachments}};break}let t={tickets:this.tickets,action:e};try{let s=await T.post("service-desk/api/problem-bulk-actions",t);Object.assign(this.$data,zs()),this.componentNameToRefresh&&(window.emitter.emit(`${this.componentNameToRefresh}refreshData`),window.emitter.emit(`${this.componentNameToRefresh}uncheckCheckbox`)),K(s,this.componentTitle)}catch(s){O(s,this.componentTitle)}finally{this.loading=!1,this.isDisabled=this.detectIsDisabled(),this.onClose()}}}},fw={class:"modal-title"},gw={key:0},bw={key:0,class:"row me-1"},yw={key:1,class:"row"},vw={key:2,class:"row"},ww={key:3,class:"row"},kw={key:0,id:"assign_change"},Cw={key:1,class:"row"},Dw=["disabled"];function Sw(e,t,s,d,a,i){const m=u("add-media"),h=u("dynamic-select"),b=u("radio-button"),f=u("reuse-loader"),g=u("modal");return s.showModal?(o(),k(g,{key:0,showModal:s.showModal,onClose:s.onClose,modalBodyClass:s.identifier==="reply"?"bulk_action_modal_dimensions":""},{title:w(()=>[n("h4",fw,r(e.lang(`problem_bulk_${s.identifier}`)),1)]),fields:w(()=>[e.loading?c("",!0):(o(),l("div",gw,[s.identifier==="reply"?(o(),l("div",bw,[_(m,{attachments:e.attachments,inlineFile:e.inline,description:e.description,classname:"col-sm-12",name:"description",onAttach:i.getAttachments,onInput:i.onChange,page_name:"problem_bulk_action",id:"focus_editor"},null,8,["attachments","inlineFile","description","onAttach","onInput"])])):c("",!0),s.identifier==="change_status"?(o(),l("div",yw,[_(h,{label:e.trans("problem_bulk_select_status"),multiple:!1,name:"status",classname:"col-sm-12",apiEndpoint:"api/dependency/statuses?meta=true",value:e.status,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])])):c("",!0),s.identifier==="change_priority"?(o(),l("div",vw,[_(h,{label:e.trans("problem_bulk_select_priority"),multiple:!1,name:"priority",classname:"col-sm-12",apiEndpoint:"api/dependency/priorities",value:e.priority,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])])):c("",!0),s.identifier==="assign"?(o(),l("div",ww,[_(b,{name:"assign",value:e.assign,options:e.radioOptions,label:e.lang("assign_to"),onChange:i.onChange,classname:"form-group col-sm-6"},null,8,["value","options","label","onChange"]),e.assignChange?(o(),l("div",kw,[_(f,{size:30,duration:4e3,color:"#1d78ff"})])):c("",!0),!e.assignChange&&e.assign!="assign_to_me"?(o(),k(h,{key:1,label:i.assignLabel,multiple:!1,name:"assign_to",classname:"col-sm-6","api-endpoint":"api/dependency/"+e.assign,"api-parameters":i.getApiParameters,value:e.assign_to,onChange:i.onChange},null,8,["label","api-endpoint","api-parameters","value","onChange"])):c("",!0)])):c("",!0)])),e.loading?(o(),l("div",Cw,[_(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=D=>i.onSubmit()),class:"btn btn-primary",disabled:e.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.lang("update")),1)],8,Dw)]),_:1},8,["showModal","onClose","modalBodyClass"])):c("",!0)}const Mw=P(_w,[["render",Sw]]),Fw={name:"problem-ticket-detach-modal",description:"Problem Ticket Detach Modal component",props:{showModal:{type:Boolean,default:!1},problemId:{type:[String,Number],default:""},ticketId:{type:[String,Number],default:""},type:{type:String,default:""},onClose:{type:Function},componentTitle:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/problem-detach-ticket/"+this.problemId+"/"+this.ticketId).then(e=>{K(e,"problem-view"),window.emitter.emit(this.componentTitle+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,O(e,"detach-ticket")})}}},Iw={class:"modal-title"},Aw={key:0},Pw={key:1,class:"row"},Tw=["disabled"];function Vw(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{alert:w(()=>[_(m,{componentName:"detach-ticket"})]),title:w(()=>[n("h4",Iw,r(e.lang("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",Aw,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",Pw,[_(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink"},null,-1)),v(" "+r(e.lang("detach")),1)],8,Tw)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Lw=P(Fw,[["render",Vw]]);const Uw={name:"problem-tickets-table",description:"Problem tickets table page",props:{problemId:{type:[String,Number],default:""},componentTitle:{type:String,default:"ProblemTickets"},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["id","ticket_number","subject","assignedTo","action"],options:{},apiEndPoint:"/service-desk/api/problem-tickets/"+this.problemId,ticketId:"",ticket_type:"",showModal:!1,ticketIds:[],bulkActions:[{name:"change_status",icon:"fas fa-exchange-alt"},{name:"change_priority",icon:"fas fa-asterisk"},{name:"assign",icon:"far fa-hand-point-right"},{name:"reply",icon:"fas fa-reply"}],action:null,showBulkActionModal:!1,componentName:"problem-associated-ticket-alert",totalCount:"",searchTerm:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{id:this.trans("id"),ticket_number:this.lang("ticket_number"),subject:this.lang("subject"),assignedTo:this.lang("assigned_to"),action:this.lang("action")},columnsClasses:{ticket_number:"associate-number",subject:"associate-subject",assignedTo:"associate-assigned",type:"associate-type",action:"associate-action"},texts:{filter:"",limit:""},templates:{subject:function(t,s){return e.h(De,{to:"/thread/"+s.id},s.subject)},ticket_number:function(t,s){return e.h(De,{to:"/thread/"+s.id},"#"+s.ticket_number)},assignedTo:function(t,s){return s.assignedTo?e.h(De,{to:"/user/"+s.assignedTo.id},s.assignedTo.full_name):s.assignedTeam?e.h("a",{href:e.basePath()+"/assign-teams/"+s.assignedTeam.id},s.assignedTeam.name):"--"},action(t,s){let d=e.h("i",{class:"fa fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.onDetach(s.id,s.type)}},[d])}},sortable:["ticket_number"],filterable:["ticket_number"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return e.searchTerm=t.query.trim(),{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc",search_query:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.tickets,count:e.totalCount}},orderBy:{column:"id",ascending:!0}}},methods:{ticketsData(e){this.ticketIds=e},performAction(e){this.action=e,this.showBulkActionModal=!0},onDetach(e,t){this.ticketId=e,this.ticket_type=t,this.showModal=!0},onClose(){this.showModal=!1,window.emitter.emit("updateProblemActions")},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){!this.searchTerm&&e===0&&window.emitter.emit("updateProblemTables")},searchTerm(e){this.searchTerm=e}},components:{"ticket-detach-modal":Lw,ProblemBulkActionModal:Mw}},Nw={id:"problem_tickets"},Ew={key:0,class:"row bulk-actions"},xw={class:"col-sm-12"},Ow={class:"btn-group float-end"},qw={type:"button",class:"btn btn-sm btn-light dropdown-toggle","data-bs-toggle":"dropdown",id:"bulk_actions"},jw={class:"dropdown-menu status-list dropdown-menu-right"},Rw=["onClick"];function Bw(e,t,s,d,a,i){const m=u("alert"),h=u("data-table"),b=u("ticket-detach-modal"),f=u("problem-bulk-action-modal");return o(),l("div",Nw,[_(m,{"component-name":a.componentName},null,8,["component-name"]),_(X,{name:"fade"},{default:w(()=>[a.ticketIds.length?(o(),l("div",Ew,[n("div",xw,[n("div",Ow,[n("button",qw,[t[0]||(t[0]=n("i",{class:"fas fa-cog"},null,-1)),v(" "+r(e.trans("problem_bulk_actions")),1)]),n("div",jw,[(o(!0),l(U,null,$(a.bulkActions,g=>(o(),l("a",{key:g.name,class:"dropdown-item",id:"change_status",onClick:D=>i.performAction(g.name),href:"javascript:;"},[n("i",{class:Q(g.icon)},null,2),v("  "+r(e.lang(`problem_bulk_${g.name}`)),1)],8,Rw))),128))])])])])):c("",!0)]),_:1}),_(h,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"problem-associates",componentTitle:s.componentTitle,tickets:i.ticketsData,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","tickets","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showModal,ticketId:a.ticketId,problemId:s.problemId,type:a.ticket_type,componentTitle:s.componentTitle},null,8,["onClose","showModal","ticketId","problemId","type","componentTitle"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[_(f,{"show-modal":a.showBulkActionModal,tickets:a.ticketIds,identifier:a.action,"component-title":a.componentName,"on-close":()=>{this.showBulkActionModal=!1},"component-name-to-refresh":s.componentTitle},null,8,["show-modal","tickets","identifier","component-title","on-close","component-name-to-refresh"])]),_:1})])}const zw=P(Uw,[["render",Bw]]);const Kw={name:"problem-associates",description:"Problem associates page",props:{problemId:{type:[String,Number],default:""},problem:{type:Object,default:()=>{}}},data(){return{tabs:"",category:"activity",loading:!0,dynamicKeys:{details:1,assets:1,activity:1,changes:1,tickets:1}}},created(){window.emitter.on("problemActionsList",this.getActionsList),window.emitter.on("updateProblemTables",()=>this.associates("activity")),this.$store.dispatch("setProblemAssociateCategory",this.category)},methods:{getActionsList(e){this.tabs=[{id:"activity",title:"activity_log",show:!0},{id:"details",title:"planning",show:e.check_planning},{id:"assets",title:"associated_assets",show:e.associated_asset},{id:"changes",title:"associated_changes",show:e.associated_change},{id:"tickets",title:"associated_tickets",show:e.associated_ticket}]},associateMethod(e){this.loading=!0,setTimeout(()=>{this.loading=!1,this.associates(e)},3e3)},associates(e){this.category!==e&&(e!=="changes"&&(this.loading=!0),this.category=e),this.updateKey(e)},handelLoader(e){this.loading=e},updateKey(e){e!=="changes"&&(this.loading=!0),this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setProblemAssociateCategory",e)}},components:{"problem-associated-assets":Av,"problem-planning":s1,"problem-activity":M1,"problem-change-details":pw,"problem-associated-tickets":zw}},Hw={key:0,class:"card card-light card-tabs",id:"changes-associates"},Yw={class:"card-header p-0 pt-1"},$w={class:"nav nav-tabs"},Ww={key:0,class:"nav-item"},Jw=["onClick"],Gw={class:"nav-item ms-auto mt-04"},Xw={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},Zw={class:"card-body"},Qw={class:"tab-content"},ek={class:"active tab-pane",id:"activity"};function tk(e,t,s,d,a,i){const m=u("alert"),h=u("problem-planning"),b=u("problem-associated-assets"),f=u("problem-activity"),g=u("problem-change-details"),D=u("problem-associated-tickets");return a.tabs?(o(),l("div",Hw,[_(m,{componentName:"problemAssociates"}),n("div",Yw,[n("ul",$w,[(o(!0),l(U,null,$(a.tabs,M=>(o(),l(U,null,[M.show?(o(),l("li",Ww,[n("a",{id:"problems_tab",class:Q(["nav-link",{active:a.category===M.id}]),"data-bs-toggle":"pill",onClick:x=>i.associates(M.id)},r(e.lang(M.title)),11,Jw)])):c("",!0)],64))),256)),n("li",Gw,[a.loading?(o(),l("a",Xw,t[0]||(t[0]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])])]),n("div",Zw,[n("div",Qw,[n("div",ek,[n("div",null,[a.category=="details"?(o(),k(h,{problemId:s.problemId,onLoaderValue:i.handelLoader,key:"problem_planning"+a.dynamicKeys.details},null,8,["problemId","onLoaderValue"])):c("",!0),a.category=="assets"?(o(),k(b,{componentTitle:"problemAssets",apiUrl:"/service-desk/api/asset-list?problem_ids="+s.problemId,problemId:s.problemId,category:a.category,disableLoader:"true",onLoaderValue:i.handelLoader,key:"problem_asset"+a.dynamicKeys.assets},null,8,["apiUrl","problemId","category","onLoaderValue"])):c("",!0),a.category=="activity"?(o(),k(f,{problemId:s.problemId,onLoaderValue:i.handelLoader,key:"problem_activity"+a.dynamicKeys.activity},null,8,["problemId","onLoaderValue"])):c("",!0),a.category=="changes"?(o(),k(g,{change:s.problem.change,key:"problem_change"+a.dynamicKeys.changes},null,8,["change"])):c("",!0),a.category=="tickets"?(o(),k(D,{problemId:s.problemId,componentTitle:"ProblemTickets",disableLoader:"true",onLoaderValue:i.handelLoader,key:"problem_ticket"+a.dynamicKeys.tickets},null,8,["problemId","onLoaderValue"])):c("",!0)])])])])])):c("",!0)}const sk=P(Kw,[["render",tk],["__scopeId","data-v-13333963"]]);const ak={name:"problem-view",description:"Problem view page",data(){return{problem:"",problem_id:"",loading:!0,counter:0}},beforeMount(){this.getValues()},created(){window.emitter.on("updateProblemAssociates",this.updateAssociates)},methods:{refreshData(){this.getValues()},updateAssociates(){this.counter+=1},getValues(){const e=window.location.pathname;this.problem_id=pe(e),T.get("/service-desk/api/problem/"+this.problem_id).then(t=>{this.loading=!1,this.problem=t.data.data}).catch(t=>{this.loading=!1})}},components:{"problem-details":Sv,"problem-associates":sk}},nk={class:"col-sm-12"},ok={key:1,class:"row"};function ik(e,t,s,d,a,i){const m=u("alert"),h=u("problem-details"),b=u("problem-associates"),f=u("reuse-loader");return o(),l("div",nk,[_(m,{componentName:"problem-view"}),a.loading?c("",!0):(o(),l(U,{key:0},[(o(),k(h,{problem:a.problem,key:a.problem_id,updateData:i.refreshData},null,8,["problem","updateData"])),(o(),k(b,{problemId:a.problem_id,problem:a.problem,key:"problem_associates"+a.counter},null,8,["problemId","problem"]))],64)),a.loading?(o(),l("div",ok,[_(f,{"animation-duration":4e3,size:60})])):c("",!0)])}const lk=P(ak,[["render",ik]]);const rk={name:"table-filter",description:"Table filter component",props:{metaData:{type:Array,required:!0},appliedFilters:{type:Object,default:()=>{}},parsedUrlParams:{type:Object,default:()=>{}},from:{type:String,default:""},showCustomFilter:{type:Boolean,default:!1},updateFields:{type:Function,default:()=>{}},selectedFields:{type:Array,default:()=>[]},endPoint:{type:String,default:""},saveFilter:{type:Boolean,default:!1},filterFor:{type:String,default:""},filterNum:{type:[String,Number],default:""},redirectTo:{type:String,default:""},deleteUrl:{type:String,default:""},closeFilter:{type:Function,default:()=>{}},save_endpoint:{type:String,default:""}},data(){return{selectedFilters:this.appliedFilters,close_on_select:!this.multiple,isShowFilter:!1,componentMetaData:this.metaData,loading:!1,formStyle:{width:"49.5%"},numberStyle:{width:"20%"},showModal:!1,filterName:"",selectedFilterId:this.filterNum,departments:[],agents:[],filterMode:"",icon_class:"",icon_color:"",dashboardWidget:!1,isDefault:!1}},beforeMount(){this.updateSelectedFieldValues();const e=at();this.filterNum?this.getFilterValue("/service-desk/api/agent/sd-filter/"+this.selectedFilterId,"filter"):e&&e.hasOwnProperty("filter-by-url")&&this.getFilterValue("/service-desk/api/filter-dependencies","urlFilter")},methods:{updatedCustomFields(e){for(var t in e)this.onChange(e[t].value,e[t].name)},updateSelectedFieldValues(){this.updateFields(this.selectedFields);for(var e in this.selectedFields)this.onChange(this.selectedFields[e].value,this.selectedFields[e].name)},onChange(e,t){this.selectedFilters[t]=e,window.emitter.emit("onFilterSelected",this.selectedFilters)},onCancel(){this.$emit("selectedFilters","closeEvent")},onApply(){this.$emit("selectedFilters",this.selectedFilters)},onSave(e){this.filterMode=e,this.showModal=!0},toggleFilterPopUp(e){this.showModal=e},onReset(){this.selectedFilters={},this.loading=!0,setTimeout(()=>{this.loading=!1},1e3),this.$emit("selectedFilters","resetEvent"),window.emitter.emit("onFilterSelected",this.selectedFilters)},getFilterValue(e,t){this.loading=!0,axios.get(e,{params:this.parsedUrlParams}).then(s=>{this.loading=!1;let d={},a=[];this.isDefault=s.data.data.is_default,(t==="filter"?s.data.data.fields:s.data.data).map(m=>{m.key.indexOf("custom_")!==-1?(a.push(m),d[m.key]=m.value):d[m.key]=m.value_meta}),a.length&&this.appendCustomFieldFilter(a),this.selectedFilters=d,window.emitter.emit("onFilterSelected",this.selectedFilters),this.componentMetaData.map(function(m){m.section.map(function(h){d.hasOwnProperty(h.name)&&(h.value=d[h.name])})}),this.selectedFilterId=s.data.data.id,this.filterName=this.isDefault?"":s.data.data.name,this.icon_class=!this.isDefault&&s.data.data.icon_class?{icon_class:s.data.data.icon_class}:"",this.departments=s.data.data.departments,this.agents=s.data.data.agents,this.dashboardWidget=s.data.data.is_dashboard_widget,this.icon_color=this.isDefault?"#00C0EF":s.data.data.icon_color}).catch(s=>{this.loading=!1})},appendCustomFieldFilter(e){this.$refs.custom_table_filter.getCustomFields(this.endPoint,e)}},components:{"dynamic-select":fe,"date-time-field":hs,"number-range-field":ps,"text-field":Ae,"custom-filter":Mn,"save-table-filter":_s,"custom-form-fields":jn}},dk={key:0,class:"card-body"},ck={class:"row"},uk={key:1,id:"table-filter"},mk={class:"row"},hk={class:"card-footer"};function pk(e,t,s,d,a,i){const m=u("custom-filter"),h=u("custom-loader"),b=u("custom-form-fields"),f=u("dynamic-select"),g=u("number-range-field"),D=u("text-field"),M=u("date-time-field"),x=u("save-table-filter"),R=u("faveo-box");return o(),k(R,{"box-class":"card card-light ",title:e.lang("filter")},{customActions:w(()=>[s.showCustomFilter?(o(),k(m,{key:0,updateFilterFields:s.updateFields,selectedFilterFields:s.selectedFields,endPoint:s.endPoint,ref:"custom_table_filter",defaultFiltersObj:a.selectedFilters},null,8,["updateFilterFields","selectedFilterFields","endPoint","defaultFiltersObj"])):c("",!0)]),actions:w(()=>[n("div",hk,[n("button",{id:"filter-apply-btn",class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=(...V)=>i.onApply&&i.onApply(...V))},[t[6]||(t[6]=n("span",{class:"fas fa-check"},null,-1)),v("  "+r(e.lang("apply")),1)]),s.saveFilter?(o(),l(U,{key:0},[s.filterNum&&!a.isDefault&&!a.loading?(o(),l(U,{key:0},[n("button",{id:"filter-upd",class:"btn btn-primary",type:"button",onClick:t[1]||(t[1]=V=>i.onSave("update"))},[t[7]||(t[7]=n("span",{class:"fas fa-sync"},null,-1)),v("  "+r(e.lang("update")),1)]),n("button",{id:"filetr-del",class:"btn btn-secondary",type:"button",onClick:t[2]||(t[2]=V=>i.onSave("delete"))},[t[8]||(t[8]=n("span",{class:"fas fa-trash-alt"},null,-1)),v("  "+r(e.lang("delete")),1)])],64)):(o(),l("button",{key:1,id:"filetr-save",class:"btn btn-primary",type:"button",onClick:t[3]||(t[3]=V=>i.onSave("save"))},[t[9]||(t[9]=n("span",{class:"fas fa-save"},null,-1)),v("  "+r(e.lang("save")),1)]))],64)):c("",!0),n("button",{id:"reset-btn",class:"btn btn-primary",type:"button",onClick:t[4]||(t[4]=(...V)=>i.onReset&&i.onReset(...V))},[t[10]||(t[10]=n("span",{class:"fas fa-undo"},null,-1)),v("  "+r(e.lang("reset")),1)]),s.from!=="report"?(o(),l("button",{key:1,id:"filter-cancel-btn",class:"btn btn-secondary",type:"button",onClick:t[5]||(t[5]=(...V)=>i.onCancel&&i.onCancel(...V))},[t[11]||(t[11]=n("span",{class:"fas fa-times"},null,-1)),v("  "+r(e.lang("cancel")),1)])):c("",!0)])]),default:w(()=>[a.loading?(o(),l("div",dk,[n("div",ck,[_(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])])):(o(),l("div",uk,[(o(!0),l(U,null,$(a.componentMetaData,V=>(o(),l("div",mk,[(o(!0),l(U,null,$(V.section,N=>(o(),l(U,null,[N.isCustom?(o(),k(b,{key:0,formField:N,allFields:s.selectedFields,onUpdated:i.updatedCustomFields,classname:N.className},null,8,["formField","allFields","onUpdated","classname"])):(o(),l(U,{key:1},[N.type!=="date"&&N.type!=="number"&&N.type!=="text"?(o(),k(f,{key:N.name,id:N.name,name:N.name,apiEndpoint:N.url,classname:N.className,elements:N.elements,multiple:N.isMultiple,label:e.lang(N.label),value:N.value,onChange:i.onChange,strlength:"35",hint:e.lang(N.hint)},null,8,["id","name","apiEndpoint","classname","elements","multiple","label","value","onChange","hint"])):c("",!0),N.type==="number"?(o(),k(g,{label:e.lang(N.label),formStyle:a.formStyle,value:N.value,key:N.name,id:N.name,name:N.name,classname:N.className,type:"text",onChange:i.onChange,min_placeholder:N.min_placeholder,max_placeholder:N.max_placeholder,required:!1},null,8,["label","formStyle","value","id","name","classname","onChange","min_placeholder","max_placeholder"])):c("",!0),N.type==="text"?(o(),k(D,{label:e.lang(N.label),value:N.value,key:N.name,id:N.name,name:N.name,onChange:i.onChange,classname:N.className,required:!1},null,8,["label","value","id","name","onChange","classname"])):c("",!0),N.type==="date"?(o(),k(M,{label:N.label,value:N.value,type:"datetime",key:N.name,id:N.name,name:N.name,onChange:i.onChange,range:N.range,required:!1,format:"MMMM DD YYYY, h:mm a",classname:N.className,clearable:!1,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":N.timeOptions,isDateSelector:!1,numberStyle:a.numberStyle,confirm:!0},null,8,["label","value","id","name","onChange","range","classname","time-picker-options","numberStyle"])):c("",!0)],64))],64))),256))]))),256))])),a.showModal?(o(),k(x,{key:2,filterName:a.filterName,icon:a.icon_class,filterValues:a.selectedFilters,filterId:a.selectedFilterId,toggleFilterPopUp:i.toggleFilterPopUp,source:s.filterFor,onUpdateFilterData:i.onApply,filterArray:a.componentMetaData,intitialDepartments:a.departments,initialAgents:a.agents,mode:a.filterMode,is_default:a.isDefault,redirectTo:s.redirectTo,deleteUrl:s.deleteUrl,closeFilter:s.closeFilter,save_endpoint:s.save_endpoint,dashboardWidget:a.dashboardWidget,icon_color:a.icon_color},null,8,["filterName","icon","filterValues","filterId","toggleFilterPopUp","source","onUpdateFilterData","filterArray","intitialDepartments","initialAgents","mode","is_default","redirectTo","deleteUrl","closeFilter","save_endpoint","dashboardWidget","icon_color"])):c("",!0)]),_:1},8,["title"])}const ss=P(rk,[["render",pk]]);const _k={name:"changes-list",description:"Changes lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{filterIndex:{type:Boolean,default:!1}},data:()=>({parsedUrlParams:"",columns:[],hasDataPopulated:!1,visibleColumns:{},staticColumns:["actions"],apiUrl:"/service-desk/api/change-list",filterOptions:[{section:[{name:"change_ids",url:"/service-desk/api/dependency/changes?meta=true",label:"changes",isCustom:!1},{name:"department_ids",url:"/api/dependency/departments",label:"departments",isCustom:!1},{name:"team_ids",url:"/api/dependency/teams",label:"teams",isCustom:!1}]},{section:[{name:"requester_ids",url:"/api/dependency/users?meta=true",label:"requester",isCustom:!1},{name:"status_ids",url:"/service-desk/api/status/list?module=2",label:"status",isCustom:!1},{name:"priority_ids",url:"/service-desk/api/dependency/change_priorities",label:"priority",isCustom:!1}]},{section:[{name:"change_type_ids",url:"/service-desk/api/dependency/change_types",label:"change_type",isCustom:!1},{name:"impact_ids",url:"/service-desk/api/dependency/impacts",label:"impact",isCustom:!1},{name:"location_ids",url:"/api/dependency/locations",label:"location",isCustom:!1}]},{section:[{name:"asset_ids",url:"/service-desk/api/asset-list?meta=true",label:"assets",isCustom:!1},{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases",isCustom:!1},{name:"ticket_ids",url:"/api/dependency/tickets",label:"tickets",isCustom:!1}]},{section:[{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems",isCustom:!1},{name:"assignee-ids",url:"/api/dependency/agents",label:"agent"},{name:"pending_approvers",url:"/api/dependency/users",label:"pending_approvers"}]},{section:[{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},pickers:!0,range:!0,isCustom:!1}]},{section:[]}],columnData:null,changeData:null,isShowFilter:!1,appliedFilters:{},customFields:[],changeFilterId:"",showIcon:!1,reportType:"changes",exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[]}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},computed:{fieldsEndPoint(){let e=location.search.substring(1),t,s;e&&(t=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"').replace(/%2F/g,"/")+'"}')),t&&(s=Object.keys(t).find(i=>i.includes("custom_")));let d={category:"changes",type:"changes",module:"filter",filter_id:this.changeFilterId||"",filter_key:s||""};return"/custom-field-flattened?"+Object.entries(d).map(([i,m])=>`${encodeURIComponent(i)}=${encodeURIComponent(m)}`).join("&")}},beforeMount(){const e=window.location.pathname;this.changeFilterId=pe(e);const t=at();t&&t.hasOwnProperty("filter-by-url")?(this.parsedUrlParams=t,It("/service-desk/api/filter-dependencies",t,{},a=>{a&&this.applyFilter(a,"dependencyFilter")},a=>{O(a)})):this.apiUrl=this.filterIndex?"/service-desk/api/change-list?filter_id="+this.changeFilterId:"/service-desk/api/change-list",this.filterData(),this.getChangeData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name==s.name&&(s.value=e.value)})})},getChangeData(){this.hasDataPopulated=!1,T.get("api/agent/report-config/change-report").then(e=>{this.changeData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],O(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{Re(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.type=="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[6].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/change-list?filter_id="+this.changeFilterId:"/service-desk/api/change-list",this.updateFilterFields([]),window.emitter.emit("clearCustomFields"),this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e,t=""){this.appliedFilters=e;for(var s in this.customFields)this.customFields[s].value=e[this.customFields[s].name];let d="/service-desk/api/change-list?",a=new URLSearchParams(vt(this.filterOptions,e));t==="dependencyFilter"&&Object.entries(e).forEach(([f,g])=>{f.includes("custom_")&&(a+=`${encodeURIComponent(f)}=${encodeURIComponent(g)}&`)});const m=a,h=new URLSearchParams(m),b={};for(const[f,g]of h)b[f]=g;a[a.length-1]==="&"&&(a=a.slice(0,-1)),this.apiUrl=d+a,this.exportData=this.reformatExportData(b)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[a,i,m]=d;t[i]=t[i]||[],t[i][m]=parseInt(e[s],10)}else t[s]=e[s].trim()}return t},exportReport(){this.loading=!0;const e={...this.exportData,total:this.dataCount};let t={};this.filterIndex&&(t.filter_id=this.changeFilterId);const s={...this.exportData,...t,total:this.dataCount};T.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:e).then(d=>{K(d,"dataTableModal")}).catch(d=>{O(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.changeFilterId};this.$router.push({path:"/reports/schedule/add/"+this.changeData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{"user-column-list":Pt,"dynamic-datatable":Tt,"changes-filter":ss,"asset-list-with-checkbox":ht}},fk={class:"col-sm-12"},gk={key:0,class:"card card-light"},bk={class:"card-header"},yk={id:"changes-list",class:"card-title"},vk={class:"card-tools"},wk={key:0,class:"card-body",id:"changes_list"};function kk(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("changes-filter"),f=u("user-column-list"),g=u("dynamic-datatable"),D=W("tooltip");return o(),l("div",fk,[_(m,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",gk,[n("div",bk,[n("h3",yk,r(e.lang("list_of_changes")),1),n("div",vk,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/changes/create"},{default:w(()=>t[3]||(t[3]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[D,e.lang("create_change")]]),S((o(),l("a",{class:"btn btn-tool",href:"javascript:;",onClick:t[0]||(t[0]=(...M)=>i.toggleFilterView&&i.toggleFilterView(...M))},t[4]||(t[4]=[n("span",{class:"glyphicon glyphicon-filter"},null,-1)]))),[[D,e.lang("filter")]]),e.showIcon?S((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=M=>i.exportReport()),href:"javascript:;"},t[5]||(t[5]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.lang("export")]]):c("",!0),e.showIcon?S((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=M=>i.scheduleList()),href:"javascript:;"},t[6]||(t[6]=[n("i",{class:"fas fa-calendar"},null,-1)]))),[[D,e.lang("schedule")]]):c("",!0)])]),e.apiUrl?(o(),l("div",wk,[e.isShowFilter?(o(),k(b,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:i.fieldsEndPoint,saveFilter:!0,filterFor:"change",filterNum:e.changeFilterId,redirectTo:"/service-desk/changes",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.changeFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter",parsedUrlParams:e.parsedUrlParams},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","endPoint","filterNum","deleteUrl","closeFilter","parsedUrlParams"])):c("",!0),(o(!0),l(U,null,$(e.columnData,M=>(o(),l("section",{key:M},[_(f,{"table-columns":M.columns,reportId:M.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),k(g,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:M.columns,staticColumns:e.staticColumns,show_pagination:e.showPagination,"report-type":e.reportType},null,8,["data-url","columns","columnsMeta","staticColumns","show_pagination","report-type"])):c("",!0)]))),128))])):c("",!0)])):c("",!0)])}const Ks=P(_k,[["render",kk]]),Ck={name:"change-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[Xe],beforeMount(){if(this.mode==="edit"){const e=pe(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-change/"+e,this.editId=pe(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=At(this.category);if(this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"){let s=e.data.data.id;setTimeout(()=>{this.$router.push("/service-desk/changes/"+s+"/show")},1e3)}}},components:{FormRenderer:Ze,Alert:We,FaveoBox:wt,CustomLoader:nt}},Dk={class:"col-sm-12"},Sk={key:0,class:"pull-right"},Mk={key:0,class:"form-group row mt-3"},Fk={class:"col-md-12"},Ik=["disabled"],Ak={key:0},Pk={key:1};function Tk(e,t,s,d,a,i){const m=u("Alert"),h=u("CustomLoader"),b=u("router-link"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FaveoBox"),M=W("tooltip");return o(),l("div",Dk,[a.formUniqueKey&&a.formSelected?(o(),k(D,{key:0,title:e.lang(i.mode)},{headerMenu:w(()=>[s.showViewButton?(o(),l("span",Sk,[S((o(),k(b,{to:"/service-desk/changes/"+a.editId+"/show",class:"btn btn-tool has-tooltip"},{default:w(()=>t[1]||(t[1]=[n("span",null,[n("i",{class:"fas fa-eye"})],-1)])),_:1},8,["to"])),[[M,e.trans("view")]])])):c("",!0)]),default:w(()=>[_(m,{componentName:"faveo-form"}),_(m,{componentName:"form-renderer"}),e.showLoader||a.submitFormInProgress?(o(),k(h,{key:0,duration:4e3})):c("",!0),_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:a.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",Mk,[n("div",Fk,[n("button",{type:"button",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=N=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",Ak,t[2]||(t[2]=[n("i",{class:"fas fa-sync"},null,-1)]))):(o(),l("span",Pk,t[3]||(t[3]=[n("i",{class:"fas fa-save"},null,-1)]))),v(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,Ik)])]))]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const Hs=P(Ck,[["render",Tk]]),Vk={name:"assign-ticket-modal",description:"Assign ticket Modal component",props:{showModal:{type:Boolean,default:!1},agentIds:{type:Array,default:()=>[]},tickets:{type:Array,default:()=>[]},onClose:{type:Function,default:()=>{}},deptId:{type:[String,Number],default:""},teamId:{type:[String,Number],default:""},changeID:{type:[String,Number],default:""}},data:()=>({isDisabled:!0,containerStyle:{width:"800px"},loading:!1,size:60,assign_to:"",assign:"agents",assignChange:!1,category:""}),computed:{getApiParameters(){let e={};if(e["supplements[ticket_id]"]=this.agentIds,e["supplements[no_email]"]=1,this.deptId&&(e["department_ids[]"]=this.deptId),this.teamId&&(e.team_id=this.teamId),this.tickets.length){let t=this.tickets.filter(s=>this.agentIds.includes(s.id)).map(s=>s.department.id);e.department_ids=t.filter((s,d)=>t.indexOf(s)===d)}return e}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e,t==="assign"&&(this.assignChange=!0,setTimeout(()=>{this.assignChange=!1},1)),t==="assign_to"&&(this.isDisabled=!e)},onSubmit(){this.loading=!0,this.isDisabled=!0,T.get("/service-desk/api/change/assign/"+this.assign_to.id+"/"+this.changeID).then(e=>{this.loading=!1,this.isDisabled=!0,K(e,"change-view"),window.emitter.emit("updateChangeAssociates"),this.category==="activity"&&window.emitter.emit("updateChangeActivity"),this.onClose()}).catch(e=>{this.loading=!1,this.isDisabled=!1,O(e,"change"),this.onClose()})}},components:{"dynamic-select":fe,"radio-button":mt}},Lk={class:"modal-title"},Uk={key:0,class:"row"},Nk={key:0,id:"assign_change"},Ek={key:1,class:"row"},xk=["disabled"];function Ok(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("dynamic-select"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:w(()=>[n("h4",Lk,r(e.lang("assign_changes")),1)]),fields:w(()=>[e.loading?c("",!0):(o(),l("div",Uk,[e.assignChange?(o(),l("div",Nk,[_(m,{size:30,duration:4e3,color:"#1d78ff"})])):c("",!0),!e.assignChange&&e.assign!="assign_to_me"?(o(),k(h,{key:1,label:e.lang("whome_do_you_want_to_assign_change"),multiple:!1,name:"assign_to",classname:"col-sm-12","api-endpoint":"api/dependency/"+e.assign+"?meta=true&team_id="+s.teamId+"&department_id="+s.deptId,"api-parameters":i.getApiParameters,value:e.assign_to,onChange:i.onChange,strlength:"65"},null,8,["label","api-endpoint","api-parameters","value","onChange"])):c("",!0)])),e.loading?(o(),l("div",Ek,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):c("",!0)]),controls:w(()=>[n("button",{type:"button",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",id:"submit_btn",disabled:e.isDisabled},[t[1]||(t[1]=n("i",{class:"far fa-hand-point-right"},null,-1)),v(" "+r(e.lang("assign")),1)],8,xk)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const qk=P(Vk,[["render",Ok]]),jk={name:"release-add-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!0,containerStyle:{width:"500px"},loading:!1,release_id:"",category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e,this.isDisabled=!e},onSubmit(){this.loading=!0,this.isDisabled=!0,T.post("/service-desk/api/change/attach-release/"+this.changeId+"/"+this.release_id.id).then(e=>{K(e,"change-view"),this.onClose(),this.loading=!1,this.isDisabled=!0,window.emitter.emit("updateChangeAssociates"),window.emitter.emit("refreshChangeStatus"),this.category==="activity"&&window.emitter.emit("updateChangeActivity")}).catch(e=>{this.loading=!1,this.isDisabled=!0,O(e,"change-view")})}},components:{"dynamic-select":fe}},Rk={class:"modal-title"},Bk={key:0},zk={class:"row"},Kk={key:1,class:"row"},Hk=["disabled"];function Yk(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",Rk,r(e.lang("release")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",Bk,[n("div",zk,[_(m,{label:e.lang("release"),multiple:!1,name:"release_id",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/releases",value:a.release_id,onChange:i.onChange,required:!0,clearable:!!a.release_id},null,8,["label","value","onChange","clearable"])])])),a.loading?(o(),l("div",Kk,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-check"},null,-1)),v(" "+r(e.lang("proceed")),1)],8,Hk)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const $k=P(jk,[["render",Yk]]);function Wk(e){const{subject:t,releaseType:s,status:d,priority:a,description:i}=e;var m={subject:[t,"isRequired"],releaseType:[s,"isRequired"],status:[d,"isRequired"],priority:[a,"isRequired"],description:[i,"isRequired"]};const h=new Ue(Ce),{errors:b,isValid:f}=h.validate(m);return Fe.dispatch("setValidationError",b),{errors:b,isValid:f}}const Jk={name:"release-create-edit",description:"Releease create edit page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{from:{type:String,default:""},change_id:{type:[String,Number],default:""},onComplete:{type:Function},alertName:{type:String,default:"release-create-edit"}},data(){return{title:"create_release",iconClass:"fas fa-save",btnName:"submit",hasDataPopulated:!1,loading:!1,release_id:"",subject:"",description:"",planned_date:"",planned_start_date:"",planned_end_date:"",status:"",location:"",priority:"",attach_assets:[],attachment:"",releaseType:"",show_attach_assets:!0,timeOptions:{start:"00:00",step:"00:30",end:"23:30"},selectedFile:"",attachment_delete:!1,identifier:""}},beforeMount(){this.getActions();const e=window.location.pathname;this.getValues(e)},methods:{getActions(){T.get("/service-desk/get/permissions").then(e=>{this.show_attach_assets=e.data.data.actions.attach_asset}).catch(e=>{this.show_attach_assets=!0})},getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.title="edit_release",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.selectedFile="",this.loading=!0,T.get("/service-desk/api/release/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0;let s=t.data.data.release;this.updateStatesWithData(s),this.releaseType=s.release_type,this.release_id=s.id,s.planned_start_date&&(this.planned_date=[new Date(s.planned_start_date),new Date(s.planned_end_date)]),this.attachment=s.attachment}).catch(t=>{this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])})},isValid(){const{errors:e,isValid:t}=Wk(this.$data);return!!t},onFileSelected(e,t,s){this.selectedFile=e[0],this.attachment_delete=s},onChange(e,t){this[t]=e,e===null&&(this[t]=""),t==="planned_date"&&(this.planned_start_date=e[0]!==null?Mt(e[0]).format("YYYY-MM-DD+HH:mm:ss"):"",this.planned_end_date=e[1]!==null?Mt(e[1]).format("YYYY-MM-DD+HH:mm:ss"):"")},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;if(this.release_id!=""&&e.append("id",this.release_id),this.from&&e.append("change_id",this.change_id),e.append("subject",this.subject),e.append("identifier",this.identifier),e.append("description",this.description),e.append("status_id",this.status.id),e.append("priority_id",this.priority.id),e.append("release_type_id",this.releaseType.id),e.append("location_id",this.location?this.location.id:""),this.selectedFile&&e.append("attachment",this.selectedFile),this.attachment&&!this.attachment_delete&&!this.selectedFile&&e.append("attachment_ids[0]",this.attachment.id),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete),this.planned_start_date&&e.append("planned_start_date",this.planned_start_date),this.planned_end_date&&e.append("planned_end_date",this.planned_end_date),this.attach_assets.length)for(var t in this.attach_assets)e.append("asset_ids["+t+"]",this.attach_assets[t].id);else e.append("asset_ids","");const s={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/release",e,s).then(d=>{this.loading=!1,K(d,this.alertName),window.emitter.emit("updateAgentSidebar"),this.from?this.onComplete():this.release_id?this.getInitialValues(this.release_id):setTimeout(()=>{let a=d.data.data.id;this.$router.push("/service-desk/releases/"+a+"/show")},3e3)}).catch(d=>{this.loading=!1,O(d,"release-create-edit")})}}},components:{"text-field":Ae,"dynamic-select":fe,"file-upload":Ft,"date-time-field":es}},Gk={class:"col-sm-12"},Xk={key:0,class:"row"},Zk={key:0,class:"card-header"},Qk={class:"card-title"},eC={class:"card-tools"},tC={class:"row"},sC={class:"row release"},aC={class:"row"},nC={class:"row"},oC={class:"ml_7"},iC={class:"row"},lC={key:1,class:"card-footer"};function rC(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("router-link"),f=u("text-field"),g=u("date-time-field"),D=u("dynamic-select"),M=u("tiny-editor"),x=u("file-upload"),R=W("tooltip"),V=W("focus-first-input");return o(),l("div",Gk,[!a.hasDataPopulated||a.loading?(o(),l("div",Xk,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"release-create-edit"}),a.hasDataPopulated?(o(),l("div",{key:1,class:Q([{"card card-light ":!s.from}])},[s.from?c("",!0):(o(),l("div",Zk,[n("h3",Qk,r(e.lang(a.title)),1),n("div",eC,[a.release_id?S((o(),k(b,{key:0,type:"button",id:"view_release",class:"btn btn-tool",to:"/service-desk/releases/"+a.release_id+"/show"},{default:w(()=>t[1]||(t[1]=[n("i",{class:"fas fa-eye"},null,-1)])),_:1},8,["to"])),[[R,e.lang("view")]]):c("",!0)])])),n("div",{class:Q(["card-body",{"p-0":s.from}])},[S((o(),l("div",tC,[_(f,{label:e.lang("subject"),value:a.subject,type:"text",name:"subject",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),_(f,{label:e.lang("identifier"),value:a.identifier,type:"text",name:"identifier",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!1},null,8,["label","value","onChange","placehold"])])),[[V]]),n("div",sC,[_(g,{label:e.lang("select_planned_date_range"),value:a.planned_date,type:"datetime",name:"planned_date",onChange:i.onChange,place:e.lang("select_date"),range:"",required:!1,format:"MMMM DD YYYY, h:mm a",classname:"col-sm-6",clearable:!0,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":a.timeOptions,confirm:!0},null,8,["label","value","onChange","place","time-picker-options"]),_(D,{label:e.lang("status"),multiple:!1,name:"status",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/status/list?module=3",value:a.status,onChange:i.onChange,required:!0,clearable:!!a.status},null,8,["label","value","onChange","clearable"])]),n("div",aC,[_(D,{label:e.lang("priority"),multiple:!1,name:"priority",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/release_priorities",value:a.priority,onChange:i.onChange,required:!0,clearable:!!a.priority},null,8,["label","value","onChange","clearable"]),_(D,{label:e.lang("release_type"),multiple:!1,name:"releaseType",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/release_types",value:a.releaseType,onChange:i.onChange,required:!0,clearable:!!a.releaseType},null,8,["label","value","onChange","clearable"])]),n("div",nC,[_(D,{label:e.lang("location"),multiple:!1,name:"location",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/api/dependency/locations",value:a.location,onChange:i.onChange,clearable:!!a.location},null,8,["label","value","onChange","clearable"]),a.show_attach_assets?(o(),k(D,{key:0,label:e.lang("attach_assets"),multiple:!0,name:"attach_assets",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/assets",value:a.attach_assets,onChange:i.onChange},null,8,["label","value","onChange"])):c("",!0)]),n("div",oC,[_(M,{value:a.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en"},null,8,["value","onChange","label"])]),n("div",iC,[_(x,{label:e.lang("attachments"),value:a.attachment,formType:"service_desk",name:"attachment",onChange:i.onFileSelected,classname:"col-sm-6",id:a.release_id},null,8,["label","value","onChange","id"])])],2),s.from?c("",!0):(o(),l("div",lC,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=N=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])]))],2)):c("",!0)])}const dC=P(Jk,[["render",rC]]),cC={name:"release-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1},from:{type:String,default:""},change_id:{type:[String,Number],default:""},onComplete:{type:Function,default:()=>{}},alertName:{type:String,default:""}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[Xe],beforeMount(){if(this.mode==="edit"){const e=pe(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-release/"+e,this.editId=pe(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue();this.change_id&&this.$store.dispatch("updateFormAdditionalProperties",{change_id:this.change_id})},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=At(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.$store.dispatch("updateFormAdditionalProperties",""),this.mode==="create"&&!this.from&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/releases/"+s+"/show")},1e3),this.from==="modal"&&(this.onComplete(),K(e,this.alertName))}},components:{FormRenderer:Ze,Alert:We,FaveoBox:wt,CustomLoader:nt}},uC={class:"col-sm-12"},mC={key:0,class:"pull-right"},hC={key:0,class:"form-group row mt-3"},pC={class:"col-md-12"},_C=["disabled"],fC={key:0},gC={key:1};function bC(e,t,s,d,a,i){const m=u("Alert"),h=u("CustomLoader"),b=u("router-link"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FaveoBox"),M=W("tooltip");return o(),l("div",uC,[a.formUniqueKey&&a.formSelected?(o(),k(D,{key:0,title:e.lang(i.mode)},{headerMenu:w(()=>[s.showViewButton?(o(),l("span",mC,[S((o(),k(b,{to:"/service-desk/releases/"+a.editId+"/show",class:"btn btn-tool has-tooltip"},{default:w(()=>t[1]||(t[1]=[n("span",null,[n("i",{class:"fas fa-eye"})],-1)])),_:1},8,["to"])),[[M,e.trans("view")]])])):c("",!0)]),default:w(()=>[_(m,{componentName:"faveo-form"}),_(m,{componentName:"form-renderer"}),e.showLoader||a.submitFormInProgress?(o(),k(h,{key:0,duration:4e3})):c("",!0),_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:a.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),!e.showLoader&&!s.from?(o(),l("div",hC,[n("div",pC,[n("button",{type:"button",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=N=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",fC,t[2]||(t[2]=[n("i",{class:"fas fa-sync"},null,-1)]))):(o(),l("span",gC,t[3]||(t[3]=[n("i",{class:"fas fa-save"},null,-1)]))),v(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,_C)])])):c("",!0)]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const ds=P(cC,[["render",bC]]);const yC={name:"release-add-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"850px"},loading:!0,modalClass:"",category:""}},beforeMount(){this.updateLoader(),this.category=this.$store.getters.getChangeAssociateCategory},methods:{updateLoader(){setTimeout(()=>{this.loading=!1,this.modalClass="release_fields"},1e3)},onSubmit(){this.$refs.releaseCreate.onSubmit()},onCompleted(){window.emitter.emit("updateChangeAssociates"),window.emitter.emit("refreshChangeStatus"),this.category==="activity"&&window.emitter.emit("updateChangeActivity"),this.onClose()}},components:{ReleaseForm:ds,release:dC}},vC={class:"modal-title"},wC={key:0},kC={key:1,class:"row"},CC=["disabled"];function DC(e,t,s,d,a,i){const m=u("ReleaseForm"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle,modalBodyClass:a.modalClass},{title:w(()=>[n("h4",vC,r(e.lang("release")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",wC,[_(m,{category:"releases",change_id:s.changeId,onComplete:i.onCompleted,ref:"releaseCreate",panel:"agent",from:"modal",alertName:"change-view"},null,8,["change_id","onComplete"])])),a.loading?(o(),l("div",kC,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(e.lang("save")),1)],8,CC)]),_:1},8,["showModal","onClose","containerStyle","modalBodyClass"])):c("",!0)}const SC=P(yC,[["render",DC]]),MC={name:"detach-modal",description:"Detach Modal component",props:{showModal:{type:Boolean,default:!1},assetId:{type:[String,Number],default:""},releaseId:{type:[String,Number],default:""},compName:{type:String,default:""},alertCompName:{type:String,default:"changesAssociates"},changeId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;let e=this.releaseId?"/service-desk/api/change/detach-release/"+this.changeId:"/service-desk/api/change/detach-asset/"+this.changeId+"/"+this.assetId;T.delete(e).then(t=>{K(t,"change-view"),this.releaseId?this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="releases"&&window.emitter.emit("updateChangeTables"):window.emitter.emit(this.compName+"refreshData"),window.emitter.emit("updateChangeAssociates"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!0,O(t,this.alertCompName)})}}},FC={class:"modal-title"},IC={key:0},AC={key:1,class:"row"},PC=["disabled"];function TC(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",FC,r(e.lang("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",IC,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",AC,[_(m,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("detach")),1)],8,PC)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Ia=P(MC,[["render",TC]]);const VC={name:"change-description",description:"Change description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},changeId:{type:[String,Number],default:""},identifier:{type:String,default:""}},data(){return{attachment:"",description:"",isDisabled:!1,loading:!0,selectedFile:"",attachment_delete:!1,category:""}},beforeMount(){this.getInitialValues(),this.category=this.$store.getters.getChangeAssociateCategory},methods:{getInitialValues(){T.get("/service-desk/api/general-popup/"+this.changeId+"/sd_changes/"+this.identifier).then(e=>{this.loading=!1,this.general_info=e.data.data.general_info,this.general_info&&(this.description=this.general_info.description,this.attachment=this.general_info.attachment)}).catch(e=>{this.loading=!1})},addInlineStyles(){this.description=this.description.replace(/<td([^>]*)>/g,(e,t)=>{const s=/style\s*=\s*["']([^"']*)["']/.test(t),d=/padding\s*:\s*[^;]+/.test(t);return s?d?e:e.replace(/style\s*=\s*["']([^"']*)["']/,(a,i)=>`style="${i} padding: 6.4px;"`):`<td${t} style="padding: 6.4px;">`}).replace(/<table([^>]*)>/g,(e,t)=>{const s=/style\s*=\s*["']([^"']*)["']/.test(t),d=/border\s*=\s*["']([^"']*)["']/.test(t);return s?e.replace(/style\s*=\s*["']([^"']*)["']/,(a,i)=>`style="${i} border-collapse: collapse;" ${d?"":'border="1"'}`):`<table${t} style="border-collapse: collapse;" ${d?"":'border="1"'}>`})},onFileSelected(e,t,s){this.selectedFile=e,this.attachment_delete=s,this.attachment=this.selectedFile?this.selectedFile[0]:this.attachment},onChange(e,t){this[t]=e},onSubmit(){if(this.description!=""){this.loading=!0,this.isDisabled=!0,this.addInlineStyles();var e=new FormData;e.append("identifier",this.identifier),e.append("description",this.description),this.selectedFile&&e.append("attachment",this.selectedFile[0]?this.selectedFile[0]:""),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/general-popup/"+this.changeId+"/sd_changes",e,t).then(s=>{this.loading=!1,this.isDisabled=!1,this.onClose(),K(s,"change-view"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="details"&&window.emitter.emit("updateChangeDetails"),window.emitter.emit("updateChangeAssociates")}).catch(s=>{this.loading=!1,this.isDisabled=!1,O(s,"change-plan")})}else this.$store.dispatch("setValidationError",{description:"This field is required."})}},components:{"file-upload":Ft}},LC={class:"modal-title"},UC={key:0},NC={class:"row"},EC={class:"row"},xC={key:1,class:"row"},OC=["disabled"];function qC(e,t,s,d,a,i){const m=u("alert"),h=u("tiny-editor"),b=u("file-upload"),f=u("reuse-loader"),g=u("modal");return s.showModal?(o(),k(g,{key:0,showModal:s.showModal,onClose:s.onClose,modalBodyClass:a.loading?"":"change_plan_div"},{alert:w(()=>[_(m,{componentName:"change-plan"})]),title:w(()=>[n("h4",LC,r(e.lang(s.identifier)),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",UC,[n("div",NC,[_(h,{value:a.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en",width:"100%",height:"300px",id:"focus_editor"},null,8,["value","onChange","label"])]),n("div",EC,[_(b,{label:e.lang("attachments"),value:a.attachment,name:"attachment",onChange:i.onFileSelected,classname:"col-sm-12"},null,8,["label","value","onChange"])])])),a.loading?(o(),l("div",xC,[_(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=D=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.lang("update")),1)],8,OC)]),_:1},8,["showModal","onClose","modalBodyClass"])):c("",!0)}const Aa=P(VC,[["render",qC]]),jC={name:"change-duration-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function},duration:{type:[String,Number],default:null}},data(){return{loading:!1,isDisabled:!1,containerStyle:{width:"500px"},formStyle:{width:"35%"},total_activity_duration:this.duration,category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};e.total_activity_duration=this.total_activity_duration,T.patch("/service-desk/api/update-activity-duration/"+this.changeId,e).then(t=>{K(t,"change-view"),this.onClose(),this.loading=!1,this.isDisabled=!0,window.emitter.emit("updateChangeAssociates"),this.category==="activity"&&window.emitter.emit("updateChangeActivity")}).catch(t=>{this.loading=!1,this.isDisabled=!1,O(t,"change-duration")})}},components:{"time-field":An}},RC={class:"modal-title"},BC={key:0,class:"row"},zC={key:1,class:"row"},KC=["disabled"];function HC(e,t,s,d,a,i){const m=u("alert"),h=u("time-field"),b=u("reuse-loader"),f=u("modal"),g=W("focus-first-input");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{alert:w(()=>[_(m,{componentName:"change-duration"})]),title:w(()=>[n("h4",RC,r(e.lang("update_activity_duration")),1)]),fields:w(()=>[a.loading?c("",!0):S((o(),l("div",BC,[_(h,{label:e.lang("total_activity_duration"),value:a.total_activity_duration,formStyle:a.formStyle,type:"number",name:"total_activity_duration",onChange:i.onChange,classname:"col-md-12",required:!0},null,8,["label","value","formStyle","onChange"])])),[[g]]),a.loading?(o(),l("div",zC,[_(b,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=D=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-check"},null,-1)),v(" "+r(e.lang("update")),1)],8,KC)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const YC=P(jC,[["render",HC]]),$C={name:"change-ticket-associate",description:"Change ticket associate Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},changeId:{type:[String,Number],default:""},associate:{type:String,default:""}},data(){return{ticket_ids:[],loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0;const e={};e.change_id=this.changeId;var t=[];for(var s in this.ticket_ids)t.push(this.ticket_ids[s].id);e.ticket_ids=t,e.type=this.associate,T.post("/service-desk/api/attach-ticket/change",e).then(d=>{window.emitter.emit("updateChangeAssociates"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="tickets"&&window.emitter.emit("ChangeTicketsrefreshData"),this.loading=!1,this.ticket_ids=[],this.onClose(),K(d,"change-view")}).catch(d=>{this.loading=!1,O(d,"change-ticket")})}},components:{"dynamic-select":fe}},WC={class:"modal-title"},JC={key:0},GC={class:"row"},XC={key:1,class:"row"},ZC=["disabled"];function QC(e,t,s,d,a,i){const m=u("alert"),h=u("dynamic-select"),b=u("reuse-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose},{alert:w(()=>[_(m,{componentName:"change-ticket"})]),title:w(()=>[n("h4",WC,r(s.associate==="initiating"?e.lang("associate_an_initiating_ticket"):e.lang("associate_a_causing_ticket")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",JC,[n("div",GC,[_(h,{label:e.lang("tickets"),multiple:!0,name:"ticket_ids",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/tickets_based_on_change?change_id="+s.changeId,value:a.ticket_ids,onChange:i.onChange,required:!0},null,8,["label","apiEndpoint","value","onChange"])])])),a.loading?(o(),l("div",XC,[_(b,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=g=>i.onSubmit()),class:"btn btn-primary",disabled:!(a.ticket_ids.length>0)},[t[1]||(t[1]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.lang("attach")),1)],8,ZC)]),_:1},8,["showModal","onClose"])):c("",!0)}const e0=P($C,[["render",QC]]),t0={name:"cab-add-modal",description:"Cab add Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!0,containerStyle:{width:"500px"},loading:!1,cab_id:"",category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e,this.isDisabled=!e},onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};e.change_id=this.changeId,e.workflow_id=this.cab_id.id,T.post("/service-desk/api/apply-cab-approval",e).then(t=>{this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="cabs"&&window.emitter.emit("updateChangeCabs"),window.emitter.emit("refreshChangeStatus"),window.emitter.emit("updateChangeAssociates"),K(t,"change-view"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!0,O(t,"change-view")})}},components:{"dynamic-select":fe}},s0={class:"modal-title"},a0={key:0},n0={class:"row"},o0={key:1,class:"row"},i0=["disabled"];function l0(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",s0,r(e.lang("apply_cab")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",a0,[n("div",n0,[_(m,{label:e.lang("cab"),multiple:!1,name:"cab_id",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/cabs",value:a.cab_id,onChange:i.onChange,required:!0,clearable:!!a.cab_id},null,8,["label","value","onChange","clearable"])])])),a.loading?(o(),l("div",o0,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-check"},null,-1)),v(" "+r(e.lang("proceed")),1)],8,i0)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const r0=P(t0,[["render",l0]]);const d0={name:"change-assets",description:"Chnage asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},changeId:{type:[String,Number],default:""}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"changeAssets",category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?change_id="+this.changeId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};T.post("/service-desk/api/change/attach-assets/"+this.changeId,e,t).then(s=>{this.loading=!1,K(s,"change-view"),this.onClose(),window.emitter.emit("updateChangeAssociates"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="assets"&&window.emitter.emit(this.componentTitle+"refreshData")}).catch(s=>{this.loading=!1,O(s,"change-view")})}}},components:{"asset-list-with-checkbox":ht,"dynamic-select":fe}},c0={class:"modal-title"},u0={class:"row"},m0={class:"col-sm-12"},h0={class:"height-limit"},p0={key:0,class:"row"},_0=["disabled"];function f0(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("asset-list-with-checkbox"),b=u("custom-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",c0,r(e.lang("attach_assets")),1)]),fields:w(()=>[n("div",u0,[_(m,{label:e.lang("asset_types"),multiple:!1,name:"asset_type_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:a.asset_type_ids,onChange:i.onChange,clearable:!!a.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("used_by"),multiple:!1,name:"used_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:a.used_by_ids,onChange:i.onChange,clearable:!!a.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("managed_by"),multiple:!1,name:"managed_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:a.managed_by_ids,onChange:i.onChange,clearable:!!a.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("organizations"),multiple:!1,name:"org_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:a.org_ids,onChange:i.onChange,clearable:!!a.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),n("div",m0,[n("button",{id:"apply-btn",class:"btn btn-primary round-btn float-start",type:"button",onClick:t[0]||(t[0]=g=>i.onApply())},[t[2]||(t[2]=n("span",{class:"fas fa-check"},null,-1)),v("  "+r(e.lang("apply")),1)])])]),t[3]||(t[3]=n("br",null,null,-1)),n("div",h0,[a.apiUrl?(o(),k(h,{key:0,apiUrl:a.apiUrl,tickets:i.assetsData,componentTitle:a.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),a.loading===!0?(o(),l("div",p0,[_(b,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=g=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[4]||(t[4]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.lang("attach")),1)],8,_0)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const g0=P(d0,[["render",f0],["__scopeId","data-v-40ec96a8"]]);const b0={name:"change-actions",props:{actions:{type:[String,Object],default:""},changeId:{type:[String,Number],default:""},teamId:{type:[String,Number],default:""},deptId:{type:[String,Number],default:""},updateChangeDetails:{type:Function},change:{type:Object,default:()=>{}}},computed:{showAttachTaskButton(){return!!this.actions.attach_task},taskExists(){return this.actions.associated_tasks},taskData(){return{entity_id:this.change.id,entity_type:"change",alertName:"change-view"}},updatePrintAPI(){return this.basePath()+"/service-desk/api/change-print/"+this.change.id+"?page="+this.printParams.page+"&limit="+this.printParams.limit+"&category="+this.printParams.category}},data(){return{showAssignModal:!1,showDeleteModal:!1,showReleaseCreate:!1,showReleaseExists:!1,showReleaseDetach:!1,showPlanningModal:!1,showApplyCab:!1,showAttach:!1,identifier:"",showAssociateModal:!1,associate:"",showChangeDurationModal:!1,printParams:{page:1,limit:10,category:"discussions"},discussionCount:0,change_status:"",statusList:"",loading:!1,category:""}},created(){window.emitter.on("chang-activity-params",this.updatePrintParams)},beforeMount(){T.get("/service-desk/api/change-print/"+this.change.id+"?getCount=true").then(e=>{this.discussionCount=e.data.data.discussionCount}).catch(e=>{O(e,"change-view")})},methods:{getStatus(e){this.showStatusModal=!0,this.change_status=e},getStatusList(){this.loading=!0,T.get("/service-desk/api/status/list?module=2").then(e=>{this.loading=!1,this.statusList=e.data.data.data}).catch(e=>{this.loading=!1}),this.category=this.$store.getters.getChangeAssociateCategory},updatePrintParams(e){e&&(fs.isString(e)?this.printParams.category=e:(this.printParams.page=e.page?e.page:1,this.printParams.limit=e.limit?e.limit:10))},taskViewAction(){this.taskExists&&window.emitter.emit("showChangeTaskAssociates")},statusChangeNow(e){T.post("/service-desk/api/change-status/"+this.changeId+"/"+e).then(t=>{window.emitter.emit("refreshChangeStatus"),window.emitter.emit("updateChangeAssociates"),this.category==="activity"&&window.emitter.emit("updateChangeActivity"),K(t,"change-view")}).catch(t=>{O(t,"change-view")})},changeActionDivMounted(){let e=[];e.alertName="change-view",e.entity_id=this.id,e.entity_type="change",window.emitter.emit("change-action-div-mounted",e)},attachNewTask(){this.showAttachNewTaskModal=!0},subString(e,t=15){return Ie(e,t)},planningMethod(e){this.showPlanningModal=!0,this.identifier=e},associateMethod(e){this.showAssociateModal=!0,this.associate=e},onClose(){this.showAssignModal=!1,this.showDeleteModal=!1,this.showReleaseCreate=!1,this.showReleaseExists=!1,this.showReleaseDetach=!1,this.showPlanningModal=!1,this.showApplyCab=!1,this.showAttach=!1,this.showAssociateModal=!1,this.showChangeDurationModal=!1,this.showAttachNewTaskModal=!1,this.showAttachExistingTaskModal=!1,this.$store.dispatch("unsetValidationError")},changePrint(){(this.discussionCount<50&&this.printParams.category==="discussions"||this.printParams.category!=="discussions")&&window.open(this.updatePrintAPI),T.get(this.updatePrintAPI).then(e=>{K(e,"change-view")}).catch(e=>{O(e,"change-view")})}},components:{"assign-change-modal":qk,"delete-modal":ot,"release-add-modal":$k,"release-create-modal":SC,"change-release-detach":Ia,"change-update-modal":Aa,"change-duration-modal":YC,"change-associate-modal":e0,"cab-add-modal":r0,"change-assets":g0,TaskActionButtons:Rn}},y0={class:"card-tools"},v0={class:"btn-group"},w0=["disabled"],k0={class:"dropdown-menu"},C0={class:"btn-group"},D0=["disabled"],S0={class:"dropdown-menu"},M0={class:"prt_1"},F0=["disabled"],I0={class:"prt_1"},A0=["disabled"],P0={class:"btn-group"},T0=["disabled"],V0={class:"dropdown-menu dropdown-menu-right"},L0={key:0,class:"btn-group prt_1"},U0={type:"button",class:"btn btn-tool btn-tool-rounded prt_1"},N0={class:"btn-group prt_1"},E0=["disabled"],x0={class:"dropdown-menu status-list dropdown-menu-right"},O0={key:0,class:"row"},q0=["onClick"],j0=["id"],R0={key:1,class:"dropdown-item",href:"javascript:;"},B0={class:"btn-group"},z0=["disabled"],K0={class:"dropdown-menu dropdown-menu-right"};function H0(e,t,s,d,a,i){const m=u("TaskActionButtons"),h=u("reuse-loader"),b=u("router-link"),f=u("delete-modal"),g=u("assign-change-modal"),D=u("release-create-modal"),M=u("release-add-modal"),x=u("cab-add-modal"),R=u("change-release-detach"),V=u("change-update-modal"),N=u("change-associate-modal"),j=u("change-assets"),Y=u("change-duration-modal"),ae=W("tooltip");return o(),l("div",y0,[n("div",v0,[S((o(),l("span",null,[n("button",{type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown",disabled:!s.actions.change_details_edit_permission},[t[16]||(t[16]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.lang("planning")),1)],8,w0),n("div",k0,[n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=ne=>i.planningMethod("reason"))},r(e.lang("reason_for_change")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=ne=>i.planningMethod("impact"))},r(e.lang("impact")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[2]||(t[2]=ne=>i.planningMethod("rollout-plan"))},r(e.lang("rollout_plan")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=ne=>i.planningMethod("backout-plan"))},r(e.lang("backout_plan")),1)])])),[[ae,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),n("div",C0,[S((o(),l("span",null,[n("button",{type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown",disabled:!s.actions.change_details_edit_permission},[t[17]||(t[17]=n("i",{class:"fas fa-ticket"},null,-1)),v(" "+r(e.lang("associate")),1)],8,D0),n("div",S0,[n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[4]||(t[4]=ne=>i.associateMethod("initiating"))},r(e.lang("tickets_initiating_this_change")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[5]||(t[5]=ne=>i.associateMethod("initiated"))},r(e.lang("tickets_caused_due_to_this_change")),1)])])),[[ae,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),S((o(),l("span",M0,[s.actions.allowed_enforce_cab?(o(),l("button",{key:0,class:"btn btn-tool btn-tool-rounded",onClick:t[6]||(t[6]=ne=>a.showApplyCab=!0),disabled:!s.actions.change_details_edit_permission},[t[18]||(t[18]=n("i",{class:"glyphicon glyphicon-plus"},null,-1)),v(" "+r(e.lang("apply_cab")),1)],8,F0)):c("",!0)])),[[ae,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]]),S((o(),l("span",I0,[n("button",{class:"btn btn-tool btn-tool-rounded",onClick:t[7]||(t[7]=ne=>a.showAttach=!0),disabled:!s.actions.change_details_edit_permission},[t[19]||(t[19]=n("i",{class:"fas fa-server"},null,-1)),v(" "+r(e.lang("attach_asset")),1)],8,A0)])),[[ae,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]]),n("div",P0,[S((o(),l("span",null,[s.actions.change_release_detach||s.actions.change_release_attach?(o(),l("button",{key:0,type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown",disabled:!s.actions.change_details_edit_permission},[t[20]||(t[20]=n("i",{class:"fas fa-link"},null,-1)),v(" "+r(e.lang("release")),1)],8,T0)):c("",!0),n("div",V0,[s.actions.change_release_detach?(o(),l(U,{key:0},[s.change.attach_releases.length>0?(o(),l("a",{key:0,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[8]||(t[8]=ne=>a.showReleaseDetach=!0)},[v(r(e.lang("detach"))+" ",1),S((o(),l("b",null,[v(r(i.subString(s.change.attach_releases[0].subject,10)),1)])),[[ae,s.change.attach_releases[0].subject]])])):c("",!0)],64)):c("",!0),s.actions.change_release_attach?(o(),l(U,{key:1},[n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[9]||(t[9]=ne=>a.showReleaseCreate=!0)},r(e.lang("new_release")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[10]||(t[10]=ne=>a.showReleaseExists=!0)},r(e.lang("existing_release")),1)],64)):c("",!0)])])),[[ae,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),i.showAttachTaskButton?(o(),l("div",L0,[_(m,{data:i.taskData,"show-button-border":0,"requires-json-parse":0,"view-button-action":i.taskViewAction,"show-view-button":i.taskExists,className:"btn-tool btn-tool-rounded"},null,8,["data","view-button-action","show-view-button"])])):c("",!0),n("button",{type:"button",class:"btn btn-tool btn-tool-rounded prt_1",onClick:t[11]||(t[11]=ne=>a.showAssignModal=!0)},[t[21]||(t[21]=n("i",{class:"far fa-hand-point-right"},null,-1)),v(" "+r(e.trans("assign")),1)]),n("button",U0,[n("a",{class:"text-dark",href:"javascript:;",onClick:t[12]||(t[12]=(...ne)=>i.changePrint&&i.changePrint(...ne))},[t[22]||(t[22]=n("i",{class:"fa fa-print","aria-hidden":"true"},null,-1)),v(" "+r(e.trans("print")),1)])]),n("div",N0,[s.actions.change_edit?S((o(),l("button",{key:0,disabled:!s.actions.change_details_edit_permission,type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown",onClick:t[13]||(t[13]=ne=>i.getStatusList()),id:"status"},[t[23]||(t[23]=n("i",{class:"fas fa-exchange-alt"},null,-1)),v(" "+r(e.trans("change_status")),1)],8,E0)),[[ae,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]]):c("",!0),n("div",x0,[a.loading?(o(),l("div",O0,[_(h,{"animation-duration":4e3,color:"#1d78ff",size:20})])):c("",!0),a.loading?c("",!0):(o(),l(U,{key:1},[a.statusList&&a.statusList.length>0?(o(!0),l(U,{key:0},$(a.statusList,ne=>(o(),l("div",{class:"dropdown-item change-status",id:"change_status",onClick:_e=>(i.statusChangeNow(ne.id),i.getStatus(ne)),href:"javascript:;"},[n("i",{class:Q(ne.icon_class),style:ct({color:ne.icon_color})},null,6),n("a",{id:ne.id,href:"javascript:;"}," "+r(ne.name),9,j0)],8,q0))),256)):c("",!0),a.statusList&&a.statusList.length===0?(o(),l("a",R0,r(e.trans("no-records")),1)):c("",!0)],64))])]),n("div",B0,[S((o(),l("span",null,[n("button",{type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown",disabled:!s.actions.change_details_edit_permission},[t[24]||(t[24]=n("i",{class:"fas fa-cog"},null,-1)),v(" "+r(e.lang("more")),1)],8,z0),n("div",K0,[s.actions.change_edit?(o(),k(b,{key:0,class:"dropdown-item text-dark",to:"/service-desk/changes/"+s.change.id+"/edit"},{default:w(()=>[v(r(e.lang("edit")),1)]),_:1},8,["to"])):c("",!0),s.actions.change_delete?(o(),l("a",{key:1,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[14]||(t[14]=ne=>a.showDeleteModal=!0)},r(e.lang("delete")),1)):c("",!0),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[15]||(t[15]=ne=>a.showChangeDurationModal=!0)},r(e.lang("update_activity_duration")),1)])])),[[ae,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),_(X,{name:"modal"},{default:w(()=>[a.showDeleteModal?(o(),k(f,{key:0,onClose:i.onClose,showModal:a.showDeleteModal,alertComponentName:"change-view",deleteUrl:"/service-desk/api/change/"+s.change.id,redirectUrl:"/service-desk/changes/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAssignModal?(o(),k(g,{key:0,onClose:i.onClose,showModal:a.showAssignModal,changeID:s.change.id,teamId:s.change.team?s.change.team.id:"",deptId:s.change.department?s.change.department.id:""},null,8,["onClose","showModal","changeID","teamId","deptId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showReleaseCreate?(o(),k(D,{key:0,onClose:i.onClose,showModal:a.showReleaseCreate,changeId:s.change.id},null,8,["onClose","showModal","changeId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showReleaseExists?(o(),k(M,{key:0,onClose:i.onClose,showModal:a.showReleaseExists,changeId:s.change.id},null,8,["onClose","showModal","changeId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showApplyCab?(o(),k(x,{key:0,onClose:i.onClose,showModal:a.showApplyCab,changeId:s.change.id},null,8,["onClose","showModal","changeId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showReleaseDetach?(o(),k(R,{key:0,onClose:i.onClose,showModal:a.showReleaseDetach,releaseId:s.change.attach_releases[0].id,changeId:s.change.id,alertCompName:"change-view",updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","releaseId","changeId","updateChangeData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showPlanningModal?(o(),k(V,{key:0,onClose:i.onClose,showModal:a.showPlanningModal,identifier:a.identifier,changeId:s.change.id,alertCompName:"change-view"},null,8,["onClose","showModal","identifier","changeId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAssociateModal?(o(),k(N,{key:0,onClose:i.onClose,showModal:a.showAssociateModal,associate:a.associate,changeId:s.change.id,alertCompName:"change-view"},null,8,["onClose","showModal","associate","changeId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAttach?(o(),k(j,{key:0,onClose:i.onClose,showModal:a.showAttach,changeId:s.change.id},null,8,["onClose","showModal","changeId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showChangeDurationModal?(o(),k(Y,{key:0,onClose:i.onClose,showModal:a.showChangeDurationModal,changeId:s.change.id,alertCompName:"change-view",duration:s.change.total_activity_duration},null,8,["onClose","showModal","changeId","duration"])):c("",!0)]),_:1})])}const Y0=P(b0,[["render",H0],["__scopeId","data-v-cfc01c79"]]);const $0={name:"change-description",description:"Change description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},W0={class:"modal-title"},J0={id:"log_desc"},G0=["innerHTML"];function X0(e,t,s,d,a,i){const m=u("modal");return s.showModal?(o(),k(m,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",W0,r(e.lang("description")),1)]),fields:w(()=>[n("div",J0,[n("span",{innerHTML:s.description},null,8,G0)])]),_:1},8,["showModal","onClose"])):c("",!0)}const Z0=P($0,[["render",X0],["__scopeId","data-v-cce247be"]]);const Q0={name:"change-details",description:"Change details page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{change:{type:Object,default:()=>{}},actions:{type:[Object,String],default:()=>{}},updateData:{type:Function}},data(){return{showDescription:!1}},methods:{checkValues(e,t=100){return e?e.name?Ie(e.name,t):Ie(e,t):"---"},subString(e,t=20){return Ie(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")},downloadFile(e){window.open(e)}},components:{"change-actions":Y0,"change-description":Z0}},eD={class:"change-details"},tD={class:"card card-light"},sD={class:"card-header"},aD={class:"card-title"},nD={class:"card-body"},oD={class:"row mb-3"},iD={class:"col-md-12"},lD={class:"callout callout-info"},rD={class:"row"},dD={class:"col-md-4"},cD={key:1},uD={class:"col-md-4"},mD={key:1},hD={class:"col-md-4"},pD={key:1},_D={class:"col-md-12"},fD={class:"row mx-1"},gD={key:0,class:"col-md-6 info-row d-flex"},bD={class:"col-md-6"},yD={class:"col-md-6"},vD={key:1,class:"col-md-6 info-row d-flex"},wD={class:"col-md-6"},kD={class:"col-md-6"},CD={key:2,class:"col-md-6 info-row d-flex"},DD={class:"col-md-6"},SD={class:"col-md-6"},MD={key:3,class:"col-md-6 info-row d-flex"},FD={class:"col-md-6"},ID={class:"col-md-6"},AD={key:4,class:"col-md-6 info-row d-flex"},PD={class:"col-md-6"},TD={class:"col-md-6"},VD={key:5,class:"col-md-6 info-row d-flex"},LD={class:"col-md-6"},UD={class:"col-md-6"},ND={key:6,class:"col-md-6 info-row d-flex"},ED={class:"col-md-6"},xD={class:"col-md-6"},OD={class:"text-primary"},qD={key:7,class:"col-md-6 info-row d-flex"},jD={class:"col-md-6"},RD={class:"col-md-6"},BD={class:"text-primary"},zD={key:8,class:"col-md-6 info-row d-flex"},KD={class:"col-md-6"},HD={class:"col-md-6"},YD={class:"text-primary"},$D={class:"col-md-6 info-row d-flex"},WD={class:"col-md-6"},JD={class:"col-md-6"},GD={class:"col-md-6 info-row d-flex"},XD={class:"col-md-6"},ZD={class:"col-md-6"},QD={key:0},e2={key:0},t2={key:10,class:"col-md-6 info-row d-flex"},s2={class:"col-md-6"},a2={class:"col-md-6"},n2={key:0},o2={class:"line"},i2=["src"],l2=["onClick"],r2={key:1},d2={key:0,class:"card card-secondary"},c2={class:"card-header"},u2={class:"card-title"},m2={class:"card-body"},h2={class:"col-md-12 asset_row"},p2={class:"row mx-1"},_2={class:"col-md-6 info-row d-flex"},f2={class:"col-md-6"},g2={class:"col-md-6"},b2={key:0},y2={onClick:"return false",class:"text-primary"},v2={key:0},w2={key:1,onClick:"return false",class:"text-primary"};function k2(e,t,s,d,a,i){const m=u("change-actions"),h=u("router-link"),b=u("change-description"),f=W("tooltip");return o(),l("div",eD,[n("div",tD,[n("div",sD,[S((o(),l("h3",aD,[v(r(i.subString(s.change.subject,50)),1)])),[[f,s.change.subject]]),_(m,{changeId:s.change.id,change:s.change,actions:s.actions,updateChangeDetails:s.updateData},null,8,["changeId","change","actions","updateChangeDetails"])]),n("div",nD,[n("div",oD,[n("div",iD,[n("div",lD,[n("div",rD,[n("div",dD,[n("b",null,r(e.trans("requester"))+" : ",1),s.change.requester?(o(),k(h,{key:0,class:"text-decoration-none",to:s.change.requester.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.change.requester.full_name?s.change.requester.full_name:s.change.requester.meta_name)),1)])),[[f,s.change.requester.full_name?s.change.requester.full_name:s.change.requester.meta_name]])]),_:1},8,["to"])):(o(),l("span",cD,"---"))]),n("div",uD,[n("b",null,r(e.trans("status"))+" : ",1),s.change.status?(o(),k(h,{class:"text-decoration-none",key:s.change.status.name,to:s.change.status.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.change.status.name)),1)])),[[f,s.change.status.name]])]),_:1},8,["to"])):(o(),l("span",mD,"---"))]),n("div",hD,[n("b",null,r(e.trans("change_type"))+" : ",1),s.change.change_type?(o(),k(h,{key:0,class:"text-decoration-none",to:s.change.change_type.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.change.change_type.name)),1)])),[[f,s.change.change_type.name]])]),_:1},8,["to"])):(o(),l("span",pD,"---"))])])])])]),n("div",_D,[n("div",fD,[s.change.agent?(o(),l("div",gD,[n("div",bD,[n("label",null,r(e.trans("agent")),1)]),n("div",yD,[_(h,{class:"text-primary",to:s.change.agent.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.change.agent.full_name,15)),1)])),[[f,s.change.agent.full_name]])]),_:1},8,["to"])])])):c("",!0),s.change.department?(o(),l("div",vD,[n("div",wD,[n("label",null,r(e.trans("department")),1)]),n("div",kD,[_(h,{class:"text-primary",to:s.change.department.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.checkValues(s.change.department,15)),1)])),[[f,i.checkValues(s.change.department)]])]),_:1},8,["to"])])])):c("",!0),s.change.impact_type?(o(),l("div",CD,[n("div",DD,[n("label",null,r(e.trans("impact_type")),1)]),n("div",SD,[_(h,{class:"text-primary",to:s.change.impact_type.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.checkValues(s.change.impact_type,15)),1)])),[[f,i.checkValues(s.change.impact_type)]])]),_:1},8,["to"])])])):c("",!0),s.change.location?(o(),l("div",MD,[n("div",FD,[n("label",null,r(e.trans("location")),1)]),n("div",ID,[_(h,{class:"text-primary",to:s.change.location.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.checkValues(s.change.location,15)),1)])),[[f,i.checkValues(s.change.location)]])]),_:1},8,["to"])])])):c("",!0),s.change.priority?(o(),l("div",AD,[n("div",PD,[n("label",null,r(e.trans("priority")),1)]),n("div",TD,[_(h,{class:"text-primary",to:s.change.priority.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.checkValues(s.change.priority,15)),1)])),[[f,i.checkValues(s.change.priority)]])]),_:1},8,["to"])])])):c("",!0),s.change.team?(o(),l("div",VD,[n("div",LD,[n("label",null,r(e.trans("team")),1)]),n("div",UD,[_(h,{class:"text-primary",to:s.change.team.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.checkValues(s.change.team,15)),1)])),[[f,i.checkValues(s.change.team)]])]),_:1},8,["to"])])])):c("",!0),s.change.change_raised_on?(o(),l("div",ND,[n("div",ED,[n("label",null,r(e.trans("change_raised_on")),1)]),n("div",xD,[S((o(),l("a",OD,[v(r(d.formattedTime(s.change.change_raised_on)),1)])),[[f,i.checkValues(d.formattedTime(s.change.change_raised_on))]])])])):c("",!0),s.change.change_closed_on?(o(),l("div",qD,[n("div",jD,[n("label",null,r(e.trans("change_closed_on")),1)]),n("div",RD,[S((o(),l("a",BD,[v(r(d.formattedTime(s.change.change_closed_on)),1)])),[[f,i.checkValues(d.formattedTime(s.change.change_closed_on))]])])])):c("",!0),s.change.total_activity_duration?(o(),l("div",zD,[n("div",KD,[n("label",null,r(e.trans("total_activity_duration")),1)]),n("div",HD,[S((o(),l("a",YD,[n("b",null,r(Math.floor(s.change.total_activity_duration/60)),1),v(" "+r(e.trans("hours"))+" ",1),n("b",null,r(s.change.total_activity_duration%60),1),v(" "+r(e.trans("mins")),1)])),[[f,Math.floor(s.change.total_activity_duration/60)+" "+e.trans("hours")+" "+s.change.total_activity_duration%60+" "+e.trans("mins")]])])])):c("",!0),n("div",$D,[n("div",WD,[n("label",null,r(e.trans("description")),1)]),n("div",JD,[n("a",{href:"javascript:;",class:"btn btn-info btn-sm",onClick:t[0]||(t[0]=g=>a.showDescription=!0)},[t[1]||(t[1]=n("i",{class:"fas fa-file-code"},"  ",-1)),v(r(e.trans("show_description")),1)])])]),s.change.custom_field_values&&s.change.custom_field_values.length>0?(o(!0),l(U,{key:9},$(s.change.custom_field_values,g=>(o(),l("div",GD,[n("div",XD,[n("label",null,r(g.label),1)]),n("div",ZD,[Array.isArray(g.value)?(o(),l("div",QD,[(o(!0),l(U,null,$(g.value,(D,M)=>(o(),k(h,{class:"text-primary",to:g.href[M].replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(D)),1)])),[[f,D]]),M!=Object.keys(g.value).length-1?(o(),l("span",e2,",")):c("",!0),t[2]||(t[2]=v("  "))]),_:2},1032,["to"]))),256))])):(o(),l(U,{key:1},[g.field_type==="date"?(o(),k(h,{key:0,class:"text-primary",to:g.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(g.value),1)])),[[f,g.value]])]),_:2},1032,["to"])):(o(),k(h,{key:1,class:"text-primary",to:g.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(g.value)),1)])),[[f,{content:g.value?g.value.replace(/\r?\n/g,"<br />"):"---",html:!0}]])]),_:2},1032,["to"]))],64))])]))),256)):c("",!0),s.change.attachments.length>0?(o(),l("div",t2,[n("div",s2,[n("label",null,r(e.trans("attachments")),1)]),n("div",a2,[s.change.attachments.length>0?(o(),l("span",n2,[(o(!0),l(U,null,$(s.change.attachments,g=>(o(),l(U,null,[n("span",o2,[S((o(),l("span",null,[n("img",{src:g.thumbnail_url,class:"attach_img"},null,8,i2),v(" "+r(i.subString(g.name,15))+" "+r("("+g.size+")"),1)])),[[f,g.name]]),S((o(),l("a",{id:"download",onClick:D=>i.downloadFile(g.download_url),href:"javascript:;"},t[3]||(t[3]=[v("  "),n("i",{class:"fas fa-download"},null,-1)]),8,l2)),[[f,e.trans("download")]])]),t[4]||(t[4]=n("br",null,null,-1))],64))),256))])):(o(),l("span",r2,"---"))])])):c("",!0)])]),t[6]||(t[6]=n("hr",null,null,-1)),s.change.custom_field_values_for_change_type&&s.change.custom_field_values_for_change_type.length>0?(o(),l("div",d2,[n("div",c2,[n("h3",u2,r(s.change.change_type.name+" "+e.trans("properties")),1)]),n("div",m2,[n("div",h2,[n("div",p2,[(o(!0),l(U,null,$(s.change.custom_field_values_for_change_type,g=>(o(),l("div",_2,[n("div",f2,[n("label",null,r(g.label),1)]),n("div",g2,[Array.isArray(g.value)?(o(),l("div",b2,[(o(!0),l(U,null,$(g.value,(D,M)=>S((o(),l("a",y2,[v(r(i.subString(D)),1),M!=Object.keys(g.value).length-1?(o(),l("span",v2,",")):c("",!0),t[5]||(t[5]=v("  "))])),[[f,D]])),256))])):S((o(),l("a",w2,[v(r(g.field_type=="date"?g.value:i.subString(g.value)),1)])),[[f,(g.field_type=="date",g.value)]])])]))),256))])])])])):c("",!0)]),_(X,{name:"modal"},{default:w(()=>[a.showDescription?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showDescription,description:s.change.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])])}const C2=P(Q0,[["render",k2],["__scopeId","data-v-a0487c47"]]),D2={name:"detach-ticket-modal",description:"Detach Ticket Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},taskId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/detach-task/change",{params:{task_id:this.taskId,change_id:this.changeId}}).then(e=>{K(e,"change-view"),window.emitter.emit("updateChangeAssociates"),window.emitter.emit("changeTaskrefreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,O(e,"detach-ticket")})}}},S2={class:"modal-title"},M2={key:0},F2={key:1,class:"row"},I2=["disabled"];function A2(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{alert:w(()=>[_(m,{componentName:"detach-task"})]),title:w(()=>[n("h4",S2,r(e.trans("sd_change_task_detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",M2,[n("span",null,r(e.trans("sd_change_task_detach_confirm")),1)])),a.loading?(o(),l("div",F2,[_(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink"},null,-1)),v(" "+r(e.trans("sd_change_task_detach")),1)],8,I2)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const P2=P(D2,[["render",A2]]);const T2={name:"ChangeTasks",description:"List of tasks linked with Change",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},components:{TaskDetachModal:P2},props:{changeId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["task_name","task_start_date","task_end_date","users","closed_by","teams","action"],options:{},apiEndPoint:"/service-desk/api/attached-task/change?change_id="+this.changeId,taskId:"",showModal:!1,totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{task_name:this.lang("task_name"),task_status:this.lang("status"),users:this.lang("Agent(s)"),closed_by:this.lang("closed_by"),teams:this.lang("Team(s)"),task_end_date:this.lang("task_end_date"),task_start_date:this.lang("task_start_date"),action:this.lang("action")},columnsClasses:{task_name:"change-task-columns",task_status:"change-task-columns",task_end_date:"change-task-columns",task_start_date:"task_dates",closed_by:"change-task-columns",users:"change-task-columns",teams:"change-task-columns",action:"change-task-columns"},texts:{filter:"",limit:""},templates:{task_name:(t,s)=>e.h(Pn,{data:s}),users:(t,s,d,a)=>e.h(Ns,{data:s,index:d,column:a}),teams:(t,s,d,a)=>e.h(Ns,{data:s,index:d,column:a}),task_end_date(t,s){return e.formattedTime(s.task_end_date)},task_start_date(t,s){return e.formattedTime(s.task_start_date)},closed_by:function(t,s){return e.h(s.closed_by?De:"span",{to:s.closed_by?"/user/"+s.closed_by.id:"#"},s.closed_by?s.closed_by.full_name:"--")},action(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("a",{class:"btn btn-primary",title:this.trans("detach"),href:"javascript:;",onClick(){e.onDetach(s.id)}},[d])}},sortable:["task_name"],filterable:["task_name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc",search_query:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.total,{data:t.data.map(s=>(s.listElementObj={key:"assignees",redirectUrl:["agents","assigned_to_me"].includes(s.assign_to)?"/user/":"/assign-teams"},s)),count:e.totalCount}},orderBy:{column:"id",ascending:!0}}},methods:{onDetach(e){this.taskId=e,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&window.emitter.emit("updateChangeTables")}}},V2={id:"change_associated_tasks"};function L2(e,t,s,d,a,i){const m=u("data-table"),h=u("task-detach-modal");return o(),l("div",V2,[_(m,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,"task-id":a.taskId,changeId:s.changeId},null,8,["onClose","showModal","task-id","changeId"])):c("",!0)]),_:1})])}const U2=P(T2,[["render",L2]]);const N2={name:"TaskCommentModal",components:{AddMedia:fa},props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},alertComponentName:{type:String,required:!0},modalTitle:{type:String,default:"sd_add_comment"},changeId:{type:[String,Number],required:!0},parentComment:{type:[String,Number],required:!1},commentText:{type:String,default:""},commentForEdit:{type:[String,Number],default:""},attachmentsForEdit:{type:Array,default:()=>[]}},data(){return{containerStyle:{width:"700px"},loading:!1,attachments:[...this.attachmentsForEdit],inline:[],comment:this.commentText}},computed:{isDisabled(){return!this.comment}},methods:{async onSubmit(){this.loading=!0;let e="service-desk/api/add-change-comment",t="POST",s={change_id:this.changeId,type:"change",comment:this.comment,parent_id:this.parentComment||null,attachments:this.attachments};this.commentForEdit&&(e="service-desk/api/update-change-comment",t="PUT",s.comment_id=this.commentForEdit);try{let d=await T.request({method:t,url:e,data:s});this.$store.dispatch("unsetValidationError"),K(d,this.alertComponentName),this.onClose(),window.emitter.emit("reloadChangeComments")}catch(d){O(d,this.alertComponentName)}finally{this.loading=!1}},getAttachments(e){this.attachments=e},onChange(e,t){this[t]=e}}},E2={class:"modal-title"},x2={key:0},O2={key:1,class:"row"};function q2(e,t,s,d,a,i){const m=u("add-media"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,modalBodyClass:"modal__dimensions"},{title:w(()=>[n("h4",E2,r(e.trans(s.modalTitle)),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",x2,[_(m,{attachments:a.attachments,inlineFile:a.inline,description:a.comment,classname:"col-sm-12",name:"comment",onAttach:i.getAttachments,onInput:i.onChange,page_name:"task_comment","label-name":"task_comment",id:"focus_editor",style:{width:"97%"}},null,8,["attachments","inlineFile","description","onAttach","onInput"])])),a.loading?(o(),l("div",O2,[_(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary"},[t[1]||(t[1]=n("i",{class:"fas fa-sync"},null,-1)),v("  "+r(e.trans("update")),1)])]),_:1},8,["showModal","onClose"])):c("",!0)}const j2=P(N2,[["render",q2]]);const R2={name:"Change Discussion",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{changeId:{type:[String,Number],required:!0},maximized:{type:Boolean,default:!1}},components:{ThreadBody:Tn,ChangeCommentModal:j2,ChangeCommentDetachModal:Vn},data(){return{inboxThreads:[],page:1,next_cursor:"initialCursor",showLoader:!1,showModal:!1,parentComment:"",commentText:"",modalKey:Math.floor(Math.random()*1e6),loading:!1,commentForEdit:"",showDeleteModal:!1,attachments:[]}},computed:{detachParams(){return{change_id:this.changeId,type:"change",comment_id:this.commentForEdit}}},beforeMount(){this.getThreads()},created(){window.emitter.on("updateTimelineThreads",this.updateLogs),window.emitter.on("threadReply",e=>{this.modalKey++,this.parentComment=e.id,this.commentText=e.content,this.showModal=!0}),window.emitter.on("threadEdit",e=>{this.modalKey++,this.parentComment="",this.commentText=e.originalText,this.commentForEdit=e.id,this.attachments=e.attach,this.showModal=!0}),window.emitter.on("threadDelete",e=>{this.commentForEdit=e.id,this.showDeleteModal=!0})},watch:{showLoader(e,t){return this.showLoader=e,this.$emit("loaderValue",e),e},loading(e){this.$emit("loaderValue",e)}},methods:{updateLogs(){this.showLoader=!0,this.page=1,this.getThreads(void 0,!0)},async getThreads(e,t=!1){this.next_cursor==="initialCursor"?this.loading=!0:this.showLoader=!0;try{let{data:s}=await T.get(`service-desk/api/get-change-comments?change_id=${this.changeId} & type=change & cursor= ${this.next_cursor}`);if(this.next_cursor!==null){const d=s.data;for(let a in d)this.inboxThreads.push(d[a]);this.next_cursor=s.next_cursor,e&&e.loaded()}else e&&e.complete()}catch(s){O(s,"change-discussion"),this.inboxThreads=[]}finally{this.showLoader=!1,this.loading=!1}},showAddCommentModal(){this.parentComment="",this.commentText="",this.commentForEdit="",this.modalKey++,this.showModal=!0},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.inboxThreads[e-1].created_at),s=this.formattedDate(this.inboxThreads[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.inboxThreads.length-1},onClose(){this.showModal=!1,this.commentForEdit=""}}},B2={class:"change-discussion"},z2={id:"change_discussions"},K2={class:"row mb-3"},H2={class:"col-sm-2",style:{display:"flex","flex-direction":"row"}},Y2={class:"card"},$2={class:"card-body"},W2={key:0,class:"timeline timeline-inverse"},J2={key:0,class:"time-label"},G2={class:"text-bg-light border"},X2={key:1},Z2={key:1,style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"}},Q2={class:"text-center text-muted"};function eS(e,t,s,d,a,i){const m=u("alert"),h=u("change-comment-modal"),b=u("change-comment-detach-modal"),f=u("thread-body"),g=u("infinite-loading");return o(),l("div",B2,[_(m,{componentName:"change-discussion"}),n("div",z2,[n("div",K2,[n("div",H2,[n("button",{class:"btn btn-light",onClick:t[0]||(t[0]=Wt((...D)=>i.showAddCommentModal&&i.showAddCommentModal(...D),["prevent"]))},[t[2]||(t[2]=n("i",{class:"glyphicon glyphicon-plus"},null,-1)),v(" "+r(e.trans("sd_add_comment")),1)])]),t[3]||(t[3]=n("div",{class:"col-sm-10"},null,-1)),_(X,{name:"modal"},{default:w(()=>[(o(),k(h,{changeId:s.changeId,"alert-component-name":"change-discussion","comment-text":a.commentText,"on-close":i.onClose,"show-modal":a.showModal,"parent-comment":a.parentComment,key:a.modalKey,"comment-for-edit":a.commentForEdit,"attachments-for-edit":a.attachments},null,8,["changeId","comment-text","on-close","show-modal","parent-comment","comment-for-edit","attachments-for-edit"]))]),_:1}),_(X,{name:"modal"},{default:w(()=>[_(b,{"detach-url":"service-desk/api/delete-change-comment","detach-params":i.detachParams,"alert-component-name":"change-discussion","show-modal":a.showDeleteModal,"on-close":()=>this.showDeleteModal=!1,"event-to-fire-after-success":"reloadChangeComments","detach-type":"sd_comment","detach-icon-class":"fas fa-trash","detach-action":"delete"},null,8,["detach-params","show-modal","on-close"])]),_:1})]),n("div",Y2,[n("div",$2,[n("div",{class:Q({"scrollable-thread":!s.maximized}),id:"thread_scroll"},[a.inboxThreads.length>0?(o(),l("div",W2,[(o(!0),l(U,null,$(a.inboxThreads,(D,M)=>(o(),l(U,{key:"thread"+M},[i.checkDate(M)?(o(),l("div",J2,[n("span",G2,r(d.formattedDate(D.created_at)),1)])):c("",!0),_(f,{thread:D,index:M,max:s.maximized,showRedaction:!1},null,8,["thread","index","max"]),i.showThreadEnd(M)?(o(),l("div",X2,t[4]||(t[4]=[n("i",{class:"fas fa-history text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),128)),_(g,{onInfinite:i.getThreads,ref:"infiniteLoading"},{spinner:w(()=>t[5]||(t[5]=[n("span",null,null,-1)])),complete:w(()=>t[6]||(t[6]=[n("span",null,null,-1)])),_:1},8,["onInfinite"])])):(o(),l("div",Z2,[n("h2",Q2,r(e.trans("change-no-discussions")),1),n("button",{class:"btn btn-light mt-3",onClick:t[1]||(t[1]=Wt((...D)=>i.showAddCommentModal&&i.showAddCommentModal(...D),["prevent"]))},r(e.trans("change-start-discussion")),1)]))],2)])])])])}const tS=P(R2,[["render",eS],["__scopeId","data-v-deda5584"]]),sS={name:"change-associates-actions",description:"Contains detach button which can be used as a component as whole. It is built basically for displaying deatch button in a datable.",props:{data:{type:Object,required:!0}},data(){return{showModal:!1}},methods:{onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"change-asset-detach":Ia}},aS={class:"btn-group"},nS=["title"],oS={key:1};function iS(e,t,s,d,a,i){const m=u("change-asset-detach"),h=W("tooltip");return o(),l("div",aS,[s.data.detach?(o(),l(U,{key:0},[s.data.is_updatable?(o(),l("a",{key:0,id:"detach-button",onClick:t[0]||(t[0]=()=>a.showModal=!0),href:"javascript:;"},[n("span",{title:e.trans("detach"),class:"btn btn-primary btn-sm",id:"detach_btn"},t[1]||(t[1]=[n("i",{class:"fas fa-unlink"},null,-1)]),8,nS)])):S((o(),l("span",oS,t[2]||(t[2]=[n("button",{class:"btn btn-primary btn-sm",disabled:!0},[n("i",{class:"fas fa-unlink"})],-1)]))),[[h,e.trans("can_not_update_change")]])],64)):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showModal,assetId:s.data.id,changeId:s.data.change_id,compName:s.data.compName},null,8,["onClose","showModal","assetId","changeId","compName"])):c("",!0)]),_:1})])}const lS=P(sS,[["render",iS]]);const rS={name:"changes-associates-table",description:"Changes associates table page",props:{category:{type:String,default:"inbox"},apiUrl:{type:String,default:""},changeId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},actions:{type:[Object,String],default:()=>{}},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["name","managed_by","used_by","contract","action"],options:{},apiEndPoint:this.apiUrl,totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",contract:"associate-contract",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){return e.h(De,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},managed_by(t,s){var d,a;return((a=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,a;return((a=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},contract:function(t,s){return s.contract&&!Array.isArray(s.contract)?e.h(De,{to:"/service-desk/contracts/"+s.contract.id+"/show"},s.contract.name):"--"},action:(t,s)=>e.h(lS,{data:s})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.data.map(s=>(s.detach=!0,s.change_id=e.changeId,s.compName=e.componentTitle,s.is_updatable=e.actions.change_details_edit_permission,s)),count:e.totalCount}},orderBy:{column:"name",ascending:!0}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateChangeTables"),window.emitter.emit("updateChangeAssociates"))}}},dS={id:"change_associated_assets"};function cS(e,t,s,d,a,i){const m=u("data-table");return o(),l("div",dS,[_(m,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"])])}const uS=P(rS,[["render",cS]]);const mS={name:"change-activity",description:"Changes activity page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{loading:!0,apiUrl:"",activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",changeId:"",refreshActivity:!1}},created(){window.emitter.on("updateChangeActivity",()=>this.refreshActivity=!0)},beforeMount(){this.changeId=pe(window.location.pathname),this.apiUrl="/service-desk/api/change-log/"+this.changeId,this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},loading(e){this.$emit("loaderValue",e)},filtering(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){window.emitter.emit("chang-activity-params",e),T.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.change_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.change_activity_logs.total,this.perPage=t.data.data.change_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":kt}},hS={class:"row",id:"activity_log_div"},pS={class:"col-sm-12 mb-2"},_S={key:0,id:"select_limit"},fS={type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},gS={class:"dropdown-menu"},bS={key:1,id:"choose_order"},yS={id:"sort_btn",type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},vS={class:"dropdown-menu",style:{"z-index":"9999"}},wS={class:"col-md-12"},kS={key:0,class:"timeline"},CS={key:0,class:"time-label"},DS={class:"text-bg-light border"},SS={class:"timeline-item"},MS={class:"time"},FS={key:0,class:"timeline-header"},IS={class:"timeline-body break"},AS={key:1},PS={key:1,class:"float-end",id:"page_div"},TS={key:0,class:"col-sm-12"},VS={class:"text-center"};function LS(e,t,s,d,a,i){const m=u("faveo-image-element"),h=u("router-link"),b=u("activity-parser"),f=u("uib-pagination");return o(),l("div",hS,[n("div",pS,[!a.loading&&a.activity_log.length>0?(o(),l("div",_S,[n("button",fS,r(a.perPage),1),n("div",gS,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=g=>i.logLimit(10))},"10"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[1]||(t[1]=g=>i.logLimit(25))},"25"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=g=>i.logLimit(50))},"50"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[3]||(t[3]=g=>i.logLimit(100))},"100")])])):c("",!0),!a.loading&&a.activity_log.length>0?(o(),l("div",bS,[n("button",yS,r(e.lang("created_time"))+" - "+r(e.lang(a.sort_key)),1),n("div",vS,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[4]||(t[4]=g=>i.orderBy("asc"))},[t[7]||(t[7]=n("i",{class:"fas fa-sort-amount-up"},null,-1)),v(" "+r(e.lang("asc")),1)]),n("a",{href:"javascript:;",onClick:t[5]||(t[5]=g=>i.orderBy("desc")),class:"dropdown-item"},[t[8]||(t[8]=n("i",{class:"fas fa-sort-amount-down"},null,-1)),v(" "+r(e.lang("desc")),1)])])])):c("",!0)]),n("div",wS,[!a.loading&&a.activity_log.length>0?(o(),l("div",kS,[(o(!0),l(U,null,$(a.activity_log,(g,D)=>(o(),l(U,null,[i.checkDate(D)?(o(),l("div",CS,[n("span",DS,r(d.formattedDate(g.created_at)),1)])):c("",!0),n("div",null,[t[10]||(t[10]=n("i",{class:"far fa-dot-circle timeline-icon"},null,-1)),n("div",SS,[n("span",MS,[t[9]||(t[9]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(g.created_at)),1)]),g.creator?(o(),l("h3",FS,[_(m,{id:"change_img","source-url":g.creator.profile_pic,classes:["img-circle","img-bordered-sm","img-rounder"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),_(h,{to:"/user/"+g.creator.id},{default:w(()=>[v(" "+r(g.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),n("div",IS,[_(b,{data:g.name},null,8,["data"])])])]),i.showThreadEnd(D)?(o(),l("div",AS,t[11]||(t[11]=[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),256))])):c("",!0),!a.loading&&a.total>10?(o(),l("div",PS,[_(f,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[6]||(t[6]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!a.filtering&&!a.loading&&a.activity_log.length===0?(o(),l("div",TS,[n("h6",VS,r(e.lang("no_data_found")),1)])):c("",!0)])}const US=P(mS,[["render",LS],["__scopeId","data-v-d0d07808"]]),NS={name:"change-updates-delte-modal",description:"Change Updates Delete Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function},identifier:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/delete/general-popup/"+this.changeId+"/sd_changes/"+this.identifier).then(e=>{K(e,"change-view"),window.emitter.emit("updateChangeDetails"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,O(e,"change-view"),this.onClose()})}}},ES={class:"modal-title"},xS={key:0},OS={key:1,class:"row"},qS=["disabled"];function jS(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",ES,r(e.lang("delete")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",xS,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",OS,[_(m,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-sync","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("delete")),1)],8,qS)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const RS=P(NS,[["render",jS]]);const BS={name:"change-updates",description:"Changes updates component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{changeId:{type:[String,Number],default:""},actions:{type:[Object,String],default:()=>{}}},data(){return{changeUpdates:"",loading:!1,showChangeUpdate:!1,showUpdateDelete:!1,identifier:"",refreshPlanning:!1}},beforeMount(){this.getDetails()},created(){window.emitter.on("updateChangeDetails",()=>this.refreshPlanning=!0)},methods:{getDetails(){this.loading=!0,T.get("/service-desk/api/change-planning/"+this.changeId).then(e=>{this.loading=!1,this.changeUpdates=e.data.data.planning_popups,this.changeUpdates.length===0&&window.emitter.emit("updateChangeTables")}).catch(e=>{this.loading=!1})},getFont(e){return e==="reason"?"ambulance":e==="impact"?"anchor":e==="rollout-plan"?"battery-empty":"thumbs-up"},getIcon(e){if(e)return e.type==="pdf"?"fas fa-file-pdf":e.type==="xls"?"fas fa-file-excel":e.type==="txt"||e.type==="text"?"fas fa-file-code":e.type==="png"||e.type==="jpg"||e.type==="jpeg"||e.type==="gif"||e.type==="PNG"||e.type==="JPG"||e.type==="JPEG"||e.type==="GIF"?"fas fa-file-image":"fas fa-file-alt"},formatBytes(e,t){if(e==0)return"0 Bytes";var s=1024,d=t||2,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(s));return parseFloat((e/Math.pow(s,i)).toFixed(d))+" "+a[i]},downloadFile(e,t){window.open(this.basePath()+"/service-desk/download/"+e+"/"+t+"/attachment")},updateMethod(e){this.showChangeUpdate=!0,this.identifier=e},deleteMethod(e){this.showUpdateDelete=!0,this.identifier=e},onClose(){this.showChangeUpdate=!1,this.showUpdateDelete=!1,this.$store.dispatch("unsetValidationError"),window.emitter.emit("updateChangeAssociates")}},watch:{loading(e){this.$emit("loaderValue",e)},refreshPlanning(e,t){e===!0&&this.getDetails(),this.refreshPlanning=!1}},components:{"change-update-modal":Aa,"change-update-delete-modal":RS}},zS={class:"chnage-details-tab"},KS={key:0,class:"timeline"},HS={class:"time-label"},YS={class:"text-bg-secondary"},$S={class:"change-key"},WS={class:"timeline-item"},JS={class:"time float-start"},GS={class:"timeline-header pb-37"},XS={class:"btn-right"},ZS=["onClick","disabled"],QS={class:"btn-right"},eM=["onClick","disabled"],tM={class:"timeline-body break"},sM=["innerHTML"],aM={key:0,class:"timeline-footer planning_footer"},nM=["onClick"],oM={key:1,class:"text-center"};function iM(e,t,s,d,a,i){const m=u("change-update-modal"),h=u("change-update-delete-modal"),b=W("tooltip");return o(),l("div",zS,[a.changeUpdates.length>0?(o(),l("div",KS,[(o(!0),l(U,null,$(a.changeUpdates,(f,g)=>(o(),l(U,null,[n("div",HS,[n("span",YS,r(e.lang(f.key)),1)]),n("div",$S,[n("i",{class:Q(["timeline-icon","fas fa-"+i.getFont(f.key)+" text-bg-blue"])},null,2),n("div",WS,[n("span",JS,[t[0]||(t[0]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(f.updated_at)),1)]),n("h3",GS,[S((o(),l("span",XS,[n("button",{class:"btn btn-light btn-sm ms-1",onClick:D=>i.deleteMethod(f.key),disabled:!s.actions.change_details_edit_permission},[t[1]||(t[1]=n("i",{class:"fas fa-trash"},null,-1)),v(" "+r(e.lang("delete")),1)],8,ZS)])),[[b,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]]),S((o(),l("span",QS,[n("button",{class:"btn btn-light btn-sm",onClick:D=>i.updateMethod(f.key),disabled:!s.actions.change_details_edit_permission},[t[2]||(t[2]=n("i",{class:"fas fa-edit"},null,-1)),v(" "+r(e.lang("edit")),1)],8,eM)])),[[b,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),n("div",tM,[n("span",{class:"text-muted",id:"log_desc",innerHTML:f.description},null,8,sM)]),f.attachment?(o(),l("div",aM,[n("span",null,[S((o(),l("span",null,[n("i",{class:Q(i.getIcon(f.attachment))},null,2),v(" "+r(f.attachment.value)+" "+r("("+i.formatBytes(f.attachment.size)+")"),1)])),[[b,f.attachment.value]]),S((o(),l("a",{id:"download",onClick:D=>i.downloadFile(f.attachment.id,f.attachment.owner)},t[3]||(t[3]=[v("  "),n("i",{class:"fas fa-download"},null,-1)]),8,nM)),[[b,e.lang("download")]])])])):c("",!0)])])],64))),256)),t[4]||(t[4]=n("div",null,[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"})],-1))])):c("",!0),!a.loading&&a.changeUpdates.length===0?(o(),l("h6",oM,r(e.lang("no_data_found")),1)):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showChangeUpdate?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showChangeUpdate,identifier:a.identifier,changeId:s.changeId,alertCompName:"change-view"},null,8,["onClose","showModal","identifier","changeId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showUpdateDelete?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showUpdateDelete,identifier:a.identifier,changeId:s.changeId,alertCompName:"change-view"},null,8,["onClose","showModal","identifier","changeId"])):c("",!0)]),_:1})])}const lM=P(BS,[["render",iM],["__scopeId","data-v-9eb793d7"]]);const rM={name:"change-release",description:"Release description page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{release:{type:Array,default:()=>[]}},methods:{subString(e,t=15){return Ie(e,t)}}},dM={class:"change-relase"},cM={key:0,class:"row mb-3"},uM={class:"col-md-12"},mM={class:"callout callout-info"},hM={class:"row"},pM={class:"col-md-4"},_M={class:"col-md-4"},fM={class:"col-md-4"},gM={key:1,class:"col-md-12"},bM={class:"row mx-1"},yM={class:"col-md-6 info-row d-flex"},vM={class:"col-md-6"},wM={class:"col-md-6"},kM={href:"javascript:void(0)"},CM={class:"col-md-6 info-row d-flex"},DM={class:"col-md-6"},SM={class:"col-md-6"},MM={href:"javascript:void(0)"},FM={class:"col-md-6 info-row d-flex"},IM={class:"col-md-6"},AM={class:"col-md-6"},PM={href:"javascript:void(0)"},TM={class:"col-md-6 info-row d-flex"},VM={class:"col-md-6"},LM={class:"col-md-6"},UM={href:"javascript:;"},NM={class:"col-md-6 info-row d-flex"},EM={class:"col-md-6"},xM={class:"col-md-6"},OM={href:"javascript:void(0)"},qM={key:2},jM={class:"text-center"};function RM(e,t,s,d,a,i){const m=W("tooltip");return o(),l("div",dM,[s.release.length>0?(o(),l("div",cM,[n("div",uM,[n("div",mM,[n("div",hM,[n("div",pM,[n("b",null,r(e.lang("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(s.release[0].created_at)),1)])),[[m,d.formattedTime(s.release[0].created_at)]])]),n("div",_M,[n("b",null,r(e.lang("planed_start_date"))+" : ",1),S((o(),l("span",null,[v(r(s.release[0].planned_start_date&&s.release[0].planned_start_date!=="--"&&s.release[0].planned_start_date!=="0000-00-00 00:00:00"?d.formattedTime(s.release[0].planned_start_date):"--"),1)])),[[m,s.release[0].planned_start_date&&s.release[0].planned_start_date!=="--"&&s.release[0].planned_start_date!=="0000-00-00 00:00:00"?d.formattedTime(s.release[0].planned_start_date):"--"]])]),n("div",fM,[n("b",null,r(e.lang("planed_end_date"))+" : ",1),S((o(),l("span",null,[v(r(s.release[0].planned_end_date&&s.release[0].planned_end_date!=="--"&&s.release[0].planned_end_date!=="0000-00-00 00:00:00"?d.formattedTime(s.release[0].planned_end_date):"---"),1)])),[[m,s.release[0].planned_end_date&&s.release[0].planned_end_date!=="--"&&s.release[0].planned_end_date!=="0000-00-00 00:00:00"?d.formattedTime(s.release[0].planned_end_date):"---"]])])])])])])):c("",!0),s.release.length>0?(o(),l("div",gM,[n("div",bM,[n("div",yM,[n("div",vM,[n("label",null,r(e.lang("subject")),1)]),n("div",wM,[S((o(),l("a",kM,[v(r(i.subString(s.release[0].subject)),1)])),[[m,s.release[0].subject]])])]),n("div",CM,[n("div",DM,[n("label",null,r(e.lang("status")),1)]),n("div",SM,[S((o(),l("a",MM,[v(r(i.subString(s.release[0].status.name)),1)])),[[m,s.release[0].status.name]])])]),n("div",FM,[n("div",IM,[n("label",null,r(e.lang("priority")),1)]),n("div",AM,[S((o(),l("a",PM,[v(r(i.subString(s.release[0].priority.name)),1)])),[[m,s.release[0].priority.name]])])]),n("div",TM,[n("div",VM,[n("label",null,r(e.lang("location")),1)]),n("div",LM,[S((o(),l("a",UM,[v(r(s.release[0].location?i.subString(s.release[0].location.name):"---"),1)])),[[m,s.release[0].location?s.release[0].location.name:"---"]])])]),n("div",NM,[n("div",EM,[n("label",null,r(e.lang("release_type")),1)]),n("div",xM,[S((o(),l("a",OM,[v(r(i.subString(s.release[0].release_type.name)),1)])),[[m,s.release[0].release_type.name]])])])])])):(o(),l("div",qM,[n("h6",jM,r(e.lang("no_data_found")),1)]))])}const BM=P(rM,[["render",RM],["__scopeId","data-v-f4b28c0e"]]);const zM={name:"change-cab",description:"Change cab details component",props:{changeId:{type:[Number,String],required:!0},actions:{type:Object,default:()=>{}}},data(){return{loading:!1,cabData:[],comment:"",showModal:!1,action:"",showAddRemoveModal:!1,add_approver:"",approver_comment:"",addRemoveLevelId:"",containerStyle:{width:"600px"},modalLoad:!1,addRemoveType:"",endPoint:"",removeCab:this.actions.remove_cab,showCab:!1}},beforeMount(){this.getDataFromServer()},created(){window.emitter.on("updateChangeCabs",this.getDataFromServer)},methods:{clearComment(){this.comment=""},closeAddModal(){this.showAddRemoveModal=!1,this.approver_comment="",this.$store.dispatch("unsetValidationError"),this.$store.dispatch("unsetAlert")},isAddRemoveValid(){const{errors:e,isValid:t}=Ln(this.$data);return t},onAddRemoveConfirm(){if(this.isAddRemoveValid()){this.endPoint=this.addRemoveType==="add"?"add-approver":"remove-approver",this.modalLoad=!0;let e={};e.action=this.addRemoveType,e.approver_id=this.addRemoveType==="add"?this.add_approver.id:this.add_approver,e.change_id=this.changeId,e.level_id=this.addRemoveLevelId,e.comment=this.approver_comment,T.post("/service-desk/api/cab/"+this.endPoint,e).then(t=>{this.modalLoad=!1,K(t,"change-view"),window.emitter.emit("refreshChangeStatus"),this.addRemoveType,this.getDataFromServer(),window.emitter.emit("updateChangeAssociates"),this.showAddRemoveModal=!1,this.addRemoveType="",this.addRemoveLevelId="",this.add_approver=""}).catch(t=>{this.modalLoad=!1,O(t,"add_remove_approver")})}},addRemoveApprover(e,t,s=""){this.addRemoveType=e,this.addRemoveLevelId=t,this.add_approver=s,this.showAddRemoveModal=!0},resumeReminder(e){this.loading=!0,T.get("/service-desk/api/resume-auto-reminder/"+e).then(t=>{this.getDataFromServer(),K(t,"change-view")}).catch(t=>{this.loading=!1,O(t,"change-view")})},stopReminder(e){this.loading=!0,T.get("/service-desk/api/stop-auto-reminder/"+e).then(t=>{this.getDataFromServer(),K(t,"change-view")}).catch(t=>{this.loading=!1,O(t,"change-view")})},sendReminder(e,t="",s=""){this.loading=!0;let d={};d.type=e,d.change_id=this.changeId,e==="level"&&(d.level_id=t),e==="approver"&&(d.id=s,d.level_id=t),T.post("/service-desk/api/send-reminder",d).then(a=>{this.getDataFromServer(),K(a,"change-view")}).catch(a=>{this.loading=!1,O(a,"change-view")})},closeModal(){this.clearComment(),this.showModal=!1,this.$store.dispatch("unsetValidationError")},subString(e,t=15){return Ie(e,t)},getDataFromServer(){this.loading=!0,Promise.all([T.get("/service-desk/api/change-approval-status/"+this.changeId),T.get("/service-desk/api/change-action/"+this.changeId)]).then(([e,t])=>{this.cabData=e.data.data,this.showCab=!0,t.data&&t.data.data&&t.data.data.actions&&t.data.data.actions.remove_cab?this.removeCab=t.data.data.actions.remove_cab:this.removeCab=!1,this.loading=!1}).catch(e=>{this.loading=!1,O(e)})},isValid(){const{errors:e,isValid:t}=wa(this.$data);return!!t},onChange(e,t){this[t]=e},onCabAction(e){this.showModal=!0,this.action=e},getIconStyle(e,t="icon"){switch(e){case"PENDING":return t=="icon"?"glyphicon glyphicon-time text-warning":"#eee";case"APPROVED":return t=="icon"?"glyphicon glyphicon-check text-success":"#cbe0d3";case"DENIED":return t=="icon"?"glyphicon glyphicon-exclamation-sign text-danger":"#f6ddd8";default:return null}},getOpacity(e){return e==1?1:.5},onCabActionConfirm(){this.action!=="remove"?this.isValid()&&(this.loading=!0,T.post("/service-desk/api/approval-action-without-hash/"+this.changeId,{action_type:this.action,comment:this.comment}).then(e=>{this.loading=!1,K(e,"change-view"),window.emitter.emit("updateChangeAssociates"),window.emitter.emit("refreshChangeStatus"),this.getDataFromServer(),setTimeout(()=>{this.initialActions()},2e3)}).catch(e=>{this.loading=!1,O(e,"change-view")})):(this.loading=!0,T.delete("/service-desk/api/remove-cab-approval/"+this.changeId).then(e=>{this.loading=!1,K(e,"change-view"),window.emitter.emit("updateChangeAssociates"),window.emitter.emit("refreshChangeStatus"),this.cabData.length===1?window.emitter.emit("updateChangeTables"):this.getDataFromServer(),setTimeout(()=>{this.initialActions()},2e3)}).catch(e=>{this.loading=!1,this.showModal=!1,O(e,"change-view"),this.removeCab=!1,T.get("/service-desk/api/change-approval-status/"+this.changeId).then(t=>{this.cabData=t.data.data})}))},initialActions(){this.showModal=!1,this.action="",this.comment=""}},computed:{modalTitle(){return this.action=="approve"?"approve_cab":this.action=="remove"?"remove_cab":"deny_cab"},modalQuestion(){let e=`${Ce("are_you_sure_you_want_to")} ${this.action}?`;return this.action=="remove"?e:`${e} ${Ce("mention_a_reason")}`},isProceedButtonDisabled(){return!this.add_approver||!this.approver_comment}},watch:{loading(e){this.$emit("loaderValue",e)}},components:{"dynamic-select":fe,"text-field":Ae}},KM={class:"change-cab-details"},HM={key:0},YM=["id"],$M={class:"card-title cab_title"},WM={class:"card-tools cab-tools"},JM=["onClick"],GM=["onClick"],XM={class:"levels"},ZM=["id"],QM={class:"card-title cab_title"},eF={class:"card-tools cab-tools"},tF=["onClick"],sF={key:1,class:"btn btn-tool not-cursor"},aF=["onClick"],nF={key:3,class:"btn btn-tool not-cursor"},oF={class:"card-body"},iF=["id"],lF={class:"list-group list-group-unbordered"},rF={id:"highlight",class:"list-group-item border-0 p-2p px-2 rounded"},dF={class:"approver-name"},cF={class:"float-end"},uF=["onClick"],mF={key:1,class:"text-dark me-3 not-cursor"},hF=["onClick"],pF={key:3,class:"text-danger me-3 not-cursor"},_F=["id"],fF={class:"list-group list-group-unbordered"},gF={id:"highlight",class:"list-group-item border-0 p-2p px-2 rounded"},bF={class:"approver-name"},yF={class:"float-end"},vF=["onClick"],wF={key:1,class:"text-dark me-3 not-cursor"},kF=["onClick"],CF={key:3,class:"text-danger me-3 not-cursor"},DF={key:1},SF={class:"modal-title"},MF={key:1,class:"row"},FF=["disabled"],IF={class:"modal-title"},AF={key:1},PF={class:"row"},TF={key:1,class:"text-center"};function VF(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("dynamic-select"),f=u("text-field"),g=u("modal"),D=W("tooltip"),M=W("focus-first-input");return o(),l("div",KM,[a.cabData.length>0?(o(),l(U,{key:0},[a.showCab?(o(),l("div",HM,[(o(!0),l(U,null,$(a.cabData,(x,R)=>(o(),l("div",{class:"card",id:"cab-element-"+R,style:ct({"border-color":i.getIconStyle(x.status,"color")})},[n("div",{class:"card-header cab_header",style:ct({"background-color":i.getIconStyle(x.status,"color")})},[S((o(),l("h3",$M,[v(r(x.name),1)])),[[D,x.name]]),n("div",WM,[x.status=="PENDING"?(o(),l(U,{key:0},[x.send_auto_reminders?c("",!0):S((o(),l("button",{key:0,class:"btn btn-tool",onClick:V=>i.resumeReminder(x.id)},t[5]||(t[5]=[n("i",{class:"fas fa-play"},null,-1)]),8,JM)),[[D,e.trans("resume_reminder")]]),x.send_auto_reminders?S((o(),l("button",{key:1,class:"btn btn-tool",onClick:V=>i.stopReminder(x.id)},t[6]||(t[6]=[n("i",{class:"fas fa-stop"},null,-1)]),8,GM)),[[D,e.trans("stop_reminder")]]):c("",!0)],64)):c("",!0),S(n("button",{class:Q(["btn btn-tool",[i.getIconStyle(x.status)]])},null,2),[[D,x.status]])])],4),n("div",XM,[(o(!0),l(U,null,$(x.approval_levels,(V,N)=>(o(),l("div",{class:"card-body cab-level",id:"cab-level-"+N,style:ct({opacity:i.getOpacity(V.is_active)})},[n("div",{class:"card margin-0 height-100-percent",style:ct({"border-color":i.getIconStyle(V.status,"color")})},[n("div",{class:"card-header cab_header",style:ct({"background-color":i.getIconStyle(V.status,"color")})},[S((o(),l("h3",QM,[v(r(i.subString(V.name,25)),1)])),[[D,V.name]]),n("div",eF,[V.status=="PENDING"?(o(),l(U,{key:0},[V.is_active?S((o(),l("button",{key:0,class:"btn btn-tool",onClick:j=>i.sendReminder("level",V.id)},t[7]||(t[7]=[n("i",{class:"fas fa-paper-plane"},null,-1)]),8,tF)),[[D,e.trans("send_reminder")]]):S((o(),l("button",sF,t[8]||(t[8]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.trans("cant_send_reminder_level")]]),V.is_active?S((o(),l("button",{key:2,class:"btn btn-tool",onClick:j=>i.addRemoveApprover("add",V.id)},t[9]||(t[9]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)]),8,aF)),[[D,e.trans("add_approver")]]):c("",!0),V.is_active?c("",!0):S((o(),l("button",nF,t[10]||(t[10]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)]))),[[D,e.trans("you_cant_add_approver")]])],64)):c("",!0),S(n("button",{class:Q(["btn btn-tool",[i.getIconStyle(V.status)]])},null,2),[[D,V.status]])])],4),n("div",oF,[(o(!0),l(U,null,$(V.approve_users,(j,Y)=>(o(),l("div",{id:"level-user-"+Y},[n("ul",lF,[n("li",rF,[S((o(),l("span",dF,[v(r(i.subString(j.name,25)),1)])),[[D,j.name]]),n("span",cF,[j.status=="PENDING"?(o(),l(U,{key:0},[V.is_active?S((o(),l("a",{key:0,href:"javascript:;",class:"text-dark me-3",onClick:ae=>i.sendReminder("approver",V.id,j.id)},t[11]||(t[11]=[n("i",{class:"fas fa-paper-plane"},null,-1)]),8,uF)),[[D,e.trans("send_reminder")]]):S((o(),l("a",mF,t[12]||(t[12]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.trans("cant_send_reminder_approver")]]),V.is_active?S((o(),l("a",{key:2,class:"text-danger me-3",href:"javascript:;",onClick:ae=>i.addRemoveApprover("remove",V.id,j.id)},t[13]||(t[13]=[n("i",{class:"fas fa-times"},null,-1)]),8,hF)),[[D,e.trans("remove_approver")]]):c("",!0),V.is_active?c("",!0):S((o(),l("a",pF,t[14]||(t[14]=[n("i",{class:"fas fa-times"},null,-1)]))),[[D,e.trans("you_cant_remove_approver")]])],64)):c("",!0),S(n("span",{class:Q(["approver-status",i.getIconStyle(j.status)])},null,2),[[D,j.status]])])])])],8,iF))),256)),(o(!0),l(U,null,$(V.approve_user_types,(j,Y)=>(o(),l("div",{id:"level-user-type-"+Y},[n("ul",fF,[n("li",gF,[S((o(),l("span",bF,[v(r(i.subString(e.lang(j.name),25)),1)])),[[D,e.lang(j.name)]]),n("span",yF,[j.status=="PENDING"?(o(),l(U,{key:0},[V.is_active?S((o(),l("a",{key:0,href:"javascript:;",class:"text-dark me-3",onClick:ae=>i.sendReminder("approver",V.id,j.id)},t[15]||(t[15]=[n("i",{class:"fas fa-paper-plane"},null,-1)]),8,vF)),[[D,e.trans("send_reminder")]]):S((o(),l("a",wF,t[16]||(t[16]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.trans("cant_send_reminder_approver_type")]]),V.is_active?S((o(),l("a",{key:2,class:"text-danger me-3",href:"javascript:;",onClick:ae=>i.addRemoveApprover("remove",V.id,j.id)},t[17]||(t[17]=[n("i",{class:"fas fa-times"},null,-1)]),8,kF)),[[D,e.trans("remove_approver_type")]]):c("",!0),V.is_active?c("",!0):S((o(),l("a",CF,t[18]||(t[18]=[n("i",{class:"fas fa-times"},null,-1)]))),[[D,e.trans("you_cant_remove_approver_type")]])],64)):c("",!0),S(n("span",{class:Q(["approver-status",i.getIconStyle(j.status)])},null,2),[[D,j.status]])])])])],8,_F))),256))])],4)],12,ZM))),256))])],12,YM))),256))])):c("",!0),a.showCab?(o(),l("div",DF,[s.actions.allowed_cab_action?(o(),l(U,{key:0},[n("button",{class:"btn btn-primary",id:"approve-button",onClick:t[0]||(t[0]=x=>i.onCabAction("approve")),name:"button"},[t[19]||(t[19]=n("span",{class:"glyphicon glyphicon-ok"},null,-1)),v(" "+r(e.lang("approve")),1)]),n("button",{class:"btn btn-light",id:"deny-button",onClick:t[1]||(t[1]=x=>i.onCabAction("deny")),name:"button"},[t[20]||(t[20]=n("span",{class:"glyphicon glyphicon-remove"},null,-1)),v(" "+r(e.lang("deny")),1)])],64)):c("",!0),a.removeCab?(o(),l("button",{key:1,class:"btn btn-light",id:"remove-button",onClick:t[2]||(t[2]=x=>i.onCabAction("remove")),name:"button"},[t[21]||(t[21]=n("span",{class:"glyphicon glyphicon-trash"},null,-1)),v(" "+r(e.lang("remove")),1)])):c("",!0)])):c("",!0),a.showAddRemoveModal?(o(),k(g,{key:2,showModal:!0,onClose:i.closeAddModal,containerStyle:a.containerStyle},{title:w(()=>[n("h4",SF,r(a.addRemoveType==="add"?e.lang("add_approver"):e.lang("remove_approver")),1)]),alert:w(()=>[_(m,{componentName:"add_remove_approver"})]),fields:w(()=>[a.modalLoad?(o(),k(h,{key:0})):(o(),l("div",MF,[a.addRemoveType==="add"?(o(),k(b,{key:0,label:e.lang("approver"),value:a.add_approver,onChange:i.onChange,name:"add_approver",apiEndpoint:"/api/dependency/users?meta=true",multiple:!1,classname:"col-md-12",strlength:"50",required:!0},null,8,["label","value","onChange"])):c("",!0),_(f,{id:"textarea",label:e.lang("reason"),value:a.approver_comment,autofocus:a.addRemoveType!="add",type:"textarea",name:"approver_comment",onChange:i.onChange,classname:"col-sm-12",required:!0},null,8,["label","value","autofocus","onChange"])]))]),controls:w(()=>[n("button",{type:"button",onClick:t[3]||(t[3]=x=>i.onAddRemoveConfirm()),class:"btn btn-primary",disabled:i.isProceedButtonDisabled},[t[22]||(t[22]=n("i",{class:"fas fa-check","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("proceed")),1)],8,FF)]),_:1},8,["onClose","containerStyle"])):c("",!0),a.showModal?(o(),k(g,{key:3,showModal:!0,onClose:i.closeModal},{title:w(()=>[n("h4",IF,r(e.lang(i.modalTitle)),1)]),alert:w(()=>[_(m)]),fields:w(()=>[a.loading?(o(),k(h,{key:0})):c("",!0),a.loading?c("",!0):(o(),l("span",AF,r(e.lang(i.modalQuestion)),1)),S((o(),l("div",PF,[!a.loading&&a.action!=="remove"?(o(),k(f,{key:0,id:"textarea",label:e.lang("comment"),value:a.comment,type:"textarea",name:"comment",onChange:i.onChange,classname:"col-sm-12",required:a.action!=="approve"},null,8,["label","value","onChange","required"])):c("",!0)])),[[M]])]),controls:w(()=>[n("button",{id:"cab-action-confirm",type:"button",onClick:t[4]||(t[4]=x=>i.onCabActionConfirm()),class:"btn btn-primary"},[t[23]||(t[23]=n("i",{class:"glyphicon glyphicon-ok","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("confirm")),1)])]),_:1},8,["onClose"])):c("",!0)],64)):c("",!0),!a.loading&&a.cabData.length===0?(o(),l("h6",TF,r(e.lang("no_data_found")),1)):c("",!0)])}const LF=P(zM,[["render",VF],["__scopeId","data-v-921cd08a"]]),UF={name:"detach-ticket-modal",description:"Detach Ticket Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},ticketId:{type:[String,Number],default:""},type:{type:String,default:""},onClose:{type:Function},componentTitle:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/detach-ticket/change",{params:{ticket_id:this.ticketId,change_id:this.changeId,type:this.type}}).then(e=>{K(e,"change-view"),window.emitter.emit("updateChangeAssociates"),window.emitter.emit(this.componentTitle+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,O(e,"detach-ticket")})}}},NF={class:"modal-title"},EF={key:0},xF={key:1,class:"row"},OF=["disabled"];function qF(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{alert:w(()=>[_(m,{componentName:"detach-ticket"})]),title:w(()=>[n("h4",NF,r(e.lang("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",EF,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",xF,[_(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink"},null,-1)),v(" "+r(e.lang("detach")),1)],8,OF)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const jF=P(UF,[["render",qF]]);const RF={name:"changes-tickets-table",description:"Changes tickets table page",props:{changeId:{type:[String,Number],default:""},componentTitle:{type:String,default:"ChangeTickets"},actions:{type:[Object,String],default:()=>{}},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["ticket_number","subject","assigned","type","action"],options:{},apiEndPoint:"/service-desk/api/attached-ticket/change?change_id="+this.changeId,ticketId:"",ticket_type:"",showModal:!1,totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{ticket_number:this.lang("ticket_number"),subject:this.lang("subject"),assigned:this.lang("assigned_to"),type:this.lang("type"),action:this.lang("action")},columnsClasses:{ticket_number:"associate-number",subject:"associate-subject",assigned:"associate-assigned",type:"associate-type",action:"associate-action"},texts:{filter:"",limit:""},templates:{subject:function(t,s){return e.h(De,{to:"/thread/"+s.id},s.subject)},ticket_number:function(t,s){return e.h(De,{to:"/thread/"+s.id},"#"+s.ticket_number)},assigned(t,s){return s.assigned?s.assigned.full_name:"--"},action(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("button",{class:"btn btn-primary",title:e.actions.change_details_edit_permission?this.trans("detach"):"Can Not Update Change Details Until Cab is Approved",disabled:!e.actions.change_details_edit_permission,onClick(){e.onDetach(s.id,s.type)}},[d])}},sortable:["ticket_number"],filterable:["ticket_number"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc",search_query:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.tickets,count:e.totalCount}},orderBy:{column:"id",ascending:!0}}},methods:{onDetach(e,t){this.ticketId=e,this.ticket_type=t,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateChangeTables"),window.emitter.emit("updateChangeAssociates"))}},components:{"ticket-detach-modal":jF}},BF={id:"change_associated_tickets"};function zF(e,t,s,d,a,i){const m=u("data-table"),h=u("ticket-detach-modal");return o(),l("div",BF,[_(m,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,ticketId:a.ticketId,changeId:s.changeId,type:a.ticket_type,componentTitle:s.componentTitle},null,8,["onClose","showModal","ticketId","changeId","type","componentTitle"])):c("",!0)]),_:1})])}const KF=P(RF,[["render",zF]]);const HF={name:"change-associates",description:"Change associates page",props:{change:{type:Object,default:()=>{}},changeId:{type:[String,Number],default:""}},data(){return{actions:"",tabs:[],category:"discussions",changeCommentThreadKey:Math.floor(Math.random()*1e6),loading:!0,showAssociates:!1,dynamicKeys:{discussions:1,activity:1,details:1,assets:1,releases:1,cabs:1,tickets:1,tasks:1}}},created(){window.emitter.on("updateChangeAssociates",this.updateAssociates),window.emitter.on("showChangeTaskAssociates",()=>this.category="tasks"),window.emitter.on("reloadChangeComments",()=>this.changeCommentThreadKey++),window.emitter.on("updateChangeTables",()=>this.associates("activity")),this.$store.dispatch("setChangeAssociateCategory",this.category)},beforeMount(){this.getActions()},methods:{getActions(e=""){this.loading=!0,T.get("/service-desk/api/change-action/"+this.changeId+"?time="+e).then(t=>{this.actions=t.data.data.actions,this.$emit("handelAction",this.actions),this.tabs=[{id:"discussions",title:"sd-plugin-discussions",show:!0},{id:"activity",title:"activity_log",show:!0},{id:"details",title:"planning",show:this.actions.planning},{id:"assets",title:"associated_assets",show:this.actions.associated_assets},{id:"releases",title:"associated_releases",show:this.actions.associated_releases},{id:"cabs",title:"associated_cabs",show:this.actions.associated_cabs},{id:"tickets",title:"associated_tickets",show:this.actions.associated_tickets},{id:"tasks",title:"sd_change_associated_tasks",show:this.actions.associated_tasks}],this.showAssociates=!0,this.loading=!1}).catch(t=>{this.loading=!1,this.actions=""})},updateAssociates(){setTimeout(()=>{this.getActions(Date.now())},500)},associates(e){this.category!==e&&(e!=="releases"&&(this.loading=!0),window.emitter.emit("chang-activity-params",e),this.category=e),this.updateKey(e)},handelLoader(e){this.loading=e},updateKey(e){e!=="releases"&&(this.loading=!0),this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setChangeAssociateCategory",e)}},components:{"change-associates-table":uS,"change-activity":US,"change-details-tab":lM,"change-release":BM,"change-cab":LF,"change-tickets":KF,ChangeTasks:U2,ChangeDiscussion:tS}},YF={key:0,id:"changes-associates",class:"card card-light card-tabs"},$F={class:"card-header p-0 pt-1"},WF={class:"nav nav-tabs"},JF={key:0,class:"nav-item"},GF=["onClick"],XF={class:"nav-item ms-auto mt-04"},ZF={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},QF={class:"card-body"},eI={class:"tab-content"},tI={class:"active tab-pane",id:"activity"};function sI(e,t,s,d,a,i){const m=u("alert"),h=u("change-discussion"),b=u("change-activity"),f=u("change-release"),g=u("change-cab"),D=u("change-associates-table"),M=u("change-details-tab"),x=u("change-tickets"),R=u("change-tasks");return a.showAssociates?(o(),l("div",YF,[_(m,{componentName:"changesAssociates"}),n("div",$F,[n("ul",WF,[(o(!0),l(U,null,$(a.tabs,V=>(o(),l(U,null,[V.show?(o(),l("li",JF,[n("a",{id:"change_tab",class:Q(["nav-link",{active:a.category===V.id}]),"data-bs-toggle":"pill",onClick:N=>i.associates(V.id)},r(e.trans(V.title)),11,GF)])):c("",!0)],64))),256)),n("li",XF,[a.loading?(o(),l("a",ZF,t[0]||(t[0]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])])]),n("div",QF,[n("div",eI,[n("div",tI,[n("div",null,[a.category==="discussions"?(o(),k(h,{changeId:s.changeId,key:a.changeCommentThreadKey,onLoaderValue:i.handelLoader},null,8,["changeId","onLoaderValue"])):c("",!0),a.category==="activity"?(o(),k(b,{changeId:s.changeId,onLoaderValue:i.handelLoader,key:"change_activity"+a.dynamicKeys.activity},null,8,["changeId","onLoaderValue"])):c("",!0),a.category==="releases"?(o(),k(f,{release:s.change.attach_releases,key:"change_releases"+a.dynamicKeys.releases},null,8,["release"])):c("",!0),a.category==="cabs"?(o(),k(g,{changeId:s.changeId,actions:a.actions,onLoaderValue:i.handelLoader,key:"change_cabs"+a.dynamicKeys.cabs},null,8,["changeId","actions","onLoaderValue"])):c("",!0),a.category==="assets"?(o(),k(D,{componentTitle:"changeAssets",apiUrl:"/service-desk/api/asset-list?change_ids="+s.changeId,changeId:s.changeId,category:a.category,actions:a.actions,onLoaderValue:i.handelLoader,disableLoader:"true",key:"change_asset"+a.dynamicKeys.assets},null,8,["apiUrl","changeId","category","actions","onLoaderValue"])):c("",!0),a.category==="details"?(o(),k(M,{changeId:s.changeId,actions:a.actions,onLoaderValue:i.handelLoader,key:"change_details"+a.dynamicKeys.details},null,8,["changeId","actions","onLoaderValue"])):c("",!0),a.category==="tickets"?(o(),k(x,{changeId:s.changeId,componentTitle:"ChangeTickets",actions:a.actions,onLoaderValue:i.handelLoader,disableLoader:"true",key:"change_tickets"+a.dynamicKeys.tickets},null,8,["changeId","actions","onLoaderValue"])):c("",!0),a.category==="tasks"?(o(),k(R,{changeId:s.changeId,componentTitle:"changeTask",actions:a.actions,onLoaderValue:i.handelLoader,disableLoader:"true",key:"change_task"+a.dynamicKeys.tasks},null,8,["changeId","actions","onLoaderValue"])):c("",!0)])])])])])):c("",!0)}const aI=P(HF,[["render",sI],["__scopeId","data-v-0488f7bf"]]),nI={name:"change-view",description:"Change view page",data(){return{change:"",change_id:"",loading:!0,actions:"",counter:0,refreshData:!1,updateViewStatus:!1}},beforeMount(){this.getValues()},watch:{refreshData(e,t){e===!0&&this.getValues(),this.refreshData=!1},updateViewStatus(e,t){e===!0&&this.updateView(),this.updateViewStatus=!1}},created(){window.emitter.on("updateChangeView",()=>this.updateViewStatus=!0),window.emitter.on("refreshChangeStatus",()=>this.refreshData=!0)},methods:{updateView(){this.loading=!0,setTimeout(()=>{this.getValues()},500)},getValues(e,t=""){const s=window.location.pathname;this.change_id=pe(s),T.get("/service-desk/api/change/"+this.change_id+"?time="+t).then(d=>{this.change=d.data.data.change,this.loading=!1}).catch(d=>{this.loading=!1,O(d,"change-view")})},updateActions(e){this.actions=e}},components:{"change-details":C2,"change-associates":aI}},oI={class:"col-sm-12"},iI={key:0};function lI(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("change-details"),f=u("change-associates");return o(),l("div",oI,[_(m,{componentName:"change-view"}),a.loading?(o(),l("div",iI,[_(h,{"animation-duration":4e3,size:60})])):c("",!0),a.loading?c("",!0):(o(),l(U,{key:1},[_(b,{change:a.change,updateData:a.refreshData,actions:a.actions},null,8,["change","updateData","actions"]),_(f,{changeId:a.change_id,change:a.change,onHandelAction:i.updateActions},null,8,["changeId","change","onHandelAction"])],64))])}const rI=P(nI,[["render",lI]]);const dI={name:"contracts-list",description:"Contracts lists table component",props:{filterIndex:{type:Boolean,default:!1}},setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data:()=>({parsedUrlParams:"",columns:[],options:{},hasDataPopulated:!1,visibleColumns:{},staticColumns:["actions"],apiUrl:"/service-desk/api/contract-list",reportType:"contracts",filterOptions:[{section:[{name:"contract_ids",url:"/service-desk/api/dependency/contracts",label:"contracts"},{name:"contract_type_ids",url:"/service-desk/api/dependency/contract_types",label:"contract_type"},{name:"approver_ids",url:"/api/dependency/users?meta=true",label:"approver"}]},{section:[{name:"vendor_ids",url:"/service-desk/api/dependency/vendors",label:"vendors"},{name:"license_type_ids",url:"/service-desk/api/dependency/license_types",label:"license_type"},{name:"contract_statuses",url:"/service-desk/api/status/list?module=5",label:"status"}]},{section:[{name:"renewal_status_ids",url:"/service-desk/api/dependency/contract_renewal_statuses",label:"renewal_status"},{name:"owner_ids",url:"/api/dependency/agents",label:"owner"},{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets"}]},{section:[{name:"notify_agent_ids",url:"/api/dependency/agents?meta=true",label:"notify_agents"},{name:"cost",label:"cost",type:"number"},{name:"notify_in_days",label:"notify_before",type:"number"}]},{section:[{name:"contract_start_date",type:"date",label:["contract_start_date","contract_start_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"contract_end_date",type:"date",label:["contract_end_date","contract_end_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[]}],isShowFilter:!1,showIcon:!1,appliedFilters:{},columnData:null,contractData:null,exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[],customFields:[],contractFilterId:""}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount),window.emitter.on("responseData",this.handleData)},beforeMount(){this.contractFilterId=pe(window.location.pathname);const e=at();e&&e.hasOwnProperty("filter-by-url")?(this.parsedUrlParams=e,It("/service-desk/api/filter-dependencies",e,{},d=>{d&&this.applyFilter(d,"dependencyFilter")},d=>{O(d)})):this.apiUrl=this.filterIndex?"/service-desk/api/contract-list?filter_id="+this.contractFilterId:"/service-desk/api/contract-list",this.filterData(),this.getContractData()},methods:{handleData(e){this.setPlaceholders(e)},handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name===s.name&&(s.value=e.value)})})},getContractData(){this.hasDataPopulated=!1,T.get("api/agent/report-config/contract-report").then(e=>{this.contractData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],O(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{Re(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.data_type==="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[6].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},setPlaceholders(e){this.filterOptions.map(function(t){t.section.map(function(s){s.name=="cost"&&(s.min_placeholder=e.data.minimum_cost,s.max_placeholder=e.data.maximum_cost),s.name=="notify_in_days"&&(s.min_placeholder=e.data.minimum_notify_before,s.max_placeholder=e.data.maximum_notify_before)})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/contract-list?filter_id="+this.contractFilterId:"/service-desk/api/contract-list",this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e,t=""){this.appliedFilters=e;for(var s in this.customFields)this.customFields[s].value=e[this.customFields[s].name];let d="/service-desk/api/contract-list?",a=new URLSearchParams(vt(this.filterOptions,e));t==="dependencyFilter"&&Object.entries(e).forEach(([f,g])=>{f.includes("custom_")&&(a+=`${encodeURIComponent(f)}=${encodeURIComponent(g)}&`)});const m=a,h=new URLSearchParams(m),b={};for(const[f,g]of h)b[f]=g;a[a.length-1]==="&"&&(a=a.slice(0,-1)),this.apiUrl=d+a,this.exportData=this.reformatExportData(b)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[a,i,m]=d;t[i]=t[i]||[],t[i][m]=parseInt(e[s],10)}else t[s]=e[s].trim()}return t},exportReport(){this.loading=!0;const e={...this.exportData,total:this.dataCount};let t={};this.filterIndex&&(t.filter_id=this.contractFilterId);const s={...this.exportData,...t,total:this.dataCount};T.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:e).then(d=>{K(d,"dataTableModal")}).catch(d=>{O(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.contractFilterId};this.$router.push({path:"/reports/schedule/add/"+this.contractData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{ModuleFilter:ys,"user-column-list":Pt,"dynamic-datatable":Tt,"contracts-filter":ss}},cI={class:"col-sm-12"},uI={key:0,class:"card card-light"},mI={class:"card-header"},hI={id:"contracts-list",class:"card-title"},pI={class:"card-tools"},_I={class:"card-body",id:"contracts_list"};function fI(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("ModuleFilter"),f=u("user-column-list"),g=u("dynamic-datatable"),D=W("tooltip");return o(),l("div",cI,[_(m,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",uI,[n("div",mI,[n("h3",hI,r(e.lang("list_of_contracts")),1),n("div",pI,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/contracts/create"},{default:w(()=>t[3]||(t[3]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[D,e.lang("create_contract")]]),S((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...M)=>i.toggleFilterView&&i.toggleFilterView(...M))},t[4]||(t[4]=[n("i",{class:"glyphicon glyphicon-filter"},null,-1)]))),[[D,e.lang("filter")]]),e.showIcon?S((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=M=>i.exportReport()),href:"javascript:;"},t[5]||(t[5]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.lang("export")]]):c("",!0),e.showIcon?S((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=M=>i.scheduleList()),href:"javascript:;"},t[6]||(t[6]=[n("i",{class:"fas fa-calendar"},null,-1)]))),[[D,e.lang("schedule")]]):c("",!0)])]),n("div",_I,[e.isShowFilter?(o(),k(b,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=contract&type=contract",saveFilter:!0,filterFor:"contract",filterNum:e.contractFilterId,redirectTo:"/service-desk/contracts",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.contractFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter",parsedUrlParams:e.parsedUrlParams},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","filterNum","deleteUrl","closeFilter","parsedUrlParams"])):c("",!0),(o(!0),l(U,null,$(e.columnData,M=>(o(),l("section",{key:M},[_(f,{"table-columns":M.columns,reportId:M.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),k(g,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:M.columns,staticColumns:e.staticColumns,"report-type":e.reportType,show_pagination:e.showPagination},null,8,["data-url","columns","columnsMeta","staticColumns","report-type","show_pagination"])):c("",!0)]))),128))])])):c("",!0)])}const Ys=P(dI,[["render",fI]]),gI={name:"contract-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[Xe],beforeMount(){if(this.mode==="edit"){const e=pe(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-contract/"+e,this.editId=pe(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=At(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/contracts/"+s+"/show")},1e3)}},components:{FormRenderer:Ze,Alert:We,FaveoBox:wt,CustomLoader:nt}},bI={class:"col-sm-12"},yI={key:0,class:"pull-right"},vI={key:0,class:"form-group row mt-3"},wI={class:"col-md-12"},kI=["disabled"],CI={key:0},DI={key:1};function SI(e,t,s,d,a,i){const m=u("Alert"),h=u("CustomLoader"),b=u("router-link"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FaveoBox"),M=W("tooltip");return o(),l("div",bI,[a.formUniqueKey&&a.formSelected?(o(),k(D,{key:0,title:e.lang(i.mode)},{headerMenu:w(()=>[s.showViewButton?(o(),l("span",yI,[S((o(),k(b,{to:"/service-desk/contracts/"+a.editId+"/show",class:"btn btn-tool has-tooltip"},{default:w(()=>t[1]||(t[1]=[n("span",null,[n("i",{class:"fas fa-eye"})],-1)])),_:1},8,["to"])),[[M,e.trans("view")]])])):c("",!0)]),default:w(()=>[_(m,{componentName:"faveo-form"}),_(m,{componentName:"form-renderer"}),e.showLoader||a.submitFormInProgress?(o(),k(h,{key:0,duration:4e3})):c("",!0),_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:a.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",vI,[n("div",wI,[n("button",{type:"button",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=N=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",CI,t[2]||(t[2]=[n("i",{class:"fas fa-sync"},null,-1)]))):(o(),l("span",DI,t[3]||(t[3]=[n("i",{class:"fas fa-save"},null,-1)]))),v(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,kI)])]))]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const $s=P(gI,[["render",SI]]);function MI(e){const{contract_end_date:t,approver:s,cost:d}=e;var a={contract_end_date:[t,"isRequired"],approver:[s,"isRequired"],cost:[d,"isRequired"]};const i=new Ue(Ce),{errors:m,isValid:h}=i.validate(a);return Fe.dispatch("setValidationError",m),{errors:m,isValid:h}}const FI={name:"time-field",description:"time field component along with error block",props:{label:{type:String,required:!0},hint:{type:String,default:""},value:{required:!0},name:{type:String,required:!0},type:{type:String,default:"text"},onChange:{type:Function,Required:!0},classname:{type:String,default:""},required:{type:Boolean,default:!1},labelStyle:{type:Object},formStyle:{type:Object},max:{type:[String,Number],default:""},placeholder:{type:String,default:""},from:{type:String,default:""}},data(){return{changedValue:this.value,currencyValue:this.value}},created(){window.emitter.on("removeVal",this.initialState)},mounted(){this.changedValue=this.value,this.currencyValue=this.value,this.focusOut()},watch:{value(e){this.changedValue=e,this.currencyValue=e}},methods:{focusOut:function(){this.currencyValue=parseFloat(this.changedValue.replace(/[^\d\.]/g,"")),isNaN(this.currencyValue)&&(this.currencyValue=0),this.changedValue=new Intl.NumberFormat().format(this.changedValue),this.changedValue=this.changedValue==0?"":this.changedValue},focusIn:function(){this.changedValue=this.currencyValue.toString(),this.changedValue=this.changedValue==0?"":this.changedValue},checkValue(e){let t=e.keyCode?e.keyCode:e.which;(t<48||t>57)&&(t!==46||this.changedValue.indexOf(".")!=-1)&&e.preventDefault(),this.changedValue!=null&&this.changedValue.indexOf(".")>-1&&e.target.selectionStart>this.changedValue.indexOf(".")&&this.changedValue.split(".")[1].length>1&&e.preventDefault()},onPaste(e){e=e||window.event,e.clipboardData.getData("Text").match(/[^\d]/)&&e.preventDefault()},initialState(){this.changedValue=0,this.changedValue=this.changedValue==0?"":this.changedValue}},components:{"form-field-template":ma}},II={class:"inline"},AI=["type","placeholder"];function PI(e,t,s,d,a,i){const m=u("form-field-template");return o(),k(m,{label:s.label,labelStyle:s.labelStyle,name:s.name,classname:s.classname,hint:s.hint,required:s.required},{default:w(()=>[n("span",II,[S(n("input",{class:"form-control",style:ct(s.formStyle),type:s.type,id:"number","onUpdate:modelValue":t[0]||(t[0]=h=>a.changedValue=h),onInput:t[1]||(t[1]=h=>s.onChange(a.changedValue,s.name)),onKeypress:t[2]||(t[2]=(...h)=>i.checkValue&&i.checkValue(...h)),onPaste:t[3]||(t[3]=(...h)=>i.onPaste&&i.onPaste(...h)),min:"1",onBlur:t[4]||(t[4]=(...h)=>i.focusOut&&i.focusOut(...h)),onFocus:t[5]||(t[5]=(...h)=>i.focusIn&&i.focusIn(...h)),placeholder:s.placeholder},null,44,AI),[[yn,a.changedValue]])])]),_:1},8,["label","labelStyle","name","classname","hint","required"])}const TI=P(FI,[["render",PI],["__scopeId","data-v-90c96973"]]),VI={name:"contract-extend-modal",description:"Contract Extend Modal component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},contract:{type:Object,default:()=>{}},updateData:{type:Function,default:()=>{}},type:{type:String,default:""}},data(){return{isDisabled:!1,loading:!1,contract_start_date:"",contract_end_date:"",timeOptions:{start:"00:00",step:"00:30",end:"23:30"},approver:"",cost:"",containerStyle:{width:"800px"},dateDisabled:!1,category:""}},beforeMount(){this.dateDisabled=this.type=="extend",this.dateDisabled&&(this.contract_start_date=this.formattedTime(this.contract.contract_end_date)),this.category=this.$store.getters.getContractAssociateCategory},methods:{onChange(e,t){this[t]=e,t==="cost"&&(this.cost=e==0?"":e)},isValid(){const{errors:e,isValid:t}=MI(this.$data);return t},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;var e=new FormData;e.append("cost",this.cost),e.append("approver_id",this.approver.id),e.append("contract_start_date",Mt(this.contract_start_date).format("YYYY-MM-DD HH:mm:ss")),e.append("contract_end_date",Mt(this.contract_end_date).format("YYYY-MM-DD HH:mm:ss"));const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/contract-"+this.type+"/"+this.contract.id,e,t).then(s=>{window.emitter.emit("updateContractAssociates"),this.category==="activity"?window.emitter.emit("updateContractActivity"):this.category==="history"&&window.emitter.emit("updateContractHistory"),this.loading=!1,this.isDisabled=!1,K(s,"contract-view"),this.updateData(),this.onClose()}).catch(s=>{this.loading=!1,this.isDisabled=!1,O(s,"contract-view"),this.onClose()})}}},components:{"date-time-field":es,"dynamic-select":fe,"currency-field":TI}},LI={class:"modal-title"},UI={key:0},NI={class:"row"},EI={class:"row"},xI={key:1,class:"row"},OI=["disabled"];function qI(e,t,s,d,a,i){const m=u("date-time-field"),h=u("dynamic-select"),b=u("currency-field"),f=u("reuse-loader"),g=u("modal");return s.showModal?(o(),k(g,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",LI,r(e.trans(s.type)),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",UI,[n("div",NI,[_(m,{label:e.trans("contract_start_date"),value:a.contract_start_date,type:"datetime",name:"contract_start_date",onChange:i.onChange,required:!0,format:"MMMM DD YYYY, h:mm a",classname:"col-sm-6",clearable:!0,disabled:a.dateDisabled,editable:!0,currentYearDate:!1,"time-picker-options":a.timeOptions},null,8,["label","value","onChange","disabled","time-picker-options"]),_(m,{label:e.trans("contract_end_date"),value:a.contract_end_date,type:"datetime",name:"contract_end_date",onChange:i.onChange,required:!0,format:"MMMM DD YYYY, h:mm a",classname:"col-sm-6",clearable:!0,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":a.timeOptions,notBefore:a.contract_start_date},null,8,["label","value","onChange","time-picker-options","notBefore"])]),n("div",EI,[_(h,{label:e.trans("approver"),multiple:!1,name:"approver",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/api/dependency/users?meta=true",value:a.approver,onChange:i.onChange,required:!0,clearable:!!a.approver,strlength:18},null,8,["label","value","onChange","clearable"]),_(b,{label:e.trans("cost"),value:a.cost,name:"cost",classname:"col-sm-6",onChange:i.onChange,type:"text",required:!0},null,8,["label","value","onChange"])])])),a.loading?(o(),l("div",xI,[_(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=D=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[n("i",{class:Q(s.type=="extend"?"fas fa-expand":"fas fa-sync")},null,2),v(" "+r(e.trans(s.type)),1)],8,OI)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const jI=P(VI,[["render",qI]]);const RI={name:"contract-assets-modal",description:"Contract Asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},contractId:{type:[String,Number],default:""}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"contractAssets",category:""}},beforeMount(){this.category=this.$store.getters.getContractAssociateCategory},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?contract_id="+this.contractId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};T.post("/service-desk/api/contract-attach-asset?contract_id="+this.contractId,e,t).then(s=>{this.loading=!1,K(s,"contract-view"),window.emitter.emit("updateContractAssociates"),this.category==="activity"?window.emitter.emit("updateContractActivity"):this.category==="assets"&&window.emitter.emit(this.componentTitle+"refreshData"),setTimeout(()=>{window.emitter.emit("updateContractTabs")},500),this.onClose()}).catch(s=>{this.loading=!1,O(s,"contract-view"),this.onClose()})}}},components:{"asset-list-with-checkbox":ht,"dynamic-select":fe}},BI={class:"row"},zI={class:"col-sm-12"},KI={class:"height-limit"},HI={key:0,class:"row"},YI=["disabled"];function $I(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("asset-list-with-checkbox"),b=u("custom-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",null,r(e.trans("attach_assets")),1)]),fields:w(()=>[n("div",BI,[_(m,{label:e.trans("asset_types"),multiple:!1,name:"asset_type_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:a.asset_type_ids,onChange:i.onChange,clearable:!!a.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.trans("used_by"),multiple:!1,name:"used_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:a.used_by_ids,onChange:i.onChange,clearable:!!a.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.trans("managed_by"),multiple:!1,name:"managed_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:a.managed_by_ids,onChange:i.onChange,clearable:!!a.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.trans("organizations"),multiple:!1,name:"org_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:a.org_ids,onChange:i.onChange,clearable:!!a.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),n("div",zI,[n("button",{id:"apply-btn",class:"btn btn-primary round-btn float-start",type:"button",onClick:t[0]||(t[0]=g=>i.onApply())},[t[2]||(t[2]=n("span",{class:"fa fa-check"},null,-1)),v("  "+r(e.trans("apply")),1)])])]),t[3]||(t[3]=n("br",null,null,-1)),n("div",KI,[a.apiUrl?(o(),k(h,{key:0,apiUrl:a.apiUrl,tickets:i.assetsData,componentTitle:a.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),a.loading===!0?(o(),l("div",HI,[_(b,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=g=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[4]||(t[4]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.trans("attach")),1)],8,YI)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const WI=P(RI,[["render",$I],["__scopeId","data-v-f285a0b3"]]),JI={name:"contract-approve",description:"Contract Approve Modal component",props:{showModal:{type:Boolean,default:!1},contractId:{type:[String,Number],default:""},type:{type:String,default:""},onClose:{type:Function},updateData:{type:Function,default:()=>{}}},data(){return{isDisabled:!1,containerStyle:{width:"700px"},loading:!1,reason:"",category:""}},beforeMount(){this.isDisabled=this.type=="reject",this.category=this.$store.getters.getContractAssociateCategory},computed:{btnClass(){return this.type=="approve"?"btn btn-success":"btn btn-secondary"},iconClass(){return this.type=="approve"?"fas fa-check":this.type=="reject"?"fas fa-unlink":"fas fa-ban"}},methods:{onChange(e,t){this[t]=e,this.isDisabled=!e},onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};this.type=="reject"&&(e.purpose_of_rejection=this.reason),this.type=="approve"&&(e.purpose_of_approval=this.reason),T.post("/service-desk/api/contract-"+this.type+"/"+this.contractId,e).then(t=>{K(t,"contract-view"),this.afterAction()}).catch(t=>{O(t,"contract-view"),this.afterAction()})},afterAction(){window.emitter.emit("updateContractAssociates"),window.emitter.emit("updateContractActions"),this.category==="activity"?window.emitter.emit("updateContractActivity"):this.category==="history"&&window.emitter.emit("updateContractHistory"),this.updateData(),this.onClose(),this.loading=!1,this.isDisabled=!0}}},GI={class:"modal-title"},XI={key:0},ZI={key:0,class:"col-sm-12"},QI={key:1},eA={key:1,class:"row"},tA=["disabled"];function sA(e,t,s,d,a,i){const m=u("tiny-editor"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",GI,r(e.trans(s.type)),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",XI,[s.type=="reject"||s.type=="approve"?(o(),l("div",ZI,[_(m,{value:a.reason,type:"text",onChange:i.onChange,name:"reason",label:s.type=="approve"?e.trans("reason_approve"):e.trans("reason_rejection"),classname:"width55",required:s.type!="approve",lang:"en",id:"focus_editor"},null,8,["value","onChange","label","required"])])):c("",!0),s.type=="terminate"?(o(),l("span",QI,r(e.trans("terminate_description")),1)):c("",!0)])),a.loading?(o(),l("div",eA,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:Q(i.btnClass),disabled:a.isDisabled},[n("i",{class:Q(i.iconClass),"aria-hidden":"true"},null,2),v(" "+r(e.trans(s.type)),1)],10,tA)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const aA=P(JI,[["render",sA]]);function nA(e){const{notify_to:t,notifyBefore:s}=e;var d={notify_to:[t,"isRequired"],notifyBefore:[s,"isRequired"]};const a=new Ue(Ce),{errors:i,isValid:m}=a.validate(d);return Fe.dispatch("setValidationError",i),{errors:i,isValid:m}}const oA={name:"contract-reminder-modal",description:"Contract Reminder Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},contract:{type:Object,default:()=>{}},updateData:{type:Function,default:()=>{}}},data(){return{isDisabled:!1,loading:!1,notify_to:this.contract.notify_to?this.contract.notify_to:"",notifyBefore:this.contract.notify_before?this.contract.notify_before:"",containerStyle:{width:"800px"},category:""}},beforeMount(){this.category=this.$store.getters.getContractAssociateCategory},methods:{onChange(e,t){this[t]=e},isValid(){const{errors:e,isValid:t}=nA(this.$data);return t},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;var e=new FormData;if(this.notifyBefore&&e.append("notify_before",this.notifyBefore),this.notify_to!=""&&this.notify_to.length>0)for(var t in this.notify_to)this.notify_to[t].id&&typeof this.notify_to[t].id=="number"?e.append("notify_agent_ids["+t+"]",this.notify_to[t].id):e.append("email_ids["+t+"]",this.notify_to[t].name);const s={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/contract-expiry-reminder/"+this.contract.id,e,s).then(d=>{this.loading=!1,this.isDisabled=!1,K(d,"contract-view"),window.emitter.emit("updateContractAssociates"),this.category==="activity"?window.emitter.emit("updateContractActivity"):this.category==="history"&&window.emitter.emit("updateContractHistory"),this.updateData(),this.onClose()}).catch(d=>{this.loading=!1,this.isDisabled=!1,O(d,"contract-view")})}}},components:{"number-field":ts,"dynamic-select":fe}},iA={class:"modal-title"},lA={key:0,class:"row"},rA={key:1,class:"row"},dA=["disabled"];function cA(e,t,s,d,a,i){const m=u("number-field"),h=u("dynamic-select"),b=u("reuse-loader"),f=u("modal"),g=W("focus-first-input");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",iA,r(e.trans("contract_expiry_reminder")),1)]),fields:w(()=>[a.loading?c("",!0):S((o(),l("div",lA,[_(m,{label:e.lang("notify_before"),value:a.notifyBefore,name:"notifyBefore",classname:"col-sm-6",onChange:i.onChange,type:"number",required:!0,hint:e.lang("notify_in_days")},null,8,["label","value","onChange","hint"]),_(h,{label:e.lang("notify_to"),multiple:!0,name:"notify_to",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/api/dependency/users?meta=true",value:a.notify_to,onChange:i.onChange,required:!0,taggable:!0,hint:e.lang("notify_to_contracts"),strlength:18},null,8,["label","value","onChange","hint"])])),[[g]]),a.loading?(o(),l("div",rA,[_(b,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=D=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(e.trans("save")),1)],8,dA)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const uA=P(oA,[["render",cA]]),mA={name:"contract-actions",description:"Contract actions component",props:{contract:{type:Object,default:()=>{}},updateContractDetails:{type:Function,default:()=>{}}},data(){return{actions:"",showUpdateModal:!1,showAssetModal:!1,showCommonModal:!1,actionType:"",showReminder:!1,showDeleteModal:!1,refreshAction:!1}},beforeMount(){this.getActions()},created(){window.emitter.on("updateContractActions",()=>this.refreshAction=!0)},methods:{getActions(){T.get("/service-desk/api/contract-action/"+this.contract.id).then(e=>{this.actions=e.data.data.actions,window.emitter.emit("updateContractTableActions",this.actions)}).catch(e=>{this.actions=""})},extendAndRenew(e){this.actionType=e,this.showUpdateModal=!0},onClose(){this.showUpdateModal=!1,this.showAssetModal=!1,this.showCommonModal=!1,this.showReminder=!1,this.showDeleteModal=!1,this.$store.dispatch("unsetValidationError")},commonMethod(e){this.showCommonModal=!0,this.actionType=e}},watch:{refreshAction(e,t){e===!0&&this.getActions(),this.refreshAction=!1}},components:{"delete-modal":ot,"contract-update-modal":jI,"contract-assets":WI,"contract-action-modal":aA,"contract-reminder-modal":uA}},hA={key:0,class:"card-tools"};function pA(e,t,s,d,a,i){const m=u("router-link"),h=u("contract-update-modal"),b=u("contract-reminder-modal"),f=u("contract-assets"),g=u("contract-action-modal"),D=u("delete-modal");return a.actions?(o(),l("div",hA,[a.actions.contract_expiry_reminder?(o(),l("button",{key:0,class:"btn btn-tool btn-tool-rounded",onClick:t[0]||(t[0]=M=>a.showReminder=!0)},[t[8]||(t[8]=n("i",{class:"fas fa-server"},null,-1)),v(" "+r(e.trans("contract_expiry_reminder")),1)])):c("",!0),a.actions.contract_asset_attach?(o(),l("button",{key:1,class:"btn btn-tool btn-tool-rounded",onClick:t[1]||(t[1]=M=>a.showAssetModal=!0)},[t[9]||(t[9]=n("i",{class:"fas fa-server"},null,-1)),v(" "+r(e.trans("attach_asset")),1)])):c("",!0),a.actions.contract_edit?(o(),k(m,{key:2,class:"btn btn-tool btn-tool-rounded",to:"/service-desk/contracts/"+s.contract.id+"/edit"},{default:w(()=>[t[10]||(t[10]=n("i",{class:"fas fa-edit"},null,-1)),v(" "+r(e.trans("edit")),1)]),_:1},8,["to"])):c("",!0),a.actions.contract_approve?(o(),l("button",{key:3,class:"btn btn-tool btn-tool-rounded",onClick:t[2]||(t[2]=M=>i.commonMethod("approve"))},[t[11]||(t[11]=n("i",{class:"fas fa-check"},null,-1)),v(" "+r(e.trans("approve")),1)])):c("",!0),a.actions.contract_approve?(o(),l("button",{key:4,class:"btn btn-tool btn-tool-rounded",onClick:t[3]||(t[3]=M=>i.commonMethod("reject"))},[t[12]||(t[12]=n("i",{class:"fas fa-ban"},null,-1)),v(" "+r(e.trans("reject")),1)])):c("",!0),a.actions.contract_renew?(o(),l("button",{key:5,class:"btn btn-tool btn-tool-rounded",onClick:t[4]||(t[4]=M=>i.extendAndRenew("renew"))},[t[13]||(t[13]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.trans("renew")),1)])):c("",!0),a.actions.contract_extend?(o(),l("button",{key:6,class:"btn btn-tool btn-tool-rounded",onClick:t[5]||(t[5]=M=>i.extendAndRenew("extend"))},[t[14]||(t[14]=n("i",{class:"fas fa-expand"},null,-1)),v(" "+r(e.trans("extend")),1)])):c("",!0),a.actions.contract_terminate?(o(),l("button",{key:7,class:"btn btn-tool btn-tool-rounded",onClick:t[6]||(t[6]=M=>i.commonMethod("terminate"))},[t[15]||(t[15]=n("i",{class:"fas fa-times"},null,-1)),v(" "+r(e.trans("terminate")),1)])):c("",!0),a.actions.contract_delete?(o(),l("button",{key:8,class:"btn btn-tool btn-tool-rounded",onClick:t[7]||(t[7]=M=>a.showDeleteModal=!0)},[t[16]||(t[16]=n("i",{class:"fas fa-trash"},null,-1)),v(" "+r(e.trans("delete")),1)])):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showUpdateModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showUpdateModal,contract:s.contract,updateData:s.updateContractDetails,type:a.actionType},null,8,["onClose","showModal","contract","updateData","type"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showReminder?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showReminder,contract:s.contract,updateData:s.updateContractDetails},null,8,["onClose","showModal","contract","updateData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAssetModal?(o(),k(f,{key:0,onClose:i.onClose,showModal:a.showAssetModal,contractId:s.contract.id},null,8,["onClose","showModal","contractId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showCommonModal?(o(),k(g,{key:0,onClose:i.onClose,showModal:a.showCommonModal,contractId:s.contract.id,type:a.actionType,updateData:s.updateContractDetails},null,8,["onClose","showModal","contractId","type","updateData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showDeleteModal?(o(),k(D,{key:0,onClose:i.onClose,showModal:a.showDeleteModal,alertComponentName:"contract-view",deleteUrl:"/service-desk/api/contract/"+s.contract.id,redirectUrl:"/service-desk/contracts/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1})])):c("",!0)}const _A=P(mA,[["render",pA]]);const fA={name:"contract-description",description:"Contract description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},gA={class:"modal-title"},bA={id:"log_desc"},yA=["innerHTML"];function vA(e,t,s,d,a,i){const m=u("modal");return s.showModal?(o(),k(m,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",gA,r(e.trans("description")),1)]),fields:w(()=>[n("div",bA,[n("span",{innerHTML:s.description},null,8,yA)])]),_:1},8,["showModal","onClose"])):c("",!0)}const wA=P(fA,[["render",vA],["__scopeId","data-v-f85bfeda"]]);const kA={name:"contract-details",description:"Contract details page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{contract:{type:Object,default:()=>{}},updateData:{type:Function}},data(){return{showDescription:!1}},methods:{subString(e,t=15){return Ie(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")},downloadFile(e){window.open(e)}},components:{"contract-actions":_A,"contract-description":wA}},CA={class:"card card-light"},DA={class:"card-header"},SA={class:"card-title"},MA={class:"card-body"},FA={class:"row mb-3"},IA={class:"col-md-12"},AA={class:"callout callout-info"},PA={class:"row"},TA={class:"col-md-4"},VA={class:"col-md-4"},LA={key:0,class:"col-md-4"},UA={class:"col-md-12"},NA={class:"row mx-1"},EA={key:0,class:"col-md-6 info-row d-flex"},xA={class:"col-md-6"},OA={class:"col-md-6"},qA={key:1,class:"col-md-6 info-row d-flex"},jA={class:"col-md-6"},RA={class:"col-md-6"},BA={key:2,class:"col-md-6 info-row d-flex"},zA={class:"col-md-6"},KA={class:"col-md-6"},HA={key:3,class:"col-md-6 info-row d-flex"},YA={class:"col-md-6"},$A={class:"col-md-6"},WA={key:4,class:"col-md-6 info-row d-flex"},JA={class:"col-md-6"},GA={class:"col-md-6"},XA={class:"col-md-6 info-row d-flex"},ZA={class:"col-md-6"},QA={class:"col-md-6"},e6={class:"text-primary"},t6={class:"col-md-6 info-row d-flex"},s6={class:"col-md-6"},a6={class:"col-md-6"},n6={class:"text-primary"},o6={class:"col-md-6 info-row d-flex"},i6={class:"col-md-6"},l6={class:"col-md-6"},r6={class:"text-primary"},d6={class:"col-md-6 info-row d-flex"},c6={class:"col-md-6"},u6={class:"col-md-6"},m6={class:"text-primary"},h6={class:"col-md-6 info-row d-flex"},p6={class:"col-md-6"},_6={class:"col-md-6"},f6={class:"text-primary"},g6={class:"col-md-6 info-row d-flex"},b6={class:"col-md-6"},y6={class:"col-md-6"},v6={class:"text-primary"},w6={class:"col-md-6 info-row d-flex"},k6={class:"col-md-6"},C6={class:"col-md-6"},D6={class:"text-primary"},S6={key:0},M6={class:"col-md-6 info-row d-flex"},F6={class:"col-md-6"},I6={class:"col-md-6"},A6={class:"col-md-6 info-row d-flex"},P6={class:"col-md-6"},T6={class:"col-md-6"},V6={key:0},L6={key:0},U6={key:6,class:"col-md-6 info-row d-flex"},N6={class:"col-md-6"},E6={class:"col-md-6"},x6={key:0},O6={class:"line"},q6=["src"],j6=["onClick"],R6={key:1};function B6(e,t,s,d,a,i){const m=u("contract-actions"),h=u("router-link"),b=u("contract-description"),f=W("tooltip");return o(),l("div",CA,[n("div",DA,[S((o(),l("h3",SA,[v(r(i.subString(s.contract.name,50)),1)])),[[f,s.contract.name]]),_(m,{contract:s.contract,updateContractDetails:s.updateData},null,8,["contract","updateContractDetails"])]),n("div",MA,[n("div",FA,[n("div",IA,[n("div",AA,[n("div",PA,[n("div",TA,[n("b",null,r(e.trans("start_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(s.contract.contract_start_date)==="Invalid date"?s.contract.contract_start_date:d.formattedTime(s.contract.contract_start_date)),1)])),[[f,d.formattedTime(s.contract.contract_start_date)==="Invalid date"?s.contract.contract_start_date:d.formattedTime(s.contract.contract_start_date)]])]),n("div",VA,[n("b",null,r(e.trans("expiry_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(s.contract.contract_end_date)==="Invalid date"?s.contract.contract_end_date:d.formattedTime(s.contract.contract_end_date)),1)])),[[f,d.formattedTime(s.contract.contract_end_date)==="Invalid date"?s.contract.contract_end_date:d.formattedTime(s.contract.contract_end_date)]])]),s.contract.contractType?(o(),l("div",LA,[n("b",null,r(e.trans("contract_type"))+" : ",1),S((o(),l("span",null,[_(h,{class:"text-decoration-none",to:s.contract.contractType.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[v(r(i.subString(s.contract.contractType.name,20)),1)]),_:1},8,["to"])])),[[f,s.contract.contractType.name]])])):c("",!0)])])])]),n("div",UA,[n("div",NA,[s.contract.vendor?(o(),l("div",EA,[n("div",xA,[n("label",null,r(e.trans("vendor")),1)]),n("div",OA,[_(h,{class:"text-primary",to:s.contract.vendor.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.contract.vendor.name)),1)])),[[f,s.contract.vendor.name]])]),_:1},8,["to"])])])):c("",!0),s.contract.status?(o(),l("div",qA,[n("div",jA,[n("label",null,r(e.trans("contract_status")),1)]),n("div",RA,[_(h,{class:"text-primary",to:s.contract.status.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.contract.status.name)),1)])),[[f,s.contract.status.name]])]),_:1},8,["to"])])])):c("",!0),s.contract.licence?(o(),l("div",BA,[n("div",zA,[n("label",null,r(e.trans("license_type")),1)]),n("div",KA,[_(h,{class:"text-primary",to:s.contract.licence.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.contract.licence.name)),1)])),[[f,s.contract.licence.name]])]),_:1},8,["to"])])])):c("",!0),s.contract.owner?(o(),l("div",HA,[n("div",YA,[n("label",null,r(e.trans("contract_creator")),1)]),n("div",$A,[_(h,{class:"text-primary",to:s.contract.owner.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.contract.owner.name)),1)])),[[f,s.contract.owner.name]])]),_:1},8,["to"])])])):c("",!0),s.contract.approver?(o(),l("div",WA,[n("div",JA,[n("label",null,r(e.trans("approver")),1)]),n("div",GA,[_(h,{class:"text-primary",to:s.contract.approver.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.contract.approver.name)),1)])),[[f,s.contract.approver.name]])]),_:1},8,["to"])])])):c("",!0),n("div",XA,[n("div",ZA,[n("label",null,r(e.trans("cost")),1)]),n("div",QA,[S((o(),l("a",e6,[v(r(i.subString(new Intl.NumberFormat().format(s.contract.cost))),1)])),[[f,new Intl.NumberFormat().format(s.contract.cost).toString()]])])]),n("div",t6,[n("div",s6,[n("label",null,r(e.trans("identifier")),1)]),n("div",a6,[S((o(),l("a",n6,[v(r(s.contract.identifier?i.subString(s.contract.identifier):"---"),1)])),[[f,s.contract.identifier?s.contract.identifier:"---"]])])]),n("div",o6,[n("div",i6,[n("label",null,r(e.trans("license_count")),1)]),n("div",l6,[S((o(),l("a",r6,[v(r(s.contract.licensce_count?i.subString(s.contract.licensce_count):"---"),1)])),[[f,s.contract.licensce_count?s.contract.licensce_count.toString():"---"]])])]),n("div",d6,[n("div",c6,[n("label",null,r(e.trans("user")),1)]),n("div",u6,[S((o(),l("a",m6,[v(r(s.contract.user.length>0?i.subString(s.contract.user[0].name):"---"),1)])),[[f,s.contract.user.length>0?s.contract.user[0].name:"---"]])])]),n("div",h6,[n("div",p6,[n("label",null,r(e.trans("organization")),1)]),n("div",_6,[S((o(),l("a",f6,[v(r(s.contract.organization.length>0?i.subString(s.contract.organization[0].name):"---"),1)])),[[f,s.contract.organization.length>0?s.contract.organization[0].name:"---"]])])]),n("div",g6,[n("div",b6,[n("label",null,r(e.trans("notify_before")),1)]),n("div",y6,[S((o(),l("a",v6,[v(r(s.contract.notify_before?i.subString(s.contract.notify_before):"---"),1)])),[[f,s.contract.notify_before?s.contract.notify_before.toString():"---"]])])]),n("div",w6,[n("div",k6,[n("label",null,r(e.trans("notify_to")),1)]),n("div",C6,[s.contract.notify_to.length>0?(o(!0),l(U,{key:0},$(s.contract.notify_to,(g,D)=>S((o(),l("a",D6,[v(r(g.name?g.name:g.email),1),D!=Object.keys(s.contract.notify_to).length-1?(o(),l("span",S6,", ")):c("",!0)])),[[f,g.name?g.name:g.email]])),256)):(o(),l(U,{key:1},[v(" --- ")],64))])]),n("div",M6,[n("div",F6,[n("label",null,r(e.trans("description")),1)]),n("div",I6,[n("a",{href:"javascript:;",class:"btn btn-info btn-sm",onClick:t[0]||(t[0]=g=>a.showDescription=!0)},[t[1]||(t[1]=n("i",{class:"fas fa-file-code"},"  ",-1)),v(r(e.trans("show_description")),1)])])]),s.contract.customFieldValues&&s.contract.customFieldValues.length>0?(o(!0),l(U,{key:5},$(s.contract.customFieldValues,g=>(o(),l("div",A6,[n("div",P6,[n("label",null,r(g.label),1)]),n("div",T6,[Array.isArray(g.value)?(o(),l("div",V6,[(o(!0),l(U,null,$(g.value,(D,M)=>(o(),k(h,{class:"text-primary",to:g.href[M].replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(D)),1)])),[[f,D]]),M!=Object.keys(g.value).length-1?(o(),l("span",L6,",")):c("",!0),t[2]||(t[2]=v("  "))]),_:2},1032,["to"]))),256))])):(o(),l(U,{key:1},[g.field_type==="date"?(o(),k(h,{key:0,class:"text-primary",to:g.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(g.value),1)])),[[f,g.value]])]),_:2},1032,["to"])):(o(),k(h,{key:1,class:"text-primary",to:g.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(g.value)),1)])),[[f,{content:g.value?g.value.replace(/\r?\n/g,"<br />"):"---",html:!0}]])]),_:2},1032,["to"]))],64))])]))),256)):c("",!0),s.contract.attachment.length>0?(o(),l("div",U6,[n("div",N6,[n("label",null,r(e.trans("attachments")),1)]),n("div",E6,[s.contract.attachment.length>0?(o(),l("span",x6,[(o(!0),l(U,null,$(s.contract.attachment,g=>(o(),l(U,null,[n("span",O6,[S((o(),l("span",null,[n("img",{src:g.thumbnail_url,class:"attach_img"},null,8,q6),v(" "+r(i.subString(g.name,15))+" "+r("("+g.size+")"),1)])),[[f,g.name]]),S((o(),l("a",{id:"download",onClick:D=>i.downloadFile(g.download_url),href:"javascript:;"},t[3]||(t[3]=[v("  "),n("i",{class:"fas fa-download"},null,-1)]),8,j6)),[[f,e.trans("download")]])]),t[4]||(t[4]=n("br",null,null,-1))],64))),256))])):(o(),l("span",R6,"---"))])])):c("",!0)])])]),_(X,{name:"modal"},{default:w(()=>[a.showDescription?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showDescription,description:s.contract.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])}const z6=P(kA,[["render",B6],["__scopeId","data-v-e029d1a5"]]);const K6={name:"contract-activity",description:"Contract activity page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{contractId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/contract-log/"+this.contractId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},created(){window.emitter.on("updateContractActivity",()=>this.refreshActivity=!0)},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},loading(e){this.$emit("loaderValue",e)},filtering(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){T.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.contract_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.contract_activity_logs.total,this.perPage=t.data.data.contract_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":kt}},H6={class:"row",id:"activity_log_div"},Y6={class:"col-sm-12 mb-2"},$6={key:0,id:"select_limit"},W6={type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},J6={class:"dropdown-menu"},G6={key:1,id:"choose_order"},X6={id:"sort_btn",type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},Z6={class:"dropdown-menu",style:{"z-index":"9999"}},Q6={key:2,id:"page_div"},e8={class:"col-md-12"},t8={key:0,class:"timeline"},s8={key:0,class:"time-label"},a8={class:"text-bg-light border"},n8={class:"contrat-activity-timeline"},o8={class:"timeline-item"},i8={class:"time"},l8={key:0,class:"timeline-header"},r8={class:"timeline-body break"},d8={key:1},c8={key:1,class:"float-end",id:"page_div"},u8={key:0,class:"col-sm-12"},m8={class:"text-center"};function h8(e,t,s,d,a,i){const m=u("uib-pagination"),h=u("faveo-image-element"),b=u("router-link"),f=u("activity-parser");return o(),l("div",H6,[n("div",Y6,[!a.loading&&a.activity_log.length>0?(o(),l("div",$6,[n("button",W6,r(a.perPage),1),n("div",J6,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=g=>i.logLimit(10))},"10"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[1]||(t[1]=g=>i.logLimit(25))},"25"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=g=>i.logLimit(50))},"50"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[3]||(t[3]=g=>i.logLimit(100))},"100")])])):c("",!0),!a.loading&&a.activity_log.length>0?(o(),l("div",G6,[n("button",X6,r(e.lang("created_time"))+" - "+r(e.lang(a.sort_key)),1),n("div",Z6,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[4]||(t[4]=g=>i.orderBy("asc"))},[t[8]||(t[8]=n("i",{class:"fas fa-sort-amount-up"},null,-1)),v(" "+r(e.lang("asc")),1)]),n("a",{href:"javascript:;",onClick:t[5]||(t[5]=g=>i.orderBy("desc")),class:"dropdown-item"},[t[9]||(t[9]=n("i",{class:"fas fa-sort-amount-down"},null,-1)),v(" "+r(e.lang("desc")),1)])])])):c("",!0),!a.loading&&a.total>10?(o(),l("div",Q6,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[6]||(t[6]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),n("div",e8,[!a.loading&&a.activity_log.length>0?(o(),l("div",t8,[(o(!0),l(U,null,$(a.activity_log,(g,D)=>(o(),l(U,null,[i.checkDate(D)?(o(),l("div",s8,[n("span",a8,r(d.formattedDate(g.created_at)),1)])):c("",!0),n("div",n8,[t[11]||(t[11]=n("i",{class:"far fa-dot-circle timeline-icon"},null,-1)),n("div",o8,[n("span",i8,[t[10]||(t[10]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(g.created_at)),1)]),g.creator?(o(),l("h3",l8,[_(h,{id:"contract_img","source-url":g.creator.profile_pic,classes:["img-circle","img-bordered-sm","img-rounder"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),_(b,{to:"/user/"+g.creator.id},{default:w(()=>[v(" "+r(g.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),n("div",r8,[_(f,{data:g.name},null,8,["data"])])])]),i.showThreadEnd(D)?(o(),l("div",d8,t[12]||(t[12]=[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),256))])):c("",!0),!a.loading&&a.total>10?(o(),l("div",c8,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[7]||(t[7]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!a.filtering&&!a.loading&&a.activity_log.length===0?(o(),l("div",u8,[n("h6",m8,r(e.lang("no_data_found")),1)])):c("",!0)])}const p8=P(K6,[["render",h8],["__scopeId","data-v-45764f79"]]);const _8={name:"contract-history",description:"Contract history page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{contractId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/contract-threads/"+this.contractId,history:"",refreshHistory:!1}},created(){window.emitter.on("updateContractHistory",()=>this.refreshHistory=!0)},beforeMount(){this.getValues()},methods:{subString(e,t=15){return e?e&&e.length>t?e.substring(0,t)+"...":e:"---"},getValues(){T.get(this.apiUrl).then(e=>{this.loading=!1,this.history=e.data.data.contract_threads}).catch(e=>{this.loading=!1})},checkDate(e){if(e==0)return!0;{let t=this.formattedDate(this.history[e-1].created_at),s=this.formattedDate(this.history[e].created_at);if(t!=s)return!0}},showThreadEnd(e){return e===this.history.length-1}},watch:{loading(e){this.$emit("loaderValue",e)},refreshHistory(e,t){e===!0&&this.getValues(),this.refreshHistory=!1}}},f8={class:"row"},g8={class:"col-md-12"},b8={key:0,class:"timeline"},y8={key:0,class:"time-label"},v8={class:"text-bg-light border"},w8={class:"history-timeline"},k8={class:"timeline-item"},C8={class:"time"},D8={class:"timeline-body"},S8={class:"col-md-12 p-2"},M8={class:"row"},F8={class:"col-md-6 info-row d-flex"},I8={class:"col-md-6"},A8={class:"col-md-6"},P8={class:"col-md-6 info-row d-flex"},T8={class:"col-md-6"},V8={class:"col-md-6"},L8={class:"col-md-6 info-row d-flex"},U8={class:"col-md-6"},N8={class:"col-md-6"},E8={class:"col-md-6 info-row d-flex"},x8={class:"col-md-6"},O8={class:"col-md-6"},q8={key:0,class:"col-md-6 info-row d-flex"},j8={class:"col-md-6"},R8={class:"col-md-6"},B8={class:"col-md-6 info-row d-flex"},z8={key:0,class:"badge text-bg-success log_type"},K8={key:1,class:"badge text-bg-success"},H8={key:2,class:"badge text-bg-danger"},Y8={key:1},$8={key:0,class:"text-center"};function W8(e,t,s,d,a,i){const m=W("tooltip");return o(),l("div",f8,[n("div",g8,[!a.loading&&a.history.length>0?(o(),l("div",b8,[(o(!0),l(U,null,$(a.history,(h,b)=>(o(),l(U,null,[i.checkDate(b)?(o(),l("div",y8,[n("span",v8,r(d.formattedDate(h.created_at)),1)])):c("",!0),n("div",w8,[t[2]||(t[2]=n("i",{class:"far fa-dot-circle timeline-icon"},null,-1)),n("div",k8,[n("span",C8,[t[0]||(t[0]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(h.created_at)),1)]),t[1]||(t[1]=n("h3",{class:"timeline-header pb-12 border-0 text-white"},".",-1)),n("div",D8,[n("div",S8,[n("div",M8,[n("div",F8,[n("div",I8,[n("label",null,r(e.trans("contract_start_date")),1)]),n("div",A8,[S((o(),l("a",null,[v(r(d.formattedTime(h.contract_start_date)),1)])),[[m,d.formattedTime(h.contract_start_date)]])])]),n("div",P8,[n("div",T8,[n("label",null,r(e.trans("contract_end_date")),1)]),n("div",V8,[S((o(),l("a",null,[v(r(d.formattedTime(h.contract_end_date)),1)])),[[m,d.formattedTime(h.contract_end_date)]])])]),n("div",L8,[n("div",U8,[n("label",null,r(e.trans("created_by")),1)]),n("div",N8,[S((o(),l("a",null,[v(r(i.subString(h.owner?h.owner.name:"---")),1)])),[[m,h.owner?h.owner.name:"---"]])])]),n("div",E8,[n("div",x8,[n("label",null,r(e.trans("approver")),1)]),n("div",O8,[S((o(),l("a",null,[v(r(i.subString(h.approver?h.approver.name:"---")),1)])),[[m,h.approver?h.approver.name:"---"]])])]),h.cost?(o(),l("div",q8,[n("div",j8,[n("label",null,r(e.trans("cost")),1)]),n("div",R8,[S((o(),l("a",null,[v(r(new Intl.NumberFormat().format(h.cost)),1)])),[[m,new Intl.NumberFormat().format(h.cost).toString()]])])])):c("",!0),n("div",B8,[h.type?(o(),l("span",z8,r(h.type),1)):c("",!0),h.current?(o(),l("span",K8,r(e.trans("current")),1)):c("",!0),h.expired?(o(),l("span",H8,r(e.trans("expired")),1)):c("",!0)])])])])])]),i.showThreadEnd(b)?(o(),l("div",Y8,t[3]||(t[3]=[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),256))])):c("",!0)]),!a.loading&&a.history.length===0?(o(),l("h6",$8,r(e.trans("no_data_found")),1)):c("",!0)])}const J8=P(_8,[["render",W8],["__scopeId","data-v-3a485eb7"]]),G8={name:"contract-asset-detach",description:"Contract Asset Detach Modal component",props:{showModal:{type:Boolean,default:!1},assetId:{type:[String,Number],default:""},compName:{type:String,default:""},alertCompName:{type:String,default:"contractAssociates"},contractId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/contract-detach-asset/"+this.contractId+"/"+this.assetId).then(e=>{K(e,this.alertCompName),window.emitter.emit("updateContractAssociates"),window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.onClose(),this.loading=!1,this.isDisabled=!0,O(e,this.alertCompName)})}}},X8={class:"modal-title"},Z8={key:0},Q8={key:1,class:"row"},e3=["disabled"];function t3(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",X8,r(e.trans("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",Z8,[n("span",null,r(e.trans("are_you_sure")),1)])),a.loading?(o(),l("div",Q8,[_(m,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1)),v(" "+r(e.trans("detach")),1)],8,e3)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const s3=P(G8,[["render",t3]]);const a3={name:"contract-assets",description:"Contract assets component",props:{actions:{type:[String,Object],default:""},category:{type:String,default:"inbox"},apiUrl:{type:String,default:""},contractId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:this.actions.contract_asset_detach?["name","managed_by","used_by","action"]:["name","managed_by","used_by"],options:{},apiEndPoint:this.apiUrl,showModal:!1,assetId:"",totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){return e.h(De,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},managed_by(t,s){var d,a;return((a=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,a;return((a=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},action:function(t,s){let d=e.h("i",{class:"fa fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.showModal=!0,e.assetId=s.id}},[d])}},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.data.map(s=>(s.detach=!0,s.contract_id=e.contractId,s.compName=e.componentTitle,s)),count:e.totalCount}}}},methods:{onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateContractTabs"),window.emitter.emit("updateContractAssetTable"))}},components:{"contract-asset-detach":s3}},n3={id:"contract_associated_assets"};function o3(e,t,s,d,a,i){const m=u("data-table"),h=u("contract-asset-detach");return o(),l("div",n3,[_(m,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,assetId:a.assetId,contractId:s.contractId,compName:s.componentTitle},null,8,["onClose","showModal","assetId","contractId","compName"])):c("",!0)]),_:1})])}const i3=P(a3,[["render",o3]]);const l3={name:"contract-associates",description:"Contract associates page",props:{contract:{type:Object,default:()=>{}}},data(){return{tabs:"",category:"activity",loading:!0,actions:"",dynamicKeys:{activity:1,history:1,assets:1}}},created(){window.emitter.on("updateContractTableActions",this.getActions),window.emitter.on("updateContractTabs",this.refreshTabs),window.emitter.on("updateContractAssetTable",()=>this.associates("activity")),this.$store.dispatch("setContractAssociateCategory",this.category)},beforeMount(){this.getTabs()},methods:{getActions(e){this.actions=e},refreshTabs(){setTimeout(()=>{this.getTabs()},1e3)},getTabs(){this.tabs=[{id:"activity",title:"activity_log",show:!0},{id:"history",title:"contract_history",show:!0},{id:"assets",title:"associated_assets",show:this.contract.attach_assets.length>0}]},associates(e){this.category!==e&&(this.loading=!0,this.category=e),this.updateKey(e)},handelLoader(e){this.loading=e},updateKey(e){e!=="changes"&&(this.loading=!0),this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setContractAssociateCategory",e)}},components:{"contract-activity":p8,"contract-history":J8,"contract-associated-assets":i3}},r3={class:"contract-associates"},d3={key:0,id:"contract-associates",class:"card card-light card-tabs"},c3={class:"card-header p-0 pt-1"},u3={class:"nav nav-tabs"},m3=["onClick"],h3={class:"nav-item ms-auto mt-04"},p3={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},_3={class:"card-body"},f3={class:"tab-content"},g3={class:"active tab-pane",id:"activity"};function b3(e,t,s,d,a,i){const m=u("contract-history"),h=u("contract-associated-assets"),b=u("contract-activity");return o(),l("div",r3,[a.tabs?(o(),l("div",d3,[n("div",c3,[n("ul",u3,[(o(!0),l(U,null,$(a.tabs,f=>(o(),l(U,null,[f.show?(o(),l("li",{key:0,class:Q([{active:a.category===f.id},"nav-item"])},[n("a",{id:"contract_tab",class:Q(["nav-link",{active:a.category===f.id}]),"data-bs-toggle":"pill",onClick:g=>i.associates(f.id)},r(e.trans(f.title)),11,m3)],2)):c("",!0)],64))),256)),n("li",h3,[a.loading?(o(),l("a",p3,t[0]||(t[0]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])])]),n("div",_3,[n("div",f3,[n("div",g3,[a.category=="history"?(o(),k(m,{contractId:s.contract.id,onLoaderValue:i.handelLoader,key:"contract_history"+a.dynamicKeys.history},null,8,["contractId","onLoaderValue"])):c("",!0),a.category=="assets"?(o(),k(h,{componentTitle:"contractAssets",actions:a.actions,apiUrl:"/service-desk/api/asset-list?contract_ids="+s.contract.id,contractId:s.contract.id,category:a.category,onLoaderValue:i.handelLoader,disableLoader:"rue",key:"contract_asset"+a.dynamicKeys.assets},null,8,["actions","apiUrl","contractId","category","onLoaderValue"])):c("",!0),a.category=="activity"?(o(),k(b,{contractId:s.contract.id,onLoaderValue:i.handelLoader,key:"contract_activity"+a.dynamicKeys.activity},null,8,["contractId","onLoaderValue"])):c("",!0)])])])])):c("",!0)])}const y3=P(l3,[["render",b3],["__scopeId","data-v-2def9917"]]),v3={name:"contract-view",description:"Contract view page",data(){return{contract:"",contract_id:"",loading:!0,counter:0,refreshView:!1}},beforeMount(){this.getValues()},created(){window.emitter.on("updateContractAssociates",()=>this.refreshView=!0)},methods:{updateAssociates(){this.loading=!0,this.getValues(!0,Date.now())},getValues(e,t=""){const s=window.location.pathname;this.contract_id=pe(s),T.get("/service-desk/api/contract/"+this.contract_id+"?time="+t).then(d=>{this.loading=!1,this.contract=d.data.data.contract}).catch(d=>{this.loading=!1,O(d)})}},watch:{refreshView(e,t){e===!0&&this.getValues(),this.refreshView=!1}},components:{"contract-details":z6,"contract-associates":y3}},w3={class:"col-sm-12"},k3={key:1,class:"row"};function C3(e,t,s,d,a,i){const m=u("alert"),h=u("contract-details"),b=u("contract-associates"),f=u("reuse-loader");return o(),l("div",w3,[_(m,{componentName:"contract-view"}),_(m,{componentName:"contractAssociates"}),!a.loading&&a.contract?(o(),l(U,{key:0},[(o(),k(h,{contract:a.contract,key:"contract_actions"+a.counter,updateData:i.getValues},null,8,["contract","updateData"])),(o(),k(b,{contract:a.contract,key:"contract_associates"+a.counter},null,8,["contract"]))],64)):c("",!0),a.loading?(o(),l("div",k3,[_(f,{"animation-duration":4e3,size:60})])):c("",!0)])}const D3=P(v3,[["render",C3]]);const S3={name:"releases-list",description:"Releases lists table component",props:{filterIndex:{type:Boolean,default:!1}},setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data:()=>({parsedUrlParams:"",columns:[],hasDataPopulated:!1,visibleColumns:{},staticColumns:["actions"],reportType:"releases",apiUrl:"/service-desk/api/release-list",filterOptions:[{section:[{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases"},{name:"release_statuses",url:"/service-desk/api/status/list?module=3",label:"status"},{name:"location_ids",url:"/api/dependency/locations",label:"location"}]},{section:[{name:"priority_ids",url:"/service-desk/api/dependency/release_priorities",label:"priority"},{name:"release_type_ids",url:"/service-desk/api/dependency/release_types",label:"release_type"},{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets"}]},{section:[{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes"},{name:"planned_start_date",type:"date",label:["planned_start_date","planned_start_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"planned_end_date",type:"date",label:["planned_end_date","planned_end_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[]}],isShowFilter:!1,appliedFilters:{},showIcon:!1,columnData:null,releaseData:null,exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[],customFields:[],releaseFilterId:""}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},beforeMount(){this.releaseFilterId=pe(window.location.pathname);const e=at();e&&e.hasOwnProperty("filter-by-url")?(this.parsedUrlParams=e,It("/service-desk/api/filter-dependencies",e,{},d=>{d&&this.applyFilter(d,"dependencyFilter")},d=>{O(d)})):this.apiUrl=this.filterIndex?"/service-desk/api/release-list?filter_id="+this.releaseFilterId:"/service-desk/api/release-list",this.filterData(),this.getReleaseData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name===s.name&&(s.value=e.value)})})},getReleaseData(){this.hasDataPopulated=!1,T.get("api/agent/report-config/release-report").then(e=>{this.releaseData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],O(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{Re(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.data_type==="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[4].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/release-list?filter_id="+this.releaseFilterId:"/service-desk/api/release-list",this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e,t=""){this.appliedFilters=e;for(var s in this.customFields)this.customFields[s].value=e[this.customFields[s].name];let d="/service-desk/api/release-list?",a=new URLSearchParams(vt(this.filterOptions,e));t==="dependencyFilter"&&Object.entries(e).forEach(([f,g])=>{f.includes("custom_")&&(a+=`${encodeURIComponent(f)}=${encodeURIComponent(g)}&`)});const m=a,h=new URLSearchParams(m),b={};for(const[f,g]of h)b[f]=g;a[a.length-1]==="&"&&(a=a.slice(0,-1)),this.apiUrl=d+a,this.exportData=this.reformatExportData(b)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[a,i,m]=d;t[i]=t[i]||[],t[i][m]=parseInt(e[s],10)}else t[s]=e[s].trim()}return t},exportReport(){this.loading=!0;const e={...this.exportData,total:this.dataCount};let t={};this.filterIndex&&(t.filter_id=this.releaseFilterId);const s={...this.exportData,...t,total:this.dataCount};T.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:e).then(d=>{K(d,"dataTableModal")}).catch(d=>{O(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.releaseFilterId};this.$router.push({path:"/reports/schedule/add/"+this.releaseData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{ModuleFilter:ys,"dynamic-datatable":Tt,"user-column-list":Pt,"releases-filter":ss}},M3={class:"col-sm-12"},F3={key:0,class:"card card-light"},I3={class:"card-header"},A3={id:"releases-list",class:"card-title"},P3={class:"card-tools"},T3={class:"card-body",id:"releases_list"};function V3(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("ModuleFilter"),f=u("user-column-list"),g=u("dynamic-datatable"),D=W("tooltip");return o(),l("div",M3,[_(m,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",F3,[n("div",I3,[n("h3",A3,r(e.lang("list_of_releases")),1),n("div",P3,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/releases/create"},{default:w(()=>t[3]||(t[3]=[n("i",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[D,e.lang("create_release")]]),S((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...M)=>i.toggleFilterView&&i.toggleFilterView(...M)),href:"javascript:;"},t[4]||(t[4]=[n("i",{class:"glyphicon glyphicon-filter"},null,-1)]))),[[D,e.lang("filter")]]),e.showIcon?S((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=M=>i.exportReport()),href:"javascript:;"},t[5]||(t[5]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.lang("export")]]):c("",!0),e.showIcon?S((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=M=>i.scheduleList()),href:"javascript:;"},t[6]||(t[6]=[n("i",{class:"fas fa-calendar"},null,-1)]))),[[D,e.lang("schedule")]]):c("",!0)])]),n("div",T3,[e.isShowFilter?(o(),k(b,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=release&type=release",saveFilter:!0,filterFor:"release",filterNum:e.releaseFilterId,redirectTo:"/service-desk/releases",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.releaseFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter",parsedUrlParams:e.parsedUrlParams},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","filterNum","deleteUrl","closeFilter","parsedUrlParams"])):c("",!0),(o(!0),l(U,null,$(e.columnData,M=>(o(),l("section",{key:M},[_(f,{"table-columns":M.columns,reportId:M.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),k(g,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:M.columns,staticColumns:e.staticColumns,"report-type":e.reportType,show_pagination:e.showPagination},null,8,["data-url","columns","columnsMeta","staticColumns","report-type","show_pagination"])):c("",!0)]))),128))])])):c("",!0)])}const Ws=P(S3,[["render",V3]]);const L3={name:"release-planning",description:"Release Planning Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},releaseId:{type:[String,Number],default:""},identifier:{type:String,default:""}},data(){return{attachment:"",description:"",isDisabled:!1,loading:!0,selectedFile:"",attachment_delete:!1,category:""}},beforeMount(){this.getInitialValues(),this.category=this.$store.getters.getReleaseAssociateCategory},methods:{getInitialValues(){T.get("/service-desk/api/general-popup/"+this.releaseId+"/sd_releases/"+this.identifier).then(e=>{this.loading=!1,this.general_info=e.data.data.general_info,this.general_info&&(this.description=this.general_info.description,this.attachment=this.general_info.attachment)}).catch(e=>{this.loading=!1})},onFileSelected(e,t,s){this.selectedFile=e,this.attachment_delete=s,this.attachment=this.selectedFile?this.selectedFile[0]:this.attachment},onChange(e,t){this[t]=e},addInlineStyles(){this.description=this.description.replace(/<td([^>]*)>/g,(e,t)=>{const s=/style\s*=\s*["']([^"']*)["']/.test(t),d=/padding\s*:\s*[^;]+/.test(t);return s?d?e:e.replace(/style\s*=\s*["']([^"']*)["']/,(a,i)=>`style="${i} padding: 6.4px;"`):`<td${t} style="padding: 6.4px;">`}).replace(/<table([^>]*)>/g,(e,t)=>{const s=/style\s*=\s*["']([^"']*)["']/.test(t),d=/border\s*=\s*["']([^"']*)["']/.test(t);return s?e.replace(/style\s*=\s*["']([^"']*)["']/,(a,i)=>`style="${i} border-collapse: collapse;" ${d?"":'border="1"'}`):`<table${t} style="border-collapse: collapse;" ${d?"":'border="1"'}>`})},onSubmit(){if(this.description!=""){this.loading=!0,this.isDisabled=!0,this.addInlineStyles();var e=new FormData;e.append("identifier",this.identifier),e.append("description",this.description),this.selectedFile&&e.append("attachment",this.selectedFile[0]?this.selectedFile[0]:""),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/general-popup/"+this.releaseId+"/sd_releases",e,t).then(s=>{this.loading=!1,this.isDisabled=!1,window.emitter.emit("updateReleaseAssociates"),this.category==="activity"?window.emitter.emit("updateReleaseActivity"):this.category==="planning"&&window.emitter.emit("updateReleasePlanning"),this.onClose(),K(s,"release-view")}).catch(s=>{this.loading=!1,this.isDisabled=!1,O(s,"release-plan")})}else this.$store.dispatch("setValidationError",{description:"This field is required."})}},components:{"file-upload":Ft}},U3={class:"modal-title"},N3={key:0},E3={class:"row"},x3={class:"file-upload"},O3={key:1,class:"row"},q3=["disabled"];function j3(e,t,s,d,a,i){const m=u("alert"),h=u("tiny-editor"),b=u("file-upload"),f=u("reuse-loader"),g=u("modal");return s.showModal?(o(),k(g,{key:0,showModal:s.showModal,modalBodyClass:a.loading?"":"release_plan_div",onClose:s.onClose},{title:w(()=>[n("h4",U3,r(e.trans(s.identifier)),1)]),alert:w(()=>[_(m,{componentName:"release-plan"})]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",N3,[n("div",E3,[_(h,{value:a.description,type:"text",onChange:i.onChange,name:"description",label:e.trans("description"),classname:"col-sm-12",required:!0,lang:"en",height:"300px",width:"100%",id:"focus_editor"},null,8,["value","onChange","label"])]),n("div",x3,[_(b,{label:e.trans("attachments"),value:a.attachment,name:"attachment",onChange:i.onFileSelected,classname:"col-sm-12"},null,8,["label","value","onChange"])])])),a.loading?(o(),l("div",O3,[_(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=D=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.trans("update")),1)],8,q3)]),_:1},8,["showModal","modalBodyClass","onClose"])):c("",!0)}const Pa=P(L3,[["render",j3]]);const R3={name:"release-assets",description:"Release asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},releaseId:{type:[String,Number],default:""}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"releaseAssets",category:""}},beforeMount(){this.category=this.$store.getters.getReleaseAssociateCategory},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?release_id="+this.releaseId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};T.post("/service-desk/api/release/attach-assets/"+this.releaseId,e,t).then(s=>{window.emitter.emit("updateReleaseAssociates"),window.emitter.emit("updateReleaseView"),this.category==="activity"?window.emitter.emit("updateReleaseActivity"):this.category==="assets"&&window.emitter.emit(this.componentTitle+"refreshData"),this.loading=!1,K(s,"release-view"),this.onClose()}).catch(s=>{this.loading=!1,O(s,"release-view")})}}},components:{"asset-list-with-checkbox":ht,"dynamic-select":fe}},B3={class:"modal-title"},z3={class:"row"},K3={class:"col-sm-12"},H3={class:"height-limit"},Y3={key:0,class:"row"},$3=["disabled"];function W3(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("asset-list-with-checkbox"),b=u("custom-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",B3,r(e.trans("attach_assets")),1)]),fields:w(()=>[n("div",z3,[_(m,{label:e.trans("asset_types"),multiple:!1,name:"asset_type_ids",classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:a.asset_type_ids,onChange:i.onChange,clearable:!!a.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.trans("used_by"),multiple:!1,name:"used_by_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:a.used_by_ids,onChange:i.onChange,clearable:!!a.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.trans("managed_by"),multiple:!1,name:"managed_by_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:a.managed_by_ids,onChange:i.onChange,clearable:!!a.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.trans("organizations"),multiple:!1,name:"org_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:a.org_ids,onChange:i.onChange,clearable:!!a.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),n("div",K3,[n("button",{id:"apply-btn",class:"btn btn-primary round-btn float-start",type:"button",onClick:t[0]||(t[0]=g=>i.onApply())},[t[2]||(t[2]=n("span",{class:"fas fa-check"},null,-1)),v("  "+r(e.trans("apply")),1)])])]),t[3]||(t[3]=n("br",null,null,-1)),n("div",H3,[a.apiUrl?(o(),k(h,{key:0,apiUrl:a.apiUrl,tickets:i.assetsData,componentTitle:a.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),a.loading===!0?(o(),l("div",Y3,[_(b,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=g=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[4]||(t[4]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.trans("attach")),1)],8,$3)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const J3=P(R3,[["render",W3],["__scopeId","data-v-dfb2dc0d"]]),G3={name:"release-associate-change",description:"Release Change Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},releaseId:{type:[String,Number],default:""},updateReleaseData:{type:Function,default:()=>{}}},data(){return{change:[],loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getReleaseAssociateCategory},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0;const e={};var t=[];for(var s in this.change)t.push(this.change[s].id);e.change_ids=t,T.post("/service-desk/api/release/attach-change/"+this.releaseId,e).then(d=>{window.emitter.emit("updateReleaseAssociates"),window.emitter.emit("updateReleaseView"),this.category==="activity"?window.emitter.emit(""):this.category==="changes"&&window.emitter.emit("releaseChangerefreshData"),this.loading=!1,this.onClose(),K(d,"release-view"),this.updateReleaseData()}).catch(d=>{this.loading=!1,this.onClose(),O(d,"release-view")})}},components:{"dynamic-select":fe}},X3={class:"modal-title"},Z3={key:0},Q3={class:"row"},eP={key:1,class:"row"},tP=["disabled"];function sP(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",X3,r(e.trans("attach_change")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",Z3,[n("div",Q3,[_(m,{label:e.trans("change"),multiple:!0,name:"change",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/changes?supplements[relation_name]=attachReleases&supplements[attribute_name]=release_id&supplements[attribute_value]="+s.releaseId,value:a.change,onChange:i.onChange,required:!0},null,8,["label","apiEndpoint","value","onChange"])])])),a.loading?(o(),l("div",eP,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:!(a.change.length>0)},[t[1]||(t[1]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.trans("attach")),1)],8,tP)]),_:1},8,["showModal","onClose"])):c("",!0)}const aP=P(G3,[["render",sP]]),nP={name:"release-status-modal",description:"Release status Modal component",props:{showModal:{type:Boolean,default:!1},releaseId:{type:[String,Number],default:""},updateReleaseData:{type:Function},onClose:{type:Function}},data:()=>({isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}),beforeMount(){this.category=this.$store.getters.getReleaseAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.post("/service-desk/api/complete-release/"+this.releaseId).then(e=>{window.emitter.emit("updateReleaseAssociates"),this.category==="activity"&&window.emitter.emit("updateReleaseActivity"),this.loading=!1,this.onClose(),K(e,"release-view"),this.updateReleaseData()}).catch(e=>{this.loading=!1,this.onClose(),O(e,"release-view")})}}},oP={class:"modal-title"},iP={key:0},lP={key:1,class:"row"},rP=["disabled"];function dP(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:w(()=>[n("h4",oP,r(e.trans("status")),1)]),fields:w(()=>[e.loading?c("",!0):(o(),l("div",iP,[n("span",null,r(e.trans("are_you_sure")),1)])),e.loading?(o(),l("div",lP,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{id:"submit_btn",type:"button",onClick:t[0]||(t[0]=(...b)=>i.onSubmit&&i.onSubmit(...b)),class:"btn btn-primary",disabled:e.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-check","aria-hidden":"true"},null,-1)),v(" "+r(e.trans("proceed")),1)],8,rP)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const cP=P(nP,[["render",dP]]),uP={name:"release-actions",props:{actions:{type:[String,Object],default:""},releaseId:{type:[String,Number],default:""},updateReleaseDetails:{type:Function}},data(){return{showPlanningModal:!1,showAttach:!1,showChangeModal:!1,showReleaseStatus:!1,showDeleteModal:!1,identifier:""}},methods:{subString(e,t=15){return Ie(e,t)},planningMethod(e){this.showPlanningModal=!0,this.identifier=e},onClose(){this.showPlanningModal=!1,this.showAttach=!1,this.showChangeModal=!1,this.showDeleteModal=!1,this.showReleaseStatus=!1,this.$store.dispatch("unsetValidationError")}},components:{"release-planning-modal":Pa,"release-assets":J3,"release-change":aP,"release-status-modal":cP,"delete-modal":ot}},mP={class:"card-tools"},hP={class:"btn-group"},pP={type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},_P={class:"dropdown-menu"},fP={class:"btn-group"},gP={key:0,type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},bP={class:"dropdown-menu"},yP={class:"btn-group"},vP={key:0,type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},wP={class:"dropdown-menu dropdown-menu-right"};function kP(e,t,s,d,a,i){const m=u("router-link"),h=u("release-planning-modal"),b=u("release-assets"),f=u("release-change"),g=u("release-status-modal"),D=u("delete-modal");return o(),l("div",mP,[n("div",hP,[n("button",pP,[t[6]||(t[6]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.trans("planning")),1)]),n("div",_P,[n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=M=>i.planningMethod("build-plan"))},r(e.trans("build-plan")),1),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=M=>i.planningMethod("test-plan"))},r(e.trans("test-plan")),1)])]),n("div",fP,[s.actions.release_asset_attach||s.actions.release_change_attach?(o(),l("button",gP,[t[7]||(t[7]=n("i",{class:"fas fa-link"},null,-1)),v(" "+r(e.trans("associate")),1)])):c("",!0),n("div",bP,[s.actions.release_asset_attach?(o(),l("a",{key:0,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[2]||(t[2]=M=>a.showAttach=!0)},[t[8]||(t[8]=n("i",{class:"fas fa-server"},null,-1)),v(" "+r(e.trans("attach_asset")),1)])):c("",!0),s.actions.release_change_attach?(o(),l("a",{key:1,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=M=>a.showChangeModal=!0)},[t[9]||(t[9]=n("i",{class:"fas fa-sync"},null,-1)),v(" "+r(e.trans("attach_change")),1)])):c("",!0)])]),n("div",yP,[s.actions.release_edit||s.actions.release_delete||s.actions.release_completed?(o(),l("button",vP,[t[10]||(t[10]=n("i",{class:"fas fa-cog"},null,-1)),v(" "+r(e.trans("more")),1)])):c("",!0),n("div",wP,[s.actions.release_edit?(o(),k(m,{key:0,class:"dropdown-item text-dark",to:"/service-desk/releases/"+s.releaseId+"/edit"},{default:w(()=>[v(r(e.trans("edit")),1)]),_:1},8,["to"])):c("",!0),s.actions.release_delete?(o(),l("a",{key:1,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[4]||(t[4]=M=>a.showDeleteModal=!0)},r(e.trans("delete")),1)):c("",!0),s.actions.release_completed?(o(),l("a",{key:2,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[5]||(t[5]=M=>a.showReleaseStatus=!0)},r(e.trans("mark_completed")),1)):c("",!0)])]),_(X,{name:"modal"},{default:w(()=>[a.showPlanningModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showPlanningModal,identifier:a.identifier,releaseId:s.releaseId,alertCompName:"release-view"},null,8,["onClose","showModal","identifier","releaseId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAttach?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showAttach,releaseId:s.releaseId},null,8,["onClose","showModal","releaseId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showChangeModal?(o(),k(f,{key:0,onClose:i.onClose,showModal:a.showChangeModal,releaseId:s.releaseId,updateReleaseData:s.updateReleaseDetails},null,8,["onClose","showModal","releaseId","updateReleaseData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showReleaseStatus?(o(),k(g,{key:0,onClose:i.onClose,showModal:a.showReleaseStatus,releaseId:s.releaseId,updateReleaseData:s.updateReleaseDetails},null,8,["onClose","showModal","releaseId","updateReleaseData"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showDeleteModal?(o(),k(D,{key:0,onClose:i.onClose,showModal:a.showDeleteModal,alertComponentName:"release-view",deleteUrl:"/service-desk/api/release/"+s.releaseId,redirectUrl:"/service-desk/releases/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1})])}const CP=P(uP,[["render",kP]]);const DP={name:"release-description",description:"Release description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},SP={class:"modal-title"},MP={id:"log_desc"},FP=["innerHTML"];function IP(e,t,s,d,a,i){const m=u("modal");return s.showModal?(o(),k(m,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",SP,r(e.trans("description")),1)]),fields:w(()=>[n("div",MP,[n("span",{innerHTML:s.description},null,8,FP)])]),_:1},8,["showModal","onClose"])):c("",!0)}const AP=P(DP,[["render",IP],["__scopeId","data-v-28af5032"]]);const PP={name:"release-details",description:"Release details page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{release:{type:Object,default:()=>{}},actions:{type:[Object,String],default:()=>{}},updateData:{type:Function}},data(){return{showDescription:!1}},methods:{checkValues(e,t=100){return e?e.name?Ie(e.name,t):Ie(e,t):"---"},subString(e,t=15){return Ie(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")},downloadFile(e){window.open(e)}},components:{"release-actions":CP,"release-description":AP}},TP={class:"release-details"},VP={class:"card card-light"},LP={class:"card-header"},UP={class:"card-title"},NP={class:"card-body"},EP={class:"row mb-3"},xP={class:"col-md-12"},OP={class:"callout callout-info"},qP={class:"row"},jP={class:"col-md-4"},RP={class:"col-md-4"},BP={class:"col-md-4"},zP={class:"col-md-12"},KP={class:"row mx-1"},HP={key:0,class:"col-md-6 info-row d-flex"},YP={class:"col-md-6"},$P={class:"col-md-6"},WP={key:1,class:"col-md-6 info-row d-flex"},JP={class:"col-md-6"},GP={class:"col-md-6"},XP={class:"col-md-6 info-row d-flex"},ZP={class:"col-md-6"},QP={class:"col-md-6"},eT={key:0,class:"text-primary"},tT={key:1},sT={class:"col-md-6 info-row d-flex"},aT={class:"col-md-6"},nT={class:"col-md-6"},oT={key:0,class:"text-primary"},iT={key:1},lT={class:"col-md-6 info-row d-flex"},rT={class:"col-md-6"},dT={class:"col-md-6"},cT={class:"text-primary"},uT={class:"col-md-6 info-row d-flex"},mT={class:"col-md-6"},hT={class:"col-md-6"},pT={class:"col-md-6 info-row d-flex"},_T={class:"col-md-6"},fT={class:"col-md-6"},gT={key:0},bT={key:0},yT={key:3,class:"col-md-6 info-row d-flex"},vT={class:"col-md-6"},wT={class:"col-md-6"},kT={key:0},CT={class:"line"},DT=["src"],ST=["onClick"],MT={key:1};function FT(e,t,s,d,a,i){const m=u("release-actions"),h=u("router-link"),b=u("release-description"),f=W("tooltip");return o(),l("div",TP,[n("div",VP,[n("div",LP,[S((o(),l("h3",UP,[v(r(i.subString(s.release.subject,50)),1)])),[[f,s.release.subject]]),_(m,{releaseId:s.release.id,actions:s.actions,updateReleaseDetails:s.updateData},null,8,["releaseId","actions","updateReleaseDetails"])]),n("div",NP,[n("div",EP,[n("div",xP,[n("div",OP,[n("div",qP,[n("div",jP,[n("b",null,r(e.lang("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(s.release.created_at)),1)])),[[f,d.formattedTime(s.release.created_at)]])]),n("div",RP,[n("b",null,r(e.lang("status"))+" : ",1),S((o(),l("span",{key:s.release.status.name},[_(h,{class:"text-decoration-none",to:s.release.status.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[v(r(i.subString(s.release.status.name)),1)]),_:1},8,["to"])])),[[f,s.release.status.name]])]),n("div",BP,[n("b",null,r(e.lang("release_type"))+" : ",1),S((o(),l("span",null,[_(h,{class:"text-decoration-none",to:s.release.release_type.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[v(r(i.subString(s.release.release_type.name)),1)]),_:1},8,["to"])])),[[f,s.release.release_type.name]])])])])])]),n("div",zP,[n("div",KP,[s.release.priority?(o(),l("div",HP,[n("div",YP,[n("label",null,r(e.lang("priority")),1)]),n("div",$P,[_(h,{class:"text-primary",to:s.release.priority.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(s.release.priority.name)),1)])),[[f,s.release.priority.name]])]),_:1},8,["to"])])])):c("",!0),s.release.location?(o(),l("div",WP,[n("div",JP,[n("label",null,r(e.lang("location")),1)]),n("div",GP,[_(h,{class:"text-primary",to:s.release.location.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.checkValues(s.release.location,15)),1)])),[[f,i.checkValues(s.release.location)]])]),_:1},8,["to"])])])):c("",!0),n("div",XP,[n("div",ZP,[n("label",null,r(e.lang("planned_start_date")),1)]),n("div",QP,[s.release.planned_start_date&&s.release.planned_start_date!="--"&&s.release.planned_start_date!="0000-00-00 00:00:00"?S((o(),l("a",eT,[v(r(d.formattedTime(s.release.planned_start_date)=="Invalid date"?s.release.planned_start_date:d.formattedTime(s.release.planned_start_date)),1)])),[[f,d.formattedTime(s.release.planned_start_date)]]):(o(),l("a",tT,"---"))])]),n("div",sT,[n("div",aT,[n("label",null,r(e.lang("planned_end_date")),1)]),n("div",nT,[s.release.planned_end_date&&s.release.planned_end_date!="--"&&s.release.planned_end_date!="0000-00-00 00:00:00"?S((o(),l("a",oT,[v(r(d.formattedTime(s.release.planned_end_date)==="Invalid date"?s.release.planned_end_date:d.formattedTime(s.release.planned_end_date)),1)])),[[f,d.formattedTime(s.release.planned_end_date)]]):(o(),l("a",iT,"---"))])]),n("div",lT,[n("div",rT,[n("label",null,r(e.lang("identifier")),1)]),n("div",dT,[S((o(),l("a",cT,[v(r(i.checkValues(s.release.identifier,15)),1)])),[[f,i.checkValues(s.release.identifier)]])])]),n("div",uT,[n("div",mT,[n("label",null,r(e.lang("description")),1)]),n("div",hT,[n("a",{href:"javascript:;",class:"btn btn-info btn-sm",onClick:t[0]||(t[0]=g=>a.showDescription=!0)},[t[1]||(t[1]=n("i",{class:"fas fa-file-code"},"  ",-1)),v(r(e.lang("show_description")),1)])])]),s.release.customFieldValues&&s.release.customFieldValues.length>0?(o(!0),l(U,{key:2},$(s.release.customFieldValues,g=>(o(),l("div",pT,[n("div",_T,[n("label",null,r(g.label),1)]),n("div",fT,[Array.isArray(g.value)?(o(),l("div",gT,[(o(!0),l(U,null,$(g.value,(D,M)=>(o(),k(h,{class:"text-primary",to:g.href[M].replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(D)),1)])),[[f,D]]),M!=Object.keys(g.value).length-1?(o(),l("span",bT,",")):c("",!0),t[2]||(t[2]=v("  "))]),_:2},1032,["to"]))),256))])):(o(),l(U,{key:1},[g.field_type==="date"?(o(),k(h,{key:0,class:"text-primary",to:g.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(g.value),1)])),[[f,g.value]])]),_:2},1032,["to"])):(o(),k(h,{key:1,class:"text-primary",to:g.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(g.value)),1)])),[[f,{content:g.value?g.value.replace(/\r?\n/g,"<br />"):"---",html:!0}]])]),_:2},1032,["to"]))],64))])]))),256)):c("",!0),s.release.attachment.length>0?(o(),l("div",yT,[n("div",vT,[n("label",null,r(e.trans("attachments")),1)]),n("div",wT,[s.release.attachment.length>0?(o(),l("span",kT,[(o(!0),l(U,null,$(s.release.attachment,g=>(o(),l(U,null,[n("span",CT,[S((o(),l("span",null,[n("img",{src:g.thumbnail_url,class:"attach_img"},null,8,DT),v(" "+r(i.subString(g.name,15))+" "+r("("+g.size+")"),1)])),[[f,g.name]]),S((o(),l("a",{id:"download",onClick:D=>i.downloadFile(g.download_url),href:"javascript:;"},t[3]||(t[3]=[v("  "),n("i",{class:"fas fa-download"},null,-1)]),8,ST)),[[f,e.trans("download")]])]),t[4]||(t[4]=n("br",null,null,-1))],64))),256))])):(o(),l("span",MT,"---"))])])):c("",!0)])])]),_(X,{name:"modal"},{default:w(()=>[a.showDescription?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showDescription,description:s.release.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])])}const IT=P(PP,[["render",FT],["__scopeId","data-v-b66cc623"]]);const AT={name:"release-activity",description:"Release activity page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{releaseId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/release-activitylog/"+this.releaseId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},created(){window.emitter.on("updateReleaseActivity",()=>this.refreshActivity=!0)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},loading(e){this.$emit("loaderValue",e)},filtering(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){T.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.release_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.release_activity_logs.total,this.perPage=t.data.data.release_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){let t="",s="";return e&&(t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at)),!e||t!=s},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":kt}},PT={class:"row",id:"activity_log_div"},TT={class:"col-sm-12 mb-2"},VT={key:0,id:"select_limit"},LT={type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},UT={class:"dropdown-menu"},NT={key:1,id:"choose_order"},ET={id:"sort_btn",type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},xT={class:"dropdown-menu",style:{"z-index":"9999"}},OT={key:2,id:"page_div"},qT={class:"col-md-12"},jT={key:0,class:"timeline"},RT={key:0,class:"time-label"},BT={class:"text-bg-light border"},zT={class:"release-activity"},KT={class:"timeline-item"},HT={class:"time"},YT={key:0,class:"timeline-header"},$T={class:"timeline-body break"},WT={key:1},JT={key:1,class:"float-end",id:"page_div"},GT={key:0,class:"col-sm-12"},XT={class:"text-center"};function ZT(e,t,s,d,a,i){const m=u("uib-pagination"),h=u("faveo-image-element"),b=u("router-link"),f=u("activity-parser");return o(),l("div",PT,[n("div",TT,[!a.loading&&a.activity_log.length>0?(o(),l("div",VT,[n("button",LT,r(a.perPage),1),n("div",UT,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=g=>i.logLimit(10))},"10"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[1]||(t[1]=g=>i.logLimit(25))},"25"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=g=>i.logLimit(50))},"50"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[3]||(t[3]=g=>i.logLimit(100))},"100")])])):c("",!0),!a.loading&&a.activity_log.length>0?(o(),l("div",NT,[n("button",ET,r(e.lang("created_time"))+" - "+r(e.lang(a.sort_key)),1),n("div",xT,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[4]||(t[4]=g=>i.orderBy("asc"))},[t[8]||(t[8]=n("i",{class:"fas fa-sort-amount-up"},null,-1)),v(" "+r(e.lang("asc")),1)]),n("a",{href:"javascript:;",onClick:t[5]||(t[5]=g=>i.orderBy("desc")),class:"dropdown-item"},[t[9]||(t[9]=n("i",{class:"fas fa-sort-amount-down"},null,-1)),v(" "+r(e.lang("desc")),1)])])])):c("",!0),!a.loading&&a.total>10?(o(),l("div",OT,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[6]||(t[6]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),n("div",qT,[!a.loading&&a.activity_log.length>0?(o(),l("div",jT,[(o(!0),l(U,null,$(a.activity_log,(g,D)=>(o(),l(U,null,[i.checkDate(D)?(o(),l("div",RT,[n("span",BT,r(d.formattedDate(g.created_at)),1)])):c("",!0),n("div",zT,[t[11]||(t[11]=n("i",{class:"far fa-dot-circle timeline-icon"},null,-1)),n("div",KT,[n("span",HT,[t[10]||(t[10]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(g.created_at)),1)]),g.creator?(o(),l("h3",YT,[_(h,{id:"change_img","source-url":g.creator.profile_pic,classes:["img-circle","img-bordered-sm","img-rounder"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),_(b,{to:"/user/"+g.creator.id},{default:w(()=>[v(" "+r(g.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),n("div",$T,[_(f,{data:g.name},null,8,["data"])])])]),i.showThreadEnd(D)?(o(),l("div",WT,t[12]||(t[12]=[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),256))])):c("",!0),!a.loading&&a.total>10?(o(),l("div",JT,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[7]||(t[7]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!a.filtering&&!a.loading&&a.activity_log.length===0?(o(),l("div",GT,[n("h6",XT,r(e.lang("no_data_found")),1)])):c("",!0)])}const QT=P(AT,[["render",ZT],["__scopeId","data-v-ed83b56c"]]),e4={name:"release-planning-delete-modal",description:"Problem Planning Delete Modal component",props:{showModal:{type:Boolean,default:!1},releaseId:{type:[String,Number],default:""},onClose:{type:Function},identifier:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/delete/general-popup/"+this.releaseId+"/sd_releases/"+this.identifier).then(e=>{window.emitter.emit("updateReleaseAssociates"),window.emitter.emit("updateReleasePlanning"),this.onClose(),K(e,"release-view"),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,O(e,"release-view"),this.onClose()})}}},t4={class:"modal-title"},s4={key:0},a4={key:1,class:"row"},n4=["disabled"];function o4(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",t4,r(e.trans("delete")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",s4,[n("span",null,r(e.trans("are_you_sure")),1)])),a.loading?(o(),l("div",a4,[_(m,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)),v(" "+r(e.trans("delete")),1)],8,n4)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const i4=P(e4,[["render",o4]]);const l4={name:"release-planning",description:"Release planning component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{releaseId:{type:[String,Number],default:""}},data(){return{releaseUpdates:"",loading:!1,showReleaseUpdate:!1,showUpdateDelete:!1,identifier:"",refreshPlanning:!1}},beforeMount(){this.getDetails()},created(){window.emitter.on("updateReleasePlanning",()=>this.refreshPlanning=!0)},methods:{getDetails(){this.loading=!0,T.get("/service-desk/api/release-planning/"+this.releaseId).then(e=>{this.loading=!1,this.releaseUpdates=e.data.data.planning_popups,this.releaseUpdates.length===0&&window.emitter.emit("updateReleaseTables")}).catch(e=>{this.loading=!1})},getFont(e){return e==="build-plan"?"cubes":"adjust"},downloadFile(e,t){window.open(this.basePath()+"/service-desk/download/"+e+"/"+t+"/attachment")},updateMethod(e){this.showReleaseUpdate=!0,this.identifier=e},deleteMethod(e){this.showUpdateDelete=!0,this.identifier=e},onClose(){this.showReleaseUpdate=!1,this.showUpdateDelete=!1,this.$store.dispatch("unsetValidationError")}},watch:{loading(e){this.$emit("loaderValue",e)},refreshPlanning(e,t){e===!0&&this.getDetails(),this.refreshPlanning=!1}},components:{"release-update-modal":Pa,"release-planning-delete":i4}},r4={class:"box-body"},d4={key:0,class:"timeline"},c4={class:"time-label"},u4={class:"text-bg-secondary"},m4={class:"release-plan-timeline"},h4={class:"timeline-item"},p4={class:"time float-start"},_4={class:"timeline-header pb-37"},f4=["onClick"],g4=["onClick"],b4={class:"timeline-body break"},y4=["innerHTML"],v4={key:0,class:"timeline-footer planning_footer"},w4={key:0},k4=["src"],C4=["onClick"],D4={key:1,class:"text-center"};function S4(e,t,s,d,a,i){const m=u("release-update-modal"),h=u("release-planning-delete"),b=W("tooltip");return o(),l("div",r4,[a.releaseUpdates.length>0?(o(),l("div",d4,[(o(!0),l(U,null,$(a.releaseUpdates,(f,g)=>(o(),l(U,null,[n("div",c4,[n("span",u4,r(e.trans(f.key)),1)]),n("div",m4,[n("i",{class:Q(["timeline-icon","fas fa-"+i.getFont(f.key)+" text-bg-blue"])},null,2),n("div",h4,[n("span",p4,[t[0]||(t[0]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(f.updated_at)),1)]),n("h3",_4,[n("button",{class:"btn btn-light btn-sm btn-right ms-1",onClick:D=>i.deleteMethod(f.key)},[t[1]||(t[1]=n("i",{class:"fas fa-trash"},null,-1)),v(" "+r(e.trans("delete")),1)],8,f4),n("button",{class:"btn btn-light btn-sm btn-right",onClick:D=>i.updateMethod(f.key)},[t[2]||(t[2]=n("i",{class:"fas fa-edit"},null,-1)),v(" "+r(e.trans("edit")),1)],8,g4)]),n("div",b4,[n("span",{class:"text-muted",id:"log_desc",innerHTML:f.description},null,8,y4)]),f.attachment?(o(),l("div",v4,[f.attachment?(o(),l("span",w4,[S((o(),l("span",null,[n("img",{src:f.attachment.icon_url,class:"attach_img"},null,8,k4),v(" "+r(f.attachment.value)+" "+r("("+f.attachment.size+")"),1)])),[[b,f.attachment.value]]),S((o(),l("a",{id:"download",onClick:D=>i.downloadFile(f.attachment.id,f.attachment.owner)},t[3]||(t[3]=[v("  "),n("i",{class:"fa fa-download"},null,-1)]),8,C4)),[[b,e.trans("download")]])])):c("",!0)])):c("",!0)])])],64))),256)),t[4]||(t[4]=n("div",null,[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"})],-1))])):c("",!0),!a.loading&&a.releaseUpdates.length===0?(o(),l("h6",D4,r(e.trans("no_data_found")),1)):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showReleaseUpdate?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showReleaseUpdate,identifier:a.identifier,releaseId:s.releaseId,alertCompName:"release-view"},null,8,["onClose","showModal","identifier","releaseId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showUpdateDelete?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showUpdateDelete,identifier:a.identifier,releaseId:s.releaseId,alertCompName:"release-view"},null,8,["onClose","showModal","identifier","releaseId"])):c("",!0)]),_:1})])}const M4=P(l4,[["render",S4],["__scopeId","data-v-a432f4f7"]]),F4={name:"problem-ticket-detach-modal",description:"Problem Ticket Detach Modal component",props:{showModal:{type:Boolean,default:!1},releaseId:{type:[String,Number],default:""},category:{type:String,default:""},fieldId:{type:[String,Number],default:""},onClose:{type:Function},compName:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/release/detach-"+this.category+"/"+this.releaseId+"/"+this.fieldId).then(e=>{K(e,"release-view"),window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,O(e,"release-view")})}}},I4={class:"modal-title"},A4={key:0},P4={key:1,class:"row"},T4=["disabled"];function V4(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",I4,r(e.trans("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",A4,[n("span",null,r(e.trans("are_you_sure")),1)])),a.loading?(o(),l("div",P4,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink"},null,-1)),v(" "+r(e.trans("detach")),1)],8,T4)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Ta=P(F4,[["render",V4]]);const L4={name:"release-associated-assets",description:"Release associated assets table page",props:{actions:{type:[String,Object],default:""},category:{type:String,default:""},apiUrl:{type:String,default:""},releaseId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{columns:this.actions.release_asset_detach?["name","managed_by","used_by","contract","action"]:["name","managed_by","used_by","contract"],options:{},apiEndPoint:this.apiUrl,showModal:!1,fieldId:"",totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",contract:"associate-contract",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){return e.h(De,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},managed_by(t,s){var d,a;return((a=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,a;return((a=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??"--"},contract:function(t,s){return s.contract&&!Array.isArray(s.contract)?e.h(De,{to:"/service-desk/contracts/"+s.contract.id+"/show"},s.contract.name):"--"},action:function(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.showModal=!0,e.fieldId=s.id}},[d])}},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.data.map(s=>(s.detach=!0,s.release_id=e.releaseId,s.compName=e.componentTitle,s)),count:e.totalCount}},orderBy:{column:"name",ascending:!0}}},methods:{onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateReleaseView"),window.emitter.emit("updateReleaseTables"),window.emitter.emit("updateReleaseAssociates"))}},components:{"release-asset-detach":Ta}},U4={id:"problem_associated_assets"};function N4(e,t,s,d,a,i){const m=u("data-table"),h=u("release-asset-detach");return o(),l("div",U4,[_(m,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"release-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,fieldId:a.fieldId,releaseId:s.releaseId,compName:s.componentTitle,category:"asset"},null,8,["onClose","showModal","fieldId","releaseId","compName"])):c("",!0)]),_:1})])}const E4=P(L4,[["render",N4]]);const x4={name:"release-associated-changes",description:"Release associated changes table page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{actions:{type:[String,Object],default:""},apiUrl:{type:String,default:""},releaseId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{columns:this.actions.release_change_detach?["identifier","subject","requester","status","priority","department","created_at","action"]:["identifier","subject","requester","status","priority","department","created_at"],options:{},apiEndPoint:this.apiUrl,showModal:!1,fieldId:"",totalCount:""}},beforeMount(){const e=this;this.options={headings:{identifier:this.lang("identifier"),subject:this.lang("subject"),requester:this.lang("requester"),status:this.lang("status"),priority:this.lang("priority"),department:this.lang("department"),created_at:this.lang("created"),action:this.lang("action")},columnsClasses:{identifier:"change-identifier",subject:"change-subject",requester:"change-requester",status:"change-status",priority:"change-priority",department:"change-department",created_at:"change-created",action:"change-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{requester:function(t,s){var d,a;return s.requester?e.h(De,{to:"/user/"+s.requester.id},((a=(d=s.requester)==null?void 0:d.full_name)==null?void 0:a.replace(/<[^>]+>/g,""))??s.requester.email):"---"},status:function(t,s){return s.status?e.h("span",{},[e.h("i",{class:s.status.icon_class,style:{color:s.status.icon_color,marginRight:"5px"}})],s.status.name):"---"},priority(t,s){return s.priority?s.priority.name:"---"},department:function(t,s){var d,a,i,m,h,b;return s.department?(a=(d=s.department)==null?void 0:d.name)!=null&&a.includes("href=https://")?e.h("a",{href:e.basePath()+"/admin/department/"+s.department.id,target:"_blank"},(m=(i=s.department)==null?void 0:i.name)==null?void 0:m.replace(/<[^>]+>/g,"")):(b=(h=s.department)==null?void 0:h.name)==null?void 0:b.replace(/<[^>]+>/g,""):"---"},created_at(t,s){return e.formattedTime(s.created_at)},action:function(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.showModal=!0,e.fieldId=s.id}},[d])}},sortable:["identifier","subject","created_at"],filterable:["identifier","subject","requester","status","priority","department"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.changes,count:e.totalCount}},orderBy:{column:"id",ascending:!0}}},methods:{onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateReleaseView"),window.emitter.emit("updateReleaseTables"),window.emitter.emit("updateReleaseAssociates"))}},components:{"release-change-detach":Ta}},O4={id:"changes_list"};function q4(e,t,s,d,a,i){const m=u("data-table"),h=u("release-change-detach");return o(),l("div",O4,[_(m,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"release-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,fieldId:a.fieldId,releaseId:s.releaseId,compName:s.componentTitle,category:"change"},null,8,["onClose","showModal","fieldId","releaseId","compName"])):c("",!0)]),_:1})])}const j4=P(x4,[["render",q4]]);const R4={name:"release-associates",description:"Release associates page",props:{release:{type:Object,default:()=>{}}},data(){return{tabs:[],category:"activity",loading:!0,actions:"",showAssociates:!1,dynamicKeys:{planning:1,assets:1,activity:1,changes:1}}},beforeMount(){this.getActions()},created(){window.emitter.on("updateReleaseAssociates",this.updateAssociates),window.emitter.on("updateReleaseTables",()=>this.associates("activity")),this.$store.dispatch("setReleaseAssociateCategory",this.category)},methods:{associates(e){this.category!==e&&(this.loading=!0,this.category=e),this.updateKey(e)},updateAssociates(){setTimeout(()=>{this.getActions(Date.now())},500)},getActions(e=""){T.get("/service-desk/api/release-action/"+this.release.id+"?time="+e).then(t=>{this.actions=t.data.data.actions,this.$emit("handelAction",this.actions),this.tabs=[{id:"activity",title:"activity_log",show:!0},{id:"planning",title:"planning",show:this.actions.check_planning},{id:"assets",title:"associated_assets",show:this.release.attach_assets.length>0},{id:"changes",title:"associated_changes",show:this.release.attach_changes.length>0}],this.showAssociates=!0,this.loading=!1}).catch(t=>{this.loading=!1,this.actions=""})},handelLoader(e){this.loading=e},updateKey(e){this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setReleaseAssociateCategory",e)}},components:{"release-activity":QT,"release-planning":M4,"release-associated-assets":E4,"release-associated-changes":j4}},B4={key:0,id:"release-associates",class:"card card-light card-tabs"},z4={class:"card-header p-0 pt-1"},K4={class:"nav nav-tabs"},H4={key:0,class:"nav-item"},Y4=["onClick"],$4={class:"nav-item ms-auto mt-04"},W4={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},J4={class:"card-body"},G4={class:"tab-content"},X4={class:"active tab-pane",id:"activity"};function Z4(e,t,s,d,a,i){const m=u("alert"),h=u("release-planning"),b=u("release-associated-assets"),f=u("release-associated-changes"),g=u("release-activity");return a.showAssociates?(o(),l("div",B4,[_(m,{componentName:"releaseAssociates"}),n("div",z4,[n("ul",K4,[(o(!0),l(U,null,$(a.tabs,D=>(o(),l(U,null,[D.show?(o(),l("li",H4,[n("a",{id:"release_tab",class:Q(["nav-link",{active:a.category===D.id}]),"data-bs-toggle":"pill",onClick:M=>i.associates(D.id)},r(e.trans(D.title)),11,Y4)])):c("",!0)],64))),256)),n("li",$4,[a.loading?(o(),l("a",W4,t[0]||(t[0]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])])]),n("div",J4,[n("div",G4,[n("div",X4,[a.category=="planning"?(o(),k(h,{releaseId:s.release.id,onLoaderValue:i.handelLoader,key:"release_planning"+a.dynamicKeys.planning},null,8,["releaseId","onLoaderValue"])):c("",!0),a.category=="assets"?(o(),k(b,{componentTitle:"releaseAssets",actions:a.actions,apiUrl:"/service-desk/api/asset-list?release_ids="+s.release.id,releaseId:s.release.id,category:a.category,disableLoader:"true",onLoaderValue:i.handelLoader,key:"release_asset"+a.dynamicKeys.assets},null,8,["actions","apiUrl","releaseId","category","onLoaderValue"])):c("",!0),a.category=="changes"?(o(),k(f,{releaseId:s.release.id,actions:a.actions,apiUrl:"/service-desk/api/change-list?release_ids="+s.release.id,disableLoader:"true",onLoaderValue:i.handelLoader,key:"release_change"+a.dynamicKeys.changes,componentTitle:"releaseChange"},null,8,["releaseId","actions","apiUrl","onLoaderValue"])):c("",!0),a.category=="activity"?(o(),k(g,{releaseId:s.release.id,onLoaderValue:i.handelLoader,key:"release_activity"+a.dynamicKeys.activity},null,8,["releaseId","onLoaderValue"])):c("",!0)])])])])):c("",!0)}const Q4=P(R4,[["render",Z4],["__scopeId","data-v-8e389b30"]]),eV={name:"release-view",description:"Release view page",data(){return{release:"",release_id:"",loading:!0,actions:"",counter:0,refreshView:!1}},beforeMount(){this.getValues()},created(){window.emitter.on("updateReleaseView",()=>this.refreshView=!0)},methods:{refreshData(){this.getValues()},getValues(e,t=""){const s=window.location.pathname;this.release_id=pe(s),T.get("/service-desk/api/release/"+this.release_id+"?time="+t).then(d=>{this.release=d.data.data.release,this.loading=!1}).catch(d=>{this.loading=!1,O(d,"release-view")})},updateActions(e){this.actions=e}},watch:{refreshView(e){e==!0&&this.refreshData(),this.refreshView=!1}},components:{"release-details":IT,"release-associates":Q4}},tV={key:0};function sV(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("release-details"),f=u("release-associates");return o(),l("div",{class:"col-sm-12",key:a.counter},[_(m,{componentName:"release-view"}),a.loading?(o(),l("div",tV,[_(h,{"animation-duration":4e3,size:60})])):c("",!0),a.loading?c("",!0):(o(),l(U,{key:1},[_(b,{release:a.release,updateData:i.refreshData,actions:a.actions},null,8,["release","updateData","actions"]),_(f,{releaseId:a.release_id,release:a.release,onHandelAction:i.updateActions},null,8,["releaseId","release","onHandelAction"])],64))])}const aV=P(eV,[["render",sV]]);const nV={name:"software-license-list",description:"Softwarelicense lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{filterIndex:{type:Boolean,default:!1}},data:()=>({parsedUrlParams:"",columns:[],hasDataPopulated:!1,visibleColumns:{},staticColumns:["actions"],apiUrl:"/service-desk/api/software-license-list",filterOptions:[{section:[{name:"software_licenses_ids",url:"service-desk/api/dependency/softwarelicense",label:"software/license",isCustom:!1},{name:"license_type",url:"/service-desk/api/dependency/license_types",label:"license_type",isCustom:!1},{name:"depreciation_ids",url:"/service-desk/api/dependency/depreciation",label:"depreciation",isCustom:!1}]},{section:[{name:"vendor_ids",url:"/service-desk/api/dependency/vendors",label:"vendor",isCustom:!1},{name:"manufacturer_ids",url:"/service-desk/api/dependency/manufacturer",label:"manufacturer",isCustom:!1},{name:"org_ids",url:"/api/dependency/organizations",label:"organization",isCustom:!1}]},{section:[{name:"asset_ids",url:"service-desk/api/dependency/assets",label:"assets",isCustom:!1},{name:"used_by_ids",url:"api/dependency/users?meta=true",label:"users",isCustom:!1},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},pickers:!0,range:!0,isCustom:!1}]},{section:[]}],columnData:null,licenseData:null,isShowFilter:!1,appliedFilters:{},customFields:[],licenseFilterId:"",showIcon:!1,reportType:"license",exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[]}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},beforeMount(){const e=window.location.pathname;this.licenseFilterId=pe(e);const t=at();t&&t.hasOwnProperty("filter-by-url")?(this.parsedUrlParams=t,It("/service-desk/api/filter-dependencies",t,{},a=>{a&&this.applyFilter(a,"dependencyFilter")},a=>{O(a)})):this.apiUrl=this.filterIndex?"service-desk/api/software-license-list?filter_id="+this.licenseFilterId:"service-desk/api/software-license-list",this.filterData(),this.getLicenseData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name==s.name&&(s.value=e.value)})})},getLicenseData(){this.hasDataPopulated=!1,T.get("api/agent/report-config/software-license-report").then(e=>{this.licenseData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],O(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{Re(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.type=="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[4].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){switch(e){case"closeEvent":this.isShowFilter=!1;break;case"resetEvent":this.resetFilter();break;default:this.applyFilter(e)}},resetFilter(){this.apiUrl=this.filterIndex?"service-desk/api/software-license-list?filter_id="+this.licenseFilterId:"service-desk/api/software-license-list",this.updateFilterFields([]),window.emitter.emit("clearCustomFields"),this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e,t=""){this.appliedFilters=e;for(const b of this.customFields)b.value=e[b.name];let s="service-desk/api/software-license-list?",d=new URLSearchParams(vt(this.filterOptions,e));t==="dependencyFilter"&&Object.entries(e).forEach(([b,f])=>{b.includes("custom_")&&(d+=`${encodeURIComponent(b)}=${encodeURIComponent(f)}&`)});const i=d,m=new URLSearchParams(i),h={};for(const[b,f]of m)h[b]=f;d.toString().endsWith("&")&&(d=d.toString().slice(0,-1)),this.apiUrl=s+d,this.exportData=this.reformatExportData(h)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[a,i,m]=d;t[i]=t[i]||[],t[i][m]=parseInt(e[s],10)}else t[s]=e[s].trim()}return t},exportReport(){this.loading=!0;let e={};this.filterIndex&&(e.filter_id=this.licenseFilterId);const t={...this.exportData,total:this.dataCount},s={...this.exportData,...e,total:this.dataCount};T.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:t).then(d=>{K(d,"dataTableModal")}).catch(d=>{O(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.licenseFilterId};this.$router.push({path:"/reports/schedule/add/"+this.licenseData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{"dynamic-datatable":Tt,"user-column-list":Pt,"software-license-filter":ss}},oV={class:"col-sm-12"},iV={key:0,class:"card card-light"},lV={class:"card-header"},rV={id:"software-license-list",class:"card-title"},dV={class:"card-tools"},cV={class:"card-body",id:"software-license-list"};function uV(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("software-license-filter"),f=u("user-column-list"),g=u("dynamic-datatable"),D=W("tooltip");return o(),l("div",oV,[_(m,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",iV,[n("div",lV,[n("h3",rV,r(e.lang("list_of_software_license")),1),n("div",dV,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/software/license/create"},{default:w(()=>t[3]||(t[3]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[D,e.lang("create_software_license")]]),S((o(),l("a",{class:"btn btn-tool",href:"javascript:;",onClick:t[0]||(t[0]=(...M)=>i.toggleFilterView&&i.toggleFilterView(...M))},t[4]||(t[4]=[n("span",{class:"glyphicon glyphicon-filter"},null,-1)]))),[[D,e.lang("filter")]]),e.showIcon?S((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=M=>i.exportReport()),href:"javascript:;"},t[5]||(t[5]=[n("i",{class:"fas fa-paper-plane"},null,-1)]))),[[D,e.lang("export")]]):c("",!0),e.showIcon?S((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=M=>i.scheduleList()),href:"javascript:;"},t[6]||(t[6]=[n("i",{class:"fas fa-calendar"},null,-1)]))),[[D,e.lang("schedule")]]):c("",!0)])]),n("div",cV,[e.isShowFilter?(o(),k(b,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=license&type=license&module=filter&filter_id="+e.licenseFilterId,filterFor:"license",closeFilter:i.toggleFilterView,filterNum:e.licenseFilterId,saveFilter:!0,deleteUrl:"/service-desk/api/agent/sd-filter/"+e.licenseFilterId,redirectTo:"/service-desk/software/license/list",save_endpoint:"/service-desk/api/agent/sd-filter",parsedUrlParams:e.parsedUrlParams},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","endPoint","closeFilter","filterNum","deleteUrl","parsedUrlParams"])):c("",!0),(o(!0),l(U,null,$(e.columnData,M=>(o(),l("section",{key:M},[_(f,{"table-columns":M.columns,reportId:M.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),k(g,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:M.columns,staticColumns:e.staticColumns,show_pagination:e.showPagination},null,8,["data-url","columns","columnsMeta","staticColumns","show_pagination"])):c("",!0)]))),128))])])):c("",!0)])}const Js=P(nV,[["render",uV]]);const mV={name:"software-license-activity",description:"Software License activity page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{licenseId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/software-license-log/"+this.licenseId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},created(){window.emitter.on("updateLicenseLogs",()=>this.refreshActivity=!0)},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},filtering(e){this.$emit("loaderValue",e)},loading(e){this.$emit("loaderValue",e)},refreshActivity(e){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){T.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.SoftwareLicense_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.SoftwareLicense_activity_logs.total,this.perPage=t.data.data.SoftwareLicense_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":kt}},hV={class:"row",id:"activity_log_div"},pV={class:"col-sm-12 mb-2"},_V={key:0,id:"select_limit"},fV={type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},gV={class:"dropdown-menu"},bV={key:1,id:"choose_order"},yV={id:"sort_btn",type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},vV={class:"dropdown-menu",style:{"z-index":"9999"}},wV={key:2,id:"page_div"},kV={class:"col-md-12"},CV={key:0,class:"timeline"},DV={key:0,class:"time-label"},SV={class:"text-bg-light border"},MV={class:"timeline-item"},FV={class:"time"},IV={key:0,class:"timeline-header"},AV={class:"timeline-body break"},PV={key:1},TV={key:1,class:"float-end",id:"page_div"},VV={key:0,class:"col-sm-12"},LV={class:"text-center"};function UV(e,t,s,d,a,i){const m=u("uib-pagination"),h=u("faveo-image-element"),b=u("router-link"),f=u("activity-parser");return o(),l("div",hV,[n("div",pV,[!a.loading&&a.activity_log.length>0?(o(),l("div",_V,[n("button",fV,r(a.perPage),1),n("div",gV,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=g=>i.logLimit(10))},"10"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[1]||(t[1]=g=>i.logLimit(25))},"25"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=g=>i.logLimit(50))},"50"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[3]||(t[3]=g=>i.logLimit(100))},"100")])])):c("",!0),!a.loading&&a.activity_log.length>0?(o(),l("div",bV,[n("button",yV,r(e.lang("created_time"))+" - "+r(e.lang(a.sort_key)),1),n("div",vV,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[4]||(t[4]=g=>i.orderBy("asc"))},[t[8]||(t[8]=n("i",{class:"fas fa-sort-amount-up"},null,-1)),v(" "+r(e.lang("asc")),1)]),n("a",{href:"javascript:;",onClick:t[5]||(t[5]=g=>i.orderBy("desc")),class:"dropdown-item"},[t[9]||(t[9]=n("i",{class:"fas fa-sort-amount-down"},null,-1)),v(" "+r(e.lang("desc")),1)])])])):c("",!0),!a.loading&&a.total>10?(o(),l("div",wV,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[6]||(t[6]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),n("div",kV,[!a.loading&&a.activity_log.length>0?(o(),l("div",CV,[(o(!0),l(U,null,$(a.activity_log,(g,D)=>(o(),l(U,null,[i.checkDate(D)?(o(),l("div",DV,[n("span",SV,r(d.formattedDate(g.created_at)),1)])):c("",!0),n("div",null,[t[11]||(t[11]=n("i",{class:"far fa-dot-circle timeline-icon"},null,-1)),n("div",MV,[n("span",FV,[t[10]||(t[10]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(g.created_at)),1)]),g.creator?(o(),l("h3",IV,[_(h,{id:"license_img","source-url":g.creator.profile_pic,classes:["img-circle","img-bordered-sm","img-rounder"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),_(b,{to:"/user/"+g.creator.id},{default:w(()=>[v(" "+r(g.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),n("div",AV,[_(f,{data:g.name},null,8,["data"])])])]),i.showThreadEnd(D)?(o(),l("div",PV,t[12]||(t[12]=[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),256))])):c("",!0),!a.loading&&a.total>10?(o(),l("div",TV,[_(m,{id:"page2",records:i.Records,modelValue:a.pagination,"onUpdate:modelValue":t[7]||(t[7]=g=>a.pagination=g),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:a.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!a.filtering&&!a.loading&&a.activity_log.length===0?(o(),l("div",VV,[n("h6",LV,r(e.lang("no_data_found")),1)])):c("",!0)])}const NV=P(mV,[["render",UV],["__scopeId","data-v-21a566ad"]]),EV={name:"asset-associate-detach",description:"Asset Associate Detach Modal component",props:{showModal:{type:Boolean,default:!1},licenseId:{type:[String,Number],default:""},associateId:{type:[String,Number],default:""},category:{type:String,default:""},onClose:{type:Function},compName:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;const e={type:this.category,type_ids:this.associateId};T.delete("service-desk/api/detach-software-license-services/"+this.licenseId,{data:e}).then(t=>{K(t,"software-license-view"),window.emitter.emit(this.compName+"refreshData"),window.emitter.emit("updateLicenseView"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!1,this.onClose(),O(t,"software-license-view")})}}},xV={class:"modal-title"},OV={key:0},qV={key:1,class:"row"},jV=["disabled"];function RV(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",xV,r(e.trans("check_in")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",OV,[n("span",null,r(e.trans("are_you_sure")),1)])),a.loading?(o(),l("div",qV,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink"},null,-1)),v(" "+r(e.trans("check_in")),1)],8,jV)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const BV=P(EV,[["render",RV]]);const zV={name:"software-license-associate-asset-table",description:"Software License associates asset table page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{licenseId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},columns:{type:Array,default:()=>[]},sortable:{type:Array,default:()=>[]},filterable:{type:Array,default:()=>[]},disableLoader:{type:Boolean,default:!1}},data(){return{options:{},showModal:!1,associateId:"",category:"",details:""}},computed:{apiEndPoint(){return"/service-desk/api/software-license-assets/"+this.licenseId}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{users:this.trans("users"),assets:this.trans("assets"),location:this.trans("location"),action:this.trans("action")},texts:{filter:"",limit:""},templates:{assets:function(t,s){return s.name?e.h(De,{to:"/service-desk/assets/"+s.id+"/show"},s.name):"---"},users:function(t,s){return s.meta_name?e.h(De,{to:"/user/"+s.id},s.meta_name?s.meta_name:s.full_name):s.used_by?e.h(De,{to:"/user/"+s.used_by.id},s.used_by.meta_name?s.used_by.meta_name:s.used_by.full_name):"---"},location:function(t,s){return s.location?s.location.title?s.location.title:s.location:"---"},action(t,s){let d=e.h("i",{class:"fa fa-unlink"}),a=e.h("span",e.trans("check_in"));const i=e.details.reassignable==="No"?"btn btn-secondary disabled":"btn btn-secondary";return e.h("a",{class:i,title:"Checkin",href:"javascript:;",onClick(){e.onDetach(s.id,s.name)}},[d,a])}},sortable:e.sortable,filterable:e.filterable,pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.results.data,count:t.data.total}}}},created(){window.emitter.on("fetchedData",this.handleData)},methods:{onDetach(e,t){t?this.category="sd_assets":this.category="users",this.associateId=e,this.showModal=!0},onClose(){this.showModal=!1},handleData(e){this.details=e},handelLoader(e){this.$emit("loaderValue",e)}},components:{"software-license-associate-detach":BV}},KV={id:"license_associates"};function HV(e,t,s,d,a,i){const m=u("data-table"),h=u("software-license-associate-detach");return o(),l("div",KV,[_(m,{url:i.apiEndPoint,dataColumns:s.columns,option:a.options,scroll_to:"license-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showModal,associateId:a.associateId,licenseId:s.licenseId,category:a.category,compName:s.componentTitle},null,8,["onClose","showModal","associateId","licenseId","category","compName"])):c("",!0)]),_:1})])}const YV=P(zV,[["render",HV]]);const $V={name:"software-license-associates",description:"Softwarelicense associates page",props:{licenseId:{type:[String,Number],default:""}},data(){return{tabs:[{id:"assets",title:"checked_out_seats",show:!0},{id:"activity",title:"activity_log",show:!0}],category:"assets",loading:!0,dynamicKeys:{activity:1,assets:1}}},created(){window.emitter.on("updatelicenseAssociates",this.updateAssociates),this.$store.dispatch("setLicenseAssociateCategory",this.category)},computed:{columns(){return["users","assets","location","action"]},filterable(){return["users","assets","location"]},sortable(){return["users","assets","location"]}},methods:{associates(e){this.category!==e&&(this.loading=!0,this.category=e),this.updateKey(e)},updateAssociates(e){this.associates(e)},handelLoader(e){this.loading=e},updateKey(e){this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setLicenseAssociateCategory",e)}},components:{"software-license-associate-asset-table":YV,"software-license-activity":NV}},WV={key:0,class:"card card-light card-tabs",id:"license-associates"},JV={class:"card-header p-0 pt-1"},GV={class:"nav nav-tabs"},XV={key:0,class:"nav-item"},ZV=["onClick"],QV={class:"nav-item me-auto mt-04"},eL={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},tL={class:"card-body"},sL={class:"tab-content"},aL={class:"active tab-pane",id:"activity"};function nL(e,t,s,d,a,i){const m=u("alert"),h=u("software-license-activity"),b=u("software-license-associate-asset-table");return a.tabs?(o(),l("div",WV,[_(m,{componentName:"software-license-associates"}),n("div",JV,[n("ul",GV,[(o(!0),l(U,null,$(a.tabs,f=>(o(),l(U,null,[f.show?(o(),l("li",XV,[n("a",{id:"license_tab",class:Q(["nav-link",{active:a.category===f.id}]),"data-bs-toggle":"pill",onClick:g=>i.associates(f.id)},r(e.trans(f.title)),11,ZV)])):c("",!0)],64))),256)),n("li",QV,[a.loading?(o(),l("a",eL,t[0]||(t[0]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])])]),n("div",tL,[n("div",sL,[n("div",aL,[a.category==="activity"?(o(),k(h,{licenseId:s.licenseId,onLoaderValue:i.handelLoader,key:"license_activity"+a.dynamicKeys.activity},null,8,["licenseId","onLoaderValue"])):c("",!0),a.category==="assets"?(o(),k(b,{columns:i.columns,"license-id":s.licenseId,sortable:i.sortable,filterable:i.filterable,"component-title":"SoftwareLicense "+a.category,onLoaderValue:i.handelLoader,disableLoader:"true",key:"license_asset"+a.dynamicKeys.assets},null,8,["columns","license-id","sortable","filterable","component-title","onLoaderValue"])):c("",!0)])])])])):c("",!0)}const oL=P($V,[["render",nL],["__scopeId","data-v-ff83d8bc"]]);const iL={name:"software-license-associate-modal",description:"Software License Associates Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},licenseId:{type:[String,Number],default:""},associate:{type:String,default:""}},data(){return{associated:[],loading:!1,availableSeats:"",showAlert:!1,category:""}},mounted(){this.availableSeats=this.licenseId.seats-this.licenseId.used_seats},created(){this.category=this.$store.getters.getLicenseAssociateCategory},computed:{endPoint(){if(this.associate==="user")return"/api/dependency/users?supplements[relation_name]=softwarelicense&supplements[attribute_name]=software_license_id&supplements[attribute_value]="+this.licenseId.id;if(this.associate==="assets")return"/service-desk/api/dependency/assets?supplements[relation_name]=softwarelicense&supplements[attribute_name]=software_license_id&supplements[attribute_value]="+this.licenseId.id}},methods:{onChange(e,t){this[t]=e},validateAttach(){this.associated.length<=this.availableSeats?(this.onSubmit(),this.showAlert=!1):this.showAlert=!0},onSubmit(){this.loading=!0;let e={},t=[];for(let s in this.associated)t.push(this.associated[s].id);this.associate==="assets"?e.type="sd_assets":e.type="users",e.type_ids=t,T.post("/service-desk/api/attach-software-license-services/"+this.licenseId.id,e).then(s=>{this.loading=!1,K(s,"software-license-associate-modal"),setTimeout(()=>{this.onClose(),window.emitter.emit("updateLicenseView"),this.category==="activity"?window.emitter.emit("updateLicenseLogs"):window.emitter.emit("SoftwareLicense assetsrefreshData")},4e3)}).catch(s=>{this.loading=!1,O(s,"software-license-associate-modal")})}},components:{"dynamic-select":fe}},lL={class:"modal-title"},rL={key:0},dL={class:"row"},cL={key:0,class:"seats ms-3"},uL={key:1,class:"row"},mL=["disabled"];function hL(e,t,s,d,a,i){const m=u("alert"),h=u("dynamic-select"),b=u("reuse-loader"),f=u("modal");return s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",lL,r(e.trans("check_out_to")+" "+s.associate),1)]),fields:w(()=>[_(m,{componentName:"software-license-associate-modal"}),a.loading?c("",!0):(o(),l("div",rL,[n("div",dL,[_(h,{label:s.associate==="assets"?e.trans(s.associate):"User",hint:e.trans("available_seats")+a.availableSeats,multiple:!0,name:"associated",prePopulate:!1,classname:"col-sm-12",apiEndpoint:i.endPoint,value:a.associated,onChange:i.onChange,required:!0},null,8,["label","hint","apiEndpoint","value","onChange"]),a.showAlert?(o(),l("p",cL,r(e.trans("available_seats_alert:")+this.availableSeats),1)):c("",!0)])])),a.loading?(o(),l("div",uL,[_(b,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=g=>i.validateAttach()),class:"btn btn-primary",disabled:!(a.associated.length>0)},[t[1]||(t[1]=n("i",{class:"fas fa-paperclip"},null,-1)),v(" "+r(e.trans("checkout")),1)],8,mL)]),_:1},8,["showModal","onClose"])):c("",!0)}const pL=P(iL,[["render",hL],["__scopeId","data-v-8b7ebbfc"]]);const _L={name:"software-license-actions",description:"Software License actions component",props:{license:{type:Object,default:()=>{}}},data(){return{showDeleteModal:!1,showAssociateModal:!1,associate:"",actions:""}},beforeMount(){this.getActions()},methods:{getActions(){this.actions="",T.get("/service-desk/api/software-license-action/"+this.license.id).then(e=>{this.actions=e.data.data.softwareLicense_actions}).catch(e=>{this.actions=""})},associateMethod(e){this.showAssociateModal=!0,this.associate=e},onClose(){this.showDeleteModal=!1,this.showAssociateModal=!1}},components:{"delete-modal":ot,"software-license-associate-modal":pL}},fL={class:"card-tools"},gL={key:0,class:"btn-group"},bL={type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},yL={class:"dropdown-menu checkout-container"};function vL(e,t,s,d,a,i){const m=u("router-link"),h=u("delete-modal"),b=u("software-license-associate-modal"),f=W("tooltip");return o(),l("div",fL,[s.license.used_seats!==s.license.seats?(o(),l("div",gL,[n("button",bL,[t[3]||(t[3]=n("i",{class:"fas fa-link"},null,-1)),v(" "+r(e.trans("checkout")),1)]),n("div",yL,[n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=g=>i.associateMethod("assets"))},[t[4]||(t[4]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.trans("checkout_to_asset")),1)]),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=g=>i.associateMethod("user"))},[t[5]||(t[5]=n("i",{class:"far fa-circle"},null,-1)),v(" "+r(e.trans("checkout_to_user")),1)])])])):c("",!0),a.actions.edit_softwareLicense?S((o(),k(m,{key:1,class:"btn btn-tool btn-tool-rounded",to:"/service-desk/software/license/"+s.license.id+"/edit"},{default:w(()=>t[6]||(t[6]=[n("span",{class:"fas fa-edit"},null,-1)])),_:1},8,["to"])),[[f,e.lang("edit")]]):c("",!0),a.actions.delete_softwareLicense?S((o(),l("button",{key:2,class:"btn btn-tool btn-tool-rounded",onClick:t[2]||(t[2]=g=>a.showDeleteModal=!0),href:"javascript:;"},t[7]||(t[7]=[n("span",{class:"fas fa-trash"},null,-1)]))),[[f,e.lang("delete")]]):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showDeleteModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showDeleteModal,alertComponentName:"software-license-view",deleteUrl:"/service-desk/api/software-license-delete/"+s.license.id,redirectUrl:"/service-desk/software/license/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAssociateModal?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showAssociateModal,licenseId:s.license,associate:a.associate},null,8,["onClose","showModal","licenseId","associate"])):c("",!0)]),_:1})])}const wL=P(_L,[["render",vL],["__scopeId","data-v-f19f25df"]]);const kL={name:"SoftwareLicenseDetails",description:"software license details Component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},props:{licenseId:{type:[String,Number],required:!0}},data(){return{licenseData:"",loading:!0,showDescription:!1,showDeleteModal:!1,refreshLicense:!1}},created(){window.emitter.on("updateLicenseView",()=>this.refreshLicense=!0)},beforeMount(){this.getData()},methods:{getData(){T.get("service-desk/api/software-license/"+this.licenseId).then(e=>{this.loading=!1,window.emitter.emit("fetchedData",e.data.data),this.licenseData=e.data.data}).catch(e=>{this.loading=!1})},subString(e,t=15){return Ie(e,t)},onClose(){this.showDeleteModal=!1,this.showDescription=!1}},watch:{refreshLicense(e,t){e===!0&&this.getData(),this.refreshLicense=!1}},components:{"software-license-actions":wL,"delete-modal":ot,"asset-description":Ca}},CL={class:"card card-light"},DL={class:"card-header"},SL={class:"card-title"},ML={class:"card-body"},FL={class:"row mb-3"},IL={class:"col-md-12"},AL={class:"callout callout-info"},PL={class:"row"},TL={class:"col-md-4"},VL={class:"col-md-4"},LL={class:"col-md-4"},UL={class:"col-md-12"},NL={class:"row mx-1"},EL={key:0,class:"col-md-6 info-row d-flex"},xL={class:"col-md-6"},OL={class:"col-md-6"},qL={key:1,class:"col-md-6 info-row d-flex"},jL={class:"col-md-6"},RL={class:"col-md-6"},BL={key:2,class:"col-md-6 info-row d-flex"},zL={class:"col-md-6"},KL={class:"col-md-6"},HL={key:3,class:"col-md-6 info-row d-flex"},YL={class:"col-md-6"},$L={class:"col-md-6"},WL={key:4,class:"col-md-6 info-row d-flex"},JL={class:"col-md-6"},GL={class:"col-md-6"},XL={class:"col-md-6 info-row d-flex"},ZL={class:"col-md-6"},QL={class:"col-md-6"},e5={class:"text-primary"},t5={class:"col-md-6 info-row d-flex"},s5={class:"col-md-6"},a5={class:"col-md-6"},n5={class:"text-primary"},o5={class:"col-md-6 info-row d-flex"},i5={class:"col-md-6"},l5={class:"col-md-6"},r5={class:"text-primary"},d5={class:"col-md-6 info-row d-flex"},c5={class:"col-md-6"},u5={class:"col-md-6"},m5={class:"text-primary"},h5={class:"col-md-6 info-row d-flex"},p5={class:"col-md-6"},_5={class:"col-md-6"},f5={class:"text-primary"},g5={class:"col-md-6 info-row d-flex"},b5={class:"col-md-6"},y5={class:"col-md-6"},v5={class:"text-primary"},w5={class:"col-md-6 info-row d-flex"},k5={class:"col-md-6"},C5={class:"col-md-6"},D5={class:"text-primary"},S5={class:"col-md-6 info-row d-flex"},M5={class:"col-md-6"},F5={class:"col-md-6"},I5={class:"text-primary"},A5={class:"col-md-6 info-row d-flex"},P5={class:"col-md-6"},T5={class:"col-md-6"},V5={class:"text-primary"},L5={class:"col-md-6 info-row d-flex"},U5={class:"col-md-6"},N5={class:"col-md-6"},E5={class:"text-primary"},x5={class:"col-md-6 info-row d-flex"},O5={class:"col-md-6"},q5={class:"col-md-6"},j5={class:"text-primary"},R5={class:"col-md-6 info-row d-flex"},B5={class:"col-md-6"},z5={class:"col-md-6"},K5={class:"text-primary"},H5={class:"col-md-6 info-row d-flex"},Y5={class:"col-md-6"},$5={class:"col-md-6"},W5={class:"text-primary"},J5={class:"col-md-6 info-row d-flex"},G5={class:"col-md-6"},X5={class:"col-md-6"},Z5={class:"col-md-6 info-row d-flex"},Q5={class:"col-md-6"},eU={class:"col-md-6"},tU={key:0},sU={key:0},aU={class:"col-md-6 info-row d-flex"},nU={class:"col-md-6"},oU={class:"col-md-6"},iU={key:0},lU={class:"line"},rU=["src"],dU=["href"],cU={key:1},uU={key:0,class:"card card-secondary"},mU={class:"card-header"},hU={class:"card-title"},pU={class:"card-body"},_U={class:"col-md-12 asset_row"},fU={class:"row mx-1"},gU={class:"col-md-6 info-row d-flex"},bU={class:"col-md-6"},yU={class:"col-md-6"},vU={key:0},wU={onClick:"return false",class:"text-primary"},kU={key:0},CU={key:1,onClick:"return false",class:"text-primary"},DU={key:1,class:"card-body",id:"loader_margin"};function SU(e,t,s,d,a,i){const m=u("software-license-actions"),h=u("router-link"),b=u("asset-description"),f=u("reuse-loader"),g=W("tooltip");return o(),l("div",CL,[!a.loading&&a.licenseData?(o(),l(U,{key:0},[n("div",DL,[S((o(),l("h3",SL,[v(r(i.subString(a.licenseData.name,50))+"("+r(a.licenseData.used_seats+"/"+a.licenseData.seats)+")",1)])),[[g,a.licenseData.name]]),_(m,{license:a.licenseData},null,8,["license"])]),n("div",ML,[n("div",FL,[n("div",IL,[n("div",AL,[n("div",PL,[n("div",TL,[n("b",null,r(e.trans("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.licenseData.created_at)),1)])),[[g,d.formattedTime(a.licenseData.created_at)]])]),n("div",VL,[n("b",null,r(e.trans("purchase_order_number"))+" : ",1),S((o(),l("span",null,[v(r(a.licenseData.purchase_order_number?i.subString(a.licenseData.purchase_order_number):"---"),1)])),[[g,a.licenseData.purchase_order_number?a.licenseData.purchase_order_number:"---"]])]),n("div",LL,[n("b",null,r(e.trans("updated_at"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.licenseData.updated_at)),1)])),[[g,d.formattedTime(a.licenseData.updated_at)]])])])])])]),n("div",UL,[n("div",NL,[a.licenseData.organization?(o(),l("div",EL,[n("div",xL,[n("label",null,r(e.trans("organization")),1)]),n("div",OL,[_(h,{class:"text-primary",to:a.licenseData.organization.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.licenseData.organization.name)),1)])),[[g,a.licenseData.organization.name]])]),_:1},8,["to"])])])):c("",!0),a.licenseData.license_type?(o(),l("div",qL,[n("div",jL,[n("label",null,r(e.trans("license_type")),1)]),n("div",RL,[_(h,{class:"text-primary",to:a.licenseData.license_type.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.licenseData.license_type.name)),1)])),[[g,a.licenseData.license_type.name]])]),_:1},8,["to"])])])):c("",!0),a.licenseData.manufacturer?(o(),l("div",BL,[n("div",zL,[n("label",null,r(e.trans("manufacturers")),1)]),n("div",KL,[_(h,{class:"text-primary",to:a.licenseData.manufacturer.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.licenseData.manufacturer.name)),1)])),[[g,a.licenseData.manufacturer.name]])]),_:1},8,["to"])])])):c("",!0),a.licenseData.vendor?(o(),l("div",HL,[n("div",YL,[n("label",null,r(e.trans("vendor")),1)]),n("div",$L,[_(h,{class:"text-primary",to:a.licenseData.vendor.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.licenseData.vendor.name)),1)])),[[g,a.licenseData.vendor.name]])]),_:1},8,["to"])])])):c("",!0),a.licenseData.depreciation?(o(),l("div",WL,[n("div",JL,[n("label",null,r(e.trans("depreciation")),1)]),n("div",GL,[_(h,{class:"text-primary",to:a.licenseData.depreciation.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(a.licenseData.depreciation.name)),1)])),[[g,a.licenseData.depreciation.name]])]),_:1},8,["to"])])])):c("",!0),n("div",XL,[n("div",ZL,[n("label",null,r(e.trans("licensed_to_email")),1)]),n("div",QL,[S((o(),l("a",e5,[v(r(a.licenseData.licensed_to_email?i.subString(a.licenseData.licensed_to_email):"---"),1)])),[[g,a.licenseData.licensed_to_email?a.licenseData.licensed_to_email:"---"]])])]),n("div",t5,[n("div",s5,[n("label",null,r(e.trans("license_key")),1)]),n("div",a5,[S((o(),l("a",n5,[v(r(a.licenseData.license_key?a.licenseData.license_key:"---"),1)])),[[g,a.licenseData.license_key?a.licenseData.license_key:"---"]])])]),n("div",o5,[n("div",i5,[n("label",null,r(e.trans("seats")),1)]),n("div",l5,[S((o(),l("a",r5,[v(r(a.licenseData.used_seats+"/"+a.licenseData.seats),1)])),[[g,a.licenseData.used_seats+"/"+a.licenseData.seats]])])]),n("div",d5,[n("div",c5,[n("label",null,r(e.trans("reassignable")),1)]),n("div",u5,[S((o(),l("a",m5,[v(r(a.licenseData.reassignable==="Yes"?"Yes":"No"),1)])),[[g,a.licenseData.reassignable==="Yes"?"Yes":"No"]])])]),n("div",h5,[n("div",p5,[n("label",null,r(e.trans("purchase_cost")),1)]),n("div",_5,[S((o(),l("a",f5,[v(r(a.licenseData.purchase_cost?a.licenseData.purchase_cost+" "+(a.licenseData.currency?a.licenseData.currency:""):0),1)])),[[g,a.licenseData.purchase_cost?a.licenseData.purchase_cost+" "+(a.licenseData.currency?a.licenseData.currency:""):0]])])]),n("div",g5,[n("div",b5,[n("label",null,r(e.trans("maintenance_cost")),1)]),n("div",y5,[S((o(),l("a",v5,[v(r(a.licenseData.maintenance_cost?a.licenseData.maintenance_cost+" "+(a.licenseData.currency?a.licenseData.currency:""):0),1)])),[[g,a.licenseData.maintenance_cost?a.licenseData.maintenance_cost+" "+(a.licenseData.currency?a.licenseData.currency:""):0]])])]),n("div",w5,[n("div",k5,[n("label",null,r(e.trans("book_value")),1)]),n("div",C5,[S((o(),l("a",D5,[v(r(a.licenseData.book_value?a.licenseData.book_value+" "+a.licenseData.currency:"---"),1)])),[[g,a.licenseData.book_value?a.licenseData.book_value+" "+a.licenseData.currency:"---"]])])]),n("div",S5,[n("div",M5,[n("label",null,r(e.trans("salvage")),1)]),n("div",F5,[S((o(),l("a",I5,[v(r(a.licenseData.salvage?a.licenseData.salvage+" "+(a.licenseData.currency?a.licenseData.currency:""):0),1)])),[[g,a.licenseData.salvage?a.licenseData.salvage+" "+(a.licenseData.currency?a.licenseData.currency:""):0]])])]),n("div",A5,[n("div",P5,[n("label",null,r(e.trans("purchase_order_number")),1)]),n("div",T5,[S((o(),l("a",V5,[v(r(a.licenseData.purchase_order_number?a.licenseData.purchase_order_number:"---"),1)])),[[g,a.licenseData.purchase_order_number?a.licenseData.purchase_order_number:"---"]])])]),n("div",L5,[n("div",U5,[n("label",null,r(e.trans("version")),1)]),n("div",N5,[S((o(),l("a",E5,[v(r(a.licenseData.version?a.licenseData.version:"---"),1)])),[[g,a.licenseData.version?a.licenseData.version:"---"]])])]),n("div",x5,[n("div",O5,[n("label",null,r(e.trans("purchase_date")),1)]),n("div",q5,[S((o(),l("a",j5,[v(r(a.licenseData.purchase_date?a.licenseData.purchase_date:"---"),1)])),[[g,a.licenseData.purchase_date?a.licenseData.purchase_date:"---"]])])]),n("div",R5,[n("div",B5,[n("label",null,r(e.trans("renewal_date")),1)]),n("div",z5,[S((o(),l("a",K5,[v(r(a.licenseData.renewal_date?a.licenseData.renewal_date:"---"),1)])),[[g,a.licenseData.renewal_date?a.licenseData.renewal_date:"---"]])])]),n("div",H5,[n("div",Y5,[n("label",null,r(e.trans("expiration_date")),1)]),n("div",$5,[S((o(),l("a",W5,[v(r(a.licenseData.expiration_date?a.licenseData.expiration_date:"---"),1)])),[[g,a.licenseData.expiration_date?a.licenseData.expiration_date:"---"]])])]),n("div",J5,[n("div",G5,[n("label",null,r(e.trans("description")),1)]),n("div",X5,[n("a",{href:"javascript:;",class:"btn btn-info btn-sm",onClick:t[0]||(t[0]=D=>a.showDescription=!0)},[t[1]||(t[1]=n("i",{class:"fas fa-file-code"},"  ",-1)),v(r(e.trans("show_description")),1)])])]),a.licenseData.custom_field_values&&a.licenseData.custom_field_values.length>0?(o(!0),l(U,{key:5},$(a.licenseData.custom_field_values,D=>(o(),l("div",Z5,[n("div",Q5,[n("label",null,r(D.label),1)]),n("div",eU,[Array.isArray(D.value)?(o(),l("div",tU,[(o(!0),l(U,null,$(D.value,(M,x)=>(o(),k(h,{class:"text-primary",to:D.href[x].replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(M)),1)])),[[g,M]]),x!=Object.keys(D.value).length-1?(o(),l("span",sU,",")):c("",!0),t[2]||(t[2]=v("  "))]),_:2},1032,["to"]))),256))])):(o(),l(U,{key:1},[D.field_type==="date"?(o(),k(h,{key:0,class:"text-primary",to:D.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(D.value),1)])),[[g,D.value]])]),_:2},1032,["to"])):(o(),k(h,{key:1,class:"text-primary",to:D.href.replace(e.basePath(),""),target:"_blank"},{default:w(()=>[S((o(),l("span",null,[v(r(i.subString(D.value)),1)])),[[g,{content:D.value?D.value.replace(/\r?\n/g,"<br />"):"---",html:!0}]])]),_:2},1032,["to"]))],64))])]))),256)):c("",!0),n("div",aU,[n("div",nU,[n("label",null,r(e.trans("attachments")),1)]),n("div",oU,[a.licenseData.attachments.length>0?(o(),l("span",iU,[(o(!0),l(U,null,$(a.licenseData.attachments,D=>(o(),l(U,null,[n("span",lU,[S((o(),l("span",null,[n("img",{src:D.thumbnail_url,class:"attach_img"},null,8,rU),v(" "+r(i.subString(D.name,15))+" "+r("("+D.size+")"),1)])),[[g,D.name]]),S((o(),l("a",{id:"download",href:D.download_url},t[3]||(t[3]=[v("   "),n("i",{class:"fas fa-download"},null,-1)]),8,dU)),[[g,e.trans("download")]])]),t[4]||(t[4]=n("br",null,null,-1))],64))),256))])):(o(),l("span",cU,"---"))])])])]),t[6]||(t[6]=n("hr",null,null,-1)),a.licenseData.custom_field_values_for_software_license_type&&a.licenseData.custom_field_values_for_software_license_type.length>0?(o(),l("div",uU,[n("div",mU,[n("h3",hU,r(a.licenseData.license_type.name+" "+e.trans("properties")),1)]),n("div",pU,[n("div",_U,[n("div",fU,[(o(!0),l(U,null,$(a.licenseData.custom_field_values_for_software_license_type,D=>(o(),l("div",gU,[n("div",bU,[n("label",null,r(D.label),1)]),n("div",yU,[Array.isArray(D.value)?(o(),l("div",vU,[(o(!0),l(U,null,$(D.value,(M,x)=>S((o(),l("a",wU,[v(r(i.subString(M)),1),x!=Object.keys(D.value).length-1?(o(),l("span",kU,",")):c("",!0),t[5]||(t[5]=v("  "))])),[[g,M]])),256))])):S((o(),l("a",CU,[v(r(D.field_type=="date"?D.value:i.subString(D.value)),1)])),[[g,D.value]])])]))),256))])])])])):c("",!0)]),a.showDescription?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showDescription,description:a.licenseData.description},null,8,["onClose","showModal","description"])):c("",!0)],64)):c("",!0),a.loading?(o(),l("div",DU,[_(f,{"animation-duration":4e3,size:60})])):c("",!0)])}const MU=P(kL,[["render",SU],["__scopeId","data-v-dc1997dc"]]);const FU={name:"software-license-view",description:"SoftwareLicense view page",computed:{licenseId(){return pe(this.currentPath())}},data(){return{loading:!1}},components:{"software-license-associates":oL,"software-license-details":MU}},IU={class:"col-sm-12"};function AU(e,t,s,d,a,i){const m=u("alert"),h=u("software-license-details"),b=u("software-license-associates");return o(),l("div",IU,[_(m,{componentName:"software-license-view"}),_(h,{licenseId:i.licenseId},null,8,["licenseId"]),_(b,{licenseId:i.licenseId},null,8,["licenseId"])])}const PU=P(FU,[["render",AU]]),TU={name:"softwarelicense-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[Xe],beforeMount(){if(this.mode==="edit"){const e=pe(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-software-license/"+e,this.editId=pe(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,T.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,O(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=At(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/software/license/"+s+"/show")},1e3)}},components:{FormRenderer:Ze,CustomLoader:nt,Alert:We,FaveoBox:wt}},VU={class:"col-sm-12"},LU={key:0,class:"pull-right"},UU={key:0,class:"form-group row mt-3"},NU={class:"col-md-12"},EU=["disabled"],xU={key:0},OU={key:1};function qU(e,t,s,d,a,i){const m=u("Alert"),h=u("CustomLoader"),b=u("router-link"),f=u("FormRenderer"),g=u("ValidationObserver"),D=u("FaveoBox"),M=W("tooltip");return o(),l("div",VU,[a.formUniqueKey&&a.formSelected?(o(),k(D,{key:0,title:e.lang(i.mode)},{headerMenu:w(()=>[s.showViewButton?(o(),l("span",LU,[S((o(),k(b,{to:"/service-desk/software/license/"+a.editId+"/show",class:"btn btn-tool has-tooltip"},{default:w(()=>t[1]||(t[1]=[n("span",null,[n("i",{class:"fas fa-eye"})],-1)])),_:1},8,["to"])),[[M,e.trans("view")]])])):c("",!0)]),default:w(()=>[_(m,{componentName:"faveo-form"}),_(m,{componentName:"form-renderer"}),e.showLoader||a.submitFormInProgress?(o(),k(h,{key:0,duration:4e3})):c("",!0),_(g,{ref:"faveoFormObserver"},{default:w(({values:x,errors:R,validate:V})=>[(o(),k(f,{key:a.formUniqueKey,fetchFormFieldApi:a.fetchFormFieldApi,formUniqueKey:a.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:a.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",UU,[n("div",NU,[n("button",{type:"button",class:"btn btn-primary pull-right",disabled:a.submitFormInProgress,onClick:t[0]||(t[0]=N=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",xU,t[2]||(t[2]=[n("i",{class:"fas fa-sync"},null,-1)]))):(o(),l("span",OU,t[3]||(t[3]=[n("i",{class:"fas fa-save"},null,-1)]))),v(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,EU)])]))]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const Gs=P(TU,[["render",qU]]);const jU={name:"product-list",description:"Product lists table component",data:()=>({columns:["name","manufacturer","product_status","status","actions"],options:{},apiUrl:"/service-desk/api/product-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),manufacturer:e.lang("manufacturer"),product_status:e.lang("product_status"),status:e.lang("status"),actions:e.lang("actions")},columnsClasses:{name:"product-name",manufacturer:"product-man",product_status:"product_status",status:"product-status"},templates:{status:function(t,s){let d=e.h("span",{class:s.status===1?"btn btn-success btn-sm pointer_normal":"btn btn-danger btn-sm pointer_normal"},s.status===1?"Enable":"Disable");return e.h("a",{class:"pointer_normal"},[d])},product_status:function(t,s){return s.product_status?e.h("span",{},[e.h("i",{class:s.product_status.icon_class,style:{color:s.product_status.icon_color,marginRight:"5px"}})],s.product_status.name):"---"},manufacturer:function(t,s){return s.manufacturer?s.manufacturer:"--"},actions:(t,s)=>e.h(qe,{data:s})},sortable:["name","manufacturer","status"],filterable:["name","manufacturer","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.products.map(s=>(s.edit_url="/service-desk/products/"+s.id+"/edit",s.view_url="/service-desk/products/"+s.id+"/show",s.delete_url=e.basePath()+"/service-desk/api/product-delete/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},RU={class:"col-sm-12"},BU={class:"card card-light"},zU={class:"card-header"},KU={id:"product-list",class:"card-title"},HU={class:"card-tools"},YU={class:"card-body",id:"product-table"};function $U(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",RU,[_(m,{componentName:"dataTableModal"}),n("div",BU,[n("div",zU,[n("h3",KU,r(e.lang("list_of_product")),1),n("div",HU,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/products/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_new_product")]])])]),n("div",YU,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"product-list"},null,8,["url","dataColumns","option"])])])])}const WU=P(jU,[["render",$U]]);function JU(e){const{name:t,manufacturer:s,product_status:d,product_proc_mode:a,department:i,description:m,assetType:h}=e;var b={name:[t,"isRequired"],manufacturer:[s,"isRequired"],product_proc_mode:[a,"isRequired"],product_status:[d,"isRequired"],department:[i,"isRequired"],description:[m,"isRequired"]};const f=new Ue(Ce),{errors:g,isValid:D}=f.validate(b);return Fe.dispatch("setValidationError",g),{errors:g,isValid:D}}const GU={data(){return{title:"create_new_product",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,product_id:"",name:"",status:1,radioOptions:[{name:"enable",value:1},{name:"disable",value:0}],manufacturer:"",product_status:"",product_proc_mode:"",department:"",description:"",assetType:"",assetDisabled:!1}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.title="edit_product",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,T.get("/service-desk/api/product/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(t.data.data.product),this.product_id=t.data.data.product.id}).catch(t=>{this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])}),this.product_proc_mode=e.procurement,this.assetType=e.asset_type,this.assetDisabled=!!e.asset_type},isValid(){const{errors:e,isValid:t}=JU(this.$data);return!!t},onChange(e,t){this[t]=e,e===null&&(this[t]="")},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.product_id!=""&&e.append("id",this.product_id),e.append("name",this.name),e.append("status_id",this.status),this.product_status&&this.product_status.id&&e.append("product_status_id",this.product_status.id),e.append("manufacturer",this.manufacturer),this.department&&this.department.id&&e.append("department_id",this.department.id),this.product_proc_mode&&this.product_proc_mode.id&&e.append("procurement_mode_id",this.product_proc_mode.id),e.append("description",this.description),e.append("asset_type_id",this.assetType?this.assetType.id:"");const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/product",e,t).then(s=>{this.loading=!1,K(s,"product"),this.product_id?this.getInitialValues(this.product_id):setTimeout(()=>{let d=s.data.data.id;this.$router.push("/service-desk/products/"+d+"/show")},3e3)}).catch(s=>{this.loading=!1,O(s,"product")})}}},components:{"text-field":Ae,"dynamic-select":fe,"radio-button":mt}},XU={class:"col-sm-12"},ZU={key:0,class:"row"},QU={key:1,class:"card card-light"},eN={class:"card-header"},tN={class:"card-title"},sN={class:"card-tools"},aN={class:"card-body"},nN={class:"row"},oN={class:"row"},iN={class:"row"},lN={class:"row"},rN={class:"row"},dN={class:"card-footer"};function cN(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("router-link"),f=u("text-field"),g=u("radio-button"),D=u("dynamic-select"),M=u("tiny-editor"),x=W("tooltip"),R=W("focus-first-input");return o(),l("div",XU,[!a.hasDataPopulated||a.loading?(o(),l("div",ZU,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"product"}),a.hasDataPopulated?(o(),l("div",QU,[n("div",eN,[n("h3",tN,r(e.lang(a.title)),1),n("div",sN,[a.product_id?S((o(),k(b,{key:0,class:"btn btn-tool",type:"button",to:"/service-desk/products/"+a.product_id+"/show"},{default:w(()=>t[1]||(t[1]=[n("i",{class:"fas fa-eye"},null,-1)])),_:1},8,["to"])),[[x,e.trans("view")]]):c("",!0)])]),n("div",aN,[S((o(),l("div",nN,[_(f,{label:e.lang("name"),value:a.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),_(g,{options:a.radioOptions,label:e.lang("status"),name:"status",value:a.status,onChange:i.onChange,classname:"form-group col-sm-4"},null,8,["options","label","value","onChange"])])),[[R]]),n("div",oN,[_(f,{label:e.lang("manufacturer"),value:a.manufacturer,type:"text",name:"manufacturer",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),_(D,{label:e.lang("product_status"),multiple:!1,name:"product_status",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/service-desk/api/status/list?module=6",value:a.product_status,onChange:i.onChange,required:!0,clearable:!!a.product_status},null,8,["label","value","onChange","clearable"])]),n("div",iN,[_(D,{label:e.lang("product_mode_procurement"),multiple:!1,name:"product_proc_mode",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/product_proc_mode",value:a.product_proc_mode,onChange:i.onChange,required:!0,clearable:!!a.product_proc_mode},null,8,["label","value","onChange","clearable"]),_(D,{label:e.lang("department_access"),multiple:!1,name:"department",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",value:a.department,onChange:i.onChange,clearable:!!a.department,required:!0},null,8,["label","value","onChange","clearable"])]),n("div",lN,[_(D,{label:e.lang("asset_type"),multiple:!1,name:"assetType",disabled:a.assetDisabled,prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/asset_types",value:a.assetType,onChange:i.onChange,clearable:!!a.assetType},null,8,["label","disabled","value","onChange","clearable"])]),n("div",rN,[_(M,{value:a.description,id:"sd-product",type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-xs-12",required:!0},null,8,["value","onChange","label"])])]),n("div",dN,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=V=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])])])):c("",!0)])}const Xs=P(GU,[["render",cN]]),uN={name:"release-add-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},productId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!0,containerStyle:{width:"500px"},loading:!1,vendorIds:""}},methods:{onChange(e,t){this[t]=e,this.isDisabled=!(this.vendorIds.length>0)},onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};e.vendor_ids=this.vendorIds.map(s=>s.id),e.product_id=this.productId;const t={headers:{"Content-Type":"application/json"}};T.post("/service-desk/api/product/attach/vendor",e,t).then(s=>{K(s,"product-view"),window.emitter.emit("ProductVendorsrefreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(s=>{this.loading=!1,this.isDisabled=!0,O(s,"product-view"),this.onClose()})}},components:{"dynamic-select":fe}},mN={class:"modal-title"},hN={key:0},pN={class:"row"},_N={key:1,class:"row"},fN=["disabled"];function gN(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",mN,r(e.lang("vendor")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",hN,[n("div",pN,[_(m,{label:e.lang("vendor"),multiple:!0,name:"vendorIds",prePopulate:!1,classname:"col-sm-12",value:a.vendorIds,onChange:i.onChange,required:!0,apiEndpoint:"/service-desk/api/dependency/vendors_based_on_product?product_id="+s.productId},null,8,["label","value","onChange","apiEndpoint"])])])),a.loading?(o(),l("div",_N,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-check"},null,-1)),v(" "+r(e.lang("proceed")),1)],8,fN)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const bN=P(uN,[["render",gN]]);const yN={name:"release-add-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},productId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"800px"},loading:!1}},methods:{onSubmit(){this.$refs.vendorCreate.onSubmit()},onCompleted(){window.emitter.emit("ProductVendorsrefreshData"),this.onClose()}},components:{vendor:rs}},vN={class:"modal-title"},wN={key:0},kN={key:1,class:"row"},CN=["disabled"];function DN(e,t,s,d,a,i){const m=u("vendor"),h=u("reuse-loader"),b=u("modal");return s.showModal?(o(),k(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle,modalBodyClass:"vendor_fields"},{title:w(()=>[n("h4",vN,r(e.lang("vendor")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",wN,[_(m,{from:"modal",ref:"vendorCreate",product_id:s.productId,onComplete:i.onCompleted,alertName:"product-view",tinyMceWidth:"100%"},null,8,["product_id","onComplete"])])),a.loading?(o(),l("div",kN,[_(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(e.lang("save")),1)],8,CN)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const SN=P(yN,[["render",DN]]);const MN={name:"product-assets",description:"Product asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},productId:{type:[String,Number],default:""}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"ProductAssets"}},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?product_id="+this.productId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds,e.product_id=this.productId;const t={headers:{"Content-Type":"application/json"}};T.post("/service-desk/api/product/attach-asset",e,t).then(s=>{this.loading=!1,K(s,"product-view"),window.emitter.emit(this.componentTitle+"refreshData"),this.onClose()}).catch(s=>{this.loading=!1,O(s,"product-view"),this.onClose()})}}},components:{"asset-list-with-checkbox":ht,"dynamic-select":fe}},FN={class:"modal-title"},IN={class:"row"},AN={class:"col-sm-12"},PN={class:"height-limit"},TN={key:0,class:"row"},VN=["disabled"];function LN(e,t,s,d,a,i){const m=u("dynamic-select"),h=u("asset-list-with-checkbox"),b=u("custom-loader"),f=u("modal");return o(),l("div",null,[s.showModal?(o(),k(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",FN,r(e.lang("attach_assets")),1)]),fields:w(()=>[n("div",IN,[_(m,{label:e.lang("asset_types"),multiple:!1,name:"asset_type_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:a.asset_type_ids,onChange:i.onChange,clearable:!!a.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("used_by"),multiple:!1,name:"used_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:a.used_by_ids,onChange:i.onChange,clearable:!!a.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("managed_by"),multiple:!1,name:"managed_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:a.managed_by_ids,onChange:i.onChange,clearable:!!a.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),_(m,{label:e.lang("organizations"),multiple:!1,name:"org_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:a.org_ids,onChange:i.onChange,clearable:!!a.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),n("div",AN,[n("button",{id:"apply-btn",class:"btn btn-primary round-btn float-start",type:"button",onClick:t[0]||(t[0]=g=>i.onApply())},[t[2]||(t[2]=n("span",{class:"fas fa-check"},null,-1)),v("  "+r(e.lang("apply")),1)])])]),t[3]||(t[3]=n("br",null,null,-1)),n("div",PN,[a.apiUrl?(o(),k(h,{key:0,apiUrl:a.apiUrl,tickets:i.assetsData,componentTitle:a.componentTitle,from:"admin"},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),a.loading===!0?(o(),l("div",TN,[_(b,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=g=>i.onSubmit()),class:"btn btn-primary",disabled:a.isDisabled},[t[4]||(t[4]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(e.lang("attach")),1)],8,VN)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)])}const UN=P(MN,[["render",LN]]),NN={name:"product-actions",description:"Product actions component",props:{product:{type:Object,default:()=>{}}},data(){return{showDeleteModal:!1,showVendorCreate:!1,showVendorExists:!1,showAttach:!1}},methods:{subString(e,t=15){return Ie(e,t)},onClose(){this.showDeleteModal=!1,this.showVendorCreate=!1,this.showVendorExists=!1,this.showAttach=!1,this.$store.dispatch("unsetValidationError")}},components:{"delete-modal":ot,"vendor-add-modal":bN,"vendor-create-modal":SN,"product-assets":UN}},EN={class:"card-tools"},xN={class:"btn-group"},ON={type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},qN={class:"dropdown-menu dropdown-menu-right"},jN={class:"btn-group"},RN={type:"button",class:"btn btn-tool btn-tool-rounded dropdown-toggle","data-bs-toggle":"dropdown"},BN={class:"dropdown-menu dropdown-menu-right"};function zN(e,t,s,d,a,i){const m=u("router-link"),h=u("delete-modal"),b=u("vendor-create-modal"),f=u("vendor-add-modal"),g=u("product-assets");return o(),l("div",EN,[n("div",xN,[n("button",ON,[t[4]||(t[4]=n("i",{class:"fas fa-link"},null,-1)),v(" "+r(e.lang("vendor")),1)]),n("div",qN,[n("a",{class:"dropdown-item",href:"javascript:;",onClick:t[0]||(t[0]=D=>a.showVendorCreate=!0)},r(e.lang("new_vendor")),1),n("a",{class:"dropdown-item",href:"javascript:;",onClick:t[1]||(t[1]=D=>a.showVendorExists=!0)},r(e.lang("existing_vendor")),1)])]),n("button",{class:"btn btn-tool btn-tool-rounded",onClick:t[2]||(t[2]=D=>a.showAttach=!0)},[t[5]||(t[5]=n("i",{class:"fas fa-server"},null,-1)),v(" "+r(e.lang("attach_asset")),1)]),n("div",jN,[n("button",RN,[t[6]||(t[6]=n("i",{class:"fas fa-cog"},null,-1)),v(" "+r(e.lang("more")),1)]),n("div",BN,[_(m,{class:"dropdown-item text-dark",to:"/service-desk/products/"+s.product.id+"/edit"},{default:w(()=>[v(r(e.lang("edit")),1)]),_:1},8,["to"]),n("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=D=>a.showDeleteModal=!0)},r(e.lang("delete")),1)])]),_(X,{name:"modal"},{default:w(()=>[a.showDeleteModal?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showDeleteModal,alertComponentName:"product-view",deleteUrl:"/service-desk/api/product-delete/"+s.product.id,redirectUrl:"/service-desk/products"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showVendorCreate?(o(),k(b,{key:0,onClose:i.onClose,showModal:a.showVendorCreate,productId:s.product.id},null,8,["onClose","showModal","productId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showVendorExists?(o(),k(f,{key:0,onClose:i.onClose,showModal:a.showVendorExists,productId:s.product.id},null,8,["onClose","showModal","productId"])):c("",!0)]),_:1}),_(X,{name:"modal"},{default:w(()=>[a.showAttach?(o(),k(g,{key:0,onClose:i.onClose,showModal:a.showAttach,productId:s.product.id},null,8,["onClose","showModal","productId"])):c("",!0)]),_:1})])}const KN=P(NN,[["render",zN]]);const HN={name:"change-description",description:"Change description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},YN={class:"modal-title"},$N={id:"log_desc"},WN=["innerHTML"];function JN(e,t,s,d,a,i){const m=u("modal");return s.showModal?(o(),k(m,{key:0,showModal:s.showModal,onClose:s.onClose},{title:w(()=>[n("h4",YN,r(e.lang("description")),1)]),fields:w(()=>[n("div",$N,[n("span",{innerHTML:s.description},null,8,WN)])]),_:1},8,["showModal","onClose"])):c("",!0)}const GN=P(HN,[["render",JN],["__scopeId","data-v-4bff2a23"]]);const XN={name:"product-details",description:"Product details page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{product:{type:Object,default:()=>{}}},data(){return{showDescription:!1}},methods:{subString(e,t=15){return Ie(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")}},components:{"product-actions":KN,"product-description":GN}},ZN={class:"card card-light"},QN={class:"card-header"},eE={class:"card-title text-capitalize"},tE={class:"card-body"},sE={class:"row mb-3"},aE={class:"col-md-12"},nE={class:"callout callout-info"},oE={class:"row"},iE={class:"col-md-4"},lE={class:"col-md-4 text-center"},rE={class:"col-md-4"},dE={class:"col-md-12"},cE={class:"row mx-1"},uE={class:"col-md-6 info-row d-flex"},mE={class:"col-md-6"},hE={class:"col-md-6"},pE={class:"text-primary"},_E={class:"col-md-6 info-row d-flex"},fE={class:"col-md-6"},gE={class:"col-md-6"},bE={key:0,class:"text-primary"},yE={key:1},vE={class:"col-md-6 info-row d-flex"},wE={class:"col-md-6"},kE={class:"col-md-6"},CE={class:"text-primary"},DE={class:"col-md-6 info-row d-flex"},SE={class:"col-md-6"},ME={class:"col-md-6"},FE={class:"col-md-6 info-row d-flex"},IE={class:"col-md-6"},AE={class:"col-md-6"},PE={key:0,class:"text-primary"},TE={key:1};function VE(e,t,s,d,a,i){const m=u("product-actions"),h=u("product-description"),b=W("tooltip");return o(),l("div",ZN,[n("div",QN,[S((o(),l("h3",eE,[v(r(i.subString(s.product.name,50)),1)])),[[b,s.product.name]]),_(m,{product:s.product},null,8,["product"])]),n("div",tE,[n("div",sE,[n("div",aE,[n("div",nE,[n("div",oE,[n("div",iE,[n("b",null,r(e.lang("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(s.product.created_at)),1)])),[[b,d.formattedTime(s.product.created_at)]])]),n("div",lE,[n("b",null,r(e.lang("status"))+" : ",1),S((o(),l("span",null,[v(r(s.product.status?e.lang("enable"):e.lang("disable")),1)])),[[b,s.product.status?"Enable":"Disable"]])]),n("div",rE,[n("b",null,r(e.lang("manufacturer"))+" : ",1),S((o(),l("span",null,[v(r(i.subString(s.product.manufacturer)),1)])),[[b,s.product.manufacturer]])])])])])]),n("div",dE,[n("div",cE,[n("div",uE,[n("div",mE,[n("label",null,r(e.lang("product_status")),1)]),n("div",hE,[S((o(),l("a",pE,[v(r(i.subString(s.product.product_status.name)),1)])),[[b,s.product.product_status.name]])])]),n("div",_E,[n("div",fE,[n("label",null,r(e.lang("department_access")),1)]),n("div",gE,[s.product.department?S((o(),l("a",bE,[v(r(i.subString(s.product.department.name)),1)])),[[b,s.product.department.name]]):(o(),l("p",yE,"---"))])]),n("div",vE,[n("div",wE,[n("label",null,r(e.lang("product_mode_procurement")),1)]),n("div",kE,[S((o(),l("a",CE,[v(r(i.subString(s.product.procurement.name)),1)])),[[b,s.product.procurement.name]])])]),n("div",DE,[n("div",SE,[n("label",null,r(e.lang("description")),1)]),n("div",ME,[n("a",{href:"javascript:;",class:"btn btn-info btn-sm",onClick:t[0]||(t[0]=f=>a.showDescription=!0)},[t[1]||(t[1]=n("i",{class:"fas fa-file-code"}," ",-1)),v(r(e.lang("show_description")),1)])])]),n("div",FE,[n("div",IE,[n("label",null,r(e.lang("asset_type")),1)]),n("div",AE,[s.product.asset_type?S((o(),l("a",PE,[v(r(i.subString(s.product.asset_type.name)),1)])),[[b,s.product.asset_type.name]]):(o(),l("p",TE,"---"))])])])])]),_(X,{name:"modal"},{default:w(()=>[a.showDescription?(o(),k(h,{key:0,onClose:i.onClose,showModal:a.showDescription,description:s.product.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])}const LE=P(XN,[["render",VE],["__scopeId","data-v-6db84932"]]),UE={name:"detach-modal",description:"Detach Modal component",props:{showModal:{type:Boolean,default:!1},detachId:{type:[String,Number],default:""},compName:{type:String,default:""},alertCompName:{type:String,default:"product-view"},productId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;let e=this.compName==="ProductAssets"?"/service-desk/api/product/detach-asset/"+this.productId+"/"+this.detachId:"/service-desk/api/product/detach-vendor/"+this.productId+"/"+this.detachId;T.delete(e).then(t=>{K(t,"product-view"),window.emitter.emit("updateProductData"),window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!0,O(t,"product-view"),this.onClose()})}}},NE={class:"modal-title"},EE={key:0},xE={key:1,class:"row"},OE=["disabled"];function qE(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",NE,r(e.lang("detach")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",EE,[n("span",null,r(e.lang("are_you_sure")),1)])),a.loading?(o(),l("div",xE,[_(m,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("detach")),1)],8,OE)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const jE=P(UE,[["render",qE]]),RE={name:"product-associates-actions",description:"Contains detach button which can be used as a component as whole. It is built basically for displaying deatch button in a datable.",props:{data:{type:Object,required:!0}},data(){return{showModal:!1}},methods:{onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"product-detach":jE}},BE={class:"btn-group"};function zE(e,t,s,d,a,i){const m=u("product-detach"),h=W("tooltip");return o(),l("div",BE,[s.data.detach?S((o(),l("a",{key:0,id:"detach-button",onClick:t[0]||(t[0]=()=>a.showModal=!0),href:"javascript:;",class:"btn btn-primary"},t[1]||(t[1]=[n("i",{class:"fas fa-unlink"},null,-1)]))),[[h,e.lang("detach")]]):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(m,{key:0,onClose:i.onClose,showModal:a.showModal,detachId:s.data.id,productId:s.data.product_id,compName:s.data.compName},null,8,["onClose","showModal","detachId","productId","compName"])):c("",!0)]),_:1})])}const KE=P(RE,[["render",zE]]);const HE={name:"changes-associates-table",description:"Changes associates table page",props:{category:{type:String,default:"assets"},apiUrl:{type:String,default:""},productId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{columns:[],options:{},apiEndPoint:this.apiUrl}},beforeMount(){this.columns=this.category==="assets"?["name","managed_by","used_by","contract","action"]:["name","email","primary_contact","action"];const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),email:this.lang("email"),primary_contact:this.lang("primary_contact"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",contract:"associate-contract",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){var d=e.category==="vendors"?"vendor":e.category;let a=d=="vendor"?"":e.basePath()+"/panel";return d=="vendor"?e.h(De,{to:"/service-desk/"+d+"/"+s.id+"/show"},s.name):e.h("a",{href:a+"/service-desk/"+d+"/"+s.id+"/show",target:"_blank"},s.name)},contract:function(t,s){return s.contract?e.h("a",{href:e.basePath()+"/panel/service-desk/contracts/"+s.contract.id+"/show",target:"_blank"},s.contract.name):"--"},used_by:function(t,s){return s.used_by?e.h("a",{href:e.basePath()+"/panel/user/"+s.used_by.id,target:"_blank"},s.used_by.first_name.length>0||s.used_by.last_name.length>0?s.used_by.first_name+" "+s.used_by.last_name:s.used_by.user_name):"--"},managed_by:function(t,s){return s.managed_by?e.h("a",{href:e.basePath()+"/panel/user/"+s.managed_by.id,target:"_blank"},s.managed_by.first_name.length>0||s.managed_by.last_name.length>0?s.managed_by.first_name+" "+s.managed_by.last_name:s.managed_by.user_name):"--"},action:(t,s)=>e.h(KE,{data:s})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){let s=e.category==="assets"?"data":e.category;return{data:t.data[s].map(d=>(d.detach=!0,d.product_id=e.productId,d.compName=e.componentTitle,d)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}}};function YE(e,t,s,d,a,i){const m=u("data-table");return o(),k(m,{url:a.apiEndPoint,dataColumns:a.columns,option:a.options,scroll_to:"product-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"])}const $E=P(HE,[["render",YE]]);const WE={name:"product-associates",description:"Product associates page",props:{productId:{type:[String,Number],default:""},product:{type:Object,default:()=>{}}},data(){return{tabs:[{id:"assets",title:"associated_assets"},{id:"vendors",title:"associated_vendors"}],category:"assets",loading:!0,tabLoading:!1,disableLoader:!0}},computed:{apiUrl(){return this.category==="assets"?"/service-desk/api/asset-list?product_ids="+this.productId:"service-desk/api/product/vendor/"+this.productId},compTitle(){return this.category==="assets"?"ProductAssets":"ProductVendors"}},methods:{associates(e){this.category!==e&&(this.tabLoading=!0,this.loading=!0,this.category=e,setTimeout(()=>{this.tabLoading=!1},1))},handelLoader(e){this.loading=e}},components:{"product-associates-table":$E}},JE={id:"product-associates"},GE={class:"card card-light card-tabs"},XE={class:"card-header p-0 pt-1"},ZE={class:"nav nav-tabs",role:"tablist"},QE=["onClick"],ex={class:"nav-item ms-auto mt-04"},tx={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},sx={class:"card-body"},ax={class:"tab-content"},nx={class:"tab-pane active",role:"tabpanel"},ox={key:0};function ix(e,t,s,d,a,i){const m=u("alert"),h=u("product-associates-table");return o(),l("div",JE,[_(m,{componentName:"ProductAssociates"}),n("div",GE,[n("div",XE,[n("ul",ZE,[(o(!0),l(U,null,$(a.tabs,b=>(o(),l("li",{key:b.id,class:"nav-item"},[n("a",{id:"product_tab",onClick:f=>i.associates(b.id),class:Q(["nav-link",{active:a.category===b.id}]),"data-bs-toggle":"pill",role:"tab"},r(e.lang(b.title)),11,QE)]))),128)),n("li",ex,[a.loading?(o(),l("a",tx,t[0]||(t[0]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])])]),n("div",sx,[n("div",ax,[n("div",nx,[a.tabLoading?c("",!0):(o(),l("div",ox,[_(h,{category:a.category,componentTitle:i.compTitle,productId:s.productId,apiUrl:i.apiUrl,disableLoader:a.disableLoader,onLoaderValue:i.handelLoader},null,8,["category","componentTitle","productId","apiUrl","disableLoader","onLoaderValue"])]))])])])])])}const lx=P(WE,[["render",ix],["__scopeId","data-v-a9c38811"]]),rx={name:"product-view",description:"Product view page",data(){return{product:"",product_id:"",loading:!0}},created(){window.emitter.on("updateProductData",this.getValues)},beforeMount(){this.getValues()},methods:{getValues(){const e=window.location.pathname;this.product_id=pe(e),T.get("/service-desk/api/product/"+this.product_id).then(t=>{this.loading=!1,this.product=t.data.data.product}).catch(t=>{this.loading=!1})}},components:{"product-details":LE,"product-associates":lx}},dx={class:"col-sm-12"},cx={key:1,class:"row"};function ux(e,t,s,d,a,i){const m=u("alert"),h=u("product-details"),b=u("product-associates"),f=u("reuse-loader");return o(),l("div",dx,[_(m,{componentName:"product-view"}),a.loading?c("",!0):(o(),l(U,{key:0},[(o(),k(h,{product:a.product,key:a.product_id},null,8,["product"])),_(b,{productId:a.product_id,product:a.product},null,8,["productId","product"])],64)),a.loading?(o(),l("div",cx,[_(f,{"animation-duration":4e3,size:60})])):c("",!0)])}const mx=P(rx,[["render",ux]]);const hx={name:"procurement-type-list",description:"Procurement type lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},data:()=>({columns:["name","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/procurement-mode-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),created_at:e.lang("created-at"),updated_at:e.lang("updated-at"),action:e.lang("action")},columnsClasses:{name:"procurement-type-name",created_at:"procurement-type-created",updated_at:"procurement-type-updated"},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(qe,{data:s})},sortable:["name","created_at","updated_at"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.procurement_modes.map(s=>(s.edit_url="/service-desk/procurement/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/procurement-mode/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},px={class:"col-sm-12"},_x={class:"card card-light procurement-type-table"},fx={class:"card-header"},gx={id:"procurement-type-list",class:"card-title"},bx={class:"card-tools"},yx={class:"card-body",id:"procurement-type-table"};function vx(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",px,[_(m,{componentName:"dataTableModal"}),n("div",_x,[n("div",fx,[n("h3",gx,r(e.lang("list_of_procurements")),1),n("div",bx,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/procurement/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("add-procurement")]])])]),n("div",yx,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"procurement-type-list"},null,8,["url","dataColumns","option"])])])])}const wx=P(hx,[["render",vx]]);function kx(e){const{name:t}=e;var s={name:[t,"isRequired"]};const d=new Ue(Ce),{errors:a,isValid:i}=d.validate(s);return Fe.dispatch("setValidationError",a),{errors:a,isValid:i}}const Cx={data(){return{title:"open_new_procurment",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,procurement_type_id:"",name:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.title="edit-procurement",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,T.get("/service-desk/api/procurement-mode/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.name=t.data.data.procurement_mode.name,this.procurement_type_id=t.data.data.procurement_mode.id}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,O(t,"procurementType")})},isValid(){const{errors:e,isValid:t}=kx(this.$data);return!!t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.procurement_type_id!=""&&e.append("id",this.procurement_type_id),e.append("name",this.name);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/procurement-mode",e,t).then(s=>{this.loading=!1,K(s,"procurementType"),this.procurement_type_id||setTimeout(()=>{this.$router.push({name:"Procurement Index"})},3e3)}).catch(s=>{this.loading=!1,O(s,"procurementType")})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}},components:{"text-field":Ae}},Dx={class:"col-sm-12"},Sx={key:0,class:"row"},Mx={key:1,class:"card card-light"},Fx={class:"card-header"},Ix={class:"card-title"},Ax={class:"card-body"},Px={class:"row"},Tx={class:"card-footer"};function Vx(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("text-field"),f=W("focus-first-input");return o(),l("div",Dx,[!a.hasDataPopulated||a.loading?(o(),l("div",Sx,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"procurementType"}),a.hasDataPopulated?(o(),l("div",Mx,[n("div",Fx,[n("h3",Ix,r(e.lang(a.title)),1)]),n("div",Ax,[S((o(),l("div",Px,[_(b,{label:e.lang("name"),value:a.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",keyupListener:i.triggerEvent,required:!0},null,8,["label","value","onChange","placehold","keyupListener"])])),[[f]])]),n("div",Tx,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=g=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])])])):c("",!0)])}const Zs=P(Cx,[["render",Vx]]);const Lx={name:"contract-type-list",description:"Contract type lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},data:()=>({columns:["name","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/contract-type-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),created_at:e.lang("created-at"),updated_at:e.lang("updated-at"),action:e.lang("action")},columnsClasses:{name:"contract-type-name",created_at:"contract-type-created",updated_at:"contract-type-updated"},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(qe,{data:s})},sortable:["name","created_at","updated_at"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.contract_types.map(s=>(s.edit_url="/service-desk/contract-type/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/contract-type/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},Ux={class:"col-sm-12"},Nx={class:"card card-light contract-type-table"},Ex={class:"card-header"},xx={id:"contract-type-list",class:"card-title"},Ox={class:"card-tools"},qx={class:"card-body",id:"contract-type-table"};function jx(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",Ux,[_(m,{componentName:"dataTableModal"}),n("div",Nx,[n("div",Ex,[n("h3",xx,r(e.lang("list_of_contract_types")),1),n("div",Ox,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/contract-type/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_new_contract_type")]])])]),n("div",qx,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"contract-type-list"},null,8,["url","dataColumns","option"])])])])}const Rx=P(Lx,[["render",jx]]);const Bx={name:"license-type-list",description:"License type lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},data:()=>({columns:["name","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/license-type-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),created_at:e.lang("created_at"),updated_at:e.lang("updated_at"),action:e.lang("action")},columnsClasses:{name:"license-type-name",created_at:"license-type-created",updated_at:"license-type-updated"},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(qe,{data:s})},sortable:["name","created_at","updated_at"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.license_types.map(s=>(s.edit_url="/service-desk/license-type/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/license-type/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},zx={class:"col-sm-12"},Kx={class:"card card-light license-type-table"},Hx={class:"card-header"},Yx={id:"license-type-list",class:"card-title"},$x={class:"card-tools"},Wx={class:"card-body",id:"license-type-table"};function Jx(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",zx,[_(m,{componentName:"dataTableModal"}),n("div",Kx,[n("div",Hx,[n("h3",Yx,r(e.lang("list_of_license_types")),1),n("div",$x,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/license-type/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("add-license-type")]])])]),n("div",Wx,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"license-type-list"},null,8,["url","dataColumns","option"])])])])}const Gx=P(Bx,[["render",Jx]]);function Xx(e){const{name:t}=e;var s={name:[t,"isRequired"]};const d=new Ue(Ce),{errors:a,isValid:i}=d.validate(s);return Fe.dispatch("setValidationError",a),{errors:a,isValid:i}}const Zx={data(){return{title:"open_new_license_type",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,license_type_id:"",name:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.title="edit_license_type",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,T.get("/service-desk/api/license-type/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.name=t.data.data.license_type.name,this.license_type_id=t.data.data.license_type.id}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,O(t,"licenseType")})},isValid(){const{errors:e,isValid:t}=Xx(this.$data);return!!t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.license_type_id!=""&&e.append("id",this.license_type_id),e.append("name",this.name);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/license-type",e,t).then(s=>{this.loading=!1,K(s,"licenseType"),this.license_type_id||setTimeout(()=>{this.$router.push({name:"License Types Index"})},3e3)}).catch(s=>{this.loading=!1,O(s,"licenseType")})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}},components:{"text-field":Ae}},Qx={class:"col-sm-12"},eO={key:0,class:"row"},tO={key:1,class:"card card-light"},sO={class:"card-header"},aO={class:"card-title"},nO={class:"card-body"},oO={class:"row"},iO={class:"card-footer"};function lO(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("text-field"),f=W("focus-first-input");return o(),l("div",Qx,[!a.hasDataPopulated||a.loading?(o(),l("div",eO,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"licenseType"}),a.hasDataPopulated?(o(),l("div",tO,[n("div",sO,[n("h3",aO,r(e.lang(a.title)),1)]),n("div",nO,[S((o(),l("div",oO,[_(b,{label:e.lang("name"),value:a.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),keyupListener:i.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold","keyupListener"])])),[[f]])]),n("div",iO,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=g=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])])])):c("",!0)])}const Qs=P(Zx,[["render",lO]]);const rO={name:"vendor-list",description:"Vendor lists table component",data:()=>({columns:["name","primary_contact","mobile","email","address","status","actions"],options:{},apiUrl:"/service-desk/api/vendor-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:this.lang("name"),email:this.lang("email"),primary_contact:this.lang("primary_contact"),address:this.lang("address"),status:this.lang("status"),actions:this.lang("actions")},columnsClasses:{name:"vendor-name",email:"vendor-email",primary_contact:"vendor-contact",address:"vendor-address",mobile:"vendor-mobile"},templates:{status:(t,s)=>e.h(qn,{data:s}),actions:(t,s)=>e.h(qe,{data:s}),primary_contact(t,s){const d=s.primary_contact||"--",a=s.phone_country_code?"+"+s.phone_country_code+" ":"",i=s.ext?"-"+s.ext:"";return`${a}${d}${i}`},mobile(t,s){return s.mobile&&s.country_code?"+"+s.country_code+" "+s.mobile:s.mobile?s.mobile:"--"}},sortable:["name","primary_contact","mobile","email","address","status"],filterable:["name","primary_contact","mobile","email","address","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.vendors.map(s=>(s.view_url="/service-desk/vendor/"+s.id+"/show",s.edit_url="/service-desk/vendor/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/vendor/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},dO={class:"col-sm-12"},cO={class:"card card-light"},uO={class:"card-header"},mO={id:"vendor-list",class:"card-title"},hO={class:"card-tools"},pO={class:"card-body",id:"vendor-table"};function _O(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",dO,[_(m,{componentName:"dataTableModal"}),n("div",cO,[n("div",uO,[n("h3",mO,r(e.lang("list_of_vendors")),1),n("div",hO,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/vendor/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_vendors")]])])]),n("div",pO,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"vendor-list"},null,8,["url","dataColumns","option"])])])])}const fO=P(rO,[["render",_O]]);const gO={name:"vendor-modal",description:"Vendor Modal component",props:{showModal:{type:Boolean,default:!1},data:{type:[Object,String],default:()=>{}},title:{type:String,default:""},onClose:{type:Function}},data:()=>({containerStyle:{width:"500px"},loading:!1,isDisabled:!1}),beforeMount(){this.title!=="delete"&&(this.containerStyle.width="800px")},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete("/service-desk/api/vendor/"+this.data.id).then(e=>{K(e,"vendor-view"),this.afterRespond(),setTimeout(()=>{this.$router.push({name:"Vendor Index"})},3e3)}).catch(e=>{O(e,"vendor-view"),this.afterRespond()})},afterRespond(){this.onClose(),this.loading=!1,this.isDisabled=!0}}},bO={class:"modal-title"},yO={key:0},vO={key:0},wO={key:1,id:"log_desc"},kO=["innerHTML"],CO={key:1,class:"row"},DO=["disabled"];function SO(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return o(),l("div",null,[s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},Qt({title:w(()=>[n("h4",bO,r(e.lang(s.title)),1)]),fields:w(()=>[e.loading?c("",!0):(o(),l("div",yO,[s.title==="delete"?(o(),l("span",vO,r(e.lang("are_you_sure_you_want_to_delete")),1)):(o(),l("div",wO,[n("span",{innerHTML:s.data.description},null,8,kO)]))])),e.loading?(o(),l("div",CO,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),_:2},[s.title==="delete"?{name:"controls",fn:w(()=>[n("button",{type:"button",onClick:t[0]||(t[0]=(...b)=>i.onSubmit&&i.onSubmit(...b)),class:"btn btn-secondary",disabled:e.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("delete")),1)],8,DO)]),key:"0"}:void 0]),1032,["showModal","onClose","containerStyle"])):c("",!0)])}const MO=P(gO,[["render",SO]]);const FO={name:"vendor-associates-table",description:"Vendor associates table",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},props:{vendorId:{type:[String,Number],default:""},category:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},computed:{apiEndPoint(){return this.category==="contracts"?"/service-desk/api/vendor/contract/"+this.vendorId:"/service-desk/api/vendor/product/"+this.vendorId},columns(){return this.category==="contracts"?["name","cost","contract_start_date","contract_end_date"]:["name","manufacturer","status","department"]},options(){const e=this;return{sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),cost:e.lang("cost"),contract_start_date:e.lang("contract_start_date"),contract_end_date:e.lang("contract_end_date"),manufacturer:e.lang("manufacturer"),department:e.lang("department"),status:e.lang("status")},columnsClasses:{name:"associate-name",cost:"contract-cost",contract_start_date:"contract-start",contract_end_date:"contract-end",manufacturer:"product-manufacturer",department:"product-dept",status:"product-status"},templates:{name:function(t,s){return e.category=="contracts"?e.h("a",{href:e.basePath()+"/panel/service-desk/contracts/"+s.id+"/show",target:"_blank"},s.name):e.h(De,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},status:function(t,s){return s.product_status?e.h("span",{},[e.h("i",{class:s.product_status.icon_class,style:{color:s.product_status.icon_color,marginRight:"5px"}})],s.product_status.name):"---"},department(t,s){return s.department?s.department.name:"--"},contract_start_date(t,s){return s.contract_start_date?e.formattedTime(s.contract_start_date):"--"},contract_end_date(t,s){return s.contract_end_date?e.formattedTime(s.contract_end_date):"--"}},sortable:e.category==="contracts"?e.columns:["name","manufacturer","status"],filterable:e.columns,pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data[e.category].map(s=>s),count:t.data.total}},orderBy:{column:"name",ascending:!0}}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}}};function IO(e,t,s,d,a,i){const m=u("data-table");return o(),l("div",null,[_(m,{url:i.apiEndPoint,dataColumns:i.columns,option:i.options,scroll_to:"vendor-associates",componentTitle:"vendor-view",onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","onLoaderState","disableLoader"])])}const AO=P(FO,[["render",IO]]);const PO={name:"vendor-view",description:"Vendor details page component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{hasDataPopulated:!1,loading:!1,vendorData:"",showModal:!1,title:"",tabs:[{id:"contracts",title:"associated_contracts"},{id:"products",title:"associated_products"}],category:"contracts",tabloading:!0}},beforeMount(){const e=window.location.pathname;this.getInitialValues(e)},methods:{associates(e){this.category!==e&&(this.tabloading=!0,this.category=e)},subString(e,t=20){return Ie(e,t)},modalMethod(e){this.title=e,this.showModal=!0},getInitialValues(e){const t=pe(e);this.loading=!0,T.get("/service-desk/api/vendor/"+t).then(s=>{this.loading=!1,this.hasDataPopulated=!0,this.vendorData=s.data.data.vendor}).catch(s=>{this.loading=!1,O(s,"vendor-view"),this.hasDataPopulated=!0})},onClose(){this.showModal=!1},handelLoader(e){this.tabloading=e}},components:{"vendor-modal":MO,"vendor-associates-table":AO}},TO={class:"col-sm-12"},VO={key:0,class:"row"},LO={key:1,class:"card card-light"},UO={class:"card-header"},NO={class:"card-title"},EO={class:"card-tools"},xO={class:"card-body"},OO={class:"row mb-3"},qO={class:"col-md-12"},jO={class:"callout callout-info"},RO={class:"row"},BO={class:"col-md-4"},zO={class:"col-md-4"},KO={class:"col-md-4"},HO={class:"col-md-12"},YO={class:"row mx-1"},$O={class:"col-md-6 info-row d-flex"},WO={class:"col-md-6"},JO={class:"col-md-6"},GO={class:"text-primary"},XO={class:"col-md-6 info-row d-flex"},ZO={class:"col-md-6"},QO={class:"col-md-6"},eq={class:"text-primary"},tq={class:"col-md-6 info-row d-flex"},sq={class:"col-md-6"},aq={class:"col-md-6"},nq={class:"text-primary"},oq={class:"col-md-6 info-row d-flex"},iq={class:"col-md-6"},lq={class:"col-md-6"},rq={class:"col-md-6 info-row d-flex"},dq={class:"col-md-6"},cq={class:"col-md-6"},uq={class:"card card-light card-tabs"},mq={class:"card-header p-0 pt-1"},hq={class:"nav nav-tabs",role:"tablist"},pq=["onClick"],_q={class:"nav-item ms-auto mt-04"},fq={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},gq={class:"card-body"},bq={class:"tab-content"},yq={class:"tab-pane active",role:"tabpanel"};function vq(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("router-link"),f=u("vendor-associates-table"),g=u("vendor-modal"),D=W("tooltip");return o(),l("div",TO,[_(m,{componentName:"vendor-view"}),!a.hasDataPopulated||a.loading?(o(),l("div",VO,[_(h,{"animation-duration":4e3,size:60})])):c("",!0),a.hasDataPopulated&&a.vendorData?(o(),l("div",LO,[n("div",UO,[S((o(),l("h3",NO,[t[2]||(t[2]=n("i",{class:"fas fa-barcode","aria-hidden":"true"},null,-1)),v(" "+r(i.subString(a.vendorData.name,50)),1)])),[[D,a.vendorData.name]]),n("div",EO,[S((o(),k(b,{class:"btn btn-tool btn-tool-rounded",to:"/service-desk/vendor/"+a.vendorData.id+"/edit"},{default:w(()=>[t[3]||(t[3]=n("span",{class:"fas fa-edit"},null,-1)),v(" "+r(e.lang("edit")),1)]),_:1},8,["to"])),[[D,e.lang("edit")]]),S((o(),l("a",{class:"btn btn-tool btn-tool-rounded",onClick:t[0]||(t[0]=M=>i.modalMethod("delete")),href:"javascript:;"},[t[4]||(t[4]=n("span",{class:"fas fa-trash"},null,-1)),v(" "+r(e.lang("delete")),1)])),[[D,e.lang("delete")]])])]),n("div",xO,[n("div",OO,[n("div",qO,[n("div",jO,[n("div",RO,[n("div",BO,[n("b",null,r(e.lang("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.vendorData.created_at)),1)])),[[D,d.formattedTime(a.vendorData.created_at)]])]),n("div",zO,[n("b",null,r(e.lang("updated_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.vendorData.updated_at)),1)])),[[D,d.formattedTime(a.vendorData.updated_at)]])]),n("div",KO,[n("b",null,r(e.lang("status"))+" : ",1),S((o(),l("span",null,[v(r(i.subString(a.vendorData.status.name)),1)])),[[D,a.vendorData.status.name]])])])])])]),n("div",HO,[n("div",YO,[n("div",$O,[n("div",WO,[n("label",null,r(e.lang("email")),1)]),n("div",JO,[S((o(),l("a",GO,[v(r(i.subString(a.vendorData.email)),1)])),[[D,a.vendorData.email]])])]),n("div",XO,[n("div",ZO,[n("label",null,r(e.lang("primary_contact")),1)]),n("div",QO,[S((o(),l("a",eq,[v(r(a.vendorData.phone_country_code&&a.vendorData.primary_contact?"+"+a.vendorData.phone_country_code+" "+a.vendorData.primary_contact+" "+(a.vendorData.ext?"-"+a.vendorData.ext:""):a.vendorData.primary_contact?a.vendorData.primary_contact+" "+(a.vendorData.ext?"-"+a.vendorData.ext:""):"--"),1)])),[[D,a.vendorData.primary_contact]])])]),n("div",tq,[n("div",sq,[n("label",null,r(e.lang("mobile")),1)]),n("div",aq,[S((o(),l("a",nq,[v(r(a.vendorData.mobile&&a.vendorData.mobile?"+"+a.vendorData.country_code+" "+a.vendorData.mobile:a.vendorData.mobile||"--"),1)])),[[D,a.vendorData.mobile]])])]),n("div",oq,[n("div",iq,[n("label",null,r(e.lang("address")),1)]),n("div",lq,[S((o(),l("a",null,[v(r(i.subString(a.vendorData.address)),1)])),[[D,a.vendorData.address]])])]),n("div",rq,[n("div",dq,[n("label",null,r(e.lang("description")),1)]),n("div",cq,[n("button",{type:"button",class:"btn btn-info btn-sm",onClick:t[1]||(t[1]=M=>i.modalMethod("vendor_description"))},[t[5]||(t[5]=n("i",{class:"fas fa-file-code"},null,-1)),v(" "+r(e.lang("show_description")),1)])])])])])])])):c("",!0),n("div",null,[n("div",uq,[n("div",mq,[n("ul",hq,[(o(!0),l(U,null,$(a.tabs,M=>(o(),l("li",{key:M.id,class:"nav-item"},[n("a",{id:"vendor_tab",onClick:x=>i.associates(M.id),class:Q(["nav-link",{active:a.category===M.id}]),"data-bs-toggle":"pill",role:"tab"},r(e.lang(M.title)),11,pq)]))),128)),n("li",_q,[a.tabloading?(o(),l("a",fq,t[6]||(t[6]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])])]),n("div",gq,[n("div",bq,[n("div",yq,[_(f,{category:a.category,vendorId:a.vendorData.id,disableLoader:"true",onLoaderValue:i.handelLoader},null,8,["category","vendorId","onLoaderValue"])])])])])]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(g,{key:0,onClose:i.onClose,showModal:a.showModal,data:a.vendorData,title:a.title},null,8,["onClose","showModal","data","title"])):c("",!0)]),_:1})])}const wq=P(PO,[["render",vq],["__scopeId","data-v-3e355e78"]]);const kq={name:"asset-type-lists",description:"Asset type lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},data:()=>({columns:["name","parent","created_at","action"],options:{},apiUrl:"service-desk/api/asset-type-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),parent:e.lang("parent"),created_at:e.lang("created_at"),action:e.lang("action")},columnsClasses:{name:"assets-type-name",is_default:"Default",parent:"parent",created_at:"assets-type-created"},templates:{created_at(t,s){return e.formattedTime(s.created_at)},parent(t,s){return s.parent?s.parent.name:"--"},action:(t,s)=>e.h(qe,{data:s})},sortable:["name","created_at"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.asset_types.map(s=>(s.edit_url="/service-desk/asset-type/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/asset-type/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},Cq={class:"col-sm-12"},Dq={class:"card card-light assets-type-table"},Sq={class:"card-header"},Mq={id:"asset-type-list",class:"card-title"},Fq={class:"card-tools"},Iq={class:"card-body",id:"assets-type-table"};function Aq(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",Cq,[_(m,{componentName:"dataTableModal"}),n("div",Dq,[n("div",Sq,[n("h3",Mq,r(e.lang("asset_type_lists-page-title")),1),n("div",Fq,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/asset-type/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_asset_type")]])])]),n("div",Iq,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"asset-type-lists"},null,8,["url","dataColumns","option"])])])])}const Pq=P(kq,[["render",Aq],["__scopeId","data-v-3e62e4f8"]]);const Tq={class:"col-sm-12"},Vq={class:"card card-light shadow-none"},Lq={class:"card-header sticky-top menu-border sticky-top-menu"},Uq={key:1,class:"card-title"},Nq={key:2,class:"card-tools"},Eq={class:"card-body p-0 pt-2 bg-light"},xq={class:"row"},Oq={class:"col-sm-3"},qq={class:"card sticky-top sticky-fields"},jq={class:"card-body p-2"},Rq={class:"row"},Bq={key:0,class:"col-12"},zq={class:"nav nav-tabs",role:"tablist"},Kq={class:"nav-item"},Hq={class:"col-sm-9"},Yq={key:0,class:"card"},$q={class:"card-body row"},Wq={key:0,class:"form-group col-md-12",id:"text"},Jq={class:"label_align1"},Gq=["name","checked"],Xq={class:"ms-3"},Zq={class:"card"},Qq={class:"card-body p-2"},ej={key:0,class:"row no-drag-form-card"},tj={class:"text-center pt-4 no-drag-fields"},sj=["src"],aj={class:"modal-title"},nj={__name:"ModuleBuilder",props:{auth:{type:Object,default:()=>({})},formMode:{type:String,default:""},formNameObj:{type:Object,default:()=>({})},formCheckbox:{type:Object,default:()=>({})},formLinker:{type:Array,default:()=>[]},editFormApi:{type:String,default:""},postFromApi:{type:String,default:""},formCategoryType:{type:String,default:""},pageHeading:{type:String,default:"form"},editFormId:{type:[String,Number],default:""},editResponseKey:{type:String,default:""},routeModuleName:{type:String,default:""}},setup(e){const t=re(),s=ha(),d=Sn(),{basePathVersion:a}=us.methods;let i=e;const m=se(""),h=se(!0),b=se(!1),f=se(!1),g=se(!1),D=se(!1),M=se("fields");let x=se({}),R=se({}),V=se([]);const N=se(!1),j=se(""),Y=se(""),ae=se("");Qe(()=>{x.value=i.formNameObj,R.value=i.formCheckbox,V.value=i.formLinker,i.formMode==="create"&&(x.value.value="",R.value.value=!1,V.value=V.value.map(B=>({...B,value:""}))),ne()});const ne=()=>{i.formMode==="create"?(g.value=!0,f.value=!0,x.value.value="",R.value.value=0,V.value.forEach((B,ee)=>{B.value=""}),h.value=!1):i.formMode==="edit"&&(D.value=!0,h.value=!1),m.value=i.formCategoryType,_e(),Oe()},_e=()=>{T.get("api/get-form-menu/"+m.value).then(B=>{t.commit("updateFormMenu",B.data.data),b.value=!0})},Oe=()=>{ve().then(B=>{D.value&&(x.value.value=B.data.data[i.editResponseKey][x.value.id]?B.data.data[i.editResponseKey][x.value.id]:"",R.value.value=B.data.data[i.editResponseKey][R.value.id]?B.data.data[i.editResponseKey][R.value.id]:"",V.value.forEach(ee=>{ee.value=B.data.data[i.editResponseKey][ee.id]?B.data.data[i.editResponseKey][ee.id]:""})),f.value=!0})},ve=()=>{h.value=!0,t.commit("updateFormCategoryType",m.value);let B="/field-manager-section",ee={category:i.formCategoryType,page:"config"};return D.value&&(B=i.editFormApi,ee.config=!1),T.get(B,{params:ee}).then(ce=>(t.commit("updateFormSections",i.formMode==="create"?ce.data.data:ce.data.data[i.editResponseKey].nodes),h.value=!1,ce)).catch(ce=>{h.value=!1,O(ce,"form-builder-main")})},Pe=async()=>{if(Ke()){const B=t.getters.getFormSections;it(B),await Vt(B)}},Ke=()=>{if(g.value||D.value){const{errors:B,isValid:ee}=Hn(i);return ee}else return!0},it=B=>{for(let ee=0;ee<B.length;ee++){const ce=B[ee];ce.sort_order=ee,ce.form_fields&&typeof ce.form_fields=="object"?Object.keys(ce.form_fields).forEach(ke=>{const ge=ce.form_fields[ke];for(let Me=0;Me<ge.length;Me++)ge[Me].sort_order=Me;it(ge)}):Object.keys(B[ee]).forEach(ke=>{Re(B[ee][ke])&&Array.isArray(B[ee][ke])&&it(B[ee][ke])})}},Vt=async B=>{try{h.value=!0;const ee=B.filter(ge=>{if(ge.data_type==="section"){const Me=ge.form_fields.first?ge.form_fields.first.length===0:!1,lt=ge.form_fields.second?ge.form_fields.second.length===0:!1;return!(Me&&lt||Me&&!ge.form_fields.second||!ge.form_fields.first&&lt)}return!0}),ce=ye(),ke=await Se(ce,ee);et(ke)}catch(ee){Le(ee)}},ye=()=>g.value||D.value?i.postFromApi:"post/form-fields",Se=async(B,ee)=>{let ce=Ve(ee);return await T.post(B,me(ce))},Ve=B=>{for(let ee=0;ee<B.length;ee++)if(B[ee].form_fields&&typeof B[ee].form_fields=="object"&&!Array.isArray(B[ee].form_fields)){const ce=B[ee].form_fields.first||[],ke=B[ee].form_fields.second||[];ce.forEach(ge=>{ge.column="first"}),ke.forEach(ge=>{ge.column="second"}),B[ee].form_fields=ce.concat(ke),B[ee].form_fields.forEach(ge=>{Re(ge.options)&&ge.options.forEach(Me=>{Ve(Me.nodes?Me.nodes:[])})})}else Re(B[ee].options)&&B[ee].options.forEach(ce=>{Ve(ce.nodes?ce.nodes:[])});return B},me=B=>{let ee={};return ee.category=i.formCategoryType,ee.id=d.params.id,ee.is_clone=1,ee.is_delete=0,ee.form_sections=B,(g.value||D.value)&&(ee[x.value.submitFormParamKey]=x.value.value,ee[R.value.submitFormParamKey]=R.value.value,V.value.forEach(ce=>{ee[ce.submitFormParamKey]=ce.value?ce.value.id:""})),D.value&&(ee.id=i.editFormId),ee},et=B=>{K(B,"form-builder-main"),g.value||D.value?Dt():Be()},Dt=()=>{h.value=!1,i.formMode==="create"?setTimeout(()=>{s.push({name:i.routeModuleName})},3e3):Be()},Be=()=>{ve().then(()=>{h.value=!1})},Le=B=>{h.value=!1,O(B,"form-builder-main")};let pt=se(!1),Lt=se(null);const St=()=>{pt.value=!1,Lt.value=null},ze=({data:B})=>{pt.value=!1,Lt.value=B,setTimeout(()=>{pt.value=!0},0)},_t=z({get(){return t.getters.getFormSections},set(B){t.dispatch("updateFormSections",B)}}),jt=async B=>{const ee=t.getters.getFormSections;await ft(ee,B.form_identifier,B)&&await t.dispatch("updateFormSections",ee),St(),window.emitter.emit("updateNestedObjects")},ft=(B,ee,ce)=>{let ke=Ts.findIndex(B,ge=>ge.form_identifier===ee);if(ke!==-1)B[ke]=ce;else for(let ge=0;ge<B.length;ge++)B[ge].form_fields&&typeof B[ge].form_fields=="object"?Object.keys(B[ge].form_fields).forEach(Me=>{ft(B[ge].form_fields[Me],ee,ce)}):Re(B[ge].options)&&B[ge].options.forEach(Me=>{ft(Me.nodes?Me.nodes:[],ee,ce)});return new Promise(ge=>{ge(!0)})},Rt=B=>{N.value=!0,j.value=B.reference_type,Y.value=B.fieldData,ae.value=B.reference_id},tt=()=>{N.value=!1,ns(Y.value)?Bt(Y.value.id,ae.value,j.value,Y.value):as(Y.value.form_identifier,Y.value)},as=(B,ee)=>{const ce=t.getters.getFormSections;Ut(ce,B)&&(t.dispatch("updateFormFields",ce),window.emitter.emit("updateNestedObjects"),window.emitter.emit("updateMenuCount",{field:ee,from:"local"}))},Bt=(B,ee,ce,ke)=>{h.value=!0;let ge=Y.value.data_type==="section"?"/remove/form-sections/"+B:"/remove/form-fields/"+B;ee&&(ge="api/unlink-form-group/"+ce+"/"+ee),T.delete(ge).then(Me=>{K(Me,"form-builder-main"),f.value=!1,ve().then(()=>{f.value=!0}),window.emitter.emit("updateNestedObjects"),window.emitter.emit("updateMenuCount",{field:ke,from:"db"}),h.value=!1}).catch(Me=>{h.value=!1,O(Me,"form-builder-main")})},ns=B=>B.type==="group"?typeof B.groupid>"u":B.id.toString().length<13,Ut=(B,ee)=>{let ce=Ts.findIndex(B,ke=>ke.form_identifier===ee);if(ce!==-1)B.splice(ce,1);else for(let ke=0;ke<B.length;ke++)B[ke].form_fields&&typeof B[ke].form_fields=="object"?Object.keys(B[ke].form_fields).forEach(ge=>{Ut(B[ke].form_fields[ge],ee)}):Re(B[ke].options)&&B[ke].options.forEach(ge=>{Ut(ge.nodes?ge.nodes:[],ee)});return Promise.resolve(!0)},zt=()=>{f.value=!1,ve().then(()=>{f.value=!0}),h.value=!1,St()};return window.emitter.on("formFieldSettingsApplied",jt),window.emitter.on("onRemoveElement",Rt),window.emitter.on("getFormDataFromServer",ve),window.emitter.on("onEditElement",ze),window.emitter.on("formLangRemoved",St),window.emitter.on("formLangRemovedInDb",zt),(B,ee)=>(o(),l("div",Tq,[_(We,{"component-name":"form-builder-main"}),n("div",Vq,[n("div",Lq,[h.value?(o(),k(nt,{key:0})):c("",!0),f.value&&b.value?(o(),l("h3",Uq,r(B.trans(e.pageHeading)),1)):c("",!0),f.value&&b.value?(o(),l("div",Nq,[n("button",{class:"btn btn-primary form-save-btn float-end form_save_btn",onClick:ee[0]||(ee[0]=ce=>Pe())},[ee[3]||(ee[3]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(B.trans("save")),1)])])):c("",!0)]),n("div",Eq,[n("div",xq,[n("div",Oq,[n("div",qq,[n("div",jq,[n("div",Rq,[b.value?(o(),l("div",Bq,[n("ul",zq,[n("li",Kq,[n("a",{class:Q(["nav-link",M.value==="fields"?"active fw-bold":""]),href:"javascript:;","data-bs-toggle":"pill",role:"tab"},r(B.trans("formfields")),3)])]),(o(),k(Bn,{key:M.value,type:M.value},null,8,["type"]))])):c("",!0)])])])]),f.value&&b.value?(o(),l(U,{key:0},[n("div",Hq,[g.value||D.value?(o(),l("div",Yq,[n("div",$q,[_(Ae,{id:we(x).id,classname:we(x).className,label:B.trans(we(x).label),value:we(x).value,type:"text",name:we(x).id,onChange:ce=>we(x).value=ce,placehold:B.trans(we(x).placeholder),required:!0},null,8,["id","classname","label","value","name","onChange","placehold"]),(o(!0),l(U,null,$(we(V),ce=>(o(),k(fe,{key:ce.id,id:ce.id,name:ce.submitFormParamKey,classname:ce.className,apiEndpoint:ce.apiEndpoint,label:B.trans(ce.label),value:ce.value,required:!1,multiple:ce.multiple,onChange:ke=>ce.value=ke},null,8,["id","name","classname","apiEndpoint","label","value","multiple","onChange"]))),128)),we(R)&&we(R).id?(o(),l("div",Wq,[n("label",Jq,[n("input",{class:"checkbox_align",type:"checkbox",name:we(R).id,onChange:ee[1]||(ee[1]=ce=>we(R).value=ce.target.checked===!0),checked:we(R).value===!0},null,40,Gq),v(" "+r(B.lang(we(R).label))+" ",1),n("span",Xq,[_(Ot,{message:B.lang(we(R).hint),size:"small"},null,8,["message"])])])])):c("",!0)])])):c("",!0),n("div",Zq,[n("div",Qq,[_(zn,{sections:_t.value,auth:e.auth,isFormGroup:g.value||D.value},null,8,["sections","auth","isFormGroup"]),_t.value.length?c("",!0):(o(),l("div",ej,[n("div",tj,[n("img",{src:we(a)()+"/themes/default/common/images/drag.png",alt:"form-no-drag",class:"no-drag-img"},null,8,sj),n("h5",null,r(B.trans("drag_elements_here")),1),n("p",null,r(B.trans("drag_an_element_from_the_left")),1)])]))])])]),we(pt)?(o(),k(Kn,{key:0,fieldData:we(Lt),isShowSettingModal:we(pt),onCloseSettingModal:St,auth:e.auth},null,8,["fieldData","isShowSettingModal","auth"])):c("",!0)],64)):c("",!0)])])]),_(X,{name:"modal"},{default:w(()=>[N.value?(o(),k(Xt,{key:0,showModal:!0,onClose:()=>N.value=!1,containerStyle:{width:"400px"}},{title:w(()=>[n("h4",aj,r(B.trans("delete")),1)]),fields:w(()=>[n("span",null,r(B.trans("are_you_sure_you_want_to_delete")),1)]),controls:w(()=>[n("button",{id:"approval-action-confirm",type:"button",onClick:ee[2]||(ee[2]=ce=>tt()),class:"btn btn-secondary"},[ee[4]||(ee[4]=n("i",{class:"fas fa-trash-alt","aria-hidden":"true"},null,-1)),v(" "+r(B.trans("confirm")),1)])]),_:1},8,["onClose"])):c("",!0)]),_:1})]))}},oj=P(nj,[["__scopeId","data-v-e9093c7c"]]),ea={__name:"AssetTypeCreateEdit",setup(e){const t=se({id:"name",className:"col-md-6",label:"name",placeholder:"name",value:"",submitFormParamKey:"name"}),s=se([{id:"parent",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/asset_types",label:"parent",value:"",submitFormParamKey:"parent_id",multiple:!1}]),d=se({id:"is_default",className:"col-md-6",value:!1,label:"make_default_asset_type",hint:"make_default_asset_type_tooltip",submitFormParamKey:"is_default"}),a=se("new"),i=se("create"),m=se(""),h=se(null),b=se("asset_types.index"),f=g=>{g.indexOf("edit")>=0&&(a.value="edit_assetstypes",i.value="edit",m.value=pe(g),h.value="/service-desk/api/asset-type/"+m.value,b.value="asset_types.edit")};return Qe(()=>{const g=window.location.pathname;f(g)}),(g,D)=>(o(),k(oj,{formCategoryType:"asset",pageHeading:a.value,formMode:i.value,"form-checkbox":d.value,"post-from-api":"/service-desk/api/asset-type","form-name-obj":t.value,"form-linker":s.value,editFormApi:h.value,editFormId:m.value,editResponseKey:"asset_type",routeModuleName:b.value},null,8,["pageHeading","formMode","form-checkbox","form-name-obj","form-linker","editFormApi","editFormId","routeModuleName"]))}};const ij={name:"change-type-lists",components:{DataTableActions:qe},description:"Change type lists table component",setup(){const e=re(),t=z(()=>e.getters.formattedTime),s=se(["name","updated_at","action"]),d="service-desk/api/change-type-list",a=se({}),i=m=>vn(qe,{data:m});return Qe(m=>{a.value={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:Ce("name"),updated_at:Ce("updated_at"),action:Ce("action")},columnsClasses:{name:"changes-type-name",is_default:"Default",parent:"parent",updated_at:"changes-type-created",actions:"actions"},templates:{updated_at(h,b){return t.value(b.updated_at)},parent(h,b){return b.parent?b.parent.name:"--"},action(h,b){return i(b)}},sortable:["name","updated_at"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(h){return{"sort-field":h.orderBy?h.orderBy:"id","sort-order":h.ascending?"desc":"asc","search-query":h.query,page:h.page,limit:h.limit}},responseAdapter({data:h}){return{data:h.data.change_types.map(b=>(b.edit_url="/service-desk/change-type/"+b.id+"/edit",b.delete_url="/service-desk/api/change-type/"+b.id,b)),count:h.data.total}},orderBy:{column:"id",ascending:!0}}}),{columns:s,apiUrl:d,options:a}}},lj={class:"col-sm-12"},rj={class:"card card-light changes-type-table"},dj={class:"card-header"},cj={id:"change-type-list",class:"card-title"},uj={class:"card-tools"},mj={class:"card-body",id:"changes-type-table"};function hj(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",lj,[_(m,{componentName:"dataTableModal"}),n("div",rj,[n("div",dj,[n("h3",cj,r(e.lang("change_type_lists-page-title")),1),n("div",uj,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/change-type/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,{content:e.lang("create_change_type"),placement:"left"}]])])]),n("div",mj,[_(b,{url:d.apiUrl,dataColumns:d.columns,option:d.options,scroll_to:"change-type-lists"},null,8,["url","dataColumns","option"])])])])}const pj=P(ij,[["render",hj],["__scopeId","data-v-a8537f92"]]);function _j(e){const{name:t}=e;var s={name:[t,"isRequired"]};const d=new Ue(Ce),{errors:a,isValid:i}=d.validate(s);return Fe.dispatch("setValidationError",a),{errors:a,isValid:i}}const fj={setup(){re();const e=ha(),t=se("new_changes"),s=se("fas fa-save"),d=se("save"),a=se(!1),i=se(!1),m=se(!1),h=se(""),b=se(""),f=se(!1);Qe(()=>{const j=window.location.pathname;g(j)});const g=j=>{const Y=pe(j);j.includes("edit")?(t.value="edit_changestypes",s.value="fas fa-sync",d.value="update",a.value=!1,D(Y)):(m.value=!1,a.value=!0,f.value=!1)},D=j=>{m.value=!0,T.get(`/service-desk/api/change-type/${j}`).then(Y=>{m.value=!1,a.value=!0;const ae=Y.data.data.change_type;b.value=ae.id,f.value=ae.is_default,h.value=ae.name}).catch(Y=>{m.value=!1,a.value=!0,O(Y,"changestypes")})},M=()=>{const{errors:j,isValid:Y}=_j({title:t.value,btnName:d.value,hasDataPopulated:a.value,name:h.value,make_default:f.value});return Y},x=(j,Y)=>{h.value=j||""},R=j=>{f.value=j.target.checked},V=()=>{if(M()){m.value=!0;const j=new FormData;b.value!==""&&j.append("id",b.value),j.append("name",h.value),j.append("is_default",f.value);const Y={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/change-type",j,Y).then(ae=>{m.value=!1,K(ae,"changestypes"),b.value?D(b.value):setTimeout(()=>{e.push({name:"Change Type"})},3e3)}).catch(ae=>{m.value=!1,O(ae,"changestypes")})}};return{title:t,iconClass:s,btnName:d,hasDataPopulated:a,shouldShowLoader:i,loading:m,name:h,changeTypeId:b,make_default:f,getValues:g,getInitialValues:D,isValid:M,onChange:x,changeDefault:R,onSubmit:V,triggerEvent:j=>{j.key==="Enter"&&V()}}},components:{"dynamic-select":fe,"text-field":Ae,"tool-tip":Ot}},gj={class:"col-sm-12"},bj={key:0},yj={key:1,class:"card card-light"},vj={class:"card-header"},wj={class:"card-title"},kj={class:"card-body"},Cj={class:"row"},Dj={class:"row"},Sj={class:"form-group col-md-12",id:"text"},Mj={class:"label_align1"},Fj=["keyupListener","checked"],Ij={class:"ms-3"},Aj={class:"card-footer"};function Pj(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("text-field"),f=u("ToolTip"),g=W("focus-first-input");return o(),l("div",gj,[d.shouldShowLoader?(o(),l("div",bj,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"changestypes"}),d.hasDataPopulated?(o(),l("div",yj,[n("div",vj,[n("h3",wj,r(e.lang(d.title)),1)]),n("div",kj,[S((o(),l("div",Cj,[_(b,{label:e.lang("name"),value:d.name,type:"text",name:"name",onChange:d.onChange,keyupListener:d.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","keyupListener"])])),[[g]]),n("div",Dj,[n("div",Sj,[n("label",Mj,[n("input",{class:"checkbox_align me-1",type:"checkbox",name:"default",onChange:t[0]||(t[0]=(...D)=>d.changeDefault&&d.changeDefault(...D)),keyupListener:d.triggerEvent,checked:d.make_default},null,40,Fj),v(r(e.lang("make_default_change_type"))+" ",1),n("span",Ij,[_(f,{message:e.lang("make_default_change_type_tooltip"),size:"medium"},null,8,["message"])])])])])]),n("div",Aj,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[1]||(t[1]=(...D)=>d.onSubmit&&d.onSubmit(...D))},[n("i",{class:Q(d.iconClass)},null,2),v(" "+r(e.lang(d.btnName)),1)])])])):c("",!0)])}const ta=P(fj,[["render",Pj],["__scopeId","data-v-ee9c5bd4"]]);const Tj={name:"asset-status-index",description:"Asset Status Index Component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},data(){return{apiUrl:"/service-desk/api/asset-status-list",columns:["name","created_at","updated_at","action"],options:{}}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},columnsClasses:{name:"asset-status-name",created_at:"asset-status-created",updated_at:"asset-status-updated",action:"asset-status-action"},texts:{filter:"",limit:""},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(qe,{data:s})},sortable:["name","created_at","updated_at"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(s=>(s.edit_url="/service-desk/asset-status/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/asset-status/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},Vj={id:"asset_status_list",class:"col-sm-12"},Lj={class:"card card-light"},Uj={class:"card-header"},Nj={class:"card-title"},Ej={class:"card-tools"},xj={class:"card-body",id:"asset_status_table"};function Oj(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",Vj,[_(m,{componentName:"dataTableModal"}),n("div",Lj,[n("div",Uj,[n("h3",Nj,r(e.trans("list_of_asset_statuses")),1),n("div",Ej,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/asset-status/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.trans("create_asset_status")]])])]),n("div",xj,[_(b,{url:a.apiUrl,dataColumns:a.columns,option:a.options,scroll_to:"asset_status_list"},null,8,["url","dataColumns","option"])])])])}const qj=P(Tj,[["render",Oj]]);function jj(e){const{name:t,description:s}=e;var d={name:[t,"isRequired",{"max(50)":Ce("name_should_be_less_than_50_characters")}],description:[s,"isRequired"]};const a=new Ue(Ce),{errors:i,isValid:m}=a.validate(d);return Fe.dispatch("setValidationError",i),{errors:i,isValid:m}}const Rj={data(){return{title:"create_asset_status",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,asset_status_id:"",name:"",description:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.title="edit_asset_status",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,T.get("/service-desk/api/asset-status/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.name=t.data.data.asset_status.name,this.description=t.data.data.asset_status.description,this.asset_status_id=t.data.data.asset_status.id}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,O(t,"assetStatus")})},isValid(){const{errors:e,isValid:t}=jj(this.$data);return t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.asset_status_id!=""&&e.append("id",this.asset_status_id),e.append("name",this.name),e.append("description",this.description);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/asset-status",e,t).then(s=>{this.loading=!1,K(s,"assetStatus"),this.asset_status_id||setTimeout(()=>{this.$router.push({name:"Asset Statuses Index"})},3e3)}).catch(s=>{this.loading=!1,O(s,"assetStatus")})}}},components:{"text-field":Ae}},Bj={class:"col-sm-12"},zj={key:0,class:"row"},Kj={key:1,class:"card card-light"},Hj={class:"card-header"},Yj={class:"card-title"},$j={class:"card-body"},Wj={class:"row"},Jj={class:"row"},Gj={class:"card-footer"};function Xj(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("text-field"),f=u("tiny-editor"),g=W("focus-first-input");return o(),l("div",Bj,[!a.hasDataPopulated||a.loading?(o(),l("div",zj,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"assetStatus"}),a.hasDataPopulated?(o(),l("div",Kj,[n("div",Hj,[n("h3",Yj,r(e.trans(a.title)),1)]),n("div",$j,[S((o(),l("div",Wj,[_(b,{label:e.trans("name"),value:a.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"])])),[[g]]),n("div",Jj,[_(f,{value:a.description,type:"text",id:"asset-status-editor",onChange:i.onChange,name:"description",label:e.trans("description"),classname:"col-sm-12",required:!0,lang:"en"},null,8,["value","onChange","label"])])]),n("div",Gj,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=D=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.trans(a.btnName)),1)])])])):c("",!0)])}const sa=P(Rj,[["render",Xj]]);const Zj={name:"cab-index",description:"Cab table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{columns:["name","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/cab"}},beforeMount(){const e=this;this.options={texts:{filter:"",limit:""},headings:{name:e.lang("name"),created_at:e.lang("created-at"),updated_at:e.lang("updated-at"),action:e.lang("action")},columnsClasses:{name:"cab-name",created_at:"cab-created",updated_at:"cab-updated",action:"cab-action"},templates:{action:(t,s)=>e.h(qe,{data:s}),created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)}},sortable:["name","created_at","updated_at"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{sort_by:t.orderBy?t.orderBy:"id",order:t.ascending?"desc":"asc",search:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(s=>(s.view_url="/service-desk/cab/"+s.id+"/show",s.edit_url="/service-desk/cab/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/cab/"+s.id+"/workflow/",s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},Qj={id:"cab-index",class:"col-sm-12"},eR={class:"card card-light"},tR={class:"card-header"},sR={class:"card-title"},aR={class:"card-tools"},nR={class:"card-body",id:"cab-table"};function oR(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",Qj,[_(m,{componentName:"dataTableModal"}),n("div",eR,[n("div",tR,[n("h3",sR,r(e.lang("list_of_cabs")),1),n("div",aR,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/cab/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_cab")]])])]),n("div",nR,[a.apiUrl!==""?(o(),k(b,{key:0,url:a.apiUrl,dataColumns:a.columns,option:a.options,scroll_to:"cab-index"},null,8,["url","dataColumns","option"])):c("",!0)])])])}const iR=P(Zj,[["render",oR]]);function lR(e){const{name:t,levels:s,send_auto_reminders:d,reminder_interval:a}=e;let i={name:[t,"isRequired"]};e.send_auto_reminders&&(i.reminder_interval=[e.reminder_interval,"isRequired"]);let m,h;s.map((g,D)=>{i["level-name-"+D]=[g.name,"isRequired"],i["level-match-"+D]=[g.match,"isRequired"],m=rR(g.approvers.users,g.approvers.user_types,D)});const f=new Ue(Ce).validate(i);return h=f.errors,m=m&&f.isValid,Fe.dispatch("setValidationError",h),{errors:h,isValid:m}}function rR(e,t,s){let d=0;if(e.length==0&&t.length==0){let a=Ce("atleast_one_user_or_one_user_type_is_required_to_create_cab");d++,Fe.dispatch("setAlert",{type:"danger",message:a,component_name:"cab-level-"+s})}return!(d>0)}const dR={name:"cab-create-edit",description:"handles create/edit part of cab",data(){return{title:"create_cab",btnName:"save",iconClass:"fas fa-save",id:0,name:"",action_on_approve:"",action_on_deny:"",levels:[{id:0,name:"",order:1,match:"all",approvers:{users:[],user_types:[]}}],loading:!1,showDeletePopUp:!1,matcherOptions:[{id:"any",name:"Any"},{id:"all",name:"All"}],hasDataPopulated:!0,deletingLevelIndex:null,deletingLevelId:null,containerStyle:{width:"500px"},send_auto_reminders:0,radioOptions:[{name:"yes",value:1},{name:"no",value:0}],reminder_interval:"",reminderOptions:[{id:1,name:"1 Hour"},{id:4,name:"4 Hours"},{id:8,name:"8 Hours"},{id:12,name:"12 Hours"},{id:24,name:"24 Hours"}]}},mounted(){const e=window.location.pathname,t=pe(e);e.indexOf("edit")>=0&&(this.hasDataPopulated=!1,this.title="edit_cab",this.btnName="update",this.iconClass="fas fa-sync",this.getInitialValues(t))},methods:{loadCabData(){const e=window.location.pathname,t=pe(e);e.indexOf("edit")>=0&&this.getInitialValues(t)},getInitialValues(e){this.loading=!0,T.get("/service-desk/api/cab/"+e).then(t=>{this.id=t.data.data.id,this.name=t.data.data.name,this.action_on_approve=t.data.data.action_on_approve,this.action_on_deny=t.data.data.action_on_deny,this.send_auto_reminders=t.data.data.send_auto_reminders,this.reminder_interval=t.data.data.reminder_interval?t.data.data.reminder_interval:"",this.levels=t.data.data.levels,this.loading=!1,this.hasDataPopulated=!0}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0})},addLevel(){this.levels.push({id:0,name:"",order:this.levels.length+1,match:"all",approvers:{users:[],user_types:[]}}),this.scrollToSubmitButton()},scrollToSubmitButton(){let e=document.getElementById("submit-cab");setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},2)},onChange(e,t){let s=t.split("-");s.length==1&&(this[t]=e);let d=s[s.length-1];t.includes("level-name-")&&(this.levels[d].name=e),t.includes("cab-user-type-")&&(this.levels[d].approvers.user_types=e),t.includes("cab-agent-")&&(this.levels[d].approvers.users=e),t.includes("level-match-")&&(this.levels[d].match=e)},isValid(){const{errors:e,isValid:t}=lR(this.$data);return!!t},onSubmit(){if(this.isValid()){this.loading=!0;const e={};e.id=this.id,e.name=this.name,e.levels=this.getFormattedLevelData(),e.action_on_approve=this.action_on_approve?this.action_on_approve.id:"",e.action_on_deny=this.action_on_deny?this.action_on_deny.id:"",e.send_auto_reminders=this.send_auto_reminders,this.send_auto_reminders?e.reminder_interval=this.reminder_interval:e.reminder_interval="",T.post("/service-desk/api/cab",e).then(t=>{K(t,"cab"),this.loading=!1,window.location.pathname.indexOf("edit")>=0?this.loadCabData():setTimeout(()=>{let s=t.data.data.id;this.$router.push("/service-desk/cab/"+s+"/show")},3e3)}).catch(t=>{O(t,"cab"),this.loading=!1})}},getFormattedLevelData(){return this.$data.levels.map(t=>({id:t.id,name:t.name,order:t.order,match:t.match,approvers:{users:Vs(t.approvers.users),user_types:Vs(t.approvers.user_types)}}))},onDelete(){this.deletingLevelId!=0&&(this.loading=!0,T.delete("/service-desk/api/cab/"+this.deletingLevelId+"/level").then(e=>{K(e,"cab"),this.loadCabData(),this.loading=!1}).catch(e=>{O(e,"cab")})),this.levels.splice(this.deletingLevelIndex,1),this.showDeletePopUp=!1},deleting(e,t){this.deletingLevelIndex=e,this.deletingLevelId=t,this.showDeletePopUp=!0}},watch:{showDeletePopUp(e){e||(this.deletingLevelIndex=null,this.deletingLevelId=null)}},components:{"text-field":Ae,"dynamic-select":fe,"static-select":qt,"radio-button":mt}},cR={class:"col-sm-12"},uR={class:"modal-title"},mR=["id"],hR={key:1,class:"row"},pR={key:2,class:"card card-light"},_R={class:"card-header"},fR={class:"card-title"},gR={class:"card-body"},bR={class:"row",id:"cab-name"},yR={key:0,class:"row"},vR={id:"list-of-levels"},wR={class:"card card-light"},kR={class:"card-header"},CR={class:"card-title"},DR={class:"card-tools"},SR=["id","onClick"],MR={class:"card-body"},FR={class:"row"},IR=["id"],AR={class:"card-footer"},PR=["disabled"];function TR(e,t,s,d,a,i){const m=u("alert"),h=u("modal"),b=u("custom-loader"),f=u("text-field"),g=u("dynamic-select"),D=u("radio-button"),M=u("static-select"),x=W("focus-first-input"),R=W("tooltip");return o(),l("div",cR,[_(m,{componentName:"cab"}),a.showDeletePopUp?(o(),k(h,{key:0,showModal:!0,onClose:()=>a.showDeletePopUp=!1,containerStyle:a.containerStyle},{title:w(()=>[n("h4",uR,r(e.trans("delete_cab_level")),1)]),fields:w(()=>[n("span",null,r(e.trans("you_are_about_to_delete_a_cab_level"))+". "+r(e.trans("please_confirm")),1)]),controls:w(()=>[n("button",{id:"confirm-delete-button-"+e.levelIndex,type:"button",onClick:t[0]||(t[0]=V=>i.onDelete()),class:"btn btn-secondary"},[t[3]||(t[3]=n("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)),v(" "+r(e.trans("delete")),1)],8,mR)]),_:1},8,["onClose","containerStyle"])):c("",!0),a.hasDataPopulated===!1||a.loading===!0?(o(),l("div",hR,[_(b)])):c("",!0),a.hasDataPopulated?(o(),l("div",pR,[n("div",_R,[n("h3",fR,r(e.trans(a.title)),1)]),n("div",gR,[S((o(),l("div",bR,[_(f,{label:e.trans("name"),value:a.name,name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),required:!0,classname:"col-md-4"},null,8,["label","value","onChange","placehold"]),_(g,{label:e.trans("status_on_approve"),name:"action_on_approve",multiple:!1,value:a.action_on_approve,classname:"col-sm-3",onChange:i.onChange,apiEndpoint:"/service-desk/api/status/list?module=2",clearable:!!a.action_on_approve},null,8,["label","value","onChange","clearable"]),_(g,{label:e.trans("status_on_deny"),name:"action_on_deny",multiple:!1,value:a.action_on_deny,classname:"col-sm-3",onChange:i.onChange,apiEndpoint:"/service-desk/api/status/list?module=2",clearable:!!a.action_on_deny},null,8,["label","value","onChange","clearable"]),_(D,{options:a.radioOptions,label:e.trans("send_auto_reminders"),name:"send_auto_reminders",value:a.send_auto_reminders,onChange:i.onChange,classname:"form-group col-sm-2"},null,8,["options","label","value","onChange"])])),[[x]]),a.send_auto_reminders?(o(),l("div",yR,[_(M,{label:e.trans("reminder_interval"),elements:a.reminderOptions,name:"reminder_interval",onChange:i.onChange,required:!0,classname:"col-sm-4",value:a.reminder_interval},null,8,["label","elements","onChange","value"])])):c("",!0),n("div",vR,[(o(!0),l(U,null,$(a.levels,(V,N)=>(o(),l(U,null,[_(m,{componentName:"cab-level-"+N},null,8,["componentName"]),n("div",wR,[n("div",kR,[n("h3",CR,r(e.trans("level"))+" "+r(N+1),1),n("div",DR,[a.levels.length>1?S((o(),l("button",{key:0,id:"cab-level-delete-"+N,onClick:j=>i.deleting(N,V.id),class:"btn btn-tool"},t[4]||(t[4]=[n("span",{class:"fas fa-times"},null,-1)]),8,SR)),[[R,e.trans("close")]]):c("",!0)])]),n("div",MR,[n("div",FR,[_(f,{label:e.trans("name"),value:V.name,name:"level-name-"+N,onChange:i.onChange,placehold:e.lang("enter_a_value"),required:!0,classname:"col-md-6"},null,8,["label","value","name","onChange","placehold"]),_(M,{label:e.trans("matcher"),elements:a.matcherOptions,name:"level-match-"+N,onChange:i.onChange,required:!0,classname:"col-md-6",value:V.match},null,8,["label","elements","name","onChange","value"])]),n("div",{class:"row",id:"cab-level-"+N},[_(g,{label:e.trans("contacts"),value:V.approvers.users,onChange:i.onChange,name:"cab-agent-"+N,apiEndpoint:"/api/dependency/users?meta=true",multiple:!0,classname:"col-md-6",strlength:"50"},null,8,["label","value","onChange","name"]),_(g,{label:e.trans("user_types"),value:V.approvers.user_types,onChange:i.onChange,name:"cab-user-type-"+N,apiEndpoint:"/service-desk/api/dependency/user_types",multiple:!0,classname:"col-md-6",strlength:"50"},null,8,["label","value","onChange","name"])],8,IR)])])],64))),256))])]),n("div",AR,[n("button",{type:"button",id:"add-level",onClick:t[1]||(t[1]=(...V)=>i.addLevel&&i.addLevel(...V)),class:"btn btn-primary"},[t[5]||(t[5]=n("span",{class:"glyphicon glyphicon-plus"},null,-1)),v(" "+r(e.trans("add_level")),1)]),n("button",{type:"button",id:"submit-cab",onClick:t[2]||(t[2]=(...V)=>i.onSubmit&&i.onSubmit(...V)),disabled:a.loading,class:"btn btn-primary"},[n("span",{class:Q(a.iconClass)},null,2),v(" "+r(e.trans(a.btnName)),1)],8,PR)])])):c("",!0)])}const aa=P(dR,[["render",TR]]),VR={name:"cursor-pagination",props:{prev_page_url:{type:[String,null],default:""},next_page_url:{type:[String,null],default:""},onPagination:{type:Function,default:()=>{}}}},LR={key:0,class:"simple-pagination"},UR=["disabled"],NR=["disabled"];function ER(e,t,s,d,a,i){return s.prev_page_url||s.next_page_url?(o(),l("div",LR,[n("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=m=>s.onPagination("previous")),disabled:!s.prev_page_url},[t[2]||(t[2]=n("i",{class:"fas fa-arrow-left"},null,-1)),v("   "+r(e.trans("previous")),1)],8,UR),n("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=m=>s.onPagination("next")),disabled:!s.next_page_url},[v(r(e.trans("next"))+"  ",1),t[3]||(t[3]=n("i",{class:"fas fa-arrow-right"},null,-1))],8,NR)])):c("",!0)}const xR=P(VR,[["render",ER]]);const OR={name:"cab-activity",description:"Cab activity page",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{loading:!0,apiUrl:"",activity_log:"",perPage:10,total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",cabId:"",next_page_url:"",prev_page_url:""}},created(){window.emitter.on("updateActivity",this.getUpdateActivity)},beforeMount(){this.cabId=pe(window.location.pathname),this.apiUrl="service-desk/api/cab-log/"+this.cabId,this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},filtering(e){this.$emit("loaderValue",e)},loading(e){this.$emit("loaderValue",e)}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{onPagination(e){this.loading=!0,this.apiUrl=e==="next"?this.next_page_url:this.prev_page_url,this.getValues(this.paramsObj)},getUpdateActivity(){this.activity_log=[],this.loading=!0,this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.apiUrl="service-desk/api/cab-log/"+this.cabId,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){T.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.cab_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.cab_activity_logs.total,this.perPage=t.data.data.cab_activity_logs.per_page,this.next_page_url=t.data.data.cab_activity_logs.next_page_url,this.prev_page_url=t.data.data.cab_activity_logs.prev_page_url}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"cursor-pagination":xR,"activity-parser":kt}},qR={class:"row",id:"activity_log_div"},jR={class:"col-sm-12 mb-2"},RR={key:0,id:"select_limit"},BR={type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},zR={class:"dropdown-menu"},KR={key:1,id:"choose_order"},HR={id:"sort_btn",type:"button","data-bs-toggle":"dropdown",class:"btn btn-light dropdown-toggle"},YR={class:"dropdown-menu p-2",style:{"z-index":"9999"}},$R={class:"float-end"},WR={class:"col-md-12"},JR={key:0,class:"timeline"},GR={key:0,class:"time-label"},XR={class:"bg-light border"},ZR={class:"change-activity-timline"},QR={class:"timeline-item"},eB={class:"time"},tB={class:"timeline-header"},sB=["href"],aB={class:"timeline-body break"},nB={key:1},oB={key:0,class:"col-sm-12"},iB={class:"text-center"};function lB(e,t,s,d,a,i){const m=u("cursor-pagination"),h=u("faveo-image-element"),b=u("activity-parser");return o(),l("div",qR,[n("div",jR,[!a.loading&&a.activity_log.length>0?(o(),l("div",RR,[n("button",BR,r(a.perPage),1),n("div",zR,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=f=>i.logLimit(10))},"10"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[1]||(t[1]=f=>i.logLimit(25))},"25"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=f=>i.logLimit(50))},"50"),n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[3]||(t[3]=f=>i.logLimit(100))},"100")])])):c("",!0),!a.loading&&a.activity_log.length>0?(o(),l("div",KR,[n("button",HR,r(e.lang("created_time"))+" - "+r(e.lang(a.sort_key)),1),n("div",YR,[n("a",{href:"javascript:;",class:"dropdown-item",onClick:t[4]||(t[4]=f=>i.orderBy("asc"))},[t[6]||(t[6]=n("i",{class:"fas fa-sort-amount-up"},null,-1)),v(" "+r(e.lang("asc")),1)]),n("a",{href:"javascript:;",onClick:t[5]||(t[5]=f=>i.orderBy("desc")),class:"dropdown-item"},[t[7]||(t[7]=n("i",{class:"fas fa-sort-amount-down"},null,-1)),v(" "+r(e.lang("desc")),1)])])])):c("",!0),n("div",$R,[_(m,{prev_page_url:a.prev_page_url,next_page_url:a.next_page_url,onPagination:i.onPagination},null,8,["prev_page_url","next_page_url","onPagination"])])]),n("div",WR,[!a.loading&&a.activity_log.length>0?(o(),l("div",JR,[(o(!0),l(U,null,$(a.activity_log,(f,g)=>(o(),l(U,null,[i.checkDate(g)?(o(),l("div",GR,[n("span",XR,r(d.formattedDate(f.created_at)),1)])):c("",!0),n("div",ZR,[t[9]||(t[9]=n("i",{class:"far fa-dot-circle timeline-icon"},null,-1)),n("div",QR,[n("span",eB,[t[8]||(t[8]=n("i",{class:"far fa-clock"},null,-1)),v(" "+r(d.formattedTime(f.created_at)),1)]),n("h3",tB,[_(h,{id:"change_img","source-url":f.creator.profile_pic,classes:["img-circle","img-bordered-sm","img-rounder"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),n("a",{href:e.basePath()+"/panel/user/"+f.creator.id}," "+r(f.creator.full_name),9,sB)]),n("div",aB,[_(b,{data:f.name},null,8,["data"])])])]),i.showThreadEnd(g)?(o(),l("div",nB,t[10]||(t[10]=[n("i",{class:"far fa-clock text-bg-secondary timeline-icon"},null,-1)]))):c("",!0)],64))),256))])):c("",!0)]),!a.filtering&&!a.loading&&a.activity_log.length===0?(o(),l("div",oB,[n("h6",iB,r(e.lang("no_data_found")),1)])):c("",!0)])}const rB=P(OR,[["render",lB],["__scopeId","data-v-f04efd72"]]),dB={name:"cab-detail",description:"Change Advisory Board",props:{cab:{type:String,default:()=>{}}},data(){return{name:"",cab_id:this.cab,title:"Cab Detail",action_on_approve:"",action_on_deny:"",send_auto_reminders:""}},beforeMount(){this.getData()},methods:{subString(e,t=15){return Ie(e,t)},getData(){this.loading=!0,axios.get("/service-desk/api/cab/"+this.cab_id).then(e=>{this.action_on_approve=e.data.data.action_on_approve.name,this.action_on_deny=e.data.data.action_on_deny.name,this.send_auto_reminders=e.data.data.send_auto_reminders?"Yes":"No",document.getElementById("on_approve").innerText=this.action_on_approve,document.getElementById("on_deny").innerText=this.action_on_deny,document.getElementById("logs").innerText=e.data.data.name,document.getElementById("reminder").innerText=this.send_auto_reminders})}}},cB={class:"card card-light"},uB={class:"card-body"},mB={class:"row mb-3"},hB={class:"col-md-12"},pB={class:"callout callout-info"},_B={class:"row"},fB={class:"col-md-4"},gB={class:"mb-0"},bB={id:"on_approve"},yB={class:"col-md-4"},vB={class:"mb-0"},wB={id:"on_deny"},kB={class:"col-md-4"},CB={class:"mb-0"},DB={id:"reminder"};function SB(e,t,s,d,a,i){const m=W("tooltip");return o(),l("div",null,[n("div",cB,[t[0]||(t[0]=n("div",{class:"card-header"},[n("h3",{class:"card-title",id:"logs"})],-1)),n("div",uB,[n("div",mB,[n("div",hB,[n("div",pB,[n("div",_B,[n("div",fB,[n("p",gB,[n("b",null,r(e.trans("status_on_approve"))+" : ",1),S(n("span",bB,null,512),[[m,this.action_on_approve]])])]),n("div",yB,[n("p",vB,[n("b",null,r(e.trans("status_on_deny"))+" : ",1),S(n("span",wB,null,512),[[m,a.action_on_deny]])])]),n("div",kB,[n("p",CB,[n("b",null,r(e.trans("send_auto_reminders"))+" : ",1),S(n("span",DB,null,512),[[m,a.send_auto_reminders]])])])])])])])])])])}const Va=P(dB,[["render",SB]]);const MB={name:"cab-associates",description:"cab associates page",props:{cab:{type:String,default:()=>{}},cabId:{type:[String,Number],default:""},actions:{type:[Object,String],default:()=>{}}},data(){return{tabs:[{id:"activity",title:"activity_log",show:!0}],category:"activity",loading:!0}},methods:{associates(e){this.category=e},handelLoader(e){this.loading=e}},components:{CabDetail:Va,CabActivity:rB}},FB={id:"cab-associates",class:"card card-light card-tabs"},IB={class:"card-header p-0 pt-1"},AB={class:"nav nav-tabs"},PB={key:0,class:"nav-item"},TB=["onClick"],VB={class:"nav-item ms-auto mt-04"},LB={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},UB={class:"card-body"},NB={class:"tab-content"},EB={class:"active tab-pane",id:"activity"};function xB(e,t,s,d,a,i){const m=u("alert"),h=u("cab-activity");return o(),l("div",FB,[_(m,{componentName:"cabAssociates"}),n("div",IB,[n("ul",AB,[(o(!0),l(U,null,$(a.tabs,b=>(o(),l(U,null,[b.show?(o(),l("li",PB,[n("a",{id:"change_tab",class:Q(["nav-link",{active:a.category===b.id}]),"data-bs-toggle":"pill",onClick:f=>i.associates(b.id)},r(e.trans(b.title)),11,TB)])):c("",!0),n("li",VB,[a.loading?(o(),l("a",LB,t[0]||(t[0]=[n("i",{class:"fas fa-refresh"},null,-1)]))):c("",!0)])],64))),256))])]),n("div",UB,[n("div",NB,[n("div",EB,[n("div",null,[a.category==="activity"?(o(),k(h,{key:0,cabId:s.cabId,onLoaderValue:i.handelLoader},null,8,["cabId","onLoaderValue"])):c("",!0)])])])])])}const OB=P(MB,[["render",xB],["__scopeId","data-v-afea01ce"]]),qB={name:"cab-view",description:"Cab view page",data(){return{cab:"",cab_id:"",loading:!0,actions:"",counter:0}},beforeMount(){this.getValues()},created(){window.emitter.on("updateCabAssociates",this.updateAssociates),window.emitter.on("updateCabView",this.updateView)},methods:{updateView(){this.loading=!0,setTimeout(()=>{this.getValues()},500)},refreshData(){this.getValues()},updateAssociates(){setTimeout(()=>{this.getValues(!0,Date.now())},500)},getValues(e,t=""){const s=window.location.pathname;this.cab_id=pe(s),T.get("/service-desk/api/cab/"+this.cab_id+"?time="+t).then(d=>{this.cab=d.data.data.cab,this.getActions(e,t)}).catch(d=>{this.loading=!1,O(d,"cab-view")})},handelLoader(e){this.tabloading=e}},components:{CabAssociates:OB,CabDetail:Va}},jB={key:0};function RB(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("cab-detail"),f=u("cab-associates");return o(),l("div",{class:"col-sm-12",key:a.counter},[_(m,{componentName:"cab-view"}),a.loading?(o(),l("div",jB,[_(h,{"animation-duration":4e3,size:60})])):c("",!0),a.loading?c("",!0):(o(),l(U,{key:1},[_(b,{cabId:a.cab_id,cab:a.cab_id},null,8,["cabId","cab"]),_(f,{cabId:a.cab_id,cab:a.cab_id,actions:a.actions},null,8,["cabId","cab","actions"])],64))])}const BB=P(qB,[["render",RB]]);function zB(e){const{to:t,subject:s,organization:d,department:a,description:i}=e;var m={subject:[s,"isRequired"],description:[i,"isRequired"]};t==="department"&&(m.department=[a,"isRequired"]),t==="organization"&&(m.organization=[d,"isRequired"]);const h=new Ue(Ce),{errors:b,isValid:f}=h.validate(m);return Fe.dispatch("setValidationError",b),{errors:b,isValid:f}}const KB={name:"announcement",description:"Announcement page",data(){return{to:"department",subject:"",description:"",organization:"",department:"",loading:!1,radioOptions:[{name:"department",value:"department"},{name:"organization",value:"organization"}],classname:"form-group",show_err:!1,showField:!0}},methods:{isValid(){const{errors:e,isValid:t}=zB(this.$data);return!!t},onChange(e,t){this[t]=e,t==="to"&&(this.department="",this.organization="",this.showField=!1,setTimeout(()=>{this.showField=!0},1))},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;e.append("option",this.to+"_id"),e.append("subject",this.subject),this.organization&&e.append("organization_id",this.organization.id),this.department&&e.append("department_id",this.department.id),e.append("announcement",this.description);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/announcement",e,t).then(s=>{this.loading=!1,this.subject="",this.description="",this.to="department",this.department="",this.organization="",K(s,"announcement")}).catch(s=>{this.loading=!1,O(s,"announcement")})}}},components:{"text-field":Ae,"dynamic-select":fe,"radio-button":mt}},HB={class:"col-sm-12"},YB={key:0,class:"row"},$B={class:"card card-light"},WB={class:"card-header"},JB={class:"card-title"},GB={class:"card-body"},XB={class:"row"},ZB={class:"row"},QB={class:"card-footer"};function e7(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("text-field"),f=u("radio-button"),g=u("dynamic-select"),D=u("tiny-editor"),M=W("focus-first-input");return o(),l("div",HB,[a.loading?(o(),l("div",YB,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"announcement"}),n("div",$B,[n("div",WB,[n("h3",JB,r(e.lang("announcement")),1)]),n("div",GB,[S((o(),l("div",XB,[_(b,{label:e.lang("subject"),value:a.subject,type:"text",name:"subject",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-5",required:!0},null,8,["label","value","onChange","placehold"]),_(f,{options:a.radioOptions,label:e.lang("announcement_to"),name:"to",value:a.to,onChange:i.onChange,classname:"form-group col-sm-3"},null,8,["options","label","value","onChange"]),a.showField?(o(),l(U,{key:0},[a.to==="department"?(o(),k(g,{key:0,label:e.lang("department"),multiple:!1,name:"department",prePopulate:!1,classname:"col-sm-4",apiEndpoint:"/api/dependency/departments",value:a.department,required:!0,clearable:!!a.department,strlength:"30",onChange:i.onChange},null,8,["label","value","clearable","onChange"])):c("",!0),a.to==="organization"?(o(),k(g,{key:1,label:e.lang("organization"),multiple:!1,name:"organization",prePopulate:!1,classname:"col-sm-4",apiEndpoint:"/api/dependency/organizations",value:a.organization,required:!0,clearable:!!a.organization,strlength:"30",onChange:i.onChange},null,8,["label","value","clearable","onChange"])):c("",!0)],64)):c("",!0)])),[[M]]),n("div",ZB,[_(D,{value:a.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),id:"announce-editor",classname:"col-sm-12",required:!0,lang:"en"},null,8,["value","onChange","label"])])]),n("div",QB,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=x=>i.onSubmit())},[t[1]||(t[1]=n("i",{class:"fas fa-paper-plane"},null,-1)),v(" "+r(e.lang("send")),1)])])])])}const t7=P(KB,[["render",e7]]),s7={components:{"text-field":Ae,radio:mt,file:Ft},beforeMount(){this.getExistingCustomTemplateDetails()},data(){return{labelType:1,display_logo_confirmed:0,radioOptionsLogo:[{name:"Yes",value:1},{name:"No",value:0}],width:"",height:"",logo_image:null,labels_per_row:"",space_between_labels:"",showModal:!1,loading:!1,loadingSpeed:4e3,logo_text:"",barcode_mode:"system_default",template_exists:!1,image_exists:!1,isDisabled:!0,templateId:"",componentRenderKey:Math.random(),isLoading:!1,containerStyle:{width:" 500px"}}},watch:{},methods:{onChange(e,t){this[t]=e,t=="logo_image"&&(this.logo_image=e?e[0]:""),e===null&&(this[t]="")},deleteTemplate(){this.$store.dispatch("unsetValidationError"),this.isLoading=!0,this.isDisabled=!0,T.patch("service-desk/barcode/template/reset/"+this.templateId).then(e=>{K(e,"barcode_settings"),Object.assign(this.$data,this.$options.data.apply(this)),this.getExistingCustomTemplateDetails()}).catch(e=>{O(e,"barcode_settings")}).finally(()=>{this.showModal=!1,this.isLoading=!1,this.loading=!1})},toggleModal(){this.showModal=!this.showModal},onClose(){this.showModal=!1},onSubmit(){let e=new FormData;this.image_exists=!!this.logo_image,this.logo_image instanceof File&&e.append("logo_image",this.logo_image),e.append("image_exists",this.image_exists),e.append("width",this.width),e.append("height",this.height),e.append("labels_per_row",this.labels_per_row),e.append("space_between_labels",this.space_between_labels),e.append("display_logo_confirmed",this.display_logo_confirmed),this.loading=!0;let t=this.template_exists?"service-desk/barcode/template/update/"+this.templateId:"service-desk/barcode/template/create";T.post(t,e,{headers:{"Content-Type":"multipart/form-data"}}).then(s=>{K(s,"barcode_settings"),this.loading=!1,this.$store.dispatch("unsetValidationError"),Object.assign(this.$data,this.$options.data.apply(this)),this.getExistingCustomTemplateDetails()}).catch(s=>{O(s,"barcode_settings"),this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])})},getExistingCustomTemplateDetails(){T.get("service-desk/barcode-template").then(e=>{this.template_exists=!0;let t=e.data.data;this.updateStatesWithData(t),this.isDisabled=!1,this.templateId=t.id}).catch(e=>{this.template_exists=!1,this.isDisabled=!0})},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}}},a7={class:"col-sm-12"},n7={class:"card card-light"},o7={class:"card-header"},i7={class:"card-title"},l7={class:"card-body"},r7={class:"row"},d7={class:"row"},c7={class:"card-footer"},u7=["disabled"],m7={class:"modal-title"},h7={key:0},p7={key:1,class:"row"};function _7(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("text-field"),f=u("radio"),g=u("file"),D=u("reuse-loader"),M=u("modal"),x=W("focus-first-input");return o(),l("div",a7,[a.loading?(o(),k(m,{key:0,duration:a.loadingSpeed},null,8,["duration"])):c("",!0),_(h,{componentName:"barcode_settings"}),n("div",n7,[n("div",o7,[n("h3",i7,r(e.lang("barcode_settings")),1)]),n("div",l7,[S((o(),l("div",r7,[_(b,{label:e.lang("label_width"),onChange:i.onChange,placehold:e.lang("enter_a_value"),value:a.width,type:"text",name:"width",keyupListener:i.triggerEvent,classname:"col-sm-3",id:"label_width",required:!0},null,8,["label","onChange","placehold","value","keyupListener"]),_(b,{label:e.lang("label_height"),onChange:i.onChange,placehold:e.lang("enter_a_value"),value:a.height,type:"text",keyupListener:i.triggerEvent,name:"height",required:!0,classname:"col-sm-3",id:"label_height"},null,8,["label","onChange","placehold","value","keyupListener"]),_(b,{label:e.lang("space_between_labels"),onChange:i.onChange,placehold:e.lang("enter_a_value"),value:a.space_between_labels,type:"text",keyupListener:i.triggerEvent,name:"space_between_labels",required:!0,classname:"col-sm-3",id:"space_between_labels"},null,8,["label","onChange","placehold","value","keyupListener"]),_(b,{label:e.lang("labels_per_row"),onChange:i.onChange,placehold:e.lang("enter_a_value"),value:a.labels_per_row,type:"text",keyupListener:i.triggerEvent,name:"labels_per_row",required:!0,classname:"col-sm-3",id:"labels_per_row"},null,8,["label","onChange","placehold","value","keyupListener"])])),[[x]]),n("div",d7,[_(f,{name:"display_logo_confirmed",value:a.display_logo_confirmed,label:e.lang("display_logo_confirm"),options:e.lang(a.radioOptionsLogo),required:!0,classname:"form-group col-sm-3",onChange:i.onChange},null,8,["value","label","options","onChange"]),(o(),k(g,{name:"logo_image",value:a.logo_image,label:e.lang("logo_image"),onChange:i.onChange,id:"logo_image",classname:"col-sm-6",key:a.componentRenderKey,accept:"image/x-png,image/jpeg"},null,8,["value","label","onChange"]))])]),n("div",c7,[n("button",{type:"button",onClick:t[0]||(t[0]=(...R)=>i.onSubmit&&i.onSubmit(...R)),class:"btn btn-primary"},[t[3]||(t[3]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(e.lang("save")),1)]),n("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...R)=>i.toggleModal&&i.toggleModal(...R)),id:"resetBtn",disabled:a.isDisabled},[t[4]||(t[4]=n("i",{class:"glyphicon glyphicon-repeat"},null,-1)),v("  "+r(e.lang("reset")),1)],8,u7)])]),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(M,{key:0,showModal:!0,onClose:()=>a.showModal=!1,containerStyle:a.containerStyle},{title:w(()=>[n("h4",m7,r(e.lang("reset")),1)]),fields:w(()=>[a.isLoading?c("",!0):(o(),l("div",h7,[n("span",null,r(e.lang("reset_confirm")),1)])),a.isLoading?(o(),l("div",p7,[_(D,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",onClick:t[2]||(t[2]=(...R)=>i.deleteTemplate&&i.deleteTemplate(...R)),class:"btn btn-primary"},[t[5]||(t[5]=n("i",{class:"glyphicon glyphicon-repeat","aria-hidden":"true"},null,-1)),v("  "+r(e.lang("reset")),1)])]),_:1},8,["onClose","containerStyle"])):c("",!0)]),_:1})])}const f7=P(s7,[["render",_7]]);const g7={name:"SdimportProgress",description:"Common component to track the import progress",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{urlLabel:"",url:"",trackingId:"",responseData:null,loading:!0,dataTableOptions:{headings:{row:this.trans("row_number"),field:this.trans("field_name"),comment:this.trans("reason")},columnsClasses:{row:"import__failed__row",field:"import__failed__field",comment:"import__failed__comment"},filterable:!1,sortable:[],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(e){return{page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.map(t=>t),count:e.total}}}}},beforeMount(){let e=new URLSearchParams(window.location.search);this.urlLabel=e.get("sd_import_redirect_url_label_after_track"),this.url=e.get("sd_import_redirect_url_after_track"),this.trackingId=pe(window.location.pathname),this.getTrackingData()},computed:{getUrlAttribute(){const e=this.basePath()+"/"+this.url,t=this.urlLabel?this.urlLabel:this.lang("sd_importer_import_tracking_view_label");return`<p><a href="${e}">${t}</a></p>`},showFailedRows(){return this.responseData.totalFailed||this.responseData.totalWarning},failedRowsUrl(){return`service-desk/import-tracking-failed/${this.trackingId}`}},methods:{async getTrackingData(){try{let e=await T.get(`service-desk/import-tracking-details/${this.trackingId}`);this.responseData=e.data.data,this.loading=!1}catch(e){console.error("Sd_Import_Progress_Error:",e)}}}},b7={class:"col-sm-12"},y7={key:1},v7={class:"row"},w7={class:"col-md-12"},k7={class:"table-responsive"},C7={class:"table table-bordered"},D7={class:"thead-light"},S7={key:0},M7=["innerHTML"],F7={key:0,class:"row"},I7={class:"col-sm-12"};function A7(e,t,s,d,a,i){const m=u("custom-loader"),h=u("faveo-box"),b=u("data-table");return o(),l("div",b7,[a.loading?(o(),k(m,{key:0,"animation-duration":4e3,size:60})):(o(),l("div",y7,[_(h,{title:e.lang("sd_import_result_summary_label")},{default:w(()=>[n("div",v7,[n("div",w7,[n("div",k7,[n("table",C7,[n("thead",D7,[n("tr",null,[n("th",null,r(e.lang("sd_import_result_name_label")),1),n("th",null,r(e.lang("sd_import_result_type_label")),1),n("th",null,r(e.lang("sd_import_result_status_label")),1),n("th",null,r(e.lang("sd_import_result_ended_at_label")),1),n("th",null,r(e.lang("sd_import_result_created_label")),1),n("th",null,r(e.lang("sd_import_result_updated_label")),1),n("th",null,r(e.lang("sd_import_result_failed_label")),1),n("th",null,r(e.lang("sd_import_result_warning_label")),1),a.url?(o(),l("th",S7,r(e.lang("sd_import_result_action_label")),1)):c("",!0)])]),n("tbody",null,[n("tr",null,[n("td",null,r(a.responseData.name),1),n("td",null,r(a.responseData.type),1),n("td",null,r(a.responseData.status_text),1),n("td",null,r(d.formattedTime(a.responseData.ended_at)),1),n("td",null,r(a.responseData.totalCreated),1),n("td",null,r(a.responseData.totalUpdated),1),n("td",null,r(a.responseData.totalFailed),1),n("td",null,r(a.responseData.totalWarning),1),a.url?(o(),l("td",{key:0,innerHTML:i.getUrlAttribute},null,8,M7)):c("",!0)])])])])])])]),_:1},8,["title"]),i.showFailedRows?(o(),l("div",F7,[n("div",I7,[_(h,{title:e.lang("sd_importer_import_tracking_view_failed_box_label")},{default:w(()=>[_(b,{url:i.failedRowsUrl,dataColumns:["row","field","comment"],option:a.dataTableOptions},null,8,["url","option"])]),_:1},8,["title"])])])):c("",!0)]))])}const P7=P(g7,[["render",A7],["__scopeId","data-v-ccd988fa"]]);const T7={name:"SdImportMapper",components:{ToolTip:Ot,FormFieldTemplate:ma,StaticSelect:qt},props:{getDetailsApiEndpoint:{type:String,required:!0},submitApiEndpoint:{type:String,required:!0},updateParent:{required:!0,type:Function},tableHeadings:{required:!0,type:Object},importId:{required:!1,type:[String,Number]},extraData:{type:Object,required:!1,default:()=>{}}},beforeMount(){this.getDataForMapping()},data(){return{systemAttributes:[],importAttributes:[],loading:!1,hasDataPopulated:!1,formFieldLabelStyle:{display:"none"},shouldUpdateExisting:!1,date_time_format:"",shouldHandleDateFormat:!1,dateFieldHasMapping:!1,dateTimeFormats:[{id:"Y-m-d H:i",name:"YYYY-MM-DD HH:mm"},{id:"m-d-Y H:i",name:"MM-DD-YYYY HH:mm"},{id:"d-m-Y H:i",name:"DD-MM-YYYY HH:mm"},{id:"Y/m/d H:i",name:"YYYY/MM/DD HH:mm"},{id:"m/d/Y H:i",name:"MM/DD/YYYY HH:mm"},{id:"d/m/Y H:i",name:"DD/MM/YYYY HH:mm"}]}},watch:{systemAttributes:{handler(e){e.forEach(t=>{t.type==="date"&&(t.mapped_to!=="No mapping"?this.dateFieldHasMapping=!0:this.dateFieldHasMapping=!1)})},deep:!0}},computed:{loadingState(){return this.loading||!this.hasDataPopulated},showDateFormatField(){return this.shouldHandleDateFormat&&this.dateFieldHasMapping}},methods:{getDataForMapping(){let e=this.extraData?this.extraData:{};T.get(this.getDetailsApiEndpoint,{params:e}).then(t=>{this.systemAttributes=t.data.data.columns_to_import,this.importAttributes=t.data.data.csv_headers_for_mapping,this.shouldHandleDateFormat=t.data.data.handle_date_field,this.loading=!1,this.hasDataPopulated=!0}).catch(t=>{O(t),this.loading=!1})},onChange(e,t){this[t]=e},emitDiscardModalButtonIsClicked(){this.$emit("sdImportDiscardModalButtonClicked")},onSubmit(){this.loading=!0;let e={mapped_system_attributes:this.systemAttributes,import_id:this.importId,update_existing:this.shouldUpdateExisting,should_handle_date:this.showDateFormatField,date_time_format:this.date_time_format?this.date_time_format:null};this.extraData&&Object.keys(this.extraData).length===0&&this.extraData.constructor===Object||(e.special_keys=this.extraData),T.post(this.submitApiEndpoint,e).then(t=>{K(t,this.$options.name),setTimeout(()=>{this.$store.dispatch("unsetAlert"),this.$store.dispatch("unsetValidationError"),this.loading=!1,this.updateParent()},5e3)}).catch(t=>{O(t,this.$options.name),this.loading=!1})}}},V7={class:"com-sm-12"},L7={key:1,class:"card card-light"},U7={class:"card-header"},N7={class:"d-flex align-items-center"},E7={class:"me-auto"},x7={class:"card-title"},O7={class:"btn-group",role:"group"},q7=["title"],j7={class:"card-body"},R7={class:"row"},B7={class:"col-sm-6"},z7={class:"form-check form-check-inline mb-3"},K7={class:"form-check-label",for:"shouldUpdateExisting"},H7={id:"faveo-attribute-list",class:"faveo-table table table-bordered"},Y7={class:"thead-default"},$7={class:"padding-top-12"},W7=["id"],J7=["id"],G7={key:1,class:"text-danger p-0"},X7=["onUpdate:modelValue","id"],Z7=["id","value"],Q7={key:0,class:"row mt-3"},e9={class:"card-footer"},t9=["disabled"];function s9(e,t,s,d,a,i){const m=u("alert"),h=u("custom-loader"),b=u("tool-tip"),f=u("form-field-template"),g=u("static-select");return o(),l("div",V7,[_(m,{componentName:this.$options.name},null,8,["componentName"]),i.loadingState?(o(),k(h,{key:0})):c("",!0),a.hasDataPopulated?(o(),l("div",L7,[n("div",U7,[n("div",N7,[n("div",E7,[n("h3",x7,r(e.lang("sd_import_mapper")),1),_(b,{message:e.lang("sd_import_mapper_description"),size:"large"},null,8,["message"])]),n("div",O7,[n("button",{class:"btn btn-light btn-sm",id:"discard-import-button",title:e.lang("sd_import_discard"),onClick:t[0]||(t[0]=(...D)=>i.emitDiscardModalButtonIsClicked&&i.emitDiscardModalButtonIsClicked(...D))},t[3]||(t[3]=[n("i",{class:"fas fa-arrow-up"},null,-1)]),8,q7)])])]),n("div",j7,[n("div",R7,[n("div",B7,[n("div",z7,[S(n("input",{class:"form-check-input cursor-pointer",type:"checkbox",id:"shouldUpdateExisting","onUpdate:modelValue":t[1]||(t[1]=D=>a.shouldUpdateExisting=D)},null,512),[[cs,a.shouldUpdateExisting]]),n("label",K7,r(e.lang("sd_importer_should_update_existing")),1)])])]),n("table",H7,[n("thead",Y7,[n("tr",null,[n("th",null,[v(r(e.lang(s.tableHeadings.system.header))+" ",1),_(b,{message:e.lang(s.tableHeadings.system.description)},null,8,["message"])]),n("th",null,[v(r(e.lang(s.tableHeadings.import.header))+" ",1),_(b,{message:e.lang(s.tableHeadings.import.description)},null,8,["message"])])])]),(o(!0),l(U,null,$(a.systemAttributes,(D,M)=>(o(),l("tr",{class:"faveo-attribute-elements",key:D.uuid},[D.hidden?(o(),l(U,{key:0},[],64)):(o(),l(U,{key:1},[n("td",$7,[D.nested?(o(),l("span",{key:0,id:"faveo-attribute-label-arrow-"+M,style:{"font-size":"1rem"}},"⤷",8,W7)):c("",!0),n("span",{class:"p-0",id:"faveo-attribute-label-"+M},r(D.label),9,J7),D.required?(o(),l("span",G7,"*")):c("",!0),D.description?(o(),k(b,{key:2,class:"p-0",message:D.description,size:"small"},null,8,["message"])):c("",!0)]),n("td",null,[_(f,{name:`mapped_system_attributes.${M}.mapped_to`,label:"",labelStyle:a.formFieldLabelStyle},{default:w(()=>[S(n("select",{"onUpdate:modelValue":x=>D.mapped_to=x,id:"attribute-list-"+M,class:"attribute-list form-control"},[(o(!0),l(U,null,$(a.importAttributes,x=>(o(),l("option",{id:"attribute-element-"+M,key:x.id,value:x.id},r(x.name),9,Z7))),128))],8,X7),[[wn,D.mapped_to]])]),_:2},1032,["name","labelStyle"])])],64))]))),128))]),a.shouldHandleDateFormat?(o(),l("div",Q7,[_(g,{label:e.lang("sd_import_date_format_label"),elements:a.dateTimeFormats,name:"date_time_format",value:a.date_time_format,classname:"col-sm-6",onChange:i.onChange,hint:e.lang("sd_importer_import_date_label_hint")},null,8,["label","elements","value","onChange","hint"])])):c("",!0)]),n("div",e9,[a.hasDataPopulated?(o(),l("button",{key:0,id:"sd-import-mapper-submit",type:"button",onClick:t[2]||(t[2]=(...D)=>i.onSubmit&&i.onSubmit(...D)),disabled:a.loading,class:"btn btn-primary update-btn"},[t[4]||(t[4]=n("span",{class:"fas fa-upload"},null,-1)),v(" "+r(e.lang("sd_import_action_button")),1)],8,t9)):c("",!0)])])):c("",!0)])}const La=P(T7,[["render",s9],["__scopeId","data-v-7bde3c1c"]]),a9={name:"DiscardSdImportModal",description:"Confirms whether user wants to discard ongoing import",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},apiUrl:{type:String,default:""}},data(){return{isDisabled:!1,loading:!1,containerStyle:{width:"500px"}}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete(this.apiUrl).then(e=>{this.loading=!1,this.isDisabled=!0,this.$emit("performImportDiscard"),this.onClose()}).catch(e=>{this.loading=!1,this.onClose()})}}},n9={class:"modal-title"},o9={key:0},i9={key:1,class:"row"},l9=["disabled"];function r9(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:a.containerStyle},{title:w(()=>[n("h4",n9,r(e.lang("sd_import_discard_modal_title")),1)]),fields:w(()=>[a.loading?c("",!0):(o(),l("div",o9,[n("span",null,r(e.lang("sd_import_discard_confirm")),1)])),a.loading?(o(),l("div",i9,[_(m,{duration:4e3})])):c("",!0)]),controls:w(()=>[n("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=(...b)=>i.onSubmit&&i.onSubmit(...b)),class:"btn btn-secondary",disabled:a.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-arrow-right"},null,-1)),v(" "+r(e.lang("sd_import_discard_confirm_button")),1)],8,l9)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const d9=P(a9,[["render",r9]]),c9={name:"SdImporter",components:{SdImportMapper:La,DynamicSelect:fe,DiscardSdImportModal:d9},props:{uploadUrl:{type:String,required:!0},discardUrl:{type:String,required:!0},mappingDetailsGetUrl:{type:String,required:!0},mappingPostUrl:{type:String,required:!0},importType:{type:String,default:""}},data(){return{apiUrl:"",importId:null,importFile:null,componentRenderKey:Math.random(),loading:!1,loadingSpeed:4e3,uploaded:!1,tableHeadings:{system:{header:"sd_importer_system_attributes",description:"sd_importer_system_attributes_description"},import:{header:"sd_importer_import_attributes",description:"sd_importer_import_attributes_description"}},buttonText:"importer_import",assetTypeId:null,extraDataObject:{},showModal:!1}},computed:{discardImportUrl(){return this.discardUrl+this.importId}},methods:{onDiscardModalButtonIsClicked(){this.showModal=!0},onChange(e,t){this[t]=e,t==="assetTypeId"&&(e?this.extraDataObject.asset_type_id=e.id:this.extraDataObject={}),e===null&&(this[t]="")},fileSelected(e){e.target.files[0].size<25e6?this.importFile=e.target.files[0]:alert(lang("importer_max_upload_size"))},updateParent(){setTimeout(()=>{this.discardImportProcessing()},2e3)},customErrors(e){e.response.status===412?this.setAlert(e.response.data.message.import_file):O(e,"importerUpload")},setAlert(e){O({response:{status:400,data:{message:e}}},"importerUpload")},submitCallback(){this.loading=!0;let e=new FormData;e.append("import_file",this.importFile),T.post(this.uploadUrl,e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{this.importId=t.data.data.import_id,this.apiUrl=this.mappingDetailsGetUrl+this.importId,K(t,"importerUpload"),this.uploaded=!0}).catch(t=>{this.customErrors(t),this.uploaded=!1}).finally(()=>{this.loading=!1})},discardImportProcessing(){this.uploaded=!1,this.importFile=null,this.importId=null,this.extraDataObject={},this.assetTypeId=null},onDiscardModalClose(){this.showModal=!1}}},u9={class:"col-sm-12"},m9={key:0,class:"row mb-2"},h9={class:"row"},p9={class:"form-group col-sm-12"},_9={class:"card-footer"};function f9(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("dynamic-select"),f=u("faveo-box"),g=u("sd-import-mapper"),D=u("discard-sd-import-modal");return o(),l("div",u9,[a.loading?(o(),k(m,{key:0,duration:a.loadingSpeed},null,8,["duration"])):c("",!0),_(h,{componentName:"importerUpload"}),a.uploaded?c("",!0):(o(),k(f,{key:1,title:e.lang("sd_importer_upload")},{actions:w(()=>[n("div",_9,[n("button",{type:"button",onClick:t[1]||(t[1]=(...M)=>i.submitCallback&&i.submitCallback(...M)),class:"btn btn-primary",id:"upload-btn"},[t[3]||(t[3]=n("i",{class:"fas fa-upload"},null,-1)),v(" "+r(e.lang("sd_importer_upload_button")),1)])])]),default:w(()=>[s.importType==="asset"?(o(),l("div",m9,[_(b,{name:"assetTypeId",classname:"col-sm-6",value:a.assetTypeId,onChange:i.onChange,placeholder:"Select Asset type",label:e.lang("sd_importer_asset_import_asset_type_label"),hint:e.lang("sd_importer_asset_import_asset_type_hint"),apiEndpoint:"service-desk/api/dependency/asset_types?meta=true"},null,8,["value","onChange","label","hint"])])):c("",!0),n("div",h9,[n("div",p9,[n("label",null,[v(r(e.lang("sd_importer_import_file_label"))+" ",1),t[2]||(t[2]=n("span",{class:"text-danger"},"*  ",-1))]),n("input",{type:"file",name:"import_file",onChange:t[0]||(t[0]=(...M)=>i.fileSelected&&i.fileSelected(...M))},null,32)])])]),_:1},8,["title"])),a.uploaded?(o(),k(g,{key:2,"update-parent":i.updateParent,"table-headings":a.tableHeadings,"button-text":a.buttonText,"import-id":a.importId,"expand-by-default":!0,"submit-api-endpoint":s.mappingPostUrl,"get-details-api-endpoint":a.apiUrl,"extra-data":a.extraDataObject,onSdImportDiscardModalButtonClicked:i.onDiscardModalButtonIsClicked},null,8,["update-parent","table-headings","button-text","import-id","submit-api-endpoint","get-details-api-endpoint","extra-data","onSdImportDiscardModalButtonClicked"])):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(D,{key:0,onClose:i.onDiscardModalClose,showModal:a.showModal,"api-url":i.discardImportUrl,onPerformImportDiscard:i.discardImportProcessing},null,8,["onClose","showModal","api-url","onPerformImportDiscard"])):c("",!0)]),_:1})])}const g9=P(c9,[["render",f9]]);const b9={name:"cmdb-relationship-list",description:"Cmdb relationship lists table component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime)}},data:()=>({columns:["forward_relation_name","inverse_relation_name","action"],options:{},apiUrl:"/service-desk/api/cmdb-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},columnsClasses:{forward_relation_name:"cmdb-forward_relation_name",inverse_relation_name:"cmdb-inverse_relation_name"},headings:{forward_relation_name:e.lang("forward_relation_name"),inverse_relation_name:e.lang("inverse_relation_name"),action:e.lang("actions")},templates:{forward_relation_name(t,s){return s.forward_relation_name?s.forward_relation_name:"--"},inverse_relation_name(t,s){return s.inverse_relation_name?s.inverse_relation_name:"--"},action:(t,s)=>e.h(qe,{data:s})},sortable:["forward_relation_name","inverse_relation_name"],filterable:["forward_relation_name","inverse_relation_name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.cmdbs.map(s=>(s.edit_url="/service-desk/cmdb-relation/edit/"+s.id,s.delete_url=e.basePath()+"/service-desk/api/cmdb/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},y9={class:"col-sm-12"},v9={class:"card card-light assets-type-table"},w9={class:"card-header"},k9={id:"cmdb-list",class:"card-title"},C9={class:"card-tools"},D9={class:"card-body",id:"cmdb-table"};function S9(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",y9,[_(m,{componentName:"dataTableModal"}),n("div",v9,[n("div",w9,[n("h3",k9,r(e.lang("cmdb_relations-page-title")),1),n("div",C9,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/cmdb-relation/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_cmdb_relation")]])])]),n("div",D9,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"cmdb-relationship-list"},null,8,["url","dataColumns","option"])])])])}const M9=P(b9,[["render",S9]]);function F9(e){const{forward_relation_name:t,inverse_relation_name:s,key:d}=e;var a={forward_relation_name:[t,"isRequired"],inverse_relation_name:[s,"isRequired"],key:[d,"isRequired"]};const i=new Ue(Ce),{errors:m,isValid:h}=i.validate(a);return Fe.dispatch("setValidationError",m),{errors:m,isValid:h}}const I9={data(){return{title:"create_cmdb_relation",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,cmdbRelationId:"",forward_relation_name:"",inverse_relation_name:"",description:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.title="edit",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,T.get("/service-desk/api/cmdb/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.cmdbRelationId=t.data.data.cmdb.id,this.forward_relation_name=t.data.data.cmdb.forward_relation_name,this.inverse_relation_name=t.data.data.cmdb.inverse_relation_name,this.description=t.data.data.cmdb.description}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,O(t,"cmdbRelation")})},isValid(){const{errors:e,isValid:t}=F9(this.$data);return!!t},onChange(e,t){this[t]=e,e||(this[t]="")},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.cmdbRelationId!=""&&e.append("id",this.cmdbRelationId),e.append("forward_relation_name",this.forward_relation_name),e.append("inverse_relation_name",this.inverse_relation_name),e.append("description",this.description);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("/service-desk/api/cmdb",e,t).then(s=>{this.loading=!1,K(s,"cmdbRelation"),this.cmdbRelationId?this.getInitialValues(this.cmdbRelationId):setTimeout(()=>{this.$router.push({name:"CMDB Relation Index"})},3e3)}).catch(s=>{this.loading=!1,O(s,"cmdbRelation")})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}},components:{"text-field":Ae}},A9={class:"col-sm-12"},P9={key:0,class:"row"},T9={key:1,class:"card card-light"},V9={class:"card-header"},L9={class:"card-title"},U9={class:"card-body"},N9={class:"row"},E9={class:"row"},x9={class:"card-footer"};function O9(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("text-field"),f=W("focus-first-input");return o(),l("div",A9,[!a.hasDataPopulated||a.loading?(o(),l("div",P9,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"cmdbRelation"}),a.hasDataPopulated?(o(),l("div",T9,[n("div",V9,[n("h3",L9,r(e.lang(a.title)),1)]),n("div",U9,[S((o(),l("div",N9,[_(b,{label:e.lang("forward_relation_name"),value:a.forward_relation_name,type:"text",name:"forward_relation_name",onChange:i.onChange,placehold:e.lang("enter_a_value"),keyupListener:i.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold","keyupListener"]),_(b,{label:e.lang("inverse_relation_name"),value:a.inverse_relation_name,type:"text",name:"inverse_relation_name",onChange:i.onChange,placehold:e.lang("enter_a_value"),keyupListener:i.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold","keyupListener"])])),[[f]]),n("div",E9,[_(b,{label:e.lang("description"),value:a.description,type:"textarea",name:"description",onChange:i.onChange,placehold:e.lang("enter_a_value"),keyupListener:i.triggerEvent,classname:"col-sm-12",required:!1},null,8,["label","value","onChange","placehold","keyupListener"])])]),n("div",x9,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=g=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])])])):c("",!0)])}const na=P(I9,[["render",O9]]);const q9={name:"status-list",components:{"status-filter":Nn},description:"Status lists table component",data:()=>({columns:["name","module","purpose_of_status","display_order","icon","action"],options:{},apiUrl:"/service-desk/api/status/list?meta=true",isShowFilter:!1,loading:!0,pageLoader:!1,filterParams:{},appliedFilters:{},filterOptions:[{section:[{name:"default",url:"service-desk/api/default/list",label:"default"},{name:"module",url:"service-desk/api/modules/list?status=1",label:"module"},{name:"purpose",url:"/service-desk/api/status/type/all",label:"purpose_of_status"}]}]}),created(){window.emitter.on("updateFilter",this.updateFilter)},computed:{apiEndPoint(){return this.apiUrl}},beforeMount(){this.filterData();const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},heading:{name:this.lang("name"),module:this.lang("module"),purpose_of_status:this.lang("purpose_of_status"),display_order:this.lang("display_order"),icon:this.lang("icon"),action:this.lang("action")},columnsClasses:{name:"status-name",module:"status-module",purpose_of_status:"status-purpose-of-status",display_order:"status-display-order",action:"status-action"},templates:{name:function(t,s){return s.name?s.name:"--"},module:function(t,s){return s.module?s.module.modules:"--"},purpose_of_status:function(t,s){return s.purpose_of_status?s.purpose_of_status.name:"--"},display_order:function(t,s){return s.display_order?s.display_order:"--"},icon:function(t,s){return e.h("i",{class:s.icon_class,style:"color : "+s.icon_color},"")},action:(t,s)=>this.h(qe,{data:s})},sortable:["name","display_order"],filterable:["name","module","purpose_of_status","display_order"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{sort_field:t.orderBy?t.orderBy:"id",sort_order:t.ascending?"asc":"desc",search:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(s=>(s.edit_url="/service-desk/status/"+s.id+"/edit",s.delete_url="/service-desk/api/status/delete/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}},methods:{updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name===s.name&&(s.value=e.value)})})},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.elements=[],t.isMultiple=!0,t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl="/service-desk/api/status/list?meta=true",this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.elements=[],t.isMultiple=!0,t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e){this.appliedFilters=e;let t="/service-desk/api/status/list?meta=true&",s=new URLSearchParams(vt(this.filterOptions,e));this.apiUrl=t+s,this.isShowFilter=!1},toggleFilterView(){this.isShowFilter=!this.isShowFilter}}},j9={class:"col-sm-12"},R9={class:"card card-light"},B9={class:"card-header"},z9={id:"status-list",class:"card-title"},K9={class:"card-tools"},H9={class:"card-body",id:"status-table"},Y9={key:1,class:"row"};function $9(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("status-filter"),f=u("data-table"),g=u("custom-loader"),D=W("tooltip");return o(),l("div",j9,[_(m,{componentName:"dataTableModal"}),n("div",R9,[n("div",B9,[n("h3",z9,r(e.trans("list_of_status")),1),n("div",K9,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/status/create"},{default:w(()=>t[1]||(t[1]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[D,e.lang("create_new_status")]]),S((o(),l("button",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...M)=>i.toggleFilterView&&i.toggleFilterView(...M)),href:"javascript:;"},t[2]||(t[2]=[n("i",{class:"glyphicon glyphicon-filter"},null,-1)]))),[[D,e.trans("filter")]])])]),n("div",H9,[e.isShowFilter?(o(),k(b,{key:0,id:"filter-box",metaData:e.filterOptions,onSelectedFilters:i.selectedFilters,updateFields:e.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/service-desk/api/status/list?meta=true"},null,8,["metaData","onSelectedFilters","updateFields","appliedFilters"])):c("",!0),_(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"status-list"},null,8,["url","dataColumns","option"]),e.pageLoader?(o(),l("div",Y9,[_(g)])):c("",!0)])])])}const W9=P(q9,[["render",$9]]);function J9(e){const{name:t,module:s,purpose_of_status:d,icon_class:a,icon_color:i,display_order:m}=e,h={name:[t,"isRequired"],module:[s,"isRequired"],purpose_of_status:[d,"isRequired"],icon_class:[a,"isRequired"],icon_color:[i,"isRequired"],display_order:[m,"isRequired"]},b=new Ue(Ce),{errors:f,isValid:g}=b.validate(h);return Fe.dispatch("setValidationError",f),{errors:f,isValid:g}}const G9={name:"status-create-edit",data(){return{page_title:"create_new_status",iconClass:"fas fa-save",btnName:"save",status_id:"",hasDataPopulated:!1,name:"",display_order:"",icon_class:{icon_class:"fas fa-edit"},iconList:[],icon_color:"",purpose_of_status:"",module:"",showErr:!1,loading:!1}},beforeMount(){const e=window.location.pathname;this.getValues(e),this.getIconList()},computed:{getPurposeOfStatusEndpoint(){return this.module?`/service-desk/api/status/type/${this.module.id}`:"/service-desk/api/status/type/"}},methods:{getIconList(){T.get("/json/icon-list.json").then(e=>{this.iconList=e.data.data}).catch(e=>{this.iconList=[]})},getValues(e){const t=pe(e);e.indexOf("edit")>=0?(this.page_title="edit_status",this.iconClass="fas fa-sync-alt",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,T.get("/service-desk/api/status/edit/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.status_id=e;let s=t.data.data;this.updateStatesWithData(s),this.icon_class={icon_class:s.icon_class}}).catch(t=>{this.loading=!1,O(t)})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])})},onChange(e,t){this[t]=e,e===null&&(this[t]="")},isValid(){const{errors:e,isValid:t}=J9(this.$data);return t},onSubmit(){if(this.icon_color=this.icon_color==="#"?"":this.icon_color,this.showErr=!this.icon_color,this.isValid()&&this.icon_color){this.loading=!0;let e={};e.name=this.name,e.display_order=this.display_order,e.icon_color=this.icon_color,e.icon_class=this.icon_class.icon_class,e.purpose_of_status=this.purpose_of_status.id,e.module=this.module.id,this.status_id&&(e.id=this.status_id);let t="service-desk/api/store/status";T.post(t,e).then(s=>{this.loading=!1,K(s,"status-create-edit"),this.status_id?this.getInitialValues(this.status_id):setTimeout(()=>{this.$router.push({name:"Sd Status Index"})},3e3)}).catch(s=>{this.loading=!1,O(s,"status-create-edit")})}}},components:{alert:We,"text-field":Ae,"number-field":ts,"dynamic-select":fe,"color-picker":En,"radio-button":mt}},X9={class:"container col-sm-12"},Z9={key:0},Q9={key:1,class:"card card-light"},ez={class:"card-header"},tz={class:"card-title"},sz={class:"card-body"},az={class:"row"},nz={class:"row"},oz={class:"pb-1"},iz={key:0,class:"error-block is-danger"},lz={class:"row"},rz={class:"card-footer"};function dz(e,t,s,d,a,i){const m=u("alert"),h=u("custom-loader"),b=u("text-field"),f=u("number-field"),g=u("dynamic-select"),D=u("color-picker"),M=W("tooltip");return o(),l("div",X9,[_(m,{componentName:"status-create-edit"}),!a.hasDataPopulated||a.loading?(o(),l("div",Z9,[_(h,{loadingSpeed:4e3})])):c("",!0),a.hasDataPopulated?(o(),l("div",Q9,[n("div",ez,[n("h3",tz,r(e.trans(a.page_title)),1)]),n("div",sz,[n("div",az,[_(b,{label:e.trans("name"),type:"text",value:a.name,name:"name",class:"col-sm-6",required:!0,onChange:i.onChange,placehold:e.lang("enter_a_value")},null,8,["label","value","onChange","placehold"]),_(f,{label:e.trans("display_order"),value:a.display_order,name:"display_order",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"])]),n("div",nz,[_(g,{name:"icon_class",label:e.trans("icon_class"),value:a.icon_class,onChange:i.onChange,classname:"col-sm-6",elements:a.iconList,multiple:!1,"option-label":"icon_class",required:!0,clearable:!1},null,8,["label","value","onChange","elements"]),n("div",{class:Q(["col-sm-6 form-group",{"has-error":a.showErr}])},[S((o(),l("label",oz,[v(r(e.trans("icon_color"))+" ",1),t[1]||(t[1]=n("span",{class:"text-danger"}," *",-1))])),[[M,e.trans("icon_color")]]),_(D,{color:a.icon_color,name:"icon_color",onColor:i.onChange,showError:a.showErr},null,8,["color","onColor","showError"]),a.showErr?(o(),l("div",iz,r(e.trans("this_field_is_required")),1)):c("",!0)],2)]),n("div",lz,[_(g,{label:e.trans("module"),multiple:!1,name:"module",required:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/modules/list?status=1",value:a.module,onChange:i.onChange,clearable:!!a.module,hint:e.trans("sd_module_for_which_status_needs_to_be_created")},null,8,["label","value","onChange","clearable","hint"]),_(g,{label:e.trans("purpose_of_status"),multiple:!1,name:"purpose_of_status",required:!0,classname:"col-sm-6",apiEndpoint:i.getPurposeOfStatusEndpoint,value:a.purpose_of_status,onChange:i.onChange,clearable:!!a.purpose_of_status,hint:e.trans("purpose_of_status_will_perform_the_action_to_be_applied_on_the_status_selection")},null,8,["label","apiEndpoint","value","onChange","clearable","hint"])])]),n("div",rz,[n("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...x)=>i.onSubmit&&i.onSubmit(...x))},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.trans(a.btnName)),1)])])])):c("",!0)])}const oa=P(G9,[["render",dz]]);const cz={name:"depreciation-modal",description:"Depreciation Modal component",props:{showModal:{type:Boolean,default:!1},data:{type:[Object,String],default:()=>{}},title:{type:String,default:""},apiUrl:{type:String,default:()=>{}},alertData:{type:String,default:()=>{}},routeData:{type:String,default:()=>{}},onClose:{type:Function}},data:()=>({containerStyle:{width:"500px"},loading:!1,isDisabled:!1}),beforeMount(){this.title!=="delete"&&(this.containerStyle.width="800px")},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,T.delete(this.apiUrl+this.data.id).then(e=>{K(e,this.alertData),this.afterRespond(),setTimeout(()=>{this.$router.push({name:this.routeData})},3e3)}).catch(e=>{O(e,this.alertData),this.afterRespond()})},afterRespond(){this.onClose(),this.loading=!1,this.isDisabled=!0}}},uz={class:"modal-title"},mz={key:0},hz={key:0},pz={key:1,class:"row"},_z=["disabled"];function fz(e,t,s,d,a,i){const m=u("reuse-loader"),h=u("modal");return o(),l("div",null,[s.showModal?(o(),k(h,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},Qt({title:w(()=>[n("h4",uz,r(e.lang(s.title)),1)]),fields:w(()=>[e.loading?c("",!0):(o(),l("div",mz,[s.title==="delete"?(o(),l("span",hz,r(e.lang("are_you_sure_you_want_to_delete")),1)):c("",!0)])),e.loading?(o(),l("div",pz,[_(m,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),_:2},[s.title==="delete"?{name:"controls",fn:w(()=>[n("button",{type:"button",onClick:t[0]||(t[0]=(...b)=>i.onSubmit&&i.onSubmit(...b)),class:"btn btn-secondary",disabled:e.isDisabled},[t[1]||(t[1]=n("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)),v(" "+r(e.lang("delete")),1)],8,_z)]),key:"0"}:void 0]),1032,["showModal","onClose","containerStyle"])):c("",!0)])}const Ua=P(cz,[["render",fz]]);const gz={name:"depreciation-list",description:"depreciation lists table component",data:()=>({columns:["name","useful_life","type","actions"],options:{},apiUrl:"service-desk/api/deprecation-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),useful_life:e.lang("useful-life"),type:e.lang("type"),actions:e.lang("actions")},columnsClasses:{name:"depreciation-name",months:"depreciation-months",useful_life:"depreciation-useful-life",type:"depreciation-type"},templates:{floor_value(t,s){return s.floor_value?s.floor_value:"---"},actions:(t,s)=>e.h(qe,{data:s})},sortable:["name","months","floor_value"],filterable:["name","months","floor_value"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.depreciation.map(s=>(s.view_url="/service-desk/deprication/"+s.id+"/show",s.edit_url="/service-desk/deprication/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/deprecation/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},bz={class:"col-sm-12"},yz={class:"card card-light"},vz={class:"card-header"},wz={id:"depreciation-list",class:"card-title"},kz={class:"card-tools"},Cz={class:"card-body",id:"depreciation-table"};function Dz(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",bz,[_(m,{componentName:"dataTableModal"}),n("div",yz,[n("div",vz,[n("h3",wz,r(e.lang("list_of_depreciation")),1),n("div",kz,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/deprication/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_depreciation")]])])]),n("div",Cz,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"depreciation-list"},null,8,["url","dataColumns","option"])])])])}const Sz=P(gz,[["render",Dz]]);function Mz(e){const{name:t,number_of_months:s,type:d}=e;var a={name:[t,"isRequired"],number_of_months:[s,"isRequired","number_of_months"],type:[d,"isRequired","number_of_months"]};const i=new Ue(Ce),{errors:m,isValid:h}=i.validate(a);return Fe.dispatch("setValidationError",m),{errors:m,isValid:h}}const Fz={name:"depreciation-create-edit",props:{from:{type:String,default:""},onComplete:{type:Function}},data(){return{isEditMode:!1,title:"create_depreciation",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,depreciation_id:"",name:"",type:"",useful_life:"",depreciationOptions:[{id:"Straight Line",name:"Straight Line"},{id:"Double Declining Balance",name:"Double Declining Balance"},{id:"Sum-of-Years Digits",name:"Sum-of-Years Digits"}],depreciation_methods:""}},beforeMount(){const e=window.location.pathname;this.isEditMode=e.includes("edit"),this.getValues(e)},methods:{async getValues(e){const t=pe(e);e.includes("edit")?this.from?(this.loading=!1,this.hasDataPopulated=!0):(this.title="edit_depreciation",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,await this.getInitialValues(t),this.loading=!1):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,T.get("service-desk/api/deprecation/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(t.data.data.depreciation),this.depreciation_id=t.data.data.depreciation.id}).catch(t=>{this.loading=!1,O(t,"depreciation-create-edit"),this.hasDataPopulated=!0})},updateStatesWithData(e){Object.keys(e).map(t=>{this.$data.hasOwnProperty(t)&&(this[t]=e[t])})},isValid(){const{errors:e,isValid:t}=Mz(this.$data);return!!t},onChange(e,t){e!==0&&(this[t]=e)},onSubmit(){if(this.isValid()){this.loading=!0;const e=new FormData;this.depreciation_id!==""&&e.append("id",this.depreciation_id),e.append("name",this.name),e.append("useful_life",this.useful_life),e.append("type",this.type);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("service-desk/api/deprecation",e,t).then(s=>{this.loading=!1,K(s,"depreciation-create-edit"),!this.from||!this.depreciation_id?setTimeout(()=>{let d=s.data.data.id;this.$router.push("/service-desk/deprication/"+d+"/show")},3e3):this.getInitialValues(this.depreciation_id).then(()=>{this.from&&this.onComplete(this.name,"depreciation-create-edit")})}).catch(s=>{this.loading=!1,O(s,"depreciation-create-edit")})}}},components:{"static-select":qt,"tool-tip":Ot,"text-field":Ae,"number-field":ts}},Iz={class:"col-sm-12"},Az={key:0,class:"row"},Pz={key:0,class:"card-header"},Tz={class:"card-title"},Vz={class:"card-tools"},Lz={class:"row"},Uz={key:1,class:"card-footer"};function Nz(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("router-link"),f=u("text-field"),g=u("number-field"),D=u("static-select"),M=W("tooltip");return o(),l("div",Iz,[!a.hasDataPopulated||a.loading?(o(),l("div",Az,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"depreciation-create-edit"}),a.hasDataPopulated?(o(),l("div",{key:1,class:Q([{"card card-light":!s.from}])},[s.from?c("",!0):(o(),l("div",Pz,[n("h3",Tz,r(e.lang(a.title)),1),n("div",Vz,[a.depreciation_id?S((o(),k(b,{key:0,id:"view_depreciation_id",class:"btn btn-tool m-unset",to:"/service-desk/deprication/"+a.depreciation_id+"/show"},{default:w(()=>t[1]||(t[1]=[n("span",{class:"fas fa-eye"},null,-1)])),_:1},8,["to"])),[[M,e.lang("view")]]):c("",!0)])])),n("div",{class:Q([{"card-body":!s.from}])},[n("div",Lz,[_(f,{label:e.lang("name"),value:a.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),_(g,{label:e.lang("useful_life"),value:a.useful_life,name:"useful_life",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"]),_(D,{label:e.trans("depreciation_methods"),elements:a.depreciationOptions,name:"type",onChange:i.onChange,required:!0,classname:"col-sm-6",value:a.type,disabled:a.isEditMode},null,8,["label","elements","onChange","value","disabled"])])],2),s.from?c("",!0):(o(),l("div",Uz,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=x=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])]))],2)):c("",!0)])}const ia=P(Fz,[["render",Nz]]);const Ez={name:"depreciation-view",description:"depreciation details page component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{hasDataPopulated:!1,loading:!1,deprecationData:"",showModal:!1,title:"",apiUrl:"/service-desk/api/deprecation/",alertData:"depreciation-view",routeData:"Depreciation Index"}},beforeMount(){const e=window.location.pathname;this.getInitialValues(e)},methods:{subString(e,t=20){return Ie(e,t)},getInitialValues(e){const t=pe(e);this.loading=!0,T.get("/service-desk/api/deprecation/"+t).then(s=>{this.loading=!1,this.hasDataPopulated=!0,this.deprecationData=s.data.data.depreciation}).catch(s=>{this.loading=!1,O(s,"depreciation-view"),this.hasDataPopulated=!0})},modalMethod(e){this.title=e,this.showModal=!0},onClose(){this.showModal=!1}},components:{"depreciation-modal":Ua}},xz={class:"col-sm-12"},Oz={key:0,class:"row"},qz={key:1,class:"card card-light"},jz={class:"card-header"},Rz={class:"card-title"},Bz={class:"card-tools"},zz={class:"card-body"},Kz={class:"row mb-3"},Hz={class:"col-md-12"},Yz={class:"callout callout-info"},$z={class:"row"},Wz={class:"col-md-6"},Jz={class:"col-md-6"},Gz={class:"col-md-12"},Xz={class:"row mx-1"},Zz={class:"col-md-6 info-row d-flex"},Qz={class:"col-md-6"},eK={class:"col-md-6"},tK={class:"text-primary"},sK={class:"col-md-6 info-row d-flex"},aK={class:"col-md-6"},nK={class:"col-md-6"},oK={class:"text-primary"};function iK(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("router-link"),f=u("depreciation-modal"),g=W("tooltip");return o(),l("div",xz,[_(m,{componentName:"depreciation-view"}),!a.hasDataPopulated||a.loading?(o(),l("div",Oz,[_(h,{"animation-duration":4e3,size:60})])):c("",!0),a.hasDataPopulated&&a.deprecationData?(o(),l("div",qz,[n("div",jz,[S((o(),l("h3",Rz,[v(r(i.subString(a.deprecationData.name,50)),1)])),[[g,a.deprecationData.name]]),n("div",Bz,[S((o(),k(b,{class:"btn btn-tool",to:"/service-desk/deprication/"+a.deprecationData.id+"/edit"},{default:w(()=>t[1]||(t[1]=[n("span",{class:"fas fa-edit"},null,-1)])),_:1},8,["to"])),[[g,e.lang("edit")]]),S((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=D=>i.modalMethod("delete")),href:"javascript:;"},t[2]||(t[2]=[n("span",{class:"fas fa-trash"},null,-1)]))),[[g,e.lang("delete")]])])]),n("div",zz,[n("div",Kz,[n("div",Hz,[n("div",Yz,[n("div",$z,[n("div",Wz,[n("b",null,r(e.lang("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.deprecationData.created_at)),1)])),[[g,d.formattedTime(a.deprecationData.created_at)]])]),n("div",Jz,[n("b",null,r(e.lang("updated_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.deprecationData.updated_at)),1)])),[[g,d.formattedTime(a.deprecationData.updated_at)]])])])])])]),n("div",Gz,[n("div",Xz,[n("div",Zz,[n("div",Qz,[n("label",null,r(e.lang("useful_life")),1)]),n("div",eK,[S((o(),l("a",tK,[v(r(i.subString(a.deprecationData.useful_life)),1)])),[[g,a.deprecationData.useful_life]])])]),n("div",sK,[n("div",aK,[n("label",null,r(e.lang("depreciation_methods")),1)]),n("div",nK,[S((o(),l("a",oK,[v(r(i.subString(a.deprecationData.type?a.deprecationData.type:"---")),1)])),[[g,a.deprecationData.type]])])])])])])])):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(f,{key:0,onClose:i.onClose,showModal:a.showModal,data:a.deprecationData,routeData:a.routeData,alertData:a.alertData,apiUrl:a.apiUrl,title:a.title},null,8,["onClose","showModal","data","routeData","alertData","apiUrl","title"])):c("",!0)]),_:1})])}const lK=P(Ez,[["render",iK],["__scopeId","data-v-5d70762d"]]);const rK={name:"ManufacturersIndex",description:"manufacturer lists table component",data:()=>({columns:["name","support_number","support_url","support_mail","actions"],options:{},apiUrl:"service-desk/api/manufacturer-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),support_number:e.lang("support_number"),support_url:e.lang("support_url"),support_mail:e.lang("support_mail"),actions:e.lang("actions")},columnsClasses:{name:"manufacturer-name",support_number:"manufacturer-support_number",support_url:"manufacturer-support_url",support_mail:"manufacturer-support_mail"},templates:{support_number(t,s){return s.support_number?s.support_number:"---"},support_url(t,s){return s.support_url?s.support_url:"---"},support_mail(t,s){return s.support_mail?s.support_mail:"---"},actions:(t,s)=>e.h(qe,{data:s})},sortable:["name","support_number","support_mail","support_url"],filterable:["name","support_number","support_mail","support_url"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.manufacturer.map(s=>(s.view_url="/service-desk/manufacturers/"+s.id+"/show",s.edit_url="/service-desk/manufacturers/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/manufacturer/"+s.id,s)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}}},dK={class:"col-sm-12"},cK={class:"card card-light"},uK={class:"card-header"},mK={id:"manufacturer-list",class:"card-title"},hK={class:"card-tools"},pK={class:"card-body",id:"manufacturer-table"};function _K(e,t,s,d,a,i){const m=u("alert"),h=u("router-link"),b=u("data-table"),f=W("tooltip");return o(),l("div",dK,[_(m,{componentName:"dataTableModal"}),n("div",cK,[n("div",uK,[n("h3",mK,r(e.lang("list_of_manufacturers")),1),n("div",hK,[S((o(),k(h,{class:"btn btn-tool",to:"/service-desk/manufacturers/create"},{default:w(()=>t[0]||(t[0]=[n("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[f,e.lang("create_manufacturer")]])])]),n("div",pK,[_(b,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"manufacturer-list"},null,8,["url","dataColumns","option"])])])])}const fK=P(rK,[["render",_K]]);function gK(e){const{name:t,support_mail:s}=e;var d={name:[t,"isRequired"],support_mail:[s,"isEmail"]};const a=new Ue(Ce),{errors:i,isValid:m}=a.validate(d);return Fe.dispatch("setValidationError",i),{errors:i,isValid:m}}const bK={name:"manufacturers-create-edit",props:{from:{type:String,default:""},onComplete:{type:Function}},data(){return{title:"create_manufacturer",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,manufacturer_id:"",name:"",support_number:"",support_url:"",support_mail:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{async getValues(e){const t=pe(e);e.includes("edit")?this.from?(this.loading=!1,this.hasDataPopulated=!0):(this.title="edit_manufacturer",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,await this.getInitialValues(t),this.loading=!1):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,T.get("service-desk/api/manufacturer/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(t.data.data.sd_manufacturer),this.manufacturer_id=t.data.data.sd_manufacturer.id}).catch(t=>{this.loading=!1,O(t,"manufacturers-create-edit"),this.hasDataPopulated=!0})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])})},isValid(){const{errors:e,isValid:t}=gK(this.$data);return!!t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.manufacturer_id!=""&&e.append("id",this.manufacturer_id),e.append("name",this.name),e.append("support_number",this.support_number),e.append("support_url",this.support_url),e.append("support_mail",this.support_mail);const t={headers:{"Content-Type":"multipart/form-data"}};T.post("service-desk/api/manufacturer",e,t).then(s=>{this.loading=!1,K(s,"manufacturers-create-edit"),this.from||(this.manufacturer_id?this.getInitialValues(this.manufacturer_id):setTimeout(()=>{let d=s.data.data.id;this.$router.push("/service-desk/manufacturers/"+d+"/show")},3e3))}).catch(s=>{this.loading=!1,O(s,"manufacturers-create-edit")})}}},components:{"text-field":Ae,"number-field":ts}},yK={class:"col-sm-12"},vK={key:0,class:"row"},wK={key:0,class:"card-header"},kK={class:"card-title"},CK={class:"card-tools"},DK={class:"row"},SK={class:"row"},MK={key:1,class:"card-footer"};function FK(e,t,s,d,a,i){const m=u("custom-loader"),h=u("alert"),b=u("router-link"),f=u("text-field"),g=u("number-field"),D=W("tooltip");return o(),l("div",yK,[!a.hasDataPopulated||a.loading?(o(),l("div",vK,[_(m,{duration:4e3})])):c("",!0),_(h,{componentName:"manufacturers-create-edit"}),a.hasDataPopulated?(o(),l("div",{key:1,class:Q([{"card card-light":!s.from}])},[s.from?c("",!0):(o(),l("div",wK,[n("h3",kK,r(e.lang(a.title)),1),n("div",CK,[a.manufacturer_id?S((o(),k(b,{key:0,id:"view_manufacturer_id",class:"btn btn-tool m-unset",to:"/service-desk/manufacturers/"+a.manufacturer_id+"/show"},{default:w(()=>t[1]||(t[1]=[n("span",{class:"fas fa-eye"},null,-1)])),_:1},8,["to"])),[[D,e.lang("view")]]):c("",!0)])])),n("div",{class:Q([{"card-body":!s.from}])},[n("div",DK,[_(f,{label:e.lang("name"),value:a.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),_(g,{label:e.lang("support_number"),value:a.support_number,name:"support_number",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"])]),n("div",SK,[_(f,{label:e.lang("support_url"),value:a.support_url,name:"support_url",classname:"col-sm-6",onChange:i.onChange,placehold:e.lang("enter_a_value")},null,8,["label","value","onChange","placehold"]),_(f,{label:e.lang("support_mail"),value:a.support_mail,name:"support_mail",classname:"col-sm-6",onChange:i.onChange,placehold:e.lang("enter_a_value"),type:"email",defaultKey:"email",required:!0},null,8,["label","value","onChange","placehold"])])],2),s.from?c("",!0):(o(),l("div",MK,[n("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=M=>i.onSubmit())},[n("i",{class:Q(a.iconClass)},null,2),v(" "+r(e.lang(a.btnName)),1)])]))],2)):c("",!0)])}const la=P(bK,[["render",FK]]);const IK={name:"manufacturer-view",description:"manufacturer details page component",setup(){const e=re();return{formattedTime:z(()=>e.getters.formattedTime),formattedDate:z(()=>e.getters.formattedDate)}},data(){return{hasDataPopulated:!1,loading:!1,manufacturerData:"",showModal:!1,title:"",apiUrl:"/service-desk/api/manufacturer/",alertData:"manufacturer-view",routeData:"Manufacturers Index"}},beforeMount(){const e=window.location.pathname;this.getInitialValues(e)},methods:{subString(e,t=20){return Ie(e,t)},getInitialValues(e){const t=pe(e);this.loading=!0,T.get("service-desk/api/manufacturer/"+t).then(s=>{this.loading=!1,this.hasDataPopulated=!0,this.manufacturerData=s.data.data.sd_manufacturer,this.manufacturerData.support_mail=this.handleEmptyField(this.manufacturerData.support_mail),this.manufacturerData.support_number=this.handleEmptyField(this.manufacturerData.support_number),this.manufacturerData.support_url=this.handleEmptyField(this.manufacturerData.support_url)}).catch(s=>{this.loading=!1,O(s,"manufacturer-view"),this.hasDataPopulated=!0})},handleEmptyField(e){return e===""?"---":e},modalMethod(e){this.title=e,this.showModal=!0},onClose(){this.showModal=!1}},components:{"depreciation-modal":Ua}},AK={class:"col-sm-12"},PK={key:0,class:"row"},TK={key:1,class:"card card-light"},VK={class:"card-header"},LK={class:"card-title"},UK={class:"card-tools"},NK={class:"card-body"},EK={class:"row mb-3"},xK={class:"col-md-12"},OK={class:"callout callout-info"},qK={class:"row"},jK={class:"col-md-6"},RK={class:"col-md-6"},BK={class:"col-md-12"},zK={class:"row mx-1"},KK={class:"col-md-6 info-row d-flex"},HK={class:"col-md-6"},YK={class:"col-md-6"},$K={class:"text-primary"},WK={class:"col-md-6 info-row d-flex"},JK={class:"col-md-6"},GK={class:"col-md-6"},XK={class:"text-primary"},ZK={class:"col-md-6 info-row d-flex"},QK={class:"col-md-6"},eH={class:"col-md-6"},tH={class:"text-primary"};function sH(e,t,s,d,a,i){const m=u("alert"),h=u("reuse-loader"),b=u("router-link"),f=u("depreciation-modal"),g=W("tooltip");return o(),l("div",AK,[_(m,{componentName:"manufacturer-view"}),!a.hasDataPopulated||a.loading?(o(),l("div",PK,[_(h,{"animation-duration":4e3,size:60})])):c("",!0),a.hasDataPopulated&&a.manufacturerData?(o(),l("div",TK,[n("div",VK,[S((o(),l("h3",LK,[v(r(i.subString(a.manufacturerData.name,50)),1)])),[[g,a.manufacturerData.name]]),n("div",UK,[S((o(),k(b,{class:"btn btn-tool",to:"/service-desk/manufacturers/"+a.manufacturerData.id+"/edit"},{default:w(()=>t[1]||(t[1]=[n("span",{class:"fas fa-edit"},null,-1)])),_:1},8,["to"])),[[g,e.lang("edit")]]),S((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=D=>i.modalMethod("delete")),href:"javascript:;"},t[2]||(t[2]=[n("span",{class:"fas fa-trash"},null,-1)]))),[[g,e.lang("delete")]])])]),n("div",NK,[n("div",EK,[n("div",xK,[n("div",OK,[n("div",qK,[n("div",jK,[n("b",null,r(e.lang("created_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.manufacturerData.created_at)),1)])),[[g,d.formattedTime(a.manufacturerData.created_at)]])]),n("div",RK,[n("b",null,r(e.lang("updated_date"))+" : ",1),S((o(),l("span",null,[v(r(d.formattedTime(a.manufacturerData.updated_at)),1)])),[[g,d.formattedTime(a.manufacturerData.updated_at)]])])])])])]),n("div",BK,[n("div",zK,[n("div",KK,[n("div",HK,[n("label",null,r(e.lang("support_mail")),1)]),n("div",YK,[S((o(),l("a",$K,[v(r(i.subString(a.manufacturerData.support_mail?a.manufacturerData.support_mail:"---")),1)])),[[g,a.manufacturerData.support_mail]])])]),n("div",WK,[n("div",JK,[n("label",null,r(e.lang("support_number")),1)]),n("div",GK,[S((o(),l("a",XK,[v(r(i.subString(a.manufacturerData.support_number?a.manufacturerData.support_number:"---")),1)])),[[g,a.manufacturerData.support_number]])])]),n("div",ZK,[n("div",QK,[n("label",null,r(e.lang("support_url")),1)]),n("div",eH,[S((o(),l("a",tH,[v(r(i.subString(a.manufacturerData.support_url?a.manufacturerData.support_url:"---")),1)])),[[g,a.manufacturerData.support_url]])])]),t[3]||(t[3]=n("div",{class:"col-md-6 info-row d-flex"},null,-1))])])])])):c("",!0),_(X,{name:"modal"},{default:w(()=>[a.showModal?(o(),k(f,{key:0,onClose:i.onClose,showModal:a.showModal,data:a.manufacturerData,routeData:a.routeData,alertData:a.alertData,apiUrl:a.apiUrl,title:a.title},null,8,["onClose","showModal","data","routeData","alertData","apiUrl","title"])):c("",!0)]),_:1})])}const aH=P(IK,[["render",sH],["__scopeId","data-v-6010468b"]]);const nH={name:"currency",components:{currencySelect:$n},data(){return{currency:"",currencyOptions:kn(),isLoading:!1}},mounted(){this.getInitialValues()},methods:{onChange(e,t){this[t]=e||""},getInitialValues(){this.isLoading=!0,T.get("service-desk/api/currency").then(e=>{this.currency=e.data.data.currency||"USD",this.hasDataPopulated=!0}).catch(e=>{O(e,"currency-create")}).finally(()=>{this.isLoading=!1})},onSubmit(){if(!this.isValid())return;this.isLoading=!0;const e={currency:this.currency};T.post("service-desk/api/currency",e).then(t=>{K(t,"currency-create"),this.getInitialValues()}).catch(t=>{O(t,"currency-create")}).finally(()=>{this.isLoading=!1})},isValid(){const{errors:e,isValid:t}=Wn(this.$data);return t}}},oH={class:"col-sm-12"},iH={class:"row"};function lH(e,t,s,d,a,i){const m=u("alert"),h=u("currency-select"),b=u("faveo-box");return o(),l("div",oH,[_(m,{componentName:"currency-create"}),_(b,{title:e.trans("currency")},{default:w(()=>[n("div",iH,[_(h,{name:"currency",classname:"col-sm-4 faveo-dynamic-select",options:a.currencyOptions,label:e.lang("currency"),value:a.currency,onChange:i.onChange,required:!0},null,8,["options","label","value","onChange"])]),n("div",null,[n("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...f)=>i.onSubmit&&i.onSubmit(...f))},[t[1]||(t[1]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(e.trans("save")),1)])])]),_:1},8,["title"])])}const rH=P(nH,[["render",lH],["__scopeId","data-v-80a56287"]]);const dH={class:"modal-title"},cH={class:"row"},uH={class:"col-sm-12"},mH={class:"command-display"},hH={__name:"SoftwareCommandModal",props:{onClose:{type:Function,default:()=>{}},showModal:{type:Boolean,default:!1},command:{type:String,required:!0}},setup(e){const t=e,s=se({width:"800px"}),d=se(!1),a=()=>{xn(t.command),d.value=!0,setTimeout(()=>{d.value=!1,t.onClose()},2e3)};return(i,m)=>{const h=u("alert"),b=u("modal"),f=W("tooltip");return e.showModal?(o(),k(b,{key:0,showModal:e.showModal,onClose:e.onClose,containerStyle:s.value},{title:w(()=>[n("h4",dH,r(i.trans("command_to_install_agent")),1)]),alert:w(()=>[_(h,{componentName:"command-modal"})]),fields:w(()=>[n("div",cH,[n("div",uH,[n("pre",mH,r(e.command),1)])])]),controls:w(()=>[S((o(),l("button",{type:"button",onClick:a,class:"btn btn-primary"},[n("span",{class:Q(d.value?"fas fa-check":"fa fa-clipboard"),id:"eye"},null,2),v("  "+r(i.trans("Copy")),1)])),[[f,d.value?i.trans("clipboard-copy-message"):i.trans("click-to-copy")]])]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}}},pH=P(hH,[["__scopeId","data-v-aa86bce2"]]);const _H={class:"col-sm-12"},fH={class:"card card-light"},gH={class:"card-header"},bH={class:"card-title"},yH={class:"card-body"},vH={class:"row"},wH={class:"col-sm-12"},kH={class:"text-center mt-5"},CH={class:"row mt-4 mb-5 justify-content-center"},DH=["onClick"],SH={class:"pt-5 device-label"},MH={key:0,class:"text-center p-3"},FH={class:"d-flex justify-content-center p-3"},IH={key:0,class:"d-flex"},AH=["id","value"],PH=["for"],TH={key:0,class:"text-center"},VH={__name:"AgentSoftwareSettings",setup(e){const{basePath:t}=us.methods,s=se([{id:1,name:"Windows",icon:"fab fa-windows",versions:[{label:"64 bit version",value:"amd64"}]},{id:2,name:"MacOS",icon:"fab fa-apple",versions:[{label:"Intel 64 version",value:"amd64"},{label:"Apple Silicon (M-series) version",value:"arm64"}]},{id:3,name:"Linux",icon:"fab fa-linux",versions:[{label:"64 bit version",value:"amd64"},{label:"ARM 64 bit version",value:"arm64"}]}]),d=se(null),a=se(null),i=se(!1),m=se(""),h=f=>{d.value=f;const g=s.value.find(D=>D.id===f);a.value=g.versions[0].value},b=async()=>{if(d.value&&a.value){const f=s.value.find(R=>R.id===d.value),g=f.versions.find(R=>R.value===a.value),D=f.name==="MacOS"?"mac":f.name.toLowerCase(),M=g.value,x=`/service-desk/install/agent?platform=${D}&architecture=${M}`;try{const R=await T.get(x);R.data&&R.data.data&&R.data.data.command?(m.value=R.data.data.command,i.value=!0):window.location.href=t()+x}catch(R){O(R,"agent-software-download")}}};return(f,g)=>{const D=u("alert");return o(),l("div",_H,[_(D,{componentName:"agent-software-download"}),n("div",fH,[n("div",gH,[n("h3",bH,r(f.trans("agent_software")),1)]),n("div",yH,[n("div",vH,[n("div",wH,[n("div",kH,[n("h2",null,r(f.trans("select_your_faveo_agent_software")),1)]),n("div",CH,[(o(!0),l(U,null,$(s.value,M=>(o(),l("div",{key:M.id,class:Q(["col-md-3 col-sm-4 text-center p-3",{settingiconblue:d.value===M.id}])},[n("a",{href:"javascript:;",onClick:x=>h(M.id)},[n("i",{class:Q([M.icon,"device-icons"])},null,2),n("h5",SH,r(M.name),1)],8,DH)],2))),128))]),d.value?(o(),l("div",MH,[n("h5",null,r(f.trans("choose_your_version")),1),n("div",FH,[(o(!0),l(U,null,$(s.value,M=>(o(),l("div",{key:M.id},[M.id===d.value?(o(),l("div",IH,[(o(!0),l(U,null,$(M.versions,x=>(o(),l("div",{class:"d-flex align-items-center me-3",key:x.value},[S(n("input",{class:"verison-option",type:"radio",id:x.value,value:x.value,"onUpdate:modelValue":g[0]||(g[0]=R=>a.value=R)},null,8,AH),[[ls,a.value]]),n("label",{for:x.value,class:"version-label"},r(x.label),9,PH)]))),128))])):c("",!0)]))),128))]),d.value&&a.value?(o(),l("div",TH,[n("button",{onClick:b,class:"btn btn-primary btn-lg"},r(f.trans("download")),1)])):c("",!0)])):c("",!0)])])])]),_(X,{name:"modal"},{default:w(()=>[_(pH,{showModal:i.value,onClose:()=>{i.value=!1},command:m.value},null,8,["showModal","onClose","command"])]),_:1})])}}},LH=P(VH,[["__scopeId","data-v-296b89c3"]]);function UH(e){const{asset_status:t}=e;var s={asset_status:[t,"isRequired"]};const d=new Ue(Ce),{errors:a,isValid:i}=d.validate(s);return Fe.dispatch("setValidationError",a),{errors:a,isValid:i}}const NH={class:"col-sm-12"},EH={key:0,class:"row"},xH={class:"row"},OH={class:"card-footer"},qH={__name:"NetworkDiscoverySettings",setup(e){const t=se(!1);let s=se({asset_status:""});const d=(h,b)=>{b==="asset_status"&&(s.value.asset_status=h??"")},a=()=>{const{errors:h,isValid:b}=UH(s.value);return b},i=()=>{if(a()){t.value=!0;const h={asset_status_id:s.value.asset_status.id};axios.post("/service-desk/network-discovery/settings",h).then(b=>{t.value=!1,K(b,"network-discovery")}).catch(b=>{t.value=!1,O(b,"network-discovery")})}};return Cn(()=>{t.value=!0,axios.get("/service-desk/network-discovery/settings").then(h=>{const b=h.data.data;s.value.asset_status=b.asset_status,t.value=!1}).catch(h=>{t.value=!1})}),(h,b)=>{const f=u("faveo-box");return o(),l("div",NH,[t.value?(o(),l("div",EH,[_(nt,{duration:4e3})])):c("",!0),_(We,{componentName:"network-discovery"}),_(f,{title:h.trans("network_discovery_settings")},{actions:w(()=>[n("div",OH,[n("button",{class:"btn btn-primary",onClick:b[0]||(b[0]=g=>i())},[b[1]||(b[1]=n("i",{class:"fas fa-save"},null,-1)),v(" "+r(h.trans("save")),1)])])]),default:w(()=>[n("div",xH,[_(fe,{label:h.lang("asset_status"),name:"asset_status",classname:"col-sm-6",apiEndpoint:"/service-desk/api/status/list?module=4",value:we(s).asset_status,onChange:d,hint:h.lang("asset_status_setting_tooltip"),required:!0},null,8,["label","value","hint"])])]),_:1},8,["title"])])}}};Ye("ticket-associated-list",gs,"user-box-mounted","user-view-table");Ye("associated-problem",Ol,"timeline-meta-box-mounted","timeline-meta-list-box");Ye("sd-ticket-actions",Si,"timeline-action-bar-mounted","timeline-action-bar");Ye("ticket-associated-list",gs,"ticket-tab-mounted","timeline-tab");Ye("ticket-associated-list",gs,"org-page-mounted","org-page-table");Ye("user-permissions",Gl,"user-permission-mounted","users-action-div");Ye("dashboard-charts",ir,"dashboard-mounted","dashboard-chart-container");Ye("sd-agent-permission",hr,"permission-list-box-mounted","permission-list-box");Ye("create-form-group-button",gr,"create-form-group-button-mounted","form-group-create-button","admin");Ye("custom-type-form-field",Tr,"custom-type-form-field-mounted","faveo-app-extra-form-field");Ye("create-workflow-button",Nr,"create-workflow-button-mounted","workflow-create-button","admin");Ye("create-listener-button",qr,"create-listener-button-mounted","listener-create-button","admin");let jH=[{path:"/change-approval",component:Us,name:"SD Change Conversation",redirect:"/change-approval/:id",children:[{path:"/change-approval/:id",component:pd,name:"ChangeConversation",meta:{breadcrumb:[{text:"Change Conversation"}]}}]},{path:"/service-desk/contract-approval",component:Us,name:"SD Contract Conversation",redirect:"/service-desk/contract-approval/:hash/:id",children:[{path:"/service-desk/contract-approval/:hash/:id",component:jd,name:"ContractConversation",meta:{breadcrumb:[{text:"Contract Approval"}]}}]}];jH.forEach(function(e){Fn.addRoute(e)});let RH={path:"/service-desk/problem",component:Ct,name:"SD Problems",redirect:"/service-desk/problem/list",children:[{path:"list",name:"Problem Index",component:Rs,meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},active:"problem"}}},{path:"create",name:"Problem Create",component:Bs,props:{category:"problem",panel:"agent"},meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"problem",to:"/service-desk/problem/list"},active:"create"}}},{path:":id/edit",name:"Problem Edit",component:Bs,props:{category:"problem",panel:"agent",showViewButton:!0},meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"problem",to:"/service-desk/problem/list"},active:"edit"}}},{path:":id/show",name:"Problem View",component:lk,meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"problem",to:"/service-desk/problem/list"},active:"view"}}},{path:"filter/:id",name:"Problem Filter",component:Rs,props:{filterIndex:!0},meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},BH={path:"/service-desk/changes",component:Ct,name:"SD Changes",redirect:"/service-desk/changes/list",children:[{path:"list",name:"Changes Index",component:Ks,meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},active:"changes"}}},{path:"create",name:"Change Create",component:Hs,props:{category:"changes",panel:"agent"},meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"changes",to:"/service-desk/changes/list"},active:"create"}}},{path:":id/edit",name:"Change Edit",component:Hs,props:{category:"changes",panel:"agent",showViewButton:!0},meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"changes",to:"/service-desk/changes/list"},active:"edit"}}},{path:":id/show",name:"Change View",component:rI,meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"changes",to:"/service-desk/changes/list"},active:"view"}}},{path:"filter/:id",name:"Change Filter",component:Ks,props:{filterIndex:!0},meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},zH={path:"/service-desk/assets",component:Ct,name:"Servicedesk Assets",redirect:"/service-desk/assets/list",children:[{path:"list",component:Os,name:"SD Assets Index",meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},active:"assets"}}},{path:"create",name:"Asset Create",component:qs,props:{category:"asset",panel:"agent"},meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"assets",to:"/service-desk/assets/list"},active:"create"}}},{path:":id/edit",name:"Asset Edit",component:qs,props:{category:"asset",panel:"agent",showViewButton:!0},meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"assets",to:"/service-desk/assets/list"},active:"edit"}}},{path:":id/show",component:Mg,name:"SD Assets View",meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"assets",to:"/service-desk/assets/list"},active:"view"}}},{path:"filter/:id",name:"Asset Filter",component:Os,props:{filterIndex:!0},meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},KH={path:"/service-desk/contracts",component:Ct,name:"Servicedesk Contracts",redirect:"/service-desk/contracts/list",children:[{path:"list",component:Ys,name:"SD Contracts Index",meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},active:"contracts"}}},{path:"create",name:"Contract Create",component:$s,props:{category:"contract",panel:"agent"},meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"contracts",to:"/service-desk/contracts/list"},active:"create"}}},{path:":id/edit",name:"Contract Edit",component:$s,props:{category:"contract",panel:"agent",showViewButton:!0},meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"contracts",to:"/service-desk/contracts/list"},active:"edit"}}},{path:":id/show",component:D3,name:"SD Contract View",meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"contracts",to:"/service-desk/contracts/list"},active:"view"}}},{path:"filter/:id",name:"Contract Filter",component:Ys,props:{filterIndex:!0},meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},HH={path:"/service-desk/releases",component:Ct,name:"Servicedesk Releases",redirect:"/service-desk/releases/list",children:[{path:"list",component:Ws,name:"SD Release Index",meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},active:"releases"}}},{path:"create",name:"Release Create",component:ds,props:{category:"releases",panel:"agent"},meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"releases",to:"/service-desk/releases/list"},active:"create"}}},{path:":id/edit",name:"Release Edit",component:ds,props:{category:"releases",panel:"agent",showViewButton:!0},meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"releases",to:"/service-desk/releases/list"},active:"edit"}}},{path:":id/show",component:aV,name:"SD Release View",meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"releases",to:"/service-desk/releases/list"},active:"view"}}},{path:"filter/:id",name:"Release Filter",component:Ws,props:{filterIndex:!0},meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},YH={path:"/service-desk/software/license",component:Ct,name:"SD Softwarelicense",redirect:"/service-desk/software/license/list",children:[{path:"list",name:"SoftwareLicense Index",component:Js,meta:{title:"software/license",crumb:{link:{name:"dashboard",to:"/"},active:"software/license"}}},{path:"create",name:"Softwarelicense Create",component:Gs,props:{category:"license",panel:"agent"},meta:{title:"software/license",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"software/license",to:"/service-desk/software/license/list"},active:"create"}}},{path:":id/edit",name:"Softwarelicense Edit",component:Gs,props:{category:"license",panel:"agent",showViewButton:!0},meta:{title:"software/license",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"software/license",to:"/service-desk/software/license/list"},active:"edit"}}},{path:":id/show",name:"Softwarelicense View",component:PU,meta:{title:"software/license",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"software/license",to:"/service-desk/software/license/list"},active:"view"}}},{path:"filter/:id",name:"Softwarelicense Filter",component:Js,props:{filterIndex:!0},meta:{title:"Software License",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},$H=[{path:"/service-desk/reports",component:Ct,name:"Servicedesk Reports",redirect:"/service-desk/reports/get",children:[{path:"get",component:nc,name:"SD Reports Home",meta:{title:"servicedesk_reports",crumb:{active:"servicedesk_reports"}}},{path:"assets",component:hc,name:"SD Reports Index",meta:{title:"assets_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},active:"assets_report"}}},{path:"assets/create",component:xs,name:"SD Reports Create",meta:{title:"assets_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},root_link:{name:"assets_report",to:"/service-desk/reports/assets"},active:"create"}}},{path:"assets/edit/:id",component:xs,name:"SD Reports Edit",meta:{title:"assets_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},root_link:{name:"assets_report",to:"/service-desk/reports/assets"},active:"edit"}}},{path:"assets/:id",component:qu,name:"SD Reports View",meta:{title:"assets_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},root_link:{name:"assets_report",to:"/service-desk/reports/assets"},active:"view"}}},{path:":type/:module/:id",component:_a,name:"SD Reports",meta:{title:"from_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},active:"from_report"}},props:!0}]},RH,BH,zH,KH,HH,YH];$H.forEach(function(e){Un.addRoute(e)});let WH={path:"/service-desk/products",component:Te,name:"Products",redirect:"/service-desk/products/list",children:[{path:"list",component:WU,name:"Products Index",meta:{title:"products",crumb:{link:{name:"admin_panel",to:"/"},active:"products"}}},{path:"create",name:"Product Create",component:Xs,meta:{title:"products",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"products",to:"/service-desk/products"},active:"create"}}},{path:":id/edit",name:"Product Edit",component:Xs,meta:{title:"products",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"products",to:"/service-desk/products"},active:"edit"}}},{path:":id/show",name:"Product View",component:mx,meta:{title:"products",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"products",to:"/service-desk/products"},active:"view"}}}]},JH={path:"/service-desk/procurement",component:Te,name:"Procurement",redirect:"/service-desk/procurement/list",children:[{path:"list",component:wx,name:"Procurement Index",meta:{title:"procurement",crumb:{link:{name:"admin_panel",to:"/"},active:"procurement"}}},{path:"create",name:"Procurement Create",component:Zs,meta:{title:"procurement",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"procurement",to:"/service-desk/procurement"},active:"create"}}},{path:":id/edit",name:"Procurement Edit",component:Zs,meta:{title:"procurement",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"procurement",to:"/service-desk/procurement"},active:"edit"}}}]},GH={path:"/service-desk/contract-type",component:Te,name:"ContractType",redirect:"/service-desk/contract-type/list",children:[{path:"list",component:Rx,name:"Contract Types Index",meta:{title:"contract_types",crumb:{link:{name:"admin_panel",to:"/"},active:"contract_types"}}},{path:"create",name:"Contract Type Create",component:Ls,meta:{title:"contract_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"contract_types",to:"/service-desk/contract-type"},active:"create"}}},{path:":id/edit",name:"Contract Type Edit",component:Ls,meta:{title:"contract_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"contract_types",to:"/service-desk/contract-type"},active:"edit"}}}]},XH={path:"/service-desk/license-type",component:Te,name:"License",redirect:"/service-desk/license-type/list",children:[{path:"list",component:Gx,name:"License Types Index",meta:{title:"license_type",crumb:{link:{name:"admin_panel",to:"/"},active:"license_type"}}},{path:"create",name:"License Type Create",component:Qs,meta:{title:"license_type",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"license_type",to:"/service-desk/license-type"},active:"create"}}},{path:":id/edit",name:"License Type Edit",component:Qs,meta:{title:"license_type",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"license_type",to:"/service-desk/license-type"},active:"edit"}}}]},ZH={path:"/service-desk/vendor",component:Te,name:"Vendor",redirect:"/service-desk/vendor/list",children:[{path:"list",component:fO,name:"Vendor Index",meta:{title:"vendor",crumb:{link:{name:"admin_panel",to:"/"},active:"vendor"}}},{path:"create",name:"Vendor Create",component:rs,meta:{title:"vendor",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"vendor",to:"/service-desk/vendor"},active:"create"}}},{path:":id/edit",name:"Vendor Edit",component:rs,meta:{title:"vendor",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"vendor",to:"/service-desk/vendor"},active:"edit"}}},{path:":id/show",name:"Vendor View",component:wq,meta:{title:"vendor",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"vendor",to:"/service-desk/vendor"},active:"view"}}}]},QH={path:"/service-desk/asset-type",component:Te,name:"Asset Type",redirect:"/service-desk/asset-type/list",children:[{path:"list",component:Pq,name:"asset_types.index",meta:{title:"asset_types",crumb:{link:{name:"admin_panel",to:"/"},active:"asset_types"}}},{path:"create",name:"asset_types.create",component:ea,meta:{title:"asset_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"asset_types",to:"/service-desk/asset-type"},active:"create"}}},{path:":id/edit",name:"asset_types.edit",component:ea,meta:{title:"asset_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"asset_types",to:"/service-desk/asset-type"},active:"edit"}}}]},eY={path:"/service-desk/change-type",component:Te,name:"Change Type",redirect:"/service-desk/change-type/list",children:[{path:"list",component:pj,name:"Change Types Index",meta:{title:"change_types",crumb:{link:{name:"admin_panel",to:"/"},active:"change_types"}}},{path:"create",name:"Change Type Create",component:ta,meta:{title:"change_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"change_types",to:"/service-desk/change-type"},active:"create"}}},{path:":id/edit",name:"Change Type Edit",component:ta,meta:{title:"change_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"change_types",to:"/service-desk/change-type"},active:"edit"}}}]},tY={path:"/service-desk/asset-status",component:Te,name:"Asset Status",redirect:"/service-desk/asset-status/list",children:[{path:"list",component:qj,name:"Asset Statuses Index",meta:{title:"asset_statuses",crumb:{link:{name:"admin_panel",to:"/"},active:"asset_status"}}},{path:"create",name:"Asset Status Create",component:sa,meta:{title:"asset_statuses",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"asset_status",to:"/service-desk/asset-status"},active:"create"}}},{path:":id/edit",name:"Asset Status Edit",component:sa,meta:{title:"asset_statuses",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"asset_status",to:"/service-desk/asset-status"},active:"edit"}}}]},sY={path:"/service-desk/cab",component:Te,name:"CAB",redirect:"/service-desk/cab/list",children:[{path:"list",component:iR,name:"CAB Index",meta:{title:"change_advisory_board",crumb:{link:{name:"admin_panel",to:"/"},active:"change_advisory_board"}}},{path:"create",name:"CAB Create",component:aa,meta:{title:"change_advisory_board",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cabs",to:"/service-desk/cab"},active:"create"}}},{path:":id/edit",name:"CAB Edit",component:aa,meta:{title:"change_advisory_board",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cabs",to:"/service-desk/cab"},active:"edit"}}},{path:":id/show",name:"CAB VIEW",component:BB,meta:{title:"change_advisory_board",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cabs",to:"/service-desk/cab"},active:"view"}}}]},aY={path:"/service-desk/announcement",component:Te,name:"Announcement",redirect:"/service-desk/announcement/settings",children:[{path:"settings",component:t7,name:"Announcement Settings",meta:{title:"announcement",crumb:{link:{name:"admin_panel",to:"/"},active:"announcement"}}}]},nY={path:"/service-desk/barcode",component:Te,name:"Barcode",redirect:"/service-desk/barcode/settings",children:[{path:"settings",component:f7,name:"Barcode Settings",meta:{title:"barcode_settings",crumb:{link:{name:"admin_panel",to:"/"},active:"barcode_settings"}}}]},oY={path:"/service-desk/import-tracking",component:Te,name:"Asset Import Progress",redirect:"/service-desk/import-tracking/settings",children:[{path:":id",component:P7,name:"Asset Import Progress Settings",props:{},meta:{title:"sd_importer_asset_import",crumb:{link:{name:"admin_panel",to:"/"},active:"sd_importer_asset_import"}}}]},iY={path:"/service-desk/asset-importer",component:Te,name:"Asset Import",redirect:"/service-desk/asset-importer/settings",children:[{path:"settings",component:g9,name:"Asset Import Settings",props:{"upload-url":"service-desk/asset-upload-csv","mapping-details-get-url":"service-desk/get-asset-mapping-details/","mapping-post-url":"service-desk/post-asset-mapping","import-type":"asset","discard-url":"service-desk/import-discard/"},meta:{title:"sd_importer_asset_import",crumb:{link:{name:"admin_panel",to:"/"},active:"sd_importer_asset_import"}}}]},lY={path:"/service-desk/cmdb-relation",component:Te,name:"CMDB",redirect:"/service-desk/cmdb-relation/list",children:[{path:"list",component:M9,name:"CMDB Relation Index",meta:{title:"cmdb_relations",crumb:{link:{name:"admin_panel",to:"/"},active:"cmdb_relations"}}},{path:"create",name:"CMDB Create",component:na,meta:{title:"cmdb_relations",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cmdb_relations",to:"/service-desk/cmdb-relation"},active:"create"}}},{path:"edit/:id",name:"CMDB Edit",component:na,meta:{title:"cmdb_relations",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cmdb_relations",to:"/service-desk/cmdb-relation"},active:"edit"}}}]},rY={path:"/service-desk/status",component:Te,name:"SdStatus",redirect:"/service-desk/status/list",children:[{path:"list",component:W9,name:"Sd Status Index",meta:{title:"service_desk_status",crumb:{link:{name:"admin_panel",to:"/"},active:"status"}}},{path:"create",name:"Sd Status Create",component:oa,meta:{title:"service_desk_status",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"status",to:"/service-desk/status/"},active:"create"}}},{path:":id/edit",name:"SD Status Edit",component:oa,meta:{title:"service_desk_status",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"status",to:"/service-desk/status"},active:"edit"}}}]},dY={path:"/service-desk/form-group",component:Te,name:"Form-Groups",redirect:"/service-desk/form-group/create/asset",children:[{path:"create/asset",name:"Asset Form-Group Create",component:$t,props:{"form-name-obj":{id:"name",className:"col-md-6",label:"form_group_name",placeholder:"name_your_form_group",value:"",submitFormParamKey:"name"},"form-linker":[{id:"asset_types",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/asset_types?config=true",label:"asset_type",value:[],submitFormParamKey:"asset_type_ids"}],"post-from-group-api":"service-desk/api/post-form-group/asset","edit-form-group-api":"service-desk/api/get-form-group/asset","form-category-type":"asset","group-mode":"create"},meta:{title:"form-groups",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"form-groups",to:"/form-group"},active:"create"}}},{path:"edit/asset/:id",name:"Asset Form-Group Edit",component:$t,props:{"form-name-obj":{id:"name",className:"col-md-6",label:"form_group_name",placeholder:"name_your_form_group",value:"",submitFormParamKey:"name"},"form-linker":[{id:"asset_types",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/asset_types?config=true",label:"asset_type",value:[],submitFormParamKey:"asset_type_ids"}],"post-from-group-api":"service-desk/api/post-form-group/asset","edit-form-group-api":"service-desk/api/get-form-group/asset","form-category-type":"asset","group-mode":"edit"},meta:{title:"form-groups",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"form-groups",to:"/form-group"},active:"edit"}}},{path:"create/change",name:"Change Form-Group Create",component:$t,props:{"form-name-obj":{id:"name",className:"col-md-6",label:"form_group_name",placeholder:"name_your_form_group",value:"",submitFormParamKey:"name"},"form-linker":[{id:"change_types",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/change_types?config=true",label:"change_type",value:[],submitFormParamKey:"change_type_ids"}],"post-from-group-api":"service-desk/api/post-form-group/change","edit-form-group-api":"service-desk/api/get-form-group/change","form-category-type":"change","group-mode":"create"},meta:{title:"form-groups",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"form-groups",to:"/form-group"},active:"create"}}},{path:"edit/change/:id",name:"Change Form-Group Edit",component:$t,props:{"form-name-obj":{id:"name",className:"col-md-6",label:"form_group_name",placeholder:"name_your_form_group",value:"",submitFormParamKey:"name"},"form-linker":[{id:"change_types",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/change_types?config=true",label:"change_type",value:[],submitFormParamKey:"change_type_ids"}],"post-from-group-api":"service-desk/api/post-form-group/change","edit-form-group-api":"service-desk/api/get-form-group/change","form-category-type":"change","group-mode":"edit"},meta:{title:"form-groups",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"form-groups",to:"/form-group"},active:"edit"}}}]},cY={path:"/service-desk/workflow",component:Te,name:"SD Workflow",redirect:"/service-desk/workflow/create",children:[{path:"create",name:"SD Workflow Create",component:Jt,props:{category:"workflow"},meta:{title:"workflow",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"workflow",to:"/workflow"},active:"create"}}},{path:":id/edit",name:"SD Workflow Edit",component:Jt,props:{category:"workflow"},meta:{title:"workflow",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"workflow",to:"/workflow"},active:"edit"}}}]},uY={path:"/service-desk/listener",component:Te,name:"SD Listener",redirect:"/service-desk/listener/create",children:[{path:"create",name:"SD Listener Create",component:Jt,props:{category:"listener"},meta:{title:"listeners",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"listeners",to:"/listener"},active:"create"}}},{path:":id/edit",name:"SD Listener Edit",component:Jt,props:{category:"listener"},meta:{title:"listeners",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"listeners",to:"/listener"},active:"edit"}}}]},mY={path:"/service-desk/deprication",component:Te,name:"Depreciation",redirect:"/service-desk/deprication/list",children:[{path:"list",component:Sz,name:"Depreciation Index",meta:{title:"depreciation",crumb:{link:{name:"admin_panel",to:"/"},active:"depreciation"}}},{path:"create",name:"Depreciation Create",component:ia,meta:{title:"depreciation",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"depreciation",to:"/service-desk/deprication"},active:"create"}}},{path:":id/edit",name:"Depreciation Edit",component:ia,meta:{title:"depreciation",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"depreciation",to:"/service-desk/deprication"},active:"edit"}}},{path:":id/show",name:"Depreciation View",component:lK,meta:{title:"depreciation",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"depreciation",to:"/service-desk/deprication"},active:"view"}}}]},hY={path:"/service-desk/manufacturers",component:Te,name:"Manufacturers",redirect:"/service-desk/manufacturers/list",children:[{path:"list",component:fK,name:"Manufacturers Index",meta:{title:"manufacturers",crumb:{link:{name:"admin_panel",to:"/"},active:"manufacturers"}}},{path:"create",name:"Manufacturers Create",component:la,meta:{title:"manufacturers",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"manufacturers",to:"/service-desk/manufacturers/"},active:"create"}}},{path:":id/edit",name:"Manufacturers Edit",component:la,meta:{title:"manufacturers",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"manufacturers",to:"/service-desk/manufacturers/"},active:"edit"}}},{path:":id/show",name:"Manufacturers View",component:aH,meta:{title:"manufacturers",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"manufacturers",to:"/service-desk/manufacturers/"},active:"view"}}}]},pY={path:"/service-desk/currency",component:Te,name:"Currency",redirect:"/service-desk/currency/create",children:[{path:"create",component:rH,name:"CurrencyCreate",meta:{title:"Create Currency",crumb:{link:{name:"admin_panel",to:"/"},active:"Create Currency"}}}]},_Y={path:"/service-desk/agent-software",component:Te,name:"Agent Software",redirect:"/service-desk/agent-software/settings",children:[{path:"settings",component:LH,name:"AgentSoftwareSettings",meta:{title:"agent_software",crumb:{link:{name:"admin_panel",to:"/"},active:"Agent Software"}}}]},fY={path:"/service-desk/network-discovery",component:Te,name:"Network Discovery",redirect:"/service-desk/network-discovery/settings",children:[{path:"settings",component:qH,name:"NetworkDiscoverySettings",meta:{title:"network_discovery",crumb:{link:{name:"admin_panel",to:"/"},active:"Network Discovery"}}}]},gY=[pY,WH,JH,GH,XH,ZH,QH,eY,tY,sY,aY,nY,iY,oY,lY,dY,cY,uY,rY,mY,hY,_Y,fY];gY.forEach(function(e){Yn.addRoute(e)});Fe.dispatch("deleteUser");Fe.dispatch("updateUser");app.component("agent-asset-index",bs);app.component("sd-import-mapper",La);const vs=Dn({components:{SDReports:_a}});vs.use(Fe);vs.mixin(us);vs.mount("#sd-reports");
