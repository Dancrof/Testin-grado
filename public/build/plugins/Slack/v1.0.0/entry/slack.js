import{_ as w,B as k,C as y,E as b,T as B,k as d,o as a,m as L,G as C,v as e,x as n,l,F as c,q as r,t as M,I as p,L as D,J as V,K as $,a1 as P,W as N}from"../../../../v9.4.0.5/chunks/bootstrap.js";import{r as q,A as z}from"../../../../v9.4.0.5/chunks/adminRouter.js";import"../../../../v9.4.0.5/chunks/vue-router.js";import"../../../../v9.4.0.5/chunks/FormGenerator.js";import"../../../../v9.4.0.5/chunks/AdminNavigationBar.js";import"../../../../v9.4.0.5/chunks/DataTableActions.js";import"../../../../v9.4.0.5/chunks/Checkbox.js";import"../../../../v9.4.0.5/chunks/HelpSection.js";const E={name:"slack-url-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},data:{type:Object,default:()=>{}},title:{type:String,default:""}},data:()=>({containerStyle:{width:"600px"},loading:!1,url:"",isDisabled:!1,btnClass:"btn btn-primary",iconClass:"glyphicon glyphicon-plus",btnName:"add"}),beforeMount(){this.data&&(this.url=this.data.webhook_url),this.title=="edit"?(this.iconClass="fas fa-sync",this.btnName="update"):this.title=="delete"&&(this.iconClass="fas fa-trash",this.btnName="delete",this.btnClass="btn btn-danger")},methods:{onChange(t,s){this[s]=t},onSubmit(){if(this.url)if(this.loading=!0,this.isDisabled=!0,this.title=="delete")k.delete("/slack/delete/webhook/"+this.data.id).then(t=>{y(t,"slack-settings"),this.onClose(!0),this.loading=!1,this.isDisabled=!1}).catch(t=>{b(t,"slack-settings"),this.onClose()});else{let t={};t.webhook=this.url,this.data&&(t.id=this.data.id),k.post("/slack/update/webhook",t).then(s=>{y(s,"slack-settings"),this.onClose(!0),this.loading=!1,this.isDisabled=!1}).catch(s=>{b(s,"slack-settings"),this.onClose()})}else this.$store.dispatch("setValidationError",{url:"This field is required."})}},components:{"text-field":B}},U={class:"modal-title"},F={key:0,class:"row"},I={key:1,class:"row"},j={key:2,class:"row"},A=["disabled"];function H(t,s,h,S,o,i){const _=d("reuse-loader"),g=d("text-field"),f=d("modal");return h.showModal?(a(),L(f,{key:0,showModal:h.showModal,onClose:h.onClose,containerStyle:t.containerStyle},{title:C(()=>[e("h4",U,n(t.trans(h.title)),1)]),fields:C(()=>[t.loading?(a(),l("div",F,[c(_,{"animation-duration":4e3,color:"#1d78ff",size:t.size},null,8,["size"])])):r("",!0),!t.loading&&h.title!="delete"?(a(),l("div",I,[c(g,{label:t.trans("url"),value:t.url,type:"text",name:"url",onChange:i.onChange,placehold:t.lang("enter_a_value"),classname:"col-sm-12",required:!0},null,8,["label","value","onChange","placehold"])])):r("",!0),!t.loading&&h.title=="delete"?(a(),l("div",j,[e("span",null,n(t.trans("are_you_sure")),1)])):r("",!0)]),controls:C(()=>[e("button",{type:"button",onClick:s[0]||(s[0]=v=>i.onSubmit()),class:M(t.btnClass),disabled:t.isDisabled},[e("i",{class:M(t.iconClass)},null,2),p(" "+n(t.trans(t.btnName)),1)],10,A)]),_:1},8,["showModal","onClose","containerStyle"])):r("",!0)}const R=w(E,[["render",H]]),G={name:"slack-settings",data(){return{showModal:!1,urlList:[],action:"",loading:!0,selectedValue:""}},beforeMount(){this.getUrlList()},methods:{openModal(t,s=""){this.showModal=!0,this.action=t,this.selectedValue=s},onClose(t=!1){this.showModal=!1,this.action="",this.selectedValue="",t&&this.getUrlList()},getUrlList(){this.loading=!0,axios.get("/slack/webhooks").then(t=>{this.urlList=t.data.data,this.loading=!1}).catch(t=>{this.loading=!1})}},components:{"slack-url-create-edit-modal":R}},J={class:"col-sm-12"},K={class:"card card-light"},O={class:"card-header"},W={class:"card-title"},Q={class:"card-tools"},X={class:"card-body"},Y={key:0,class:"row"},Z={key:1,class:"row"},x={key:0,class:"col-sm-12 text-center"},tt={key:1,class:"table border"},et={class:"actions-row"},st=["onClick"],at=["onClick"];function lt(t,s,h,S,o,i){const _=d("alert"),g=d("reuse-loader"),f=d("slack-url-create-edit-modal"),v=N("tooltip");return a(),l("div",J,[c(_,{"component-name":"slack-settings"}),e("div",K,[e("div",O,[e("h3",W,n(t.trans("settings")),1),e("div",Q,[D((a(),l("button",{class:"btn btn-tool",onClick:s[0]||(s[0]=u=>i.openModal("create"))},s[1]||(s[1]=[e("i",{class:"glyphicon glyphicon-plus"},null,-1)]))),[[v,t.lang("create_webhook")]])])]),e("div",X,[o.loading?(a(),l("div",Y,[c(g)])):r("",!0),o.loading?r("",!0):(a(),l("div",Z,[o.urlList.length?(a(),l("table",tt,[e("thead",null,[e("tr",null,[e("th",null,n(t.trans("s.no")),1),e("th",null,n(t.trans("url")),1),e("th",null,n(t.trans("actions")),1)])]),e("tbody",null,[(a(!0),l(V,null,$(o.urlList,(u,m)=>(a(),l("tr",{key:m},[e("td",null,n(m+1),1),e("td",null,n(u.webhook_url),1),e("td",null,[e("div",et,[e("a",{href:"javascript:;",class:"btn btn-primary",onClick:T=>i.openModal("edit",u)},[s[2]||(s[2]=e("i",{class:"fas fa-edit"},null,-1)),p(" "+n(t.trans("edit")),1)],8,st),e("a",{href:"javascript:;",class:"btn btn-danger",onClick:T=>i.openModal("delete",u)},[s[3]||(s[3]=e("i",{class:"fas fa-trash"},null,-1)),p(" "+n(t.trans("delete")),1)],8,at)])])]))),128))])])):(a(),l("div",x,n(t.trans("no-records")),1))]))])]),c(P,{name:"modal"},{default:C(()=>[o.showModal?(a(),L(f,{key:0,onClose:i.onClose,showModal:o.showModal,data:o.selectedValue,title:o.action},null,8,["onClose","showModal","data","title"])):r("",!0)]),_:1})])}const ot=w(G,[["render",lt]]),nt={data(){return{hasDataPopulated:!1,loading:!1,shortCodesLoader:!1,shortcodes:[],template:""}},beforeMount(){this.getInitialValues(),this.getShortCodes()},methods:{getShortCodes(){this.shortCodesLoader=!0,k.get("/slack/get/shortcodes").then(t=>{this.shortCodesLoader=!1,this.shortcodes=t.data.data}).catch(t=>{this.shortCodesLoader=!1,b(t,"slack-template")})},getInitialValues(){this.loading=!0,k.get("/slack/get/templateContent").then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.template=t.data.data}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,b(t,"slack-template")})},onChange(t,s){this[s]=t},onSubmit(){if(this.template){this.loading=!0;let t={};t.body=this.template,k.post("/slack/api/update/templateContent",t).then(s=>{this.loading=!1,y(s,"slack-template"),this.getInitialValues()}).catch(s=>{this.loading=!1,b(s,"slack-template")})}else this.$store.dispatch("setValidationError",{template:"This field is required."})}}},it={class:"col-sm-12"},dt={key:0,class:"row"},rt={key:1,class:"card card-light"},ct={class:"card-header"},ht={class:"card-title"},ut={class:"card-body"},mt={class:"row"},pt={class:"col-md-12 px-3"},_t={class:"card card-light"},gt={class:"card-header"},ft={class:"card-title"},kt={class:"card-body col-md-12"},bt={key:0,class:"row"},vt={key:1},Ct={class:"alert alert-info alert-dismissable"},yt={key:0,class:"list-inline"},wt={class:"list-inline-item",style:{width:"23%"}},St={"data-placement":"right"},Mt={class:"row"},Lt={class:"col-md-12 form-group"},Dt={class:"card-footer"};function Vt(t,s,h,S,o,i){const _=d("custom-loader"),g=d("alert"),f=d("reuse-loader"),v=d("tiny-editor-with-validation"),u=N("tooltip");return a(),l("div",it,[!o.hasDataPopulated||o.loading?(a(),l("div",dt,[c(_,{duration:4e3})])):r("",!0),c(g,{componentName:"slack-template"}),o.hasDataPopulated?(a(),l("div",rt,[e("div",ct,[e("h3",ht,n(t.trans("template")),1)]),e("div",ut,[e("div",mt,[e("div",pt,[e("div",_t,[e("div",gt,[e("h3",ft,n(t.trans("list-of-available-shot-codes")),1)]),e("div",kt,[o.shortCodesLoader?(a(),l("div",bt,[c(f,{"animation-duration":4e3,size:60})])):(a(),l("div",vt,[e("div",Ct,[s[1]||(s[1]=e("i",{class:"fas fa-info-circle"},null,-1)),s[2]||(s[2]=p("Â  ")),e("span",null,n(t.trans("template-short-code-tips")),1),s[3]||(s[3]=e("button",{type:"button",class:"btn-close float-end","data-bs-dismiss":"alert","aria-label":"Close"},null,-1))]),o.shortcodes.length?(a(),l("ul",yt,[(a(!0),l(V,null,$(o.shortcodes,m=>(a(),l("li",wt,[D((a(),l("span",St,[p(n(m.shortcode),1)])),[[u,t.trans(m.desc_lang_key),void 0,{right:!0}]])]))),256))])):r("",!0)]))])])])]),e("div",Mt,[e("div",Lt,[c(v,{id:"slack-editor",value:o.template,onChange:i.onChange,name:"template",label:t.trans("template"),required:!0,classname:"col-sm-12 width55",lang:"en",convertURLs:!1},null,8,["value","onChange","label"])])])]),e("div",Dt,[e("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=m=>i.onSubmit())},[s[4]||(s[4]=e("i",{class:"fas fa-sync"},null,-1)),p(" "+n(t.trans("update")),1)])])])):r("",!0)])}const $t=w(nt,[["render",Vt]]);q.addRoute({path:"/slack",component:z,name:"Slack",redirect:"/slack/settings",children:[{path:"settings",component:ot,name:"Slack Settings",meta:{title:"slack",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"slack"}}},{path:"template/settings",component:$t,name:"Slack Template",meta:{title:"template",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"slack",to:"/slack"},active:"template"}}}]});
