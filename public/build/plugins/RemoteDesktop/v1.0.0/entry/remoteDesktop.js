import{_ as B,e as n,c as X,aj as Y,o as u,l as v,v as i,I as P,x as f,q as T,J as z,K as Z,B as U,E as q,C as H,W as A,L as S,$ as J,a2 as g,h as C,k as b,F as h,G as $,s as E,T as ee,R as te,N as oe,H as ae,t as F,m as j,O as ne}from"../../../../v9.4.0.5/chunks/bootstrap.js";import{r as se,A as le}from"../../../../v9.4.0.5/chunks/adminRouter.js";import{a as ie,c as re}from"../../../../v9.4.0.5/chunks/DataTableActions.js";import{u as ce}from"../../../../v9.4.0.5/chunks/vue-router.js";import"../../../../v9.4.0.5/chunks/FormGenerator.js";import"../../../../v9.4.0.5/chunks/AdminNavigationBar.js";import"../../../../v9.4.0.5/chunks/Checkbox.js";import"../../../../v9.4.0.5/chunks/HelpSection.js";const de={name:"RemoteDesktopList",props:{data:{type:String,required:!0}},setup(p){const o=n([]),m=X(()=>JSON.parse(p.data).ticket.user.email),e=async()=>{await U.get("agent/remote/desktop/providers").then(a=>{o.value=a.data.data}).catch(a=>{q(a,"timeline")})},s=a=>{const c={customer_email:m.value};let _="";a==="zoho-assist"?_="zoho-assist/session":a==="microsoft-teams"&&(_="microsoft-teams/meeting"),U.post(`/agent/remote/desktop/${_}`,c).then(d=>{H(d,"timeline"),window.emitter.emit("show-session-link",d.data.data.html_content)}).catch(d=>{q(d,"timeline")})};return Y(e),{remoteDesktopProviders:o,getResponse:s}}},pe={key:0,class:"btn btn-light btn-sm dropdown-toggle supportSession",type:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},ue={class:"dropdown-menu min-content-width",style:{right:"auto"},"aria-labelledby":"supportSession"},me=["onClick"];function _e(p,o,m,e,s,a){return u(),v(z,null,[e.remoteDesktopProviders&&e.remoteDesktopProviders.length>0?(u(),v("button",pe,[o[0]||(o[0]=i("i",{class:"fa-solid fa-display me-1"},null,-1)),P(" "+f(p.trans("remote_desktop")),1)])):T("",!0),i("div",ue,[(u(!0),v(z,null,Z(e.remoteDesktopProviders,c=>(u(),v("a",{class:"dropdown-item cursor-pointer",onClick:_=>e.getResponse(c),key:c},[o[1]||(o[1]=i("i",{class:"fa-solid fa-envelope-open-text me-1"},null,-1)),P(f(p.trans(c)),1)],8,me))),128))])],64)}const ve=B(de,[["render",_e],["__scopeId","data-v-48719682"]]);const ge={name:"ProviderName",description:"Provider name column table component",props:{data:{type:Object,required:!0}}},he={key:0,class:"provider-alert"};function fe(p,o,m,e,s,a){const c=A("tooltip");return u(),v("span",null,[i("span",null,f(m.data.provider),1),o[1]||(o[1]=P(" Â  ")),m.data.tooltip_message?S((u(),v("span",he,o[0]||(o[0]=[i("i",{style:{color:"#3c8dbc"},class:"fas fa-question-circle"},null,-1)]))),[[c,m.data.tooltip_message]]):T("",!0)])}const be=B(ge,[["render",fe],["__scopeId","data-v-11db80b5"]]),ke={name:"CustomCssIndex",setup(){const p=n("/api/admin/remote/desktop-list"),o=n(!1),m=n(["provider","status","action"]),e=n({});return J(()=>{e.value={headings:{provider:g("provider"),status:g("status"),action:g("actions")},sortable:[],sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{provider:(s,a)=>C(be,{data:a}),status:(s,a)=>{const c=C("span",{class:a.value?"text-success":"text-danger"},a.value?g("active"):g("inactive"));return C("a",{},[c])},action:(s,a)=>C(ie,{data:a})},requestAdapter:s=>({"sort-field":s.orderBy?s.orderBy:"id","sort-order":s.ascending?"desc":"asc","search-query":s.query.trim(),page:s.page,limit:s.limit}),responseAdapter:({data:s})=>({data:s.data.map(a=>(a.settings_url=a.url_setting,a)),count:s.data.length}),orderBy:{column:"id",ascending:!0},pagination:{chunk:5,nav:"fixed",edge:!0}}}),{apiUrl:p,loading:o,columns:m,options:e,lang:g,h:C}}},ye={class:"main col-sm-12"},we={class:"row",id:"remote_desktop"};function xe(p,o,m,e,s,a){const c=b("alert"),_=b("data-table"),d=b("faveo-box");return u(),v("div",ye,[h(c,{componentName:"dataTableModal"}),h(d,{title:e.lang("remote_desktop")},{default:$(()=>[i("div",we,[h(_,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"remote_desktop",class:"col-sm-12"},null,8,["url","dataColumns","option"])])]),_:1},8,["title"])])}const Ce=B(ke,[["render",xe]]),De={name:"RemoteDesktopSettings",setup(){const p=n(!1),o=n(""),m=n("fas fa-save"),e=n("save"),s=n(""),a=n(""),c=n(""),_=n(!1),d=n(1),y=n(""),w=n(""),x=n(""),r=n(""),I=n(""),V=n(""),D=n(""),L=n(!1),G=n([{name:g("active"),value:1},{name:g("inactive"),value:0}]),k=n("RemoteDesktopSettings"),K=ce(),W=()=>{re(c.value),_.value=!0,setTimeout(()=>_.value=!1,5e3)},M=l=>{let t=l.split("/");o.value=t[t.length-1],o.value!=="microsoft-teams"&&o.value!=="zoho-assist"?(setTimeout(()=>{K.push("/remote")},2e3),E.dispatch("setAlert",{type:"danger",message:g("provider_not_found"),component_name:k.value})):O()},O=()=>{axios.get(`/api/admin/remote/desktop-settings/${o.value}`).then(l=>{const t=l.data.data;d.value=t.status,s.value=t.client_id?t.client_id:"",a.value=t.client_secret?t.client_secret:"",c.value=t.redirect?t.redirect:"",w.value=t.scopes?t.scopes:"",y.value=t.api_base_url?t.api_base_url:"",I.value=t.session_url?t.session_url:"",x.value=t.tenant_id?t.tenant_id:"",V.value=t.upn?t.upn:"",r.value=t.graph_url?t.graph_url:""}).catch(l=>q(l,k.value))},Q=()=>{p.value=!0;const l=new FormData;l.append("provider_name",o.value),l.append("client_id",s.value),l.append("client_secret",a.value),l.append("redirect",c.value),l.append("status",d.value),l.append("scopes",w.value),o.value==="zoho-assist"?(l.append("api_base_url",y.value),l.append("session_url",I.value)):o.value==="microsoft-teams"&&(l.append("tenant_id",x.value),l.append("graph_url",r.value),l.append("upn",V.value)),l.append("_method","POST"),axios.post("api/admin/remote/desktop-update",l,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{var N,R;p.value=!1,L.value=!1,(R=(N=t.data)==null?void 0:N.data)!=null&&R.redirect_url&&(window.location.href=t.data.data.redirect_url),H(t,k.value)}).catch(t=>{p.value=!1,q(t,k.value)})};return J(()=>{const l=window.location.pathname;M(l);const t=new URLSearchParams(window.location.search);if(D.value=t.get("error")||t.get("success"),D.value){const N=t.has("success")?"success":"danger";E.dispatch("setAlert",{type:N,message:D.value,component_name:k.value}),t.delete("success"),t.delete("error");const R=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},document.title,R)}}),{loading:p,providerName:o,iconClass:m,btnName:e,client_id:s,client_secret:a,redirect:c,copied:_,status:d,api_base_url:y,scopes:w,message:D,tenant_id:x,graph_url:r,session_url:I,upn:V,create_token:L,radioOptions:G,componentName:k,lang:g,copyToClipboard:W,getValues:M,getInitialValues:O,onSubmit:Q}},components:{"text-field":ee,"radio-button":te}},Ne={class:"col-sm-12"},Re={key:0,class:"row"},Se={key:1},Pe={class:"card card-light"},Te={class:"card-header"},qe={class:"card-title"},Be={class:"card-body"},Ie={class:"row"},Ve={class:"row"},Ae={class:"col-sm-6"},Le={class:"input-group"},Me={class:"row"},Oe={class:"row"},ze={class:"card-footer"};function Ue(p,o,m,e,s,a){const c=b("alert"),_=b("custom-loader"),d=b("text-field"),y=b("radio-button"),w=A("focus-first-input"),x=A("tooltip");return u(),v("div",Ne,[h(c,{componentName:e.componentName},null,8,["componentName"]),e.loading?(u(),v("div",Re,[h(_,{duration:4e3})])):(u(),v("div",Se,[i("div",Pe,[i("div",Te,[i("h3",qe,f(e.lang(e.providerName))+" "+f(e.lang("settings")),1)]),i("div",Be,[S((u(),v("div",Ie,[h(d,{id:"client-id",label:e.lang("client-id"),value:e.client_id,type:"text",name:"client_id",onChange:r=>e.client_id=r,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),h(d,{id:"client-secret",label:e.lang("client-secret"),value:e.client_secret,type:"password",name:"client_secret",onChange:r=>e.client_secret=r,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"])])),[[w]]),i("div",Ve,[h(d,{id:"scopes",label:e.lang("scopes"),value:e.scopes,type:"text",name:"scopes",onChange:r=>e.scopes=r,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),i("div",Ae,[i("label",null,f(e.lang("redirect_url")),1),i("div",Le,[S(i("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=r=>e.redirect=r),name:"redirect_url",disabled:""},null,512),[[oe,e.redirect]]),S((u(),v("span",{class:"input-group-text cursor-pointer",onClick:o[1]||(o[1]=ae(r=>e.copyToClipboard(),["prevent"]))},[i("i",{class:F(e.copied?"glyphicon glyphicon-ok text-success":"fa fa-clipboard")},null,2)])),[[x,e.copied?e.lang("clipboard-copy-message"):e.lang("click-url-copy")]])])])]),i("div",Me,[e.providerName==="microsoft-teams"?(u(),j(d,{key:0,id:"upn",label:e.lang("upn"),value:e.upn,type:"text",name:"upn",onChange:r=>e.upn=r,placehold:e.lang("enter_a_value"),hint:e.lang("upn_tooltip"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold","hint"])):T("",!0),e.providerName==="microsoft-teams"?(u(),j(d,{key:1,id:"tenant-id",label:e.lang("tenant_id"),value:e.tenant_id,type:"text",name:"tenant_id",onChange:r=>e.tenant_id=r,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"])):T("",!0)]),i("div",Oe,[h(y,{options:e.radioOptions,label:p.trans("status"),name:"status",value:e.status,onChange:r=>e.status=r,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"])])]),i("div",ze,[i("button",{id:"submit_btn",class:"btn btn-primary",onClick:o[2]||(o[2]=(...r)=>e.onSubmit&&e.onSubmit(...r))},[i("i",{class:F(e.iconClass)},null,2),P(" "+f(e.lang(e.btnName)),1)])])])]))])}const Ee=B(De,[["render",Ue]]);ne("remote-desktop-list",ve,"support-session-renderer","support-session-view");let Fe={path:"/remote",component:le,name:"RemoteDesktop",redirect:"/remote/settings",children:[{path:"settings",component:Ce,name:"RemoteDesktop Index",meta:{title:"remote_desktop",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"remote_desktop"}}},{path:"desktop-settings/:app",component:Ee,name:"RemoteDesktop Settings",meta:{title:"remote_desktop",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"remote_desktop",to:"/remote"},active:"settings"}}}]};se.addRoute(Fe);
