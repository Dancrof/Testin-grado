import{an as k,C as z,E as V,_ as w,k as h,o as d,l,F as m,q as _,J as f,K as y,v as a,x as r,t as C,L as S,N as I,I as N}from"../chunks/bootstrap.js";import{r as U,A as x}from"../chunks/adminRouter.js";import{S as O}from"../chunks/FormGenerator.js";import"../chunks/vue-router.js";import"../chunks/HelpSection.js";import"../chunks/AdminNavigationBar.js";import"../chunks/Checkbox.js";import"../chunks/DataTableActions.js";const P={name:"dashboard-optimize",data(){return{moduleData:[],subModuleData:[],moduleLoad:!1,subModuleLoad:!1,updateModuleLoad:!1}},beforeMount(){this.getModuleData()},computed:{...k(["formattedTime"])},methods:{getModuleData(){this.moduleLoad=!0,axios.get("/api/modules").then(e=>{this.moduleData=e.data.data.helpdesk,this.moduleLoad=!1,this.getSubModulesData()}).catch(e=>{this.moduleLoad=!1})},getSubModulesData(){this.subModuleLoad=!0,axios.get("/api/sub-module/1?panel=admin").then(e=>{this.subModuleData=e.data.message.map(t=>({...t,display:t.display?t.display:!1,cache:t.cache?t.cache:0})),this.subModuleLoad=!1}).catch(e=>{this.subModuleLoad=!1})},onInput(e){if(e.cache.toString().length<=3)return!0;e.cache=e.cache.toString().substring(0,e.cache.toString().length-1)},checkValue(e){e=e||window.event;let t=e.which?e.which:e.keyCode;if(t>31&&(t<48||t>57))e.preventDefault();else return!0},onPaste(e){e=e||window.event,e.preventDefault()},onChange(e,t){this[t]=e},updateDashboard(e,t){this.updateModuleLoad=!0;let c={};c.module_id=e.id,c.panel="admin",c.is_enabled=e.admin_enable?1:0,c.sub_module=t.map(n=>({id:n.id,display:n.display?1:0,cache:n.display?parseInt(n.cache):0})),axios.post("/update/sub-module",c).then(n=>{z(n,"dashboard-optimize"),this.updateModuleLoad=!1,this.getModuleData()}).catch(n=>{V(n,"dashboard-optimize"),this.updateModuleLoad=!1})}},components:{"status-switch":O}},B={class:"col-sm-12"},T={key:0,class:"row"},A={key:1,class:"p-50"},E={class:"card card-light"},F={class:"card-header"},H={class:"card-title mt-2"},K={class:"card-tools switch-pos"},q={class:"card-body"},G={class:"row"},J={class:"col-sm-12"},R={class:"alert alert-info"},Q={class:"row p-2"},W={key:0,class:"col-sm-12 p-50"},X={key:1,class:"table table-striped border"},Y={class:"input-group"},Z=["onUpdate:modelValue","onInput","disabled"],j={type:"button",class:"btn btn-light disabled cursor-default border"},$={key:0,class:"card-footer"},ee=["onClick"];function ae(e,t,c,n,o,u){const g=h("alert"),M=h("custom-loader"),v=h("reuse-loader"),b=h("toggle"),D=h("loader");return d(),l("div",B,[m(g,{componentName:"dashboard-optimize"}),o.updateModuleLoad?(d(),l("div",T,[m(M,{duration:4e3})])):_("",!0),o.moduleLoad?(d(),l("div",A,[m(v,{"animation-duration":4e3,color:"#1d78ff",size:60})])):(d(!0),l(f,{key:2},y(o.moduleData,p=>(d(),l("div",E,[a("div",F,[a("h3",H,r(e.trans("dashboard")),1),a("div",K,[m(b,{modelValue:p.admin_enable,"onUpdate:modelValue":s=>p.admin_enable=s,class:"toggle-switch"},null,8,["modelValue","onUpdate:modelValue"])])]),a("div",q,[a("div",G,[a("div",J,[a("div",R,r(p.description),1),a("div",Q,[o.subModuleLoad?(d(),l("div",W,[m(D,{"animation-duration":4e3,color:"#1d78ff",size:60})])):_("",!0),!o.subModuleLoad&&!o.moduleLoad?(d(),l("table",X,[a("thead",null,[a("tr",null,[a("th",null,r(e.trans("title")),1),a("th",null,r(e.trans("cache")),1),a("th",null,r(e.trans("action")),1)])]),a("tbody",null,[(d(!0),l(f,null,y(o.subModuleData,(s,L)=>(d(),l("tr",{key:L,class:C(p.admin_enable?"":"row_disable")},[a("td",null,r(e.trans(s.label)),1),a("td",null,[a("div",Y,[S(a("input",{type:"number",min:"0","onUpdate:modelValue":i=>s.cache=i,max:"999",class:"form-control cache-field",onInput:i=>u.onInput(s),onKeypress:t[0]||(t[0]=(...i)=>u.checkValue&&u.checkValue(...i)),onPaste:t[1]||(t[1]=(...i)=>u.onPaste&&u.onPaste(...i)),disabled:!s.display},null,40,Z),[[I,s.cache]]),a("div",j,r(e.trans("minutes")),1)])]),a("td",null,[m(b,{modelValue:s.display,"onUpdate:modelValue":i=>s.display=i,class:"toggle-switch"},null,8,["modelValue","onUpdate:modelValue"])])],2))),128))])])):_("",!0)])])])]),!o.subModuleLoad&&!o.moduleLoad?(d(),l("div",$,[a("button",{class:"btn btn-primary float-end",onClick:s=>u.updateDashboard(p,o.subModuleData)},[t[2]||(t[2]=a("i",{class:"fas fa-sync-alt"},null,-1)),N("Â "+r(e.trans("update")),1)],8,ee)])):_("",!0)]))),256))])}const te=w(P,[["render",ae],["__scopeId","data-v-8efb11a6"]]);let oe={path:"/optimize",component:x,name:"Dashboard Optimize",redirect:"/optimize/dashboard",children:[{path:"dashboard",component:te,name:"DashboardOptimize",meta:{title:"optimize",crumb:{link:{name:"admin_panel",to:"/"},active:"optimize"}}}]};U.addRoute(oe);
