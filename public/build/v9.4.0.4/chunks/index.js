import{aY as U3,aZ as tt,a_ as R3,y as Q3}from"./bootstrap.js";/*! OpenPGP.js v6.1.0 - 2025-01-30 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */const Ht=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _3(n,t){return t.forEach(function(e){e&&typeof e!="string"&&!Array.isArray(e)&&Object.keys(e).forEach(function(r){if(r!=="default"&&!(r in n)){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}})}),Object.freeze(n)}const f0=Symbol("doneWritingPromise"),p2=Symbol("doneWritingResolve"),g2=Symbol("doneWritingReject"),U0=Symbol("readingIndex");class he extends Array{constructor(){super(),Object.setPrototypeOf(this,he.prototype),this[f0]=new Promise((t,e)=>{this[p2]=t,this[g2]=e}),this[f0].catch(()=>{})}}function kt(n){return n&&n.getReader&&Array.isArray(n)}function z0(n){if(!kt(n)){const t=n.getWriter(),e=t.releaseLock;return t.releaseLock=()=>{t.closed.catch(function(){}),e.call(t)},t}this.stream=n}function ee(n){if(kt(n))return"array";if(Ht.ReadableStream&&Ht.ReadableStream.prototype.isPrototypeOf(n))return"web";if(n&&!(Ht.ReadableStream&&n instanceof Ht.ReadableStream)&&typeof n._read=="function"&&typeof n._readableState=="object")throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!n||!n.getReader)&&"web-like"}function ai(n){return Uint8Array.prototype.isPrototypeOf(n)}function A2(n){if(n.length===1)return n[0];let t=0;for(let i=0;i<n.length;i++){if(!ai(n[i]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=n[i].length}const e=new Uint8Array(t);let r=0;return n.forEach(function(i){e.set(i,r),r+=i.length}),e}he.prototype.getReader=function(){return this[U0]===void 0&&(this[U0]=0),{read:async()=>(await this[f0],this[U0]===this.length?{value:void 0,done:!0}:{value:this[this[U0]++],done:!1})}},he.prototype.readToEnd=async function(n){await this[f0];const t=n(this.slice(this[U0]));return this.length=0,t},he.prototype.clone=function(){const n=new he;return n[f0]=this[f0].then(()=>{n.push(...this)}),n},z0.prototype.write=async function(n){this.stream.push(n)},z0.prototype.close=async function(){this.stream[p2]()},z0.prototype.abort=async function(n){return this.stream[g2](n),n},z0.prototype.releaseLock=function(){},typeof Ht.process=="object"&&Ht.process.versions;const s1=new WeakSet,dt=Symbol("externalBuffer");function ke(n){if(this.stream=n,n[dt]&&(this[dt]=n[dt].slice()),kt(n)){const e=n.getReader();return this._read=e.read.bind(e),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(ee(n)){const e=n.getReader();return this._read=e.read.bind(e),this._releaseLock=()=>{e.closed.catch(function(){}),e.releaseLock()},void(this._cancel=e.cancel.bind(e))}let t=!1;this._read=async()=>t||s1.has(n)?{value:void 0,done:!0}:(t=!0,{value:n,done:!1}),this._releaseLock=()=>{if(t)try{s1.add(n)}catch{}}}function wa(n){return ee(n)?n:new ReadableStream({start(t){t.enqueue(n),t.close()}})}function x2(n){if(ee(n))return n;const t=new he;return(async()=>{const e=se(t);await e.write(n),await e.close()})(),t}function Yt(n){return n.some(t=>ee(t)&&!kt(t))?function(t){t=t.map(wa);const e=b2(async function(s){await Promise.all(i.map(a=>Hs(a,s)))});let r=Promise.resolve();const i=t.map((s,a)=>Ir(s,(o,c)=>(r=r.then(()=>Or(o,e.writable,{preventClose:a!==t.length-1})),r)));return e.readable}(n):n.some(t=>kt(t))?function(t){const e=new he;let r=Promise.resolve();return t.forEach((i,s)=>(r=r.then(()=>Or(i,e,{preventClose:s!==t.length-1})),r)),e}(n):typeof n[0]=="string"?n.join(""):A2(n)}async function Or(n,t,{preventClose:e=!1,preventAbort:r=!1,preventCancel:i=!1}={}){if(ee(n)&&!kt(n)){n=wa(n);try{if(n[dt]){const o=se(t);for(let c=0;c<n[dt].length;c++)await o.ready,await o.write(n[dt][c]);o.releaseLock()}await n.pipeTo(t,{preventClose:e,preventAbort:r,preventCancel:i})}catch{}return}const s=rr(n=x2(n)),a=se(t);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){e||await a.close();break}await a.write(c)}}catch(o){r||await a.abort(o)}finally{s.releaseLock(),a.releaseLock()}}function w2(n,t){const e=new TransformStream(t);return Or(n,e.writable),e.readable}function b2(n){let t,e,r,i=!1,s=!1;return{readable:new ReadableStream({start(a){r=a},pull(){t?t():i=!0},async cancel(a){s=!0,n&&await n(a),e&&e(a)}},{highWaterMark:0}),writable:new WritableStream({write:async function(a){if(s)throw Error("Stream is cancelled");r.enqueue(a),i?i=!1:(await new Promise((o,c)=>{t=o,e=c}),t=null,e=null)},close:r.close.bind(r),abort:r.error.bind(r)})}}function mt(n,t=()=>{},e=()=>{}){if(kt(n)){const s=new he;return(async()=>{const a=se(s);try{const o=await Dt(n),c=t(o),h=e();let u;u=c!==void 0&&h!==void 0?Yt([c,h]):c!==void 0?c:h,await a.write(u),await a.close()}catch(o){await a.abort(o)}})(),s}if(ee(n))return w2(n,{async transform(s,a){try{const o=await t(s);o!==void 0&&a.enqueue(o)}catch(o){a.error(o)}},async flush(s){try{const a=await e();a!==void 0&&s.enqueue(a)}catch(a){s.error(a)}}});const r=t(n),i=e();return r!==void 0&&i!==void 0?Yt([r,i]):r!==void 0?r:i}function Ir(n,t){if(ee(n)&&!kt(n)){let r;const i=new TransformStream({start(o){r=o}}),s=Or(n,i.writable),a=b2(async function(o){r.error(o),await s,await new Promise(setTimeout)});return t(i.readable,a.writable),a.readable}n=x2(n);const e=new he;return t(n,e),e}function oi(n,t){let e;const r=Ir(n,(i,s)=>{const a=rr(i);a.remainder=()=>(a.releaseLock(),Or(i,s),r),e=t(a)});return e}function Gr(n){if(kt(n))return n.clone();if(ee(n)){const t=function(e){if(kt(e))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(ee(e)){const r=wa(e).tee();return r[0][dt]=r[1][dt]=e[dt],r}return[_t(e),_t(e)]}(n);return m2(n,t[0]),t[1]}return _t(n)}function tn(n){return kt(n)?Gr(n):ee(n)?new ReadableStream({start(t){const e=Ir(n,async(r,i)=>{const s=rr(r),a=se(i);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){try{t.close()}catch{}return void await a.close()}try{t.enqueue(c)}catch{}await a.write(c)}}catch(o){t.error(o),await a.abort(o)}});m2(n,e)}}):_t(n)}function m2(n,t){Object.entries(Object.getOwnPropertyDescriptors(n.constructor.prototype)).forEach(([e,r])=>{e!=="constructor"&&(r.value?r.value=r.value.bind(t):r.get=r.get.bind(t),Object.defineProperty(n,e,r))})}function _t(n,t=0,e=1/0){if(kt(n))throw Error("Not implemented");if(ee(n)){if(t>=0&&e>=0){let r=0;return w2(n,{transform(i,s){r<e?(r+i.length>=t&&s.enqueue(_t(i,Math.max(t-r,0),e-r)),r+=i.length):s.terminate()}})}if(t<0&&(e<0||e===1/0)){let r=[];return mt(n,i=>{i.length>=-t?r=[i]:r.push(i)},()=>_t(Yt(r),t,e))}if(t===0&&e<0){let r;return mt(n,i=>{const s=r?Yt([r,i]):i;if(s.length>=-e)return r=_t(s,e),_t(s,t,e);r=s})}return console.warn(`stream.slice(input, ${t}, ${e}) not implemented efficiently.`),Kr(async()=>_t(await Dt(n),t,e))}return n[dt]&&(n=Yt(n[dt].concat([n]))),ai(n)?n.subarray(t,e===1/0?n.length:e):n.slice(t,e)}async function Dt(n,t=Yt){return kt(n)?n.readToEnd(t):ee(n)?rr(n).readToEnd(t):n}async function Hs(n,t){if(ee(n)){if(n.cancel){const e=await n.cancel(t);return await new Promise(setTimeout),e}if(n.destroy)return n.destroy(t),await new Promise(setTimeout),t}}function Kr(n){const t=new he;return(async()=>{const e=se(t);try{await e.write(await n()),await e.close()}catch(r){await e.abort(r)}})(),t}function rr(n){return new ke(n)}function se(n){return new z0(n)}ke.prototype.read=async function(){return this[dt]&&this[dt].length?{done:!1,value:this[dt].shift()}:this._read()},ke.prototype.releaseLock=function(){this[dt]&&(this.stream[dt]=this[dt]),this._releaseLock()},ke.prototype.cancel=function(n){return this._cancel(n)},ke.prototype.readLine=async function(){let n,t=[];for(;!n;){let{done:e,value:r}=await this.read();if(r+="",e)return t.length?Yt(t):void 0;const i=r.indexOf(`
`)+1;i&&(n=Yt(t.concat(r.substr(0,i))),t=[]),i!==r.length&&t.push(r.substr(i))}return this.unshift(...t),n},ke.prototype.readByte=async function(){const{done:n,value:t}=await this.read();if(n)return;const e=t[0];return this.unshift(_t(t,1)),e},ke.prototype.readBytes=async function(n){const t=[];let e=0;for(;;){const{done:r,value:i}=await this.read();if(r)return t.length?Yt(t):void 0;if(t.push(i),e+=i.length,e>=n){const s=Yt(t);return this.unshift(_t(s,n)),_t(s,0,n)}}},ke.prototype.peekBytes=async function(n){const t=await this.readBytes(n);return this.unshift(t),t},ke.prototype.unshift=function(...n){this[dt]||(this[dt]=[]),n.length===1&&ai(n[0])&&this[dt].length&&n[0].length&&this[dt][0].byteOffset>=n[0].length?this[dt][0]=new Uint8Array(this[dt][0].buffer,this[dt][0].byteOffset-n[0].length,this[dt][0].byteLength+n[0].length):this[dt].unshift(...n.filter(t=>t&&t.length))},ke.prototype.readToEnd=async function(n=Yt){const t=[];for(;;){const{done:e,value:r}=await this.read();if(e)break;t.push(r)}return n(t)};const R0=Symbol("byValue");var l={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(n,t){if(typeof t=="number"&&(t=this.read(n,t)),n[t]!==void 0)return n[t];throw Error("Invalid enum value.")},read:function(n,t){if(n[R0]||(n[R0]=[],Object.entries(n).forEach(([e,r])=>{n[R0][r]=e})),n[R0][t]!==void 0)return n[R0][t];throw Error("Invalid enum value.")}},W={preferredHashAlgorithm:l.hash.sha512,preferredSymmetricAlgorithm:l.symmetric.aes256,preferredCompressionAlgorithm:l.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:l.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:l.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([l.symmetric.aes128,l.symmetric.aes192,l.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.1.0",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([l.hash.md5,l.hash.ripemd]),rejectMessageHashAlgorithms:new Set([l.hash.md5,l.hash.ripemd,l.hash.sha1]),rejectPublicKeyAlgorithms:new Set([l.publicKey.elgamal,l.publicKey.dsa]),rejectCurves:new Set([l.curve.secp256k1])};const a1=(()=>{try{return!1}catch{}return!1})(),m={isString:function(n){return typeof n=="string"||n instanceof String},nodeRequire:()=>{},isArray:function(n){return n instanceof Array},isUint8Array:ai,isStream:ee,getNobleCurve:async(n,t)=>{if(!W.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:e}=await Promise.resolve().then(function(){return x5});switch(n){case l.publicKey.ecdh:case l.publicKey.ecdsa:{const r=e.get(t);if(!r)throw Error("Unsupported curve");return r}case l.publicKey.x448:return e.get("x448");case l.publicKey.ed448:return e.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(n){let t=0;for(let e=0;e<n.length;e++)t+=256**e*n[n.length-1-e];return t},writeNumber:function(n,t){const e=new Uint8Array(t);for(let r=0;r<t;r++)e[r]=n>>8*(t-r-1)&255;return e},readDate:function(n){const t=m.readNumber(n);return new Date(1e3*t)},writeDate:function(n){const t=Math.floor(n.getTime()/1e3);return m.writeNumber(t,4)},normalizeDate:function(n=Date.now()){return n===null||n===1/0?n:new Date(1e3*Math.floor(+n/1e3))},readMPI:function(n){const t=(n[0]<<8|n[1])+7>>>3;return m.readExactSubarray(n,2,2+t)},readExactSubarray:function(n,t,e){if(n.length<e-t)throw Error("Input array too short");return n.subarray(t,e)},leftPad(n,t){if(n.length>t)throw Error("Input array too long");const e=new Uint8Array(t),r=t-n.length;return e.set(n,r),e},uint8ArrayToMPI:function(n){const t=m.uint8ArrayBitLength(n);if(t===0)throw Error("Zero MPI");const e=n.subarray(n.length-Math.ceil(t/8)),r=new Uint8Array([(65280&t)>>8,255&t]);return m.concatUint8Array([r,e])},uint8ArrayBitLength:function(n){let t;for(t=0;t<n.length&&n[t]===0;t++);if(t===n.length)return 0;const e=n.subarray(t);return 8*(e.length-1)+m.nbits(e[0])},hexToUint8Array:function(n){const t=new Uint8Array(n.length>>1);for(let e=0;e<n.length>>1;e++)t[e]=parseInt(n.substr(e<<1,2),16);return t},uint8ArrayToHex:function(n){const t="0123456789abcdef";let e="";return n.forEach(r=>{e+=t[r>>4]+t[15&r]}),e},stringToUint8Array:function(n){return mt(n,t=>{if(!m.isString(t))throw Error("stringToUint8Array: Data must be in the form of a string");const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})},uint8ArrayToString:function(n){const t=[],r=(n=new Uint8Array(n)).length;for(let i=0;i<r;i+=16384)t.push(String.fromCharCode.apply(String,n.subarray(i,i+16384<r?i+16384:r)));return t.join("")},encodeUTF8:function(n){const t=new TextEncoder("utf-8");function e(r,i=!1){return t.encode(r,{stream:!i})}return mt(n,e,()=>e("",!0))},decodeUTF8:function(n){const t=new TextDecoder("utf-8");function e(r,i=!1){return t.decode(r,{stream:!i})}return mt(n,e,()=>e(new Uint8Array,!0))},concat:Yt,concatUint8Array:A2,equalsUint8Array:function(n,t){if(!m.isUint8Array(n)||!m.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0},writeChecksum:function(n){let t=0;for(let e=0;e<n.length;e++)t=t+n[e]&65535;return m.writeNumber(t,2)},printDebug:function(n){a1&&console.log("[OpenPGP.js debug]",n)},printDebugError:function(n){a1&&console.error("[OpenPGP.js debug]",n)},nbits:function(n){let t=1,e=n>>>16;return e!==0&&(n=e,t+=16),e=n>>8,e!==0&&(n=e,t+=8),e=n>>4,e!==0&&(n=e,t+=4),e=n>>2,e!==0&&(n=e,t+=2),e=n>>1,e!==0&&(n=e,t+=1),t},double:function(n){const t=new Uint8Array(n.length),e=n.length-1;for(let r=0;r<e;r++)t[r]=n[r]<<1^n[r+1]>>7;return t[e]=n[e]<<1^135*(n[0]>>7),t},shiftRight:function(n,t){if(t)for(let e=n.length-1;e>=0;e--)n[e]>>=t,e>0&&(n[e]|=n[e-1]<<8-t);return n},getWebCrypto:function(){var t;const n=Ht!==void 0&&Ht.crypto&&Ht.crypto.subtle||((t=this.getNodeCrypto())==null?void 0:t.webcrypto.subtle);if(!n)throw Error("The WebCrypto API is not available");return n},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(n){return m.isString(n)?/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(n):!1},canonicalizeEOL:function(n){let t=!1;return mt(n,e=>{let r;t&&(e=m.concatUint8Array([new Uint8Array([13]),e])),e[e.length-1]===13?(t=!0,e=e.subarray(0,-1)):t=!1;const i=[];for(let o=0;r=e.indexOf(10,o)+1,r;o=r)e[r-2]!==13&&i.push(r);if(!i.length)return e;const s=new Uint8Array(e.length+i.length);let a=0;for(let o=0;o<i.length;o++){const c=e.subarray(i[o-1]||0,i[o]);s.set(c,a),a+=c.length,s[a-1]=13,s[a]=10,a++}return s.set(e.subarray(i[i.length-1]||0),a),s},()=>t?new Uint8Array([13]):void 0)},nativeEOL:function(n){let t=!1;return mt(n,e=>{let r;(e=t&&e[0]!==10?m.concatUint8Array([new Uint8Array([13]),e]):new Uint8Array(e))[e.length-1]===13?(t=!0,e=e.subarray(0,-1)):t=!1;let i=0;for(let s=0;s!==e.length;s=r){r=e.indexOf(13,s)+1,r||(r=e.length);const a=r-(e[r]===10?1:0);s&&e.copyWithin(i,s,a),i+=a-s}return e.subarray(0,i)},()=>t?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(n){return n.split(`
`).map(t=>{let e=t.length-1;for(;e>=0&&(t[e]===" "||t[e]==="	"||t[e]==="\r");e--);return t.substr(0,e+1)}).join(`
`)},wrapError:function(n,t){if(!t)return Error(n);try{t.message=n+": "+t.message}catch{}return t},constructAllowedPackets:function(n){const t={};return n.forEach(e=>{if(!e.tag)throw Error("Invalid input: expected a packet class");t[e.tag]=e}),t},anyPromise:function(n){return new Promise(async(t,e)=>{let r;await Promise.all(n.map(async i=>{try{t(await i)}catch(s){r=s}})),e(r)})},selectUint8Array:function(n,t,e){const r=Math.max(t.length,e.length),i=new Uint8Array(r);let s=0;for(let a=0;a<i.length;a++)i[a]=t[a]&256-n|e[a]&255+n,s+=n&a<t.length|1-n&a<e.length;return i.subarray(0,s)},selectUint8:function(n,t,e){return t&256-n|e&255+n},isAES:function(n){return n===l.symmetric.aes128||n===l.symmetric.aes192||n===l.symmetric.aes256}},Ci=m.getNodeBuffer();let Nn,zn;function je(n){let t=new Uint8Array;return mt(n,e=>{t=m.concatUint8Array([t,e]);const r=[],i=Math.floor(t.length/45),s=45*i,a=Nn(t.subarray(0,s));for(let o=0;o<i;o++)r.push(a.substr(60*o,60)),r.push(`
`);return t=t.subarray(s),r.join("")},()=>t.length?Nn(t)+`
`:"")}function v2(n){let t="";return mt(n,e=>{t+=e;let r=0;const i=[" ","	","\r",`
`];for(let o=0;o<i.length;o++){const c=i[o];for(let h=t.indexOf(c);h!==-1;h=t.indexOf(c,h+1))r++}let s=t.length;for(;s>0&&(s-r)%4!=0;s--)i.includes(t[s])&&r--;const a=zn(t.substr(0,s));return t=t.substr(s),a},()=>zn(t))}function me(n){return v2(n.replace(/-/g,"+").replace(/_/g,"/"))}function Ot(n,t){let e=je(n).replace(/[\r\n]/g,"");return e=e.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),e}function L3(n){const t=n.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?l.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?l.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?l.armor.signed:/MESSAGE/.test(t[1])?l.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?l.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?l.armor.privateKey:/SIGNATURE/.test(t[1])?l.armor.signature:void 0}function Ur(n,t){let e="";return t.showVersion&&(e+="Version: "+t.versionString+`
`),t.showComment&&(e+="Comment: "+t.commentString+`
`),n&&(e+="Comment: "+n+`
`),e+=`
`,e}function Rr(n){const t=function(e){let r=13501623;return mt(e,i=>{const s=T3?Math.floor(i.length/4):0,a=new Uint32Array(i.buffer,i.byteOffset,s);for(let o=0;o<s;o++)r^=a[o],r=Kt[0][r>>24&255]^Kt[1][r>>16&255]^Kt[2][r>>8&255]^Kt[3][255&r];for(let o=4*s;o<i.length;o++)r=r>>8^Kt[0][255&r^i[o]]},()=>new Uint8Array([r,r>>8,r>>16]))}(n);return je(t)}Ci?(Nn=n=>Ci.from(n).toString("base64"),zn=n=>{const t=Ci.from(n,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(Nn=n=>btoa(m.uint8ArrayToString(n)),zn=n=>m.stringToUint8Array(atob(n)));const Kt=[Array(255),Array(255),Array(255),Array(255)];for(let n=0;n<=255;n++){let t=n<<16;for(let e=0;e<8;e++)t=t<<1^(8388608&t?8801531:0);Kt[0][n]=(16711680&t)>>16|65280&t|(255&t)<<16}for(let n=0;n<=255;n++)Kt[1][n]=Kt[0][n]>>8^Kt[0][255&Kt[0][n]];for(let n=0;n<=255;n++)Kt[2][n]=Kt[1][n]>>8^Kt[0][255&Kt[1][n]];for(let n=0;n<=255;n++)Kt[3][n]=Kt[2][n]>>8^Kt[0][255&Kt[2][n]];const T3=function(){const n=new ArrayBuffer(2);return new DataView(n).setInt16(0,255,!0),new Int16Array(n)[0]===255}();function o1(n){for(let t=0;t<n.length;t++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(n[t])||m.printDebugError(Error("Improperly formatted armor header: "+n[t])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(n[t])||m.printDebugError(Error("Unknown header: "+n[t]))}function H3(n){let t=n;const e=n.lastIndexOf("=");return e>=0&&e!==n.length-1&&(t=n.slice(0,e)),t}function yn(n){return new Promise(async(t,e)=>{try{const r=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,h=a,u=[];const f=v2(Ir(n,async(y,d)=>{const g=rr(y);try{for(;;){let A=await g.readLine();if(A===void 0)throw Error("Misformed armored text");if(A=m.removeTrailingSpaces(A.replace(/[\r\n]/g,"")),s)if(o)c||s!==l.armor.signed||(r.test(A)?(u=u.join(`\r
`),c=!0,o1(h),h=[],o=!1):u.push(A.replace(/^- /,"")));else if(r.test(A)&&e(Error("Mandatory blank line missing between armor headers and armor data")),i.test(A)){if(o1(h),o=!0,c||s!==l.armor.signed){t({text:u,data:f,headers:a,type:s});break}}else h.push(A);else r.test(A)&&(s=L3(A))}}catch(A){return void e(A)}const p=se(d);try{for(;;){await p.ready;const{done:A,value:v}=await g.read();if(A)throw Error("Misformed armored text");const w=v+"";if(w.indexOf("=")!==-1||w.indexOf("-")!==-1){let x=await g.readToEnd();x.length||(x=""),x=w+x,x=m.removeTrailingSpaces(x.replace(/\r/g,""));const b=x.split(r);if(b.length===1)throw Error("Misformed armored text");const S=H3(b[0].slice(0,-1));await p.write(S);break}await p.write(w)}await p.ready,await p.close()}catch(A){await p.abort(A)}}))}catch(r){e(r)}}).then(async t=>(kt(t.data)&&(t.data=await Dt(t.data)),t))}function dn(n,t,e,r,i,s=!1,a=W){let o,c;n===l.armor.signed&&(o=t.text,c=t.hash,t=t.data);const h=s&&tn(t),u=[];switch(n){case l.armor.multipartSection:u.push("-----BEGIN PGP MESSAGE, PART "+e+"/"+r+`-----
`),u.push(Ur(i,a)),u.push(je(t)),h&&u.push("=",Rr(h)),u.push("-----END PGP MESSAGE, PART "+e+"/"+r+`-----
`);break;case l.armor.multipartLast:u.push("-----BEGIN PGP MESSAGE, PART "+e+`-----
`),u.push(Ur(i,a)),u.push(je(t)),h&&u.push("=",Rr(h)),u.push("-----END PGP MESSAGE, PART "+e+`-----
`);break;case l.armor.signed:u.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),u.push(c?`Hash: ${c}

`:`
`),u.push(o.replace(/^-/gm,"- -")),u.push(`
-----BEGIN PGP SIGNATURE-----
`),u.push(Ur(i,a)),u.push(je(t)),h&&u.push("=",Rr(h)),u.push(`-----END PGP SIGNATURE-----
`);break;case l.armor.message:u.push(`-----BEGIN PGP MESSAGE-----
`),u.push(Ur(i,a)),u.push(je(t)),h&&u.push("=",Rr(h)),u.push(`-----END PGP MESSAGE-----
`);break;case l.armor.publicKey:u.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),u.push(Ur(i,a)),u.push(je(t)),h&&u.push("=",Rr(h)),u.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case l.armor.privateKey:u.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),u.push(Ur(i,a)),u.push(je(t)),h&&u.push("=",Rr(h)),u.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case l.armor.signature:u.push(`-----BEGIN PGP SIGNATURE-----
`),u.push(Ur(i,a)),u.push(je(t)),h&&u.push("=",Rr(h)),u.push(`-----END PGP SIGNATURE-----
`)}return m.concat(u)}const Jt=BigInt(0),A0=BigInt(1);function Y(n){const t="0123456789ABCDEF";let e="";return n.forEach(r=>{e+=t[r>>4]+t[15&r]}),BigInt("0x0"+e)}function rt(n,t){const e=n%t;return e<Jt?e+t:e}function Ft(n,t,e){if(e===Jt)throw Error("Modulo cannot be zero");if(e===A0)return BigInt(0);if(t<Jt)throw Error("Unsopported negative exponent");let r=t,i=n;i%=e;let s=BigInt(1);for(;r>Jt;){const a=r&A0;r>>=A0,s=a?s*i%e:s,i=i*i%e}return s}function c1(n){return n>=Jt?n:-n}function m0(n,t){const{gcd:e,x:r}=function(i,s){let a=BigInt(0),o=BigInt(1),c=BigInt(1),h=BigInt(0),u=c1(i),f=c1(s);const y=i<Jt,d=s<Jt;for(;f!==Jt;){const g=u/f;let p=a;a=c-g*a,c=p,p=o,o=h-g*o,h=p,p=f,f=u%f,u=p}return{x:y?-c:c,y:d?-h:h,gcd:u}}(n,t);if(e!==A0)throw Error("Inverse does not exist");return rt(r+t,t)}function Ms(n){const t=Number(n);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}function M3(n,t){return(n>>BigInt(t)&A0)===Jt?0:1}function x0(n){const t=n<Jt?BigInt(-1):Jt;let e=1,r=n;for(;(r>>=A0)!==t;)e++;return e}function te(n){const t=n<Jt?BigInt(-1):Jt,e=BigInt(8);let r=1,i=n;for(;(i>>=e)!==t;)r++;return r}function Et(n,t="be",e){let r=n.toString(16);r.length%2==1&&(r="0"+r);const i=r.length/2,s=new Uint8Array(e||i),a=e?e-i:0;let o=0;for(;o<i;)s[o+a]=parseInt(r.slice(2*o,2*o+2),16),o++;return t!=="be"&&s.reverse(),s}const Di=m.getNodeCrypto();function Pt(n){const t=typeof crypto<"u"?crypto:Di==null?void 0:Di.webcrypto;if(t!=null&&t.getRandomValues){const e=new Uint8Array(n);return t.getRandomValues(e)}throw Error("No secure random number generator available.")}function Br(n,t){if(t<n)throw Error("Illegal parameter value: max <= min");const e=t-n;return rt(Y(Pt(te(e)+8)),e)+n}const Ce=BigInt(1);function h1(n,t,e){const r=BigInt(30),i=Ce<<BigInt(n-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2];let a=Br(i,i<<Ce),o=Ms(rt(a,r));do a+=BigInt(s[o]),o=(o+s[o])%s.length,x0(a)>n&&(a=rt(a,i<<Ce),a+=i,o=Ms(rt(a,r)));while(!E2(a,t,e));return a}function E2(n,t,e){return(!t||function(r,i){let s=r,a=i;for(;a!==Jt;){const o=a;a=s%a,s=o}return s}(n-Ce,t)===Ce)&&!!function(r){const i=BigInt(0);return N3.every(s=>rt(r,s)!==i)}(n)&&!!function(r,i=BigInt(2)){return Ft(i,r-Ce,r)===Ce}(n)&&!!function(r,i){const s=x0(r);i||(i=Math.max(1,s/48|0));const a=r-Ce;let o=0;for(;!M3(a,o);)o++;const c=r>>BigInt(o);for(;i>0;i--){let h,u=Ft(Br(BigInt(2),a),c,r);if(u!==Ce&&u!==a){for(h=1;h<o;h++){if(u=rt(u*u,r),u===Ce)return!1;if(u===a)break}if(h===o)return!1}}return!0}(n,e)}const N3=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(n=>BigInt(n)),u1=m.getWebCrypto(),On=m.getNodeCrypto(),z3=On&&On.getHashes();function nr(n){if(On&&z3.includes(n))return async function(t){const e=On.createHash(n);return mt(t,r=>{e.update(r)},()=>new Uint8Array(e.digest()))}}function ir(n,t){const e=async()=>{const{nobleHashes:r}=await Promise.resolve().then(function(){return P5}),i=r.get(n);if(!i)throw Error("Unsupported hash");return i};return async function(r){if(kt(r)&&(r=await Dt(r)),m.isStream(r)){const i=(await e()).create();return mt(r,s=>{i.update(s)},()=>i.digest())}return u1&&t?new Uint8Array(await u1.digest(t,r)):(await e())(r)}}const O3=nr("md5")||ir("md5"),G3=nr("sha1")||ir("sha1","SHA-1"),q3=nr("sha224")||ir("sha224"),W3=nr("sha256")||ir("sha256","SHA-256"),j3=nr("sha384")||ir("sha384","SHA-384"),V3=nr("sha512")||ir("sha512","SHA-512"),Y3=nr("ripemd160")||ir("ripemd160"),Z3=nr("sha3-256")||ir("sha3_256"),X3=nr("sha3-512")||ir("sha3_512");function Te(n,t){switch(n){case l.hash.md5:return O3(t);case l.hash.sha1:return G3(t);case l.hash.ripemd:return Y3(t);case l.hash.sha256:return W3(t);case l.hash.sha384:return j3(t);case l.hash.sha512:return V3(t);case l.hash.sha224:return q3(t);case l.hash.sha3_256:return Z3(t);case l.hash.sha3_512:return X3(t);default:throw Error("Unsupported hash function")}}function Ct(n){switch(n){case l.hash.md5:return 16;case l.hash.sha1:case l.hash.ripemd:return 20;case l.hash.sha256:return 32;case l.hash.sha384:return 48;case l.hash.sha512:return 64;case l.hash.sha224:return 28;case l.hash.sha3_256:return 32;case l.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}const De=[];function B2(n,t){const e=n.length;if(e>t-11)throw Error("Message too long");const r=function(s){const a=new Uint8Array(s);let o=0;for(;o<s;){const c=Pt(s-o);for(let h=0;h<c.length;h++)c[h]!==0&&(a[o++]=c[h])}return a}(t-e-3),i=new Uint8Array(t);return i[1]=2,i.set(r,2),i.set(n,t-e),i}function k2(n,t){let e=2,r=1;for(let o=e;o<n.length;o++)r&=n[o]!==0,e+=r;const i=e-2,s=n.subarray(e+1),a=n[0]===0&n[1]===2&i>=8&!r;if(t)return m.selectUint8Array(a,s,t);if(a)return s;throw Error("Decryption error")}function C2(n,t,e){let r;if(t.length!==Ct(n))throw Error("Invalid hash length");const i=new Uint8Array(De[n].length);for(r=0;r<De[n].length;r++)i[r]=De[n][r];const s=i.length+t.length;if(e<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(e-s-3).fill(255),o=new Uint8Array(e);return o[1]=1,o.set(a,2),o.set(i,e-s),o.set(t,e-t.length),o}De[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],De[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],De[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],De[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],De[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],De[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],De[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];const v0=m.getWebCrypto(),qr=m.getNodeCrypto(),Cr=BigInt(1);async function $3(n,t,e,r,i,s,a,o,c){if(Ct(n)>=e.length)throw Error("Digest size cannot exceed key modulus size");if(t&&!m.isStream(t)){if(m.getWebCrypto())try{return await async function(h,u,f,y,d,g,p,A){const v=await Ns(f,y,d,g,p,A),w={name:"RSASSA-PKCS1-v1_5",hash:{name:h}},x=await v0.importKey("jwk",v,w,!1,["sign"]);return new Uint8Array(await v0.sign("RSASSA-PKCS1-v1_5",x,u))}(l.read(l.webHash,n),t,e,r,i,s,a,o)}catch(h){m.printDebugError(h)}else if(m.getNodeCrypto())return async function(h,u,f,y,d,g,p,A){const v=qr.createSign(l.read(l.hash,h));v.write(u),v.end();const w=await Ns(f,y,d,g,p,A);return new Uint8Array(v.sign({key:w,format:"jwk",type:"pkcs1"}))}(n,t,e,r,i,s,a,o)}return async function(h,u,f,y){u=Y(u);const d=Y(C2(h,y,te(u)));return f=Y(f),Et(Ft(d,f,u),"be",te(u))}(n,e,i,c)}async function J3(n,t,e,r,i,s){if(t&&!m.isStream(t)){if(m.getWebCrypto())try{return await async function(a,o,c,h,u){const f=zs(h,u),y=await v0.importKey("jwk",f,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["verify"]);return v0.verify("RSASSA-PKCS1-v1_5",y,c,o)}(l.read(l.webHash,n),t,e,r,i)}catch(a){m.printDebugError(a)}else if(m.getNodeCrypto())return async function(a,o,c,h,u){const f=zs(h,u),y={key:f,format:"jwk",type:"pkcs1"},d=qr.createVerify(l.read(l.hash,a));d.write(o),d.end();try{return d.verify(y,c)}catch{return!1}}(n,t,e,r,i)}return async function(a,o,c,h,u){if(c=Y(c),o=Y(o),h=Y(h),o>=c)throw Error("Signature size cannot exceed modulus size");const f=Et(Ft(o,h,c),"be",te(c)),y=C2(a,u,te(c));return m.equalsUint8Array(f,y)}(n,e,r,i,s)}async function t4(n,t,e){return m.getNodeCrypto()?async function(r,i,s){const a=zs(i,s),o={key:a,format:"jwk",type:"pkcs1",padding:qr.constants.RSA_PKCS1_PADDING};return new Uint8Array(qr.publicEncrypt(o,r))}(n,t,e):async function(r,i,s){if(i=Y(i),r=Y(B2(r,te(i))),s=Y(s),r>=i)throw Error("Message size cannot exceed modulus size");return Et(Ft(r,s,i),"be",te(i))}(n,t,e)}async function e4(n,t,e,r,i,s,a,o){if(m.getNodeCrypto()&&!o)try{return await async function(c,h,u,f,y,d,g){const p=await Ns(h,u,f,y,d,g),A={key:p,format:"jwk",type:"pkcs1",padding:qr.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(qr.privateDecrypt(A,c))}catch{throw Error("Decryption error")}}(n,t,e,r,i,s,a)}catch(c){m.printDebugError(c)}return async function(c,h,u,f,y,d,g,p){if(c=Y(c),h=Y(h),u=Y(u),f=Y(f),y=Y(y),d=Y(d),g=Y(g),c>=h)throw Error("Data too large.");const A=rt(f,d-Cr),v=rt(f,y-Cr),w=Br(BigInt(2),h),x=Ft(m0(w,h),u,h);c=rt(c*x,h);const b=Ft(c,v,y),S=Ft(c,A,d);let F=rt(g*(S-b),d)*y+b;return F=rt(F*w,h),k2(Et(F,"be",te(h)),p)}(n,t,e,r,i,s,a,o)}async function Ns(n,t,e,r,i,s){const a=Y(r),o=Y(i),c=Y(e);let h=rt(c,o-Cr),u=rt(c,a-Cr);return u=Et(u),h=Et(h),{kty:"RSA",n:Ot(n),e:Ot(t),d:Ot(e),p:Ot(i),q:Ot(r),dp:Ot(h),dq:Ot(u),qi:Ot(s),ext:!0}}function zs(n,t){return{kty:"RSA",n:Ot(n),e:Ot(t),ext:!0}}function f1(n,t){return{n:me(n.n),e:Et(t),d:me(n.d),p:me(n.q),q:me(n.p),u:me(n.qi)}}const Ar=BigInt(1),Si=typeof Ht=="object"&&"crypto"in Ht?Ht.crypto:void 0,xt={};var V=function(n){var t,e=new Float64Array(16);if(n)for(t=0;t<n.length;t++)e[t]=n[t];return e},Os=function(){throw Error("no PRNG")},D2=new Uint8Array(32);D2[0]=9;var Gs=V(),Gn=V([1]),r4=V([56129,1]),n4=V([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),i4=V([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l1=V([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y1=V([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),s4=V([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d1(n,t,e,r){n[t]=e>>24&255,n[t+1]=e>>16&255,n[t+2]=e>>8&255,n[t+3]=255&e,n[t+4]=r>>24&255,n[t+5]=r>>16&255,n[t+6]=r>>8&255,n[t+7]=255&r}function S2(n,t,e,r){return function(i,s,a,o,c){var h,u=0;for(h=0;h<c;h++)u|=i[s+h]^a[o+h];return(1&u-1>>>8)-1}(n,t,e,r,32)}function wr(n,t){var e;for(e=0;e<16;e++)n[e]=0|t[e]}function Ii(n){var t,e,r=1;for(t=0;t<16;t++)e=n[t]+r+65535,r=Math.floor(e/65536),n[t]=e-65536*r;n[0]+=r-1+37*(r-1)}function l0(n,t,e){for(var r,i=~(e-1),s=0;s<16;s++)r=i&(n[s]^t[s]),n[s]^=r,t[s]^=r}function nn(n,t){var e,r,i,s=V(),a=V();for(e=0;e<16;e++)a[e]=t[e];for(Ii(a),Ii(a),Ii(a),r=0;r<2;r++){for(s[0]=a[0]-65517,e=1;e<15;e++)s[e]=a[e]-65535-(s[e-1]>>16&1),s[e-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,l0(a,s,1-i)}for(e=0;e<16;e++)n[2*e]=255&a[e],n[2*e+1]=a[e]>>8}function p1(n,t){var e=new Uint8Array(32),r=new Uint8Array(32);return nn(e,n),nn(r,t),S2(e,0,r,0)}function I2(n){var t=new Uint8Array(32);return nn(t,n),1&t[0]}function K2(n,t){var e;for(e=0;e<16;e++)n[e]=t[2*e]+(t[2*e+1]<<8);n[15]&=32767}function Ie(n,t,e){for(var r=0;r<16;r++)n[r]=t[r]+e[r]}function Fe(n,t,e){for(var r=0;r<16;r++)n[r]=t[r]-e[r]}function st(n,t,e){var r,i,s=0,a=0,o=0,c=0,h=0,u=0,f=0,y=0,d=0,g=0,p=0,A=0,v=0,w=0,x=0,b=0,S=0,K=0,F=0,k=0,B=0,E=0,C=0,I=0,D=0,P=0,U=0,T=0,M=0,z=0,O=0,H=e[0],R=e[1],Q=e[2],L=e[3],_=e[4],G=e[5],N=e[6],j=e[7],q=e[8],$=e[9],Z=e[10],at=e[11],ot=e[12],it=e[13],et=e[14],yt=e[15];s+=(r=t[0])*H,a+=r*R,o+=r*Q,c+=r*L,h+=r*_,u+=r*G,f+=r*N,y+=r*j,d+=r*q,g+=r*$,p+=r*Z,A+=r*at,v+=r*ot,w+=r*it,x+=r*et,b+=r*yt,a+=(r=t[1])*H,o+=r*R,c+=r*Q,h+=r*L,u+=r*_,f+=r*G,y+=r*N,d+=r*j,g+=r*q,p+=r*$,A+=r*Z,v+=r*at,w+=r*ot,x+=r*it,b+=r*et,S+=r*yt,o+=(r=t[2])*H,c+=r*R,h+=r*Q,u+=r*L,f+=r*_,y+=r*G,d+=r*N,g+=r*j,p+=r*q,A+=r*$,v+=r*Z,w+=r*at,x+=r*ot,b+=r*it,S+=r*et,K+=r*yt,c+=(r=t[3])*H,h+=r*R,u+=r*Q,f+=r*L,y+=r*_,d+=r*G,g+=r*N,p+=r*j,A+=r*q,v+=r*$,w+=r*Z,x+=r*at,b+=r*ot,S+=r*it,K+=r*et,F+=r*yt,h+=(r=t[4])*H,u+=r*R,f+=r*Q,y+=r*L,d+=r*_,g+=r*G,p+=r*N,A+=r*j,v+=r*q,w+=r*$,x+=r*Z,b+=r*at,S+=r*ot,K+=r*it,F+=r*et,k+=r*yt,u+=(r=t[5])*H,f+=r*R,y+=r*Q,d+=r*L,g+=r*_,p+=r*G,A+=r*N,v+=r*j,w+=r*q,x+=r*$,b+=r*Z,S+=r*at,K+=r*ot,F+=r*it,k+=r*et,B+=r*yt,f+=(r=t[6])*H,y+=r*R,d+=r*Q,g+=r*L,p+=r*_,A+=r*G,v+=r*N,w+=r*j,x+=r*q,b+=r*$,S+=r*Z,K+=r*at,F+=r*ot,k+=r*it,B+=r*et,E+=r*yt,y+=(r=t[7])*H,d+=r*R,g+=r*Q,p+=r*L,A+=r*_,v+=r*G,w+=r*N,x+=r*j,b+=r*q,S+=r*$,K+=r*Z,F+=r*at,k+=r*ot,B+=r*it,E+=r*et,C+=r*yt,d+=(r=t[8])*H,g+=r*R,p+=r*Q,A+=r*L,v+=r*_,w+=r*G,x+=r*N,b+=r*j,S+=r*q,K+=r*$,F+=r*Z,k+=r*at,B+=r*ot,E+=r*it,C+=r*et,I+=r*yt,g+=(r=t[9])*H,p+=r*R,A+=r*Q,v+=r*L,w+=r*_,x+=r*G,b+=r*N,S+=r*j,K+=r*q,F+=r*$,k+=r*Z,B+=r*at,E+=r*ot,C+=r*it,I+=r*et,D+=r*yt,p+=(r=t[10])*H,A+=r*R,v+=r*Q,w+=r*L,x+=r*_,b+=r*G,S+=r*N,K+=r*j,F+=r*q,k+=r*$,B+=r*Z,E+=r*at,C+=r*ot,I+=r*it,D+=r*et,P+=r*yt,A+=(r=t[11])*H,v+=r*R,w+=r*Q,x+=r*L,b+=r*_,S+=r*G,K+=r*N,F+=r*j,k+=r*q,B+=r*$,E+=r*Z,C+=r*at,I+=r*ot,D+=r*it,P+=r*et,U+=r*yt,v+=(r=t[12])*H,w+=r*R,x+=r*Q,b+=r*L,S+=r*_,K+=r*G,F+=r*N,k+=r*j,B+=r*q,E+=r*$,C+=r*Z,I+=r*at,D+=r*ot,P+=r*it,U+=r*et,T+=r*yt,w+=(r=t[13])*H,x+=r*R,b+=r*Q,S+=r*L,K+=r*_,F+=r*G,k+=r*N,B+=r*j,E+=r*q,C+=r*$,I+=r*Z,D+=r*at,P+=r*ot,U+=r*it,T+=r*et,M+=r*yt,x+=(r=t[14])*H,b+=r*R,S+=r*Q,K+=r*L,F+=r*_,k+=r*G,B+=r*N,E+=r*j,C+=r*q,I+=r*$,D+=r*Z,P+=r*at,U+=r*ot,T+=r*it,M+=r*et,z+=r*yt,b+=(r=t[15])*H,a+=38*(K+=r*Q),o+=38*(F+=r*L),c+=38*(k+=r*_),h+=38*(B+=r*G),u+=38*(E+=r*N),f+=38*(C+=r*j),y+=38*(I+=r*q),d+=38*(D+=r*$),g+=38*(P+=r*Z),p+=38*(U+=r*at),A+=38*(T+=r*ot),v+=38*(M+=r*it),w+=38*(z+=r*et),x+=38*(O+=r*yt),s=(r=(s+=38*(S+=r*R))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),o=(r=o+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),A=(r=A+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),x=(r=x+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),s=(r=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),o=(r=o+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),A=(r=A+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),x=(r=x+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),s+=i-1+37*(i-1),n[0]=s,n[1]=a,n[2]=o,n[3]=c,n[4]=h,n[5]=u,n[6]=f,n[7]=y,n[8]=d,n[9]=g,n[10]=p,n[11]=A,n[12]=v,n[13]=w,n[14]=x,n[15]=b}function be(n,t){st(n,t,t)}function F2(n,t){var e,r=V();for(e=0;e<16;e++)r[e]=t[e];for(e=253;e>=0;e--)be(r,r),e!==2&&e!==4&&st(r,r,t);for(e=0;e<16;e++)n[e]=r[e]}function P2(n,t,e){var r,i,s=new Uint8Array(32),a=new Float64Array(80),o=V(),c=V(),h=V(),u=V(),f=V(),y=V();for(i=0;i<31;i++)s[i]=t[i];for(s[31]=127&t[31]|64,s[0]&=248,K2(a,e),i=0;i<16;i++)c[i]=a[i],u[i]=o[i]=h[i]=0;for(o[0]=u[0]=1,i=254;i>=0;--i)l0(o,c,r=s[i>>>3]>>>(7&i)&1),l0(h,u,r),Ie(f,o,h),Fe(o,o,h),Ie(h,c,u),Fe(c,c,u),be(u,f),be(y,o),st(o,h,o),st(h,c,f),Ie(f,o,h),Fe(o,o,h),be(c,o),Fe(h,u,y),st(o,h,r4),Ie(o,o,u),st(h,h,o),st(o,u,y),st(u,c,a),be(c,f),l0(o,c,r),l0(h,u,r);for(i=0;i<16;i++)a[i+16]=o[i],a[i+32]=h[i],a[i+48]=c[i],a[i+64]=u[i];var d=a.subarray(32),g=a.subarray(16);return F2(d,d),st(g,g,d),nn(n,g),0}function g1(n,t){return P2(n,t,D2)}var A1=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function x1(n,t,e,r){for(var i,s,a,o,c,h,u,f,y,d,g,p,A,v,w,x,b,S,K,F,k,B,E,C,I,D,P=new Int32Array(16),U=new Int32Array(16),T=n[0],M=n[1],z=n[2],O=n[3],H=n[4],R=n[5],Q=n[6],L=n[7],_=t[0],G=t[1],N=t[2],j=t[3],q=t[4],$=t[5],Z=t[6],at=t[7],ot=0;r>=128;){for(K=0;K<16;K++)F=8*K+ot,P[K]=e[F+0]<<24|e[F+1]<<16|e[F+2]<<8|e[F+3],U[K]=e[F+4]<<24|e[F+5]<<16|e[F+6]<<8|e[F+7];for(K=0;K<80;K++)if(i=T,s=M,a=z,o=O,c=H,h=R,u=Q,y=_,d=G,g=N,p=j,A=q,v=$,w=Z,E=65535&(B=at),C=B>>>16,I=65535&(k=L),D=k>>>16,E+=65535&(B=(q>>>14|H<<18)^(q>>>18|H<<14)^(H>>>9|q<<23)),C+=B>>>16,I+=65535&(k=(H>>>14|q<<18)^(H>>>18|q<<14)^(q>>>9|H<<23)),D+=k>>>16,E+=65535&(B=q&$^~q&Z),C+=B>>>16,I+=65535&(k=H&R^~H&Q),D+=k>>>16,k=A1[2*K],E+=65535&(B=A1[2*K+1]),C+=B>>>16,I+=65535&k,D+=k>>>16,k=P[K%16],C+=(B=U[K%16])>>>16,I+=65535&k,D+=k>>>16,I+=(C+=(E+=65535&B)>>>16)>>>16,E=65535&(B=S=65535&E|C<<16),C=B>>>16,I=65535&(k=b=65535&I|(D+=I>>>16)<<16),D=k>>>16,E+=65535&(B=(_>>>28|T<<4)^(T>>>2|_<<30)^(T>>>7|_<<25)),C+=B>>>16,I+=65535&(k=(T>>>28|_<<4)^(_>>>2|T<<30)^(_>>>7|T<<25)),D+=k>>>16,C+=(B=_&G^_&N^G&N)>>>16,I+=65535&(k=T&M^T&z^M&z),D+=k>>>16,f=65535&(I+=(C+=(E+=65535&B)>>>16)>>>16)|(D+=I>>>16)<<16,x=65535&E|C<<16,E=65535&(B=p),C=B>>>16,I=65535&(k=o),D=k>>>16,C+=(B=S)>>>16,I+=65535&(k=b),D+=k>>>16,M=i,z=s,O=a,H=o=65535&(I+=(C+=(E+=65535&B)>>>16)>>>16)|(D+=I>>>16)<<16,R=c,Q=h,L=u,T=f,G=y,N=d,j=g,q=p=65535&E|C<<16,$=A,Z=v,at=w,_=x,K%16==15)for(F=0;F<16;F++)k=P[F],E=65535&(B=U[F]),C=B>>>16,I=65535&k,D=k>>>16,k=P[(F+9)%16],E+=65535&(B=U[(F+9)%16]),C+=B>>>16,I+=65535&k,D+=k>>>16,b=P[(F+1)%16],E+=65535&(B=((S=U[(F+1)%16])>>>1|b<<31)^(S>>>8|b<<24)^(S>>>7|b<<25)),C+=B>>>16,I+=65535&(k=(b>>>1|S<<31)^(b>>>8|S<<24)^b>>>7),D+=k>>>16,b=P[(F+14)%16],C+=(B=((S=U[(F+14)%16])>>>19|b<<13)^(b>>>29|S<<3)^(S>>>6|b<<26))>>>16,I+=65535&(k=(b>>>19|S<<13)^(S>>>29|b<<3)^b>>>6),D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,P[F]=65535&I|D<<16,U[F]=65535&E|C<<16;E=65535&(B=_),C=B>>>16,I=65535&(k=T),D=k>>>16,k=n[0],C+=(B=t[0])>>>16,I+=65535&k,D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,n[0]=T=65535&I|D<<16,t[0]=_=65535&E|C<<16,E=65535&(B=G),C=B>>>16,I=65535&(k=M),D=k>>>16,k=n[1],C+=(B=t[1])>>>16,I+=65535&k,D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,n[1]=M=65535&I|D<<16,t[1]=G=65535&E|C<<16,E=65535&(B=N),C=B>>>16,I=65535&(k=z),D=k>>>16,k=n[2],C+=(B=t[2])>>>16,I+=65535&k,D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,n[2]=z=65535&I|D<<16,t[2]=N=65535&E|C<<16,E=65535&(B=j),C=B>>>16,I=65535&(k=O),D=k>>>16,k=n[3],C+=(B=t[3])>>>16,I+=65535&k,D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,n[3]=O=65535&I|D<<16,t[3]=j=65535&E|C<<16,E=65535&(B=q),C=B>>>16,I=65535&(k=H),D=k>>>16,k=n[4],C+=(B=t[4])>>>16,I+=65535&k,D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,n[4]=H=65535&I|D<<16,t[4]=q=65535&E|C<<16,E=65535&(B=$),C=B>>>16,I=65535&(k=R),D=k>>>16,k=n[5],C+=(B=t[5])>>>16,I+=65535&k,D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,n[5]=R=65535&I|D<<16,t[5]=$=65535&E|C<<16,E=65535&(B=Z),C=B>>>16,I=65535&(k=Q),D=k>>>16,k=n[6],C+=(B=t[6])>>>16,I+=65535&k,D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,n[6]=Q=65535&I|D<<16,t[6]=Z=65535&E|C<<16,E=65535&(B=at),C=B>>>16,I=65535&(k=L),D=k>>>16,k=n[7],C+=(B=t[7])>>>16,I+=65535&k,D+=k>>>16,D+=(I+=(C+=(E+=65535&B)>>>16)>>>16)>>>16,n[7]=L=65535&I|D<<16,t[7]=at=65535&E|C<<16,ot+=128,r-=128}return r}function O0(n,t,e){var r,i=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=e;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,x1(i,s,t,e),e%=128,r=0;r<e;r++)a[r]=t[o-e+r];for(a[e]=128,a[(e=256-128*(e<112?1:0))-9]=0,d1(a,e-8,o/536870912|0,o<<3),x1(i,s,a,e),r=0;r<8;r++)d1(n,8*r,i[r],s[r]);return 0}function qs(n,t){var e=V(),r=V(),i=V(),s=V(),a=V(),o=V(),c=V(),h=V(),u=V();Fe(e,n[1],n[0]),Fe(u,t[1],t[0]),st(e,e,u),Ie(r,n[0],n[1]),Ie(u,t[0],t[1]),st(r,r,u),st(i,n[3],t[3]),st(i,i,i4),st(s,n[2],t[2]),Ie(s,s,s),Fe(a,r,e),Fe(o,s,i),Ie(c,s,i),Ie(h,r,e),st(n[0],a,o),st(n[1],h,c),st(n[2],c,o),st(n[3],a,h)}function w1(n,t,e){var r;for(r=0;r<4;r++)l0(n[r],t[r],e)}function Ws(n,t){var e=V(),r=V(),i=V();F2(i,t[2]),st(e,t[0],i),st(r,t[1],i),nn(n,r),n[31]^=I2(e)<<7}function U2(n,t,e){var r,i;for(wr(n[0],Gs),wr(n[1],Gn),wr(n[2],Gn),wr(n[3],Gs),i=255;i>=0;--i)w1(n,t,r=e[i/8|0]>>(7&i)&1),qs(t,n),qs(n,n),w1(n,t,r)}function js(n,t){var e=[V(),V(),V(),V()];wr(e[0],l1),wr(e[1],y1),wr(e[2],Gn),st(e[3],l1,y1),U2(n,e,t)}function b1(n,t,e){var r,i=new Uint8Array(64),s=[V(),V(),V(),V()];for(e||Os(t,32),O0(i,t,32),i[0]&=248,i[31]&=127,i[31]|=64,js(s,i),Ws(n,s),r=0;r<32;r++)t[r+32]=n[r];return 0}var Ki=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function R2(n,t){var e,r,i,s;for(r=63;r>=32;--r){for(e=0,i=r-32,s=r-12;i<s;++i)t[i]+=e-16*t[r]*Ki[i-(r-32)],e=Math.floor((t[i]+128)/256),t[i]-=256*e;t[i]+=e,t[r]=0}for(e=0,i=0;i<32;i++)t[i]+=e-(t[31]>>4)*Ki[i],e=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=e*Ki[i];for(r=0;r<32;r++)t[r+1]+=t[r]>>8,n[r]=255&t[r]}function Fi(n){var t,e=new Float64Array(64);for(t=0;t<64;t++)e[t]=n[t];for(t=0;t<64;t++)n[t]=0;R2(n,e)}function a4(n,t){var e=V(),r=V(),i=V(),s=V(),a=V(),o=V(),c=V();return wr(n[2],Gn),K2(n[1],t),be(i,n[1]),st(s,i,n4),Fe(i,i,n[2]),Ie(s,n[2],s),be(a,s),be(o,a),st(c,o,a),st(e,c,i),st(e,e,s),function(h,u){var f,y=V();for(f=0;f<16;f++)y[f]=u[f];for(f=250;f>=0;f--)be(y,y),f!==1&&st(y,y,u);for(f=0;f<16;f++)h[f]=y[f]}(e,e),st(e,e,i),st(e,e,s),st(e,e,s),st(n[0],e,s),be(r,n[0]),st(r,r,s),p1(r,i)&&st(n[0],n[0],s4),be(r,n[0]),st(r,r,s),p1(r,i)?-1:(I2(n[0])===t[31]>>7&&Fe(n[0],Gs,n[0]),st(n[3],n[0],n[1]),0)}var Qr=64;function i0(){for(var n=0;n<arguments.length;n++)if(!(arguments[n]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}xt.scalarMult=function(n,t){if(i0(n,t),n.length!==32)throw Error("bad n size");if(t.length!==32)throw Error("bad p size");var e=new Uint8Array(32);return P2(e,n,t),e},xt.box={},xt.box.keyPair=function(){var n=new Uint8Array(32),t=new Uint8Array(32);return function(e,r){Os(r,32),g1(e,r)}(n,t),{publicKey:n,secretKey:t}},xt.box.keyPair.fromSecretKey=function(n){if(i0(n),n.length!==32)throw Error("bad secret key size");var t=new Uint8Array(32);return g1(t,n),{publicKey:t,secretKey:new Uint8Array(n)}},xt.sign=function(n,t){if(i0(n,t),t.length!==64)throw Error("bad secret key size");var e=new Uint8Array(Qr+n.length);return function(r,i,s,a){var o,c,h=new Uint8Array(64),u=new Uint8Array(64),f=new Uint8Array(64),y=new Float64Array(64),d=[V(),V(),V(),V()];for(O0(h,a,32),h[0]&=248,h[31]&=127,h[31]|=64,o=0;o<s;o++)r[64+o]=i[o];for(o=0;o<32;o++)r[32+o]=h[32+o];for(O0(f,r.subarray(32),s+32),Fi(f),js(d,f),Ws(r,d),o=32;o<64;o++)r[o]=a[o];for(O0(u,r,s+64),Fi(u),o=0;o<64;o++)y[o]=0;for(o=0;o<32;o++)y[o]=f[o];for(o=0;o<32;o++)for(c=0;c<32;c++)y[o+c]+=u[o]*h[c];R2(r.subarray(32),y)}(e,n,n.length,t),e},xt.sign.detached=function(n,t){for(var e=xt.sign(n,t),r=new Uint8Array(Qr),i=0;i<r.length;i++)r[i]=e[i];return r},xt.sign.detached.verify=function(n,t,e){if(i0(n,t,e),t.length!==Qr)throw Error("bad signature size");if(e.length!==32)throw Error("bad public key size");var r,i=new Uint8Array(Qr+n.length),s=new Uint8Array(Qr+n.length);for(r=0;r<Qr;r++)i[r]=t[r];for(r=0;r<n.length;r++)i[r+Qr]=n[r];return function(a,o,c,h){var u,f=new Uint8Array(32),y=new Uint8Array(64),d=[V(),V(),V(),V()],g=[V(),V(),V(),V()];if(c<64||a4(g,h))return-1;for(u=0;u<c;u++)a[u]=o[u];for(u=0;u<32;u++)a[u+32]=h[u];if(O0(y,a,c),Fi(y),U2(d,g,y),js(g,o.subarray(32)),qs(d,g),Ws(f,d),c-=64,S2(o,0,f,0)){for(u=0;u<c;u++)a[u]=0;return-1}for(u=0;u<c;u++)a[u]=o[u+64];return c}(s,i,i.length,e)>=0},xt.sign.keyPair=function(){var n=new Uint8Array(32),t=new Uint8Array(64);return b1(n,t),{publicKey:n,secretKey:t}},xt.sign.keyPair.fromSecretKey=function(n){if(i0(n),n.length!==64)throw Error("bad secret key size");for(var t=new Uint8Array(32),e=0;e<t.length;e++)t[e]=n[32+e];return{publicKey:t,secretKey:new Uint8Array(n)}},xt.sign.keyPair.fromSeed=function(n){if(i0(n),n.length!==32)throw Error("bad seed size");for(var t=new Uint8Array(32),e=new Uint8Array(64),r=0;r<32;r++)e[r]=n[r];return b1(t,e,!0),{publicKey:t,secretKey:e}},xt.setPRNG=function(n){Os=n},function(){Si&&Si.getRandomValues&&xt.setPRNG(function(n,t){var e,r=new Uint8Array(t);for(e=0;e<t;e+=65536)Si.getRandomValues(r.subarray(e,e+Math.min(t-e,65536)));for(e=0;e<t;e++)n[e]=r[e];(function(i){for(var s=0;s<i.length;s++)i[s]=0})(r)})}();const o4={"2a8648ce3d030107":l.curve.nistP256,"2b81040022":l.curve.nistP384,"2b81040023":l.curve.nistP521,"2b8104000a":l.curve.secp256k1,"2b06010401da470f01":l.curve.ed25519Legacy,"2b060104019755010501":l.curve.curve25519Legacy,"2b2403030208010107":l.curve.brainpoolP256r1,"2b240303020801010b":l.curve.brainpoolP384r1,"2b240303020801010d":l.curve.brainpoolP512r1};class $e{constructor(t){if(t instanceof $e)this.oid=t.oid;else if(m.isArray(t)||m.isUint8Array(t)){if((t=new Uint8Array(t))[0]===6){if(t[1]!==t.length-2)throw Error("Length mismatch in DER encoded oid");t=t.subarray(2)}this.oid=t}else this.oid=""}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.oid=t.subarray(1,1+e),1+this.oid.length}throw Error("Invalid oid")}write(){return m.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return m.uint8ArrayToHex(this.oid)}getName(){const t=o4[this.toHex()];if(!t)throw Error("Unknown curve object identifier.");return t}}function Q2(n){let t,e=0;const r=n[0];return r<192?([e]=n,t=1):r<255?(e=(n[0]-192<<8)+n[1]+192,t=2):r===255&&(e=m.readNumber(n.subarray(1,5)),t=5),{len:e,offset:t}}function ci(n){return n<192?new Uint8Array([n]):n>191&&n<8384?new Uint8Array([192+(n-192>>8),n-192&255]):m.concatUint8Array([new Uint8Array([255]),m.writeNumber(n,4)])}function c4(n){if(n<0||n>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+n])}function qn(n){return new Uint8Array([192|n])}function m1(n,t){return m.concatUint8Array([qn(n),ci(t)])}function Rn(n){return[l.packet.literalData,l.packet.compressedData,l.packet.symmetricallyEncryptedData,l.packet.symEncryptedIntegrityProtectedData,l.packet.aeadEncryptedData].includes(n)}async function h4(n,t){const e=rr(n);let r,i;try{const s=await e.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await e.readByte();let o,c,h=-1,u=-1;u=0,64&a&&(u=1),u?h=63&a:(h=(63&a)>>2,c=3&a);const f=Rn(h);let y,d=null;if(f){if(m.isStream(n)==="array"){const p=new he;r=se(p),d=p}else{const p=new TransformStream;r=se(p.writable),d=p.readable}i=t({tag:h,packet:d})}else d=[];do{if(u){const p=await e.readByte();if(y=!1,p<192)o=p;else if(p>=192&&p<224)o=(p-192<<8)+await e.readByte()+192;else if(p>223&&p<255){if(o=1<<(31&p),y=!0,!f)throw new TypeError("This packet type does not support partial lengths.")}else o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte()}else switch(c){case 0:o=await e.readByte();break;case 1:o=await e.readByte()<<8|await e.readByte();break;case 2:o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte();break;default:o=1/0}if(o>0){let p=0;for(;;){r&&await r.ready;const{done:A,value:v}=await e.read();if(A){if(o===1/0)break;throw Error("Unexpected end of packet")}const w=o===1/0?v:v.subarray(0,o-p);if(r?await r.write(w):d.push(w),p+=v.length,p>=o){e.unshift(v.subarray(o-p+v.length));break}}}}while(y);const g=await e.peekBytes(f?1/0:2);return r?(await r.ready,await r.close()):(d=m.concatUint8Array(d),await t({tag:h,packet:d})),!g||!g.length}catch(s){if(r)return await r.abort(s),!0;throw s}finally{r&&await i,e.releaseLock()}}class ft extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,ft),this.name="UnsupportedError"}}class _2 extends ft{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,ft),this.name="UnknownPacketError"}}class Vs{constructor(t,e){this.tag=t,this.rawContent=e}write(){return this.rawContent}}async function ba(n){switch(n){case l.publicKey.ed25519:try{const t=m.getWebCrypto(),e=await t.generateKey("Ed25519",!0,["sign","verify"]),r=await t.exportKey("jwk",e.privateKey),i=await t.exportKey("jwk",e.publicKey);return{A:new Uint8Array(me(i.x)),seed:me(r.d)}}catch(t){if(t.name!=="NotSupportedError"&&t.name!=="OperationError")throw t;const e=Pt(hi(n)),{publicKey:r}=xt.sign.keyPair.fromSeed(e);return{A:r,seed:e}}case l.publicKey.ed448:{const t=await m.getNobleCurve(l.publicKey.ed448),e=t.utils.randomPrivateKey();return{A:t.getPublicKey(e),seed:e}}default:throw Error("Unsupported EdDSA algorithm")}}async function ma(n,t,e,r,i,s){if(Ct(t)<Ct(ui(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case l.publicKey.ed25519:try{const a=m.getWebCrypto(),o=u4(n,r,i),c=await a.importKey("jwk",o,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await a.sign("Ed25519",c,s))}}catch(a){if(a.name!=="NotSupportedError")throw a;const o=m.concatUint8Array([i,r]);return{RS:xt.sign.detached(s,o)}}case l.publicKey.ed448:return{RS:(await m.getNobleCurve(l.publicKey.ed448)).sign(s,i)};default:throw Error("Unsupported EdDSA algorithm")}}async function va(n,t,{RS:e},r,i,s){if(Ct(t)<Ct(ui(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case l.publicKey.ed25519:try{const a=m.getWebCrypto(),o=T2(n,i),c=await a.importKey("jwk",o,"Ed25519",!1,["verify"]);return await a.verify("Ed25519",c,e,s)}catch(a){if(a.name!=="NotSupportedError")throw a;return xt.sign.detached.verify(s,e,i)}case l.publicKey.ed448:return(await m.getNobleCurve(l.publicKey.ed448)).verify(e,s,i);default:throw Error("Unsupported EdDSA algorithm")}}async function L2(n,t,e){switch(n){case l.publicKey.ed25519:{const{publicKey:r}=xt.sign.keyPair.fromSeed(e);return m.equalsUint8Array(t,r)}case l.publicKey.ed448:{const r=(await m.getNobleCurve(l.publicKey.ed448)).getPublicKey(e);return m.equalsUint8Array(t,r)}default:return!1}}function hi(n){switch(n){case l.publicKey.ed25519:return 32;case l.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function ui(n){switch(n){case l.publicKey.ed25519:return l.hash.sha256;case l.publicKey.ed448:return l.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const T2=(n,t)=>{if(n===l.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:Ot(t),ext:!0};throw Error("Unsupported EdDSA algorithm")},u4=(n,t,e)=>{if(n===l.publicKey.ed25519){const r=T2(n,t);return r.d=Ot(e),r}throw Error("Unsupported EdDSA algorithm")};var f4=Object.freeze({__proto__:null,generate:ba,getPayloadSize:hi,getPreferredHashAlgo:ui,sign:ma,validateParams:L2,verify:va});function H2(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function ht(n,...t){if(!H2(n))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(n.length))throw Error(`Uint8Array expected of length ${t}, not of length=${n.length}`)}function Wn(n,t=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(t&&n.finished)throw Error("Hash#digest() has already been called")}function M2(n,t){ht(n);const e=t.outputLen;if(n.length<e)throw Error("digestInto() expects output buffer of length at least "+e)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const Ea=n=>new Uint8Array(n.buffer,n.byteOffset,n.byteLength),pt=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),jn=n=>new DataView(n.buffer,n.byteOffset,n.byteLength);if(new Uint8Array(new Uint32Array([287454020]).buffer)[0]!==68)throw Error("Non little-endian hardware is not supported");function sn(n){if(typeof n=="string")n=function(t){if(typeof t!="string")throw Error("string expected, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}(n);else{if(!H2(n))throw Error("Uint8Array expected, got "+typeof n);n=Xt(n)}return n}function N2(n,t){if(n.length!==t.length)return!1;let e=0;for(let r=0;r<n.length;r++)e|=n[r]^t[r];return e===0}const pn=(n,t)=>(Object.assign(t,n),t);function Pi(n,t,e,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(t,e,r);const i=BigInt(32),s=BigInt(4294967295),a=Number(e>>i&s),o=Number(e&s);n.setUint32(t+0,a,r),n.setUint32(t+4,o,r)}function ue(n){return n.byteOffset%4==0}function Xt(n){return Uint8Array.from(n)}function Mt(...n){for(let t=0;t<n.length;t++)n[t].fill(0)}const Ve=16,Ba=new Uint8Array(16),Ke=pt(Ba),oe=n=>(n>>>0&255)<<24|(n>>>8&255)<<16|(n>>>16&255)<<8|n>>>24&255;class z2{constructor(t,e){this.blockLen=Ve,this.outputLen=Ve,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,ht(t=sn(t),16);const r=jn(t);let i=r.getUint32(0,!1),s=r.getUint32(4,!1),a=r.getUint32(8,!1),o=r.getUint32(12,!1);const c=[];for(let v=0;v<128;v++)c.push({s0:oe(i),s1:oe(s),s2:oe(a),s3:oe(o)}),{s0:i,s1:s,s2:a,s3:o}={s3:(f=a)<<31|(y=o)>>>1,s2:(u=s)<<31|f>>>1,s1:(h=i)<<31|u>>>1,s0:h>>>1^225<<24&-(1&y)};var h,u,f,y;const d=(v=>v>65536?8:v>1024?4:2)(e||1024);if(![1,2,4,8].includes(d))throw Error(`ghash: wrong window size=${d}, should be 2, 4 or 8`);this.W=d;const g=128/d,p=this.windowSize=2**d,A=[];for(let v=0;v<g;v++)for(let w=0;w<p;w++){let x=0,b=0,S=0,K=0;for(let F=0;F<d;F++){if(!(w>>>d-F-1&1))continue;const{s0:k,s1:B,s2:E,s3:C}=c[d*v+F];x^=k,b^=B,S^=E,K^=C}A.push({s0:x,s1:b,s2:S,s3:K})}this.t=A}_updateBlock(t,e,r,i){t^=this.s0,e^=this.s1,r^=this.s2,i^=this.s3;const{W:s,t:a,windowSize:o}=this;let c=0,h=0,u=0,f=0;const y=(1<<s)-1;let d=0;for(const g of[t,e,r,i])for(let p=0;p<4;p++){const A=g>>>8*p&255;for(let v=8/s-1;v>=0;v--){const w=A>>>s*v&y,{s0:x,s1:b,s2:S,s3:K}=a[d*o+w];c^=x,h^=b,u^=S,f^=K,d+=1}}this.s0=c,this.s1=h,this.s2=u,this.s3=f}update(t){t=sn(t),Wn(this);const e=pt(t),r=Math.floor(t.length/Ve),i=t.length%Ve;for(let s=0;s<r;s++)this._updateBlock(e[4*s+0],e[4*s+1],e[4*s+2],e[4*s+3]);return i&&(Ba.set(t.subarray(r*Ve)),this._updateBlock(Ke[0],Ke[1],Ke[2],Ke[3]),Mt(Ke)),this}destroy(){const{t}=this;for(const e of t)e.s0=0,e.s1=0,e.s2=0,e.s3=0}digestInto(t){Wn(this),M2(t,this),this.finished=!0;const{s0:e,s1:r,s2:i,s3:s}=this,a=pt(t);return a[0]=e,a[1]=r,a[2]=i,a[3]=s,t}digest(){const t=new Uint8Array(Ve);return this.digestInto(t),this.destroy(),t}}class l4 extends z2{constructor(t,e){const r=function(i){i.reverse();const s=1&i[15];let a=0;for(let o=0;o<i.length;o++){const c=i[o];i[o]=c>>>1|a,a=(1&c)<<7}return i[0]^=225&-s,i}(Xt(t=sn(t)));super(r,e),Mt(r)}update(t){t=sn(t),Wn(this);const e=pt(t),r=t.length%Ve,i=Math.floor(t.length/Ve);for(let s=0;s<i;s++)this._updateBlock(oe(e[4*s+3]),oe(e[4*s+2]),oe(e[4*s+1]),oe(e[4*s+0]));return r&&(Ba.set(t.subarray(i*Ve)),this._updateBlock(oe(Ke[3]),oe(Ke[2]),oe(Ke[1]),oe(Ke[0])),Mt(Ke)),this}digestInto(t){Wn(this),M2(t,this),this.finished=!0;const{s0:e,s1:r,s2:i,s3:s}=this,a=pt(t);return a[0]=e,a[1]=r,a[2]=i,a[3]=s,t.reverse()}}function O2(n){const t=(r,i)=>n(i,r.length).update(sn(r)).digest(),e=n(new Uint8Array(16),0);return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=(r,i)=>n(r,i),t}const v1=O2((n,t)=>new z2(n,t));O2((n,t)=>new l4(n,t));const Vt=16,En=new Uint8Array(Vt),y4=283;function ka(n){return n<<1^y4&-(n>>7)}function y0(n,t){let e=0;for(;t>0;t>>=1)e^=n&-(1&t),n=ka(n);return e}const Ys=(()=>{const n=new Uint8Array(256);for(let e=0,r=1;e<256;e++,r^=ka(r))n[e]=r;const t=new Uint8Array(256);t[0]=99;for(let e=0;e<255;e++){let r=n[255-e];r|=r<<8,t[n[e]]=255&(r^r>>4^r>>5^r>>6^r>>7^99)}return Mt(n),t})(),d4=Ys.map((n,t)=>Ys.indexOf(t)),p4=n=>n<<24|n>>>8,Ui=n=>n<<8|n>>>24,E1=n=>n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255;function G2(n,t){if(n.length!==256)throw Error("Wrong sbox length");const e=new Uint32Array(256).map((h,u)=>t(n[u])),r=e.map(Ui),i=r.map(Ui),s=i.map(Ui),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let h=0;h<256;h++)for(let u=0;u<256;u++){const f=256*h+u;a[f]=e[h]^r[u],o[f]=i[h]^s[u],c[f]=n[h]<<8|n[u]}return{sbox:n,sbox2:c,T0:e,T1:r,T2:i,T3:s,T01:a,T23:o}}const Ca=G2(Ys,n=>y0(n,3)<<24|n<<16|n<<8|y0(n,2)),q2=G2(d4,n=>y0(n,11)<<24|y0(n,13)<<16|y0(n,9)<<8|y0(n,14)),g4=(()=>{const n=new Uint8Array(16);for(let t=0,e=1;t<16;t++,e=ka(e))n[t]=e;return n})();function Xr(n){ht(n);const t=n.length;if(![16,24,32].includes(t))throw Error("aes: wrong key size: should be 16, 24 or 32, got: "+t);const{sbox2:e}=Ca,r=[];ue(n)||r.push(n=Xt(n));const i=pt(n),s=i.length,a=c=>Pe(e,c,c,c,c),o=new Uint32Array(t+28);o.set(i);for(let c=s;c<o.length;c++){let h=o[c-1];c%s==0?h=a(p4(h))^g4[c/s-1]:s>6&&c%s==4&&(h=a(h)),o[c]=o[c-s]^h}return Mt(...r),o}function Da(n){const t=Xr(n),e=t.slice(),r=t.length,{sbox2:i}=Ca,{T0:s,T1:a,T2:o,T3:c}=q2;for(let h=0;h<r;h+=4)for(let u=0;u<4;u++)e[h+u]=t[r-h-4+u];Mt(t);for(let h=4;h<r-4;h++){const u=e[h],f=Pe(i,u,u,u,u);e[h]=s[255&f]^a[f>>>8&255]^o[f>>>16&255]^c[f>>>24]}return e}function br(n,t,e,r,i,s){return n[e<<8&65280|r>>>8&255]^t[i>>>8&65280|s>>>24&255]}function Pe(n,t,e,r,i){return n[255&t|65280&e]|n[r>>>16&255|i>>>16&65280]<<16}function ve(n,t,e,r,i){const{sbox2:s,T01:a,T23:o}=Ca;let c=0;t^=n[c++],e^=n[c++],r^=n[c++],i^=n[c++];const h=n.length/4-2;for(let u=0;u<h;u++){const f=n[c++]^br(a,o,t,e,r,i),y=n[c++]^br(a,o,e,r,i,t),d=n[c++]^br(a,o,r,i,t,e),g=n[c++]^br(a,o,i,t,e,r);t=f,e=y,r=d,i=g}return{s0:n[c++]^Pe(s,t,e,r,i),s1:n[c++]^Pe(s,e,r,i,t),s2:n[c++]^Pe(s,r,i,t,e),s3:n[c++]^Pe(s,i,t,e,r)}}function fi(n,t,e,r,i){const{sbox2:s,T01:a,T23:o}=q2;let c=0;t^=n[c++],e^=n[c++],r^=n[c++],i^=n[c++];const h=n.length/4-2;for(let u=0;u<h;u++){const f=n[c++]^br(a,o,t,i,r,e),y=n[c++]^br(a,o,e,t,i,r),d=n[c++]^br(a,o,r,e,t,i),g=n[c++]^br(a,o,i,r,e,t);t=f,e=y,r=d,i=g}return{s0:n[c++]^Pe(s,t,i,r,e),s1:n[c++]^Pe(s,e,t,i,r),s2:n[c++]^Pe(s,r,e,t,i),s3:n[c++]^Pe(s,i,r,e,t)}}function an(n,t){if(t===void 0)return new Uint8Array(n);if(ht(t),t.length<n)throw Error(`aes: wrong destination length, expected at least ${n}, got: ${t.length}`);if(!ue(t))throw Error("unaligned dst");return t}function W2(n,t,e,r){ht(t,Vt),ht(e);const i=e.length;r=an(i,r);const s=t,a=pt(s);let{s0:o,s1:c,s2:h,s3:u}=ve(n,a[0],a[1],a[2],a[3]);const f=pt(e),y=pt(r);for(let g=0;g+4<=f.length;g+=4){y[g+0]=f[g+0]^o,y[g+1]=f[g+1]^c,y[g+2]=f[g+2]^h,y[g+3]=f[g+3]^u;let p=1;for(let A=s.length-1;A>=0;A--)p=p+(255&s[A])|0,s[A]=255&p,p>>>=8;({s0:o,s1:c,s2:h,s3:u}=ve(n,a[0],a[1],a[2],a[3]))}const d=Vt*Math.floor(f.length/4);if(d<i){const g=new Uint32Array([o,c,h,u]),p=Ea(g);for(let A=d,v=0;A<i;A++,v++)r[A]=e[A]^p[v];Mt(g)}return r}function G0(n,t,e,r,i){ht(e,Vt),ht(r),i=an(r.length,i);const s=e,a=pt(s),o=jn(s),c=pt(r),h=pt(i),u=t?0:12,f=r.length;let y=o.getUint32(u,t),{s0:d,s1:g,s2:p,s3:A}=ve(n,a[0],a[1],a[2],a[3]);for(let w=0;w+4<=c.length;w+=4)h[w+0]=c[w+0]^d,h[w+1]=c[w+1]^g,h[w+2]=c[w+2]^p,h[w+3]=c[w+3]^A,y=y+1>>>0,o.setUint32(u,y,t),{s0:d,s1:g,s2:p,s3:A}=ve(n,a[0],a[1],a[2],a[3]);const v=Vt*Math.floor(c.length/4);if(v<f){const w=new Uint32Array([d,g,p,A]),x=Ea(w);for(let b=v,S=0;b<f;b++,S++)i[b]=r[b]^x[S];Mt(w)}return i}const A4=pn({blockSize:16,nonceLength:16},function(n,t){function e(r,i){if(ht(r),i!==void 0&&(ht(i),!ue(i)))throw Error("unaligned destination");const s=Xr(n),a=Xt(t),o=[s,a];ue(r)||o.push(r=Xt(r));const c=W2(s,a,r,i);return Mt(...o),c}return ht(n),ht(t,Vt),{encrypt:(r,i)=>e(r,i),decrypt:(r,i)=>e(r,i)}}),j2=pn({blockSize:16,nonceLength:16},function(n,t,e={}){ht(n),ht(t,16);const r=!e.disablePadding;return{encrypt(i,s){const a=Xr(n),{b:o,o:c,out:h}=function(w,x,b){ht(w);let S=w.length;const K=S%Vt;if(!x&&K!==0)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");ue(w)||(w=Xt(w));const F=pt(w);if(x){let B=Vt-K;B||(B=Vt),S+=B}const k=an(S,b);return{b:F,o:pt(k),out:k}}(i,r,s);let u=t;const f=[a];ue(u)||f.push(u=Xt(u));const y=pt(u);let d=y[0],g=y[1],p=y[2],A=y[3],v=0;for(;v+4<=o.length;)d^=o[v+0],g^=o[v+1],p^=o[v+2],A^=o[v+3],{s0:d,s1:g,s2:p,s3:A}=ve(a,d,g,p,A),c[v++]=d,c[v++]=g,c[v++]=p,c[v++]=A;if(r){const w=function(x){const b=new Uint8Array(16),S=pt(b);b.set(x);const K=Vt-x.length;for(let F=Vt-K;F<Vt;F++)b[F]=K;return S}(i.subarray(4*v));d^=w[0],g^=w[1],p^=w[2],A^=w[3],{s0:d,s1:g,s2:p,s3:A}=ve(a,d,g,p,A),c[v++]=d,c[v++]=g,c[v++]=p,c[v++]=A}return Mt(...f),h},decrypt(i,s){(function(v){if(ht(v),v.length%Vt!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")})(i);const a=Da(n);let o=t;const c=[a];ue(o)||c.push(o=Xt(o));const h=pt(o),u=an(i.length,s);ue(i)||c.push(i=Xt(i));const f=pt(i),y=pt(u);let d=h[0],g=h[1],p=h[2],A=h[3];for(let v=0;v+4<=f.length;){const w=d,x=g,b=p,S=A;d=f[v+0],g=f[v+1],p=f[v+2],A=f[v+3];const{s0:K,s1:F,s2:k,s3:B}=fi(a,d,g,p,A);y[v++]=K^w,y[v++]=F^x,y[v++]=k^b,y[v++]=B^S}return Mt(...c),function(v,w){if(!w)return v;const x=v.length;if(!x)throw Error("aes/pcks5: empty ciphertext not allowed");const b=v[x-1];if(b<=0||b>16)throw Error("aes/pcks5: wrong padding");const S=v.subarray(0,-b);for(let K=0;K<b;K++)if(v[x-K-1]!==b)throw Error("aes/pcks5: wrong padding");return S}(u,r)}}}),V2=pn({blockSize:16,nonceLength:16},function(n,t){function e(r,i,s){ht(r);const a=r.length;s=an(a,s);const o=Xr(n);let c=t;const h=[o];ue(c)||h.push(c=Xt(c)),ue(r)||h.push(r=Xt(r));const u=pt(r),f=pt(s),y=i?f:u,d=pt(c);let g=d[0],p=d[1],A=d[2],v=d[3];for(let x=0;x+4<=u.length;){const{s0:b,s1:S,s2:K,s3:F}=ve(o,g,p,A,v);f[x+0]=u[x+0]^b,f[x+1]=u[x+1]^S,f[x+2]=u[x+2]^K,f[x+3]=u[x+3]^F,g=y[x++],p=y[x++],A=y[x++],v=y[x++]}const w=Vt*Math.floor(u.length/4);if(w<a){({s0:g,s1:p,s2:A,s3:v}=ve(o,g,p,A,v));const x=Ea(new Uint32Array([g,p,A,v]));for(let b=w,S=0;b<a;b++,S++)s[b]=r[b]^x[S];Mt(x)}return Mt(...h),s}return ht(n),ht(t,16),{encrypt:(r,i)=>e(r,!0,i),decrypt:(r,i)=>e(r,!1,i)}}),Bn=pn({blockSize:16,nonceLength:12,tagLength:16},function(n,t,e){if(ht(n),ht(t),e!==void 0&&ht(e),t.length<8)throw Error("aes/gcm: invalid nonce length");const r=16;function i(a,o,c){const h=function(u,f,y,d,g){const p=g==null?0:g.length,A=u.create(y,d.length+p);g&&A.update(g),A.update(d);const v=new Uint8Array(16),w=jn(v);g&&Pi(w,0,BigInt(8*p),f),Pi(w,8,BigInt(8*d.length),f),A.update(v);const x=A.digest();return Mt(v),x}(v1,!1,a,c,e);for(let u=0;u<o.length;u++)h[u]^=o[u];return h}function s(){const a=Xr(n),o=En.slice(),c=En.slice();if(G0(a,!1,c,c,o),t.length===12)c.set(t);else{const h=En.slice();Pi(jn(h),8,BigInt(8*t.length),!1);const u=v1.create(o).update(t).update(h);u.digestInto(c),u.destroy()}return{xk:a,authKey:o,counter:c,tagMask:G0(a,!1,c,En)}}return{encrypt(a){ht(a);const{xk:o,authKey:c,counter:h,tagMask:u}=s(),f=new Uint8Array(a.length+r),y=[o,c,h,u];ue(a)||y.push(a=Xt(a)),G0(o,!1,h,a,f);const d=i(c,u,f.subarray(0,f.length-r));return y.push(d),f.set(d,a.length),Mt(...y),f},decrypt(a){if(ht(a),a.length<r)throw Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:o,authKey:c,counter:h,tagMask:u}=s(),f=[o,c,u,h];ue(a)||f.push(a=Xt(a));const y=a.subarray(0,-16),d=a.subarray(-16),g=i(c,u,y);if(f.push(g),!N2(g,d))throw Error("aes/gcm: invalid ghash tag");const p=G0(o,!1,h,y);return Mt(...f),p}}});function Y2(n){return n!=null&&typeof n=="object"&&(n instanceof Uint32Array||n.constructor.name==="Uint32Array")}function Z2(n,t){if(ht(t,16),!Y2(n))throw Error("_encryptBlock accepts result of expandKeyLE");const e=pt(t);let{s0:r,s1:i,s2:s,s3:a}=ve(n,e[0],e[1],e[2],e[3]);return e[0]=r,e[1]=i,e[2]=s,e[3]=a,t}function X2(n,t){if(ht(t,16),!Y2(n))throw Error("_decryptBlock accepts result of expandKeyLE");const e=pt(t);let{s0:r,s1:i,s2:s,s3:a}=fi(n,e[0],e[1],e[2],e[3]);return e[0]=r,e[1]=i,e[2]=s,e[3]=a,t}const B1={encrypt(n,t){if(t.length>=2**32)throw Error("plaintext should be less than 4gb");const e=Xr(n);if(t.length===16)Z2(e,t);else{const r=pt(t);let i=r[0],s=r[1];for(let a=0,o=1;a<6;a++)for(let c=2;c<r.length;c+=2,o++){const{s0:h,s1:u,s2:f,s3:y}=ve(e,i,s,r[c],r[c+1]);i=h,s=u^E1(o),r[c]=f,r[c+1]=y}r[0]=i,r[1]=s}e.fill(0)},decrypt(n,t){if(t.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const e=Da(n),r=t.length/8-1;if(r===1)X2(e,t);else{const i=pt(t);let s=i[0],a=i[1];for(let o=0,c=6*r;o<6;o++)for(let h=2*r;h>=1;h-=2,c--){a^=E1(c);const{s0:u,s1:f,s2:y,s3:d}=fi(e,s,a,i[h],i[h+1]);s=u,a=f,i[h]=y,i[h+1]=d}i[0]=s,i[1]=a}e.fill(0)}},k1=new Uint8Array(8).fill(166),$2=pn({blockSize:8},n=>({encrypt(t){if(ht(t),!t.length||t.length%8!=0)throw Error("invalid plaintext length");if(t.length===8)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const e=function(...r){let i=0;for(let a=0;a<r.length;a++){const o=r[a];ht(o),i+=o.length}const s=new Uint8Array(i);for(let a=0,o=0;a<r.length;a++){const c=r[a];s.set(c,o),o+=c.length}return s}(k1,t);return B1.encrypt(n,e),e},decrypt(t){if(ht(t),t.length%8!=0||t.length<24)throw Error("invalid ciphertext length");const e=Xt(t);if(B1.decrypt(n,e),!N2(e.subarray(0,8),k1))throw Error("integrity check failed");return e.subarray(0,8).fill(0),e.subarray(8)}})),C1={expandKeyLE:Xr,expandKeyDecLE:Da,encrypt:ve,decrypt:fi,encryptBlock:Z2,decryptBlock:X2,ctrCounter:W2,ctr32:G0};async function J2(n){switch(n){case l.symmetric.aes128:case l.symmetric.aes192:case l.symmetric.aes256:throw Error("Not a legacy cipher");case l.symmetric.cast5:case l.symmetric.blowfish:case l.symmetric.twofish:case l.symmetric.tripledes:{const{legacyCiphers:t}=await Promise.resolve().then(function(){return Q5}),e=l.read(l.symmetric,n),r=t.get(e);if(!r)throw Error("Unsupported cipher algorithm");return r}default:throw Error("Unsupported cipher algorithm")}}function x4(n){switch(n){case l.symmetric.aes128:case l.symmetric.aes192:case l.symmetric.aes256:case l.symmetric.twofish:return 16;case l.symmetric.blowfish:case l.symmetric.cast5:case l.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function w4(n){switch(n){case l.symmetric.aes128:case l.symmetric.blowfish:case l.symmetric.cast5:return 16;case l.symmetric.aes192:case l.symmetric.tripledes:return 24;case l.symmetric.aes256:case l.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function lt(n){return{keySize:w4(n),blockSize:x4(n)}}const w0=m.getWebCrypto();async function Zs(n,t,e){const{keySize:r}=lt(n);if(!m.isAES(n)||t.length!==r)throw Error("Unexpected algorithm or key size");try{const i=await w0.importKey("raw",t,{name:"AES-KW"},!1,["wrapKey"]),s=await w0.importKey("raw",e,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),a=await w0.wrapKey("raw",s,i,{name:"AES-KW"});return new Uint8Array(a)}catch(i){if(i.name!=="NotSupportedError"&&(t.length!==24||i.name!=="OperationError"))throw i;m.printDebugError("Browser did not support operation: "+i.message)}return $2(t).encrypt(e)}async function Xs(n,t,e){const{keySize:r}=lt(n);if(!m.isAES(n)||t.length!==r)throw Error("Unexpected algorithm or key size");let i;try{i=await w0.importKey("raw",t,{name:"AES-KW"},!1,["unwrapKey"])}catch(s){if(s.name!=="NotSupportedError"&&(t.length!==24||s.name!=="OperationError"))throw s;return m.printDebugError("Browser did not support operation: "+s.message),$2(t).decrypt(e)}try{const s=await w0.unwrapKey("raw",e,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await w0.exportKey("raw",s))}catch(s){throw s.name==="OperationError"?Error("Key Data Integrity failed"):s}}const D1=m.getWebCrypto();async function Dr(n,t,e,r,i){const s=l.read(l.webHash,n);if(!s)throw Error("Hash algo not supported with HKDF");const a=await D1.importKey("raw",t,"HKDF",!1,["deriveBits"]),o=await D1.deriveBits({name:"HKDF",hash:s,salt:e,info:r},a,8*i);return new Uint8Array(o)}const Vn={x25519:m.encodeUTF8("OpenPGP X25519"),x448:m.encodeUTF8("OpenPGP X448")};async function Sa(n){switch(n){case l.publicKey.x25519:{const t=Pt(32),{publicKey:e}=xt.box.keyPair.fromSecretKey(t);return{A:e,k:t}}case l.publicKey.x448:{const t=await m.getNobleCurve(l.publicKey.x448),e=t.utils.randomPrivateKey();return{A:t.getPublicKey(e),k:e}}default:throw Error("Unsupported ECDH algorithm")}}async function tc(n,t,e){switch(n){case l.publicKey.x25519:{const{publicKey:r}=xt.box.keyPair.fromSecretKey(e);return m.equalsUint8Array(t,r)}case l.publicKey.x448:{const r=(await m.getNobleCurve(l.publicKey.x448)).getPublicKey(e);return m.equalsUint8Array(t,r)}default:return!1}}async function ec(n,t,e){const{ephemeralPublicKey:r,sharedSecret:i}=await Ka(n,e),s=m.concatUint8Array([r,e,i]);switch(n){case l.publicKey.x25519:{const a=l.symmetric.aes128,{keySize:o}=lt(a),c=await Dr(l.hash.sha256,s,new Uint8Array,Vn.x25519,o);return{ephemeralPublicKey:r,wrappedKey:await Zs(a,c,t)}}case l.publicKey.x448:{const a=l.symmetric.aes256,{keySize:o}=lt(l.symmetric.aes256),c=await Dr(l.hash.sha512,s,new Uint8Array,Vn.x448,o);return{ephemeralPublicKey:r,wrappedKey:await Zs(a,c,t)}}default:throw Error("Unsupported ECDH algorithm")}}async function rc(n,t,e,r,i){const s=await Fa(n,t,r,i),a=m.concatUint8Array([t,r,s]);switch(n){case l.publicKey.x25519:{const o=l.symmetric.aes128,{keySize:c}=lt(o);return Xs(o,await Dr(l.hash.sha256,a,new Uint8Array,Vn.x25519,c),e)}case l.publicKey.x448:{const o=l.symmetric.aes256,{keySize:c}=lt(l.symmetric.aes256);return Xs(o,await Dr(l.hash.sha512,a,new Uint8Array,Vn.x448,c),e)}default:throw Error("Unsupported ECDH algorithm")}}function Ia(n){switch(n){case l.publicKey.x25519:return 32;case l.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function Ka(n,t){switch(n){case l.publicKey.x25519:{const e=Pt(Ia(n)),r=xt.scalarMult(e,t);Yn(r);const{publicKey:i}=xt.box.keyPair.fromSecretKey(e);return{ephemeralPublicKey:i,sharedSecret:r}}case l.publicKey.x448:{const e=await m.getNobleCurve(l.publicKey.x448),r=e.utils.randomPrivateKey(),i=e.getSharedSecret(r,t);return Yn(i),{ephemeralPublicKey:e.getPublicKey(r),sharedSecret:i}}default:throw Error("Unsupported ECDH algorithm")}}async function Fa(n,t,e,r){switch(n){case l.publicKey.x25519:{const i=xt.scalarMult(r,t);return Yn(i),i}case l.publicKey.x448:{const i=(await m.getNobleCurve(l.publicKey.x448)).getSharedSecret(r,t);return Yn(i),i}default:throw Error("Unsupported ECDH algorithm")}}function Yn(n){let t=0;for(let e=0;e<n.length;e++)t|=n[e];if(t===0)throw Error("Unexpected low order point")}var b4=Object.freeze({__proto__:null,decrypt:rc,encrypt:ec,generate:Sa,generateEphemeralEncryptionMaterial:Ka,getPayloadSize:Ia,recomputeSharedSecret:Fa,validateParams:tc});const Ri=m.getWebCrypto(),Zn=m.getNodeCrypto(),Re={[l.curve.nistP256]:"P-256",[l.curve.nistP384]:"P-384",[l.curve.nistP521]:"P-521"},ze=Zn?Zn.getCurves():[],Se=Zn?{[l.curve.secp256k1]:ze.includes("secp256k1")?"secp256k1":void 0,[l.curve.nistP256]:ze.includes("prime256v1")?"prime256v1":void 0,[l.curve.nistP384]:ze.includes("secp384r1")?"secp384r1":void 0,[l.curve.nistP521]:ze.includes("secp521r1")?"secp521r1":void 0,[l.curve.ed25519Legacy]:ze.includes("ED25519")?"ED25519":void 0,[l.curve.curve25519Legacy]:ze.includes("X25519")?"X25519":void 0,[l.curve.brainpoolP256r1]:ze.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[l.curve.brainpoolP384r1]:ze.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[l.curve.brainpoolP512r1]:ze.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},nc={[l.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:Se[l.curve.nistP256],web:Re[l.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[l.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:l.publicKey.ecdsa,hash:l.hash.sha384,cipher:l.symmetric.aes192,node:Se[l.curve.nistP384],web:Re[l.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[l.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:l.publicKey.ecdsa,hash:l.hash.sha512,cipher:l.symmetric.aes256,node:Se[l.curve.nistP521],web:Re[l.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[l.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:Se[l.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[l.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:l.publicKey.eddsaLegacy,hash:l.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[l.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:l.publicKey.ecdh,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[l.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:Se[l.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[l.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:l.publicKey.ecdsa,hash:l.hash.sha384,cipher:l.symmetric.aes192,node:Se[l.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[l.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:l.publicKey.ecdsa,hash:l.hash.sha512,cipher:l.symmetric.aes256,node:Se[l.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class le{constructor(t){try{this.name=t instanceof $e?t.getName():l.write(l.curve,t)}catch{throw new ft("Unknown curve")}const e=nc[this.name];this.keyType=e.keyType,this.oid=e.oid,this.hash=e.hash,this.cipher=e.cipher,this.node=e.node,this.web=e.web,this.payloadSize=e.payloadSize,this.sharedSize=e.sharedSize,this.wireFormatLeadingByte=e.wireFormatLeadingByte,this.web&&m.getWebCrypto()?this.type="web":this.node&&m.getNodeCrypto()?this.type="node":this.name===l.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===l.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(t,e){const r=await Ri.generateKey({name:"ECDSA",namedCurve:Re[t]},!0,["sign","verify"]),i=await Ri.exportKey("jwk",r.privateKey);return{publicKey:ac(await Ri.exportKey("jwk",r.publicKey),e),privateKey:me(i.d)}}(this.name,this.wireFormatLeadingByte)}catch(t){return m.printDebugError("Browser did not support generating ec key "+t.message),S1(this.name)}case"node":return async function(t){const e=Zn.createECDH(Se[t]);return await e.generateKeys(),{publicKey:new Uint8Array(e.getPublicKey()),privateKey:new Uint8Array(e.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:t,A:e}=await Sa(l.publicKey.x25519),r=t.slice().reverse();return r[0]=127&r[0]|64,r[31]&=248,{publicKey:m.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),e]),privateKey:r}}case"ed25519Legacy":{const{seed:t,A:e}=await ba(l.publicKey.ed25519);return{publicKey:m.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),e]),privateKey:t}}default:return S1(this.name)}}}async function Qn(n){const t=new le(n),{oid:e,hash:r,cipher:i}=t,s=await t.genKeyPair();return{oid:e,Q:s.publicKey,secret:m.leftPad(s.privateKey,t.payloadSize),hash:r,cipher:i}}function ic(n){return nc[n.getName()].hash}async function sc(n,t,e,r){const i={[l.curve.nistP256]:!0,[l.curve.nistP384]:!0,[l.curve.nistP521]:!0,[l.curve.secp256k1]:!0,[l.curve.curve25519Legacy]:n===l.publicKey.ecdh,[l.curve.brainpoolP256r1]:!0,[l.curve.brainpoolP384r1]:!0,[l.curve.brainpoolP512r1]:!0},s=t.getName();if(!i[s])return!1;if(s===l.curve.curve25519Legacy){r=r.slice().reverse();const{publicKey:o}=xt.box.keyPair.fromSecretKey(r);e=new Uint8Array(e);const c=new Uint8Array([64,...o]);return!!m.equalsUint8Array(c,e)}const a=(await m.getNobleCurve(l.publicKey.ecdsa,s)).getPublicKey(r,!1);return!!m.equalsUint8Array(a,e)}function Wr(n,t){const{payloadSize:e,wireFormatLeadingByte:r,name:i}=n,s=i===l.curve.curve25519Legacy||i===l.curve.ed25519Legacy?e:2*e;if(t[0]!==r||t.length!==s+1)throw Error("Invalid point encoding")}async function S1(n){const t=await m.getNobleCurve(l.publicKey.ecdsa,n),e=t.utils.randomPrivateKey();return{publicKey:t.getPublicKey(e,!1),privateKey:e}}function ac(n,t){const e=me(n.x),r=me(n.y),i=new Uint8Array(e.length+r.length+1);return i[0]=t,i.set(e,1),i.set(r,e.length+1),i}function li(n,t,e){const r=n,i=e.slice(1,r+1),s=e.slice(r+1,2*r+1);return{kty:"EC",crv:t,x:Ot(i),y:Ot(s),ext:!0}}function oc(n,t,e,r){const i=li(n,t,e);return i.d=Ot(r),i}const Xn=m.getWebCrypto(),cc=m.getNodeCrypto();async function $s(n,t,e,r,i,s){const a=new le(n);if(Wr(a,r),e&&!m.isStream(e)){const c={publicKey:r,privateKey:i};switch(a.type){case"web":try{return await async function(h,u,f,y){const d=h.payloadSize,g=oc(h.payloadSize,Re[h.name],y.publicKey,y.privateKey),p=await Xn.importKey("jwk",g,{name:"ECDSA",namedCurve:Re[h.name],hash:{name:l.read(l.webHash,h.hash)}},!1,["sign"]),A=new Uint8Array(await Xn.sign({name:"ECDSA",namedCurve:Re[h.name],hash:{name:l.read(l.webHash,u)}},p,f));return{r:A.slice(0,d),s:A.slice(d,d<<1)}}(a,t,e,c)}catch(h){if(a.name!=="nistP521"&&(h.name==="DataError"||h.name==="OperationError"))throw h;m.printDebugError("Browser did not support signing: "+h.message)}break;case"node":return async function(h,u,f,y){const d=m.nodeRequire("eckey-utils"),g=m.getNodeBuffer(),{privateKey:p}=d.generateDer({curveName:Se[h.name],privateKey:g.from(y)}),A=cc.createSign(l.read(l.hash,u));A.write(f),A.end();const v=new Uint8Array(A.sign({key:p,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),w=h.payloadSize;return{r:v.subarray(0,w),s:v.subarray(w,w<<1)}}(a,t,e,i)}}const o=(await m.getNobleCurve(l.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:Et(o.r,"be",a.payloadSize),s:Et(o.s,"be",a.payloadSize)}}async function Js(n,t,e,r,i,s){const a=new le(n);Wr(a,i);const o=async()=>s[0]===0&&I1(a,e,s.subarray(1),i);if(r&&!m.isStream(r))switch(a.type){case"web":try{return await async function(h,u,{r:f,s:y},d,g){const p=li(h.payloadSize,Re[h.name],g),A=await Xn.importKey("jwk",p,{name:"ECDSA",namedCurve:Re[h.name],hash:{name:l.read(l.webHash,h.hash)}},!1,["verify"]),v=m.concatUint8Array([f,y]).buffer;return Xn.verify({name:"ECDSA",namedCurve:Re[h.name],hash:{name:l.read(l.webHash,u)}},A,v,d)}(a,t,e,r,i)||o()}catch(c){if(a.name!=="nistP521"&&(c.name==="DataError"||c.name==="OperationError"))throw c;m.printDebugError("Browser did not support verifying: "+c.message)}break;case"node":return await async function(h,u,{r:f,s:y},d,g){const p=m.nodeRequire("eckey-utils"),A=m.getNodeBuffer(),{publicKey:v}=p.generateDer({curveName:Se[h.name],publicKey:A.from(g)}),w=cc.createVerify(l.read(l.hash,u));w.write(d),w.end();const x=m.concatUint8Array([f,y]);try{return w.verify({key:v,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},x)}catch{return!1}}(a,t,e,r,i)||o()}return await I1(a,e,s,i)||o()}async function I1(n,t,e,r){return(await m.getNobleCurve(l.publicKey.ecdsa,n.name)).verify(m.concatUint8Array([t.r,t.s]),e,r,{lowS:!1})}var m4=Object.freeze({__proto__:null,sign:$s,validateParams:async function(n,t,e){const r=new le(n);if(r.keyType!==l.publicKey.ecdsa)return!1;switch(r.type){case"web":case"node":{const i=Pt(8),s=l.hash.sha256,a=await Te(s,i);try{const o=await $s(n,s,i,t,e,a);return await Js(n,s,o,i,t,a)}catch{return!1}}default:return sc(l.publicKey.ecdsa,n,t,e)}},verify:Js});async function hc(n,t,e,r,i,s){if(Wr(new le(n),r),Ct(t)<Ct(l.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await ma(l.publicKey.ed25519,t,0,r.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}}async function uc(n,t,{r:e,s:r},i,s,a){if(Wr(new le(n),s),Ct(t)<Ct(l.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=m.concatUint8Array([e,r]);return va(l.publicKey.ed25519,t,{RS:o},0,s.subarray(1),a)}async function fc(n,t,e){if(n.getName()!==l.curve.ed25519Legacy)return!1;const{publicKey:r}=xt.sign.keyPair.fromSeed(e),i=new Uint8Array([64,...r]);return m.equalsUint8Array(t,i)}var v4=Object.freeze({__proto__:null,sign:hc,validateParams:fc,verify:uc});function E4(n){const t=n.length;if(t>0){const e=n[t-1];if(e>=1){const r=n.subarray(t-e),i=new Uint8Array(e).fill(e);if(m.equalsUint8Array(r,i))return n.subarray(0,t-e)}}throw Error("Invalid padding")}const mr=m.getWebCrypto(),lc=m.getNodeCrypto();function yc(n,t,e,r){return m.concatUint8Array([t.write(),new Uint8Array([n]),e.write(),m.stringToUint8Array("Anonymous Sender    "),r])}async function dc(n,t,e,r,i=!1,s=!1){let a;if(i){for(a=0;a<t.length&&t[a]===0;a++);t=t.subarray(a)}if(s){for(a=t.length-1;a>=0&&t[a]===0;a--);t=t.subarray(0,a+1)}return(await Te(n,m.concatUint8Array([new Uint8Array([0,0,0,1]),t,r]))).subarray(0,e)}async function B4(n,t){switch(n.type){case"curve25519Legacy":{const{sharedSecret:e,ephemeralPublicKey:r}=await Ka(l.publicKey.x25519,t.subarray(1));return{publicKey:m.concatUint8Array([new Uint8Array([n.wireFormatLeadingByte]),r]),sharedKey:e}}case"web":if(n.web&&m.getWebCrypto())try{return await async function(e,r){const i=li(e.payloadSize,e.web,r);let s=mr.generateKey({name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]),a=mr.importKey("jwk",i,{name:"ECDH",namedCurve:e.web},!1,[]);[s,a]=await Promise.all([s,a]);let o=mr.deriveBits({name:"ECDH",namedCurve:e.web,public:a},s.privateKey,e.sharedSize),c=mr.exportKey("jwk",s.publicKey);[o,c]=await Promise.all([o,c]);const h=new Uint8Array(o);return{publicKey:new Uint8Array(ac(c,e.wireFormatLeadingByte)),sharedKey:h}}(n,t)}catch(e){return m.printDebugError(e),F1(n,t)}break;case"node":return async function(e,r){const i=lc.createECDH(e.node);i.generateKeys();const s=new Uint8Array(i.computeSecret(r));return{publicKey:new Uint8Array(i.getPublicKey()),sharedKey:s}}(n,t);default:return F1(n,t)}}async function pc(n,t,e,r,i){const s=function(y){const d=8-y.length%8,g=new Uint8Array(y.length+d).fill(d);return g.set(y),g}(e),a=new le(n);Wr(a,r);const{publicKey:o,sharedKey:c}=await B4(a,r),h=yc(l.publicKey.ecdh,n,t,i),{keySize:u}=lt(t.cipher),f=await dc(t.hash,c,u,h);return{publicKey:o,wrappedKey:await Zs(t.cipher,f,s)}}async function k4(n,t,e,r){if(r.length!==n.payloadSize){const i=new Uint8Array(n.payloadSize);i.set(r,n.payloadSize-r.length),r=i}switch(n.type){case"curve25519Legacy":{const i=r.slice().reverse();return{secretKey:i,sharedKey:await Fa(l.publicKey.x25519,t.subarray(1),e.subarray(1),i)}}case"web":if(n.web&&m.getWebCrypto())try{return await async function(i,s,a,o){const c=oc(i.payloadSize,i.web,a,o);let h=mr.importKey("jwk",c,{name:"ECDH",namedCurve:i.web},!0,["deriveKey","deriveBits"]);const u=li(i.payloadSize,i.web,s);let f=mr.importKey("jwk",u,{name:"ECDH",namedCurve:i.web},!0,[]);[h,f]=await Promise.all([h,f]);let y=mr.deriveBits({name:"ECDH",namedCurve:i.web,public:f},h,i.sharedSize),d=mr.exportKey("jwk",h);[y,d]=await Promise.all([y,d]);const g=new Uint8Array(y);return{secretKey:me(d.d),sharedKey:g}}(n,t,e,r)}catch(i){return m.printDebugError(i),K1(n,t,r)}break;case"node":return async function(i,s,a){const o=lc.createECDH(i.node);o.setPrivateKey(a);const c=new Uint8Array(o.computeSecret(s));return{secretKey:new Uint8Array(o.getPrivateKey()),sharedKey:c}}(n,t,r);default:return K1(n,t,r)}}async function gc(n,t,e,r,i,s,a){const o=new le(n);Wr(o,i),Wr(o,e);const{sharedKey:c}=await k4(o,e,i,s),h=yc(l.publicKey.ecdh,n,t,a),{keySize:u}=lt(t.cipher);let f;for(let y=0;y<3;y++)try{const d=await dc(t.hash,c,u,h,y===1,y===2);return E4(await Xs(t.cipher,d,r))}catch(d){f=d}throw f}async function K1(n,t,e){return{secretKey:e,sharedKey:(await m.getNobleCurve(l.publicKey.ecdh,n.name)).getSharedSecret(e,t).subarray(1)}}async function F1(n,t){const e=await m.getNobleCurve(l.publicKey.ecdh,n.name),{publicKey:r,privateKey:i}=await n.genKeyPair();return{publicKey:r,sharedKey:e.getSharedSecret(i,t).subarray(1)}}var C4=Object.freeze({__proto__:null,CurveWithOID:le,ecdh:Object.freeze({__proto__:null,decrypt:gc,encrypt:pc,validateParams:async function(n,t,e){return sc(l.publicKey.ecdh,n,t,e)}}),ecdhX:b4,ecdsa:m4,eddsa:f4,eddsaLegacy:v4,generate:Qn,getPreferredHashAlgo:ic});const _n=BigInt(0),q0=BigInt(1);class Ac{constructor(t){t&&(this.data=t)}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.data=t.subarray(1,1+e),1+this.data.length}throw Error("Invalid symmetric key")}write(){return m.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class xc{constructor(t){if(t){const{hash:e,cipher:r}=t;this.hash=e,this.cipher=r}else this.hash=null,this.cipher=null}read(t){if(t.length<4||t[0]!==3||t[1]!==1)throw new ft("Cannot read KDFParams");return this.hash=t[2],this.cipher=t[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class yi{static fromObject({wrappedKey:t,algorithm:e}){const r=new yi;return r.wrappedKey=t,r.algorithm=e,r}read(t){let e=0,r=t[e++];this.algorithm=r%2?t[e++]:null,r-=r%2,this.wrappedKey=m.readExactSubarray(t,e,e+r),e+=r}write(){return m.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}async function D4(n,t,e,r,i){switch(n){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:{const{n:s,e:a}=e;return{c:await t4(r,s,a)}}case l.publicKey.elgamal:{const{p:s,g:a,y:o}=e;return async function(c,h,u,f){h=Y(h),u=Y(u),f=Y(f);const y=Y(B2(c,te(h))),d=Br(Ar,h-Ar);return{c1:Et(Ft(u,d,h)),c2:Et(rt(Ft(f,d,h)*y,h))}}(r,s,a,o)}case l.publicKey.ecdh:{const{oid:s,Q:a,kdfParams:o}=e,{publicKey:c,wrappedKey:h}=await pc(s,o,r,a,i);return{V:c,C:new Ac(h)}}case l.publicKey.x25519:case l.publicKey.x448:{if(t&&!m.isAES(t))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:s}=e,{ephemeralPublicKey:a,wrappedKey:o}=await ec(n,r,s);return{ephemeralPublicKey:a,C:yi.fromObject({algorithm:t,wrappedKey:o})}}default:return[]}}async function S4(n,t,e,r,i,s){switch(n){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:{const{c:a}=r,{n:o,e:c}=t,{d:h,p:u,q:f,u:y}=e;return e4(a,o,c,h,u,f,y,s)}case l.publicKey.elgamal:{const{c1:a,c2:o}=r;return async function(c,h,u,f,y){return c=Y(c),h=Y(h),u=Y(u),k2(Et(rt(m0(Ft(c,f=Y(f),u),u)*h,u),"be",te(u)),y)}(a,o,t.p,e.x,s)}case l.publicKey.ecdh:{const{oid:a,Q:o,kdfParams:c}=t,{d:h}=e,{V:u,C:f}=r;return gc(a,c,u,f.data,o,h,i)}case l.publicKey.x25519:case l.publicKey.x448:{const{A:a}=t,{k:o}=e,{ephemeralPublicKey:c,C:h}=r;if(h.algorithm!==null&&!m.isAES(h.algorithm))throw Error("AES session key expected");return rc(n,c,h.wrappedKey,a,o)}default:throw Error("Unknown public key encryption algorithm.")}}function P1(n,t,e){let r=0;switch(n){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const i=m.readMPI(t.subarray(r));r+=i.length+2;const s=m.readMPI(t.subarray(r));r+=s.length+2;const a=m.readMPI(t.subarray(r));r+=a.length+2;const o=m.readMPI(t.subarray(r));return r+=o.length+2,{read:r,privateParams:{d:i,p:s,q:a,u:o}}}case l.publicKey.dsa:case l.publicKey.elgamal:{const i=m.readMPI(t.subarray(r));return r+=i.length+2,{read:r,privateParams:{x:i}}}case l.publicKey.ecdsa:case l.publicKey.ecdh:{const i=d0(n,e.oid);let s=m.readMPI(t.subarray(r));return r+=s.length+2,s=m.leftPad(s,i),{read:r,privateParams:{d:s}}}case l.publicKey.eddsaLegacy:{const i=d0(n,e.oid);if(e.oid.getName()!==l.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=m.readMPI(t.subarray(r));return r+=s.length+2,s=m.leftPad(s,i),{read:r,privateParams:{seed:s}}}case l.publicKey.ed25519:case l.publicKey.ed448:{const i=d0(n),s=m.readExactSubarray(t,r,r+i);return r+=s.length,{read:r,privateParams:{seed:s}}}case l.publicKey.x25519:case l.publicKey.x448:{const i=d0(n),s=m.readExactSubarray(t,r,r+i);return r+=s.length,{read:r,privateParams:{k:s}}}default:throw new ft("Unknown public key encryption algorithm.")}}function E0(n,t){const e=new Set([l.publicKey.ed25519,l.publicKey.x25519,l.publicKey.ed448,l.publicKey.x448]),r=Object.keys(t).map(i=>{const s=t[i];return m.isUint8Array(s)?e.has(n)?s:m.uint8ArrayToMPI(s):s.write()});return m.concatUint8Array(r)}function I4(n,t,e){switch(n){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:return async function(r,i){if(i=BigInt(i),m.getWebCrypto()){const h={name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:Et(i),hash:{name:"SHA-1"}},u=await v0.generateKey(h,!0,["sign","verify"]);return f1(await v0.exportKey("jwk",u.privateKey),i)}if(m.getNodeCrypto()){const h={modulusLength:r,publicExponent:Ms(i),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},u=await new Promise((f,y)=>{qr.generateKeyPair("rsa",h,(d,g,p)=>{d?y(d):f(p)})});return f1(u,i)}let s,a,o;do a=h1(r-(r>>1),i,40),s=h1(r>>1,i,40),o=s*a;while(x0(o)!==r);const c=(s-Cr)*(a-Cr);return a<s&&([s,a]=[a,s]),{n:Et(o),e:Et(i),d:Et(m0(i,c)),p:Et(s),q:Et(a),u:Et(m0(s,a))}}(t,65537).then(({n:r,e:i,d:s,p:a,q:o,u:c})=>({privateParams:{d:s,p:a,q:o,u:c},publicParams:{n:r,e:i}}));case l.publicKey.ecdsa:return Qn(e).then(({oid:r,Q:i,secret:s})=>({privateParams:{d:s},publicParams:{oid:new $e(r),Q:i}}));case l.publicKey.eddsaLegacy:return Qn(e).then(({oid:r,Q:i,secret:s})=>({privateParams:{seed:s},publicParams:{oid:new $e(r),Q:i}}));case l.publicKey.ecdh:return Qn(e).then(({oid:r,Q:i,secret:s,hash:a,cipher:o})=>({privateParams:{d:s},publicParams:{oid:new $e(r),Q:i,kdfParams:new xc({hash:a,cipher:o})}}));case l.publicKey.ed25519:case l.publicKey.ed448:return ba(n).then(({A:r,seed:i})=>({privateParams:{seed:i},publicParams:{A:r}}));case l.publicKey.x25519:case l.publicKey.x448:return Sa(n).then(({A:r,k:i})=>({privateParams:{k:i},publicParams:{A:r}}));case l.publicKey.dsa:case l.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}}async function K4(n,t,e){if(!t||!e)throw Error("Missing key parameters");switch(n){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const{n:r,e:i}=t,{d:s,p:a,q:o,u:c}=e;return async function(h,u,f,y,d,g){if(h=Y(h),(y=Y(y))*(d=Y(d))!==h)return!1;const p=BigInt(2);if(rt(y*(g=Y(g)),d)!==BigInt(1))return!1;u=Y(u),f=Y(f);const A=Br(p,p<<BigInt(Math.floor(x0(h)/3))),v=A*f*u;return!(rt(v,y-Cr)!==A||rt(v,d-Cr)!==A)}(r,i,s,a,o,c)}case l.publicKey.dsa:{const{p:r,q:i,g:s,y:a}=t,{x:o}=e;return async function(c,h,u,f,y){if(c=Y(c),h=Y(h),u=Y(u),f=Y(f),u<=q0||u>=c||rt(c-q0,h)!==_n||Ft(u,h,c)!==q0)return!1;const d=BigInt(x0(h));if(d<BigInt(150)||!E2(h,null,32))return!1;y=Y(y);const g=BigInt(2);return f===Ft(u,h*Br(g<<d-q0,g<<d)+y,c)}(r,i,s,a,o)}case l.publicKey.elgamal:{const{p:r,g:i,y:s}=t,{x:a}=e;return async function(o,c,h,u){if(o=Y(o),c=Y(c),h=Y(h),c<=Ar||c>=o)return!1;const f=BigInt(x0(o));if(f<BigInt(1023)||Ft(c,o-Ar,o)!==Ar)return!1;let y=c,d=BigInt(1);const g=BigInt(2),p=g<<BigInt(17);for(;d<p;){if(y=rt(y*c,o),y===Ar)return!1;d++}u=Y(u);const A=Br(g<<f-Ar,g<<f);return h===Ft(c,(o-Ar)*A+u,o)}(r,i,s,a)}case l.publicKey.ecdsa:case l.publicKey.ecdh:{const r=C4[l.read(l.publicKey,n)],{oid:i,Q:s}=t,{d:a}=e;return r.validateParams(i,s,a)}case l.publicKey.eddsaLegacy:{const{Q:r,oid:i}=t,{seed:s}=e;return fc(i,r,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:r}=t,{seed:i}=e;return L2(n,r,i)}case l.publicKey.x25519:case l.publicKey.x448:{const{A:r}=t,{k:i}=e;return tc(n,r,i)}default:throw Error("Unknown public key algorithm.")}}function ta(n){const{keySize:t}=lt(n);return Pt(t)}function Qi(n){try{n.getName()}catch{throw new ft("Unknown curve OID")}}function d0(n,t){switch(n){case l.publicKey.ecdsa:case l.publicKey.ecdh:case l.publicKey.eddsaLegacy:return new le(t).payloadSize;case l.publicKey.ed25519:case l.publicKey.ed448:return hi(n);case l.publicKey.x25519:case l.publicKey.x448:return Ia(n);default:throw Error("Unknown elliptic algo")}}const Ln=m.getWebCrypto(),on=m.getNodeCrypto(),_r=on?on.getCiphers():[],$n={idea:_r.includes("idea-cfb")?"idea-cfb":void 0,tripledes:_r.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:_r.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:_r.includes("bf-cfb")?"bf-cfb":void 0,aes128:_r.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:_r.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:_r.includes("aes-256-cfb")?"aes-256-cfb":void 0};async function wc(n){const{blockSize:t}=lt(n),e=await Pt(t),r=new Uint8Array([e[e.length-2],e[e.length-1]]);return m.concat([e,r])}async function cn(n,t,e,r,i){const s=l.read(l.symmetric,n);if(m.getNodeCrypto()&&$n[s])return function(f,y,d,g){const p=l.read(l.symmetric,f),A=new on.createCipheriv($n[p],y,g);return mt(d,v=>new Uint8Array(A.update(v)))}(n,t,e,r);if(m.isAES(n))return async function(f,y,d,g){if(Ln&&await U1.isSupported(f)){const p=new U1(f,y,g);return m.isStream(d)?mt(d,A=>p.encryptChunk(A),()=>p.finish()):p.encrypt(d)}if(m.isStream(d)){const p=new bc(!0,f,y,g);return mt(d,A=>p.processChunk(A),()=>p.finish())}return V2(y,g).encrypt(d)}(n,t,e,r);const a=new(await J2(n))(t),o=a.blockSize,c=r.slice();let h=new Uint8Array;const u=f=>{f&&(h=m.concatUint8Array([h,f]));const y=new Uint8Array(h.length);let d,g=0;for(;f?h.length>=o:h.length;){const p=a.encrypt(c);for(d=0;d<o;d++)c[d]=h[d]^p[d],y[g++]=c[d];h=h.subarray(o)}return y.subarray(0,g)};return mt(e,u,u)}async function di(n,t,e,r){const i=l.read(l.symmetric,n);if(on&&$n[i])return function(u,f,y,d){const g=l.read(l.symmetric,u),p=new on.createDecipheriv($n[g],f,d);return mt(y,A=>new Uint8Array(p.update(A)))}(n,t,e,r);if(m.isAES(n))return async function(u,f,y,d){if(m.isStream(y)){const g=new bc(!1,u,f,d);return mt(y,p=>g.processChunk(p),()=>g.finish())}return V2(f,d).decrypt(y)}(n,t,e,r);const s=new(await J2(n))(t),a=s.blockSize;let o=r,c=new Uint8Array;const h=u=>{u&&(c=m.concatUint8Array([c,u]));const f=new Uint8Array(c.length);let y,d=0;for(;u?c.length>=a:c.length;){const g=s.encrypt(o);for(o=c.subarray(0,a),y=0;y<a;y++)f[d++]=o[y]^g[y];c=c.subarray(a)}return f.subarray(0,d)};return mt(e,h,h)}class U1{constructor(t,e,r){const{blockSize:i}=lt(t);this.key=e,this.prevBlock=r,this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(t){const{keySize:e}=lt(t);return Ln.importKey("raw",new Uint8Array(e),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)}async _runCBC(t,e){const r="AES-CBC";this.keyRef=this.keyRef||await Ln.importKey("raw",this.key,r,!1,["encrypt"]);const i=await Ln.encrypt({name:r,iv:e||this.zeroBlock},this.keyRef,t);return new Uint8Array(i).subarray(0,t.length)}async encryptChunk(t){const e=this.nextBlock.length-this.i,r=t.subarray(0,e);if(this.nextBlock.set(r,this.i),this.i+t.length>=2*this.blockSize){const s=(t.length-e)%this.blockSize,a=m.concatUint8Array([this.nextBlock,t.subarray(e,t.length-s)]),o=m.concatUint8Array([this.prevBlock,a.subarray(0,a.length-this.blockSize)]),c=await this._runCBC(o);return kn(c,a),this.prevBlock=c.slice(-this.blockSize),s>0&&this.nextBlock.set(t.subarray(-s)),this.i=s,c}let i;if(this.i+=r.length,this.i===this.nextBlock.length){const s=this.nextBlock;i=await this._runCBC(this.prevBlock),kn(i,s),this.prevBlock=i.slice(),this.i=0;const a=t.subarray(r.length);this.nextBlock.set(a,this.i),this.i+=a.length}else i=new Uint8Array;return i}async finish(){let t;if(this.i===0)t=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const e=this.nextBlock,r=await this._runCBC(this.prevBlock);kn(r,e),t=r.subarray(0,e.length)}return this.clearSensitiveData(),t}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(t){const e=(await this._runCBC(m.concatUint8Array([new Uint8Array(this.blockSize),t]),this.iv)).subarray(0,t.length);return kn(e,t),this.clearSensitiveData(),e}}class bc{constructor(t,e,r,i){this.forEncryption=t;const{blockSize:s}=lt(e);this.key=C1.expandKeyLE(r),i.byteOffset%4!=0&&(i=i.slice()),this.prevBlock=_i(i),this.nextBlock=new Uint8Array(s),this.i=0,this.blockSize=s}_runCFB(t){const e=_i(t),r=new Uint8Array(t.length),i=_i(r);for(let s=0;s+4<=i.length;s+=4){const{s0:a,s1:o,s2:c,s3:h}=C1.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);i[s+0]=e[s+0]^a,i[s+1]=e[s+1]^o,i[s+2]=e[s+2]^c,i[s+3]=e[s+3]^h,this.prevBlock=(this.forEncryption?i:e).slice(s,s+4)}return r}async processChunk(t){const e=this.nextBlock.length-this.i,r=t.subarray(0,e);if(this.nextBlock.set(r,this.i),this.i+t.length>=2*this.blockSize){const s=(t.length-e)%this.blockSize,a=m.concatUint8Array([this.nextBlock,t.subarray(e,t.length-s)]),o=this._runCFB(a);return s>0&&this.nextBlock.set(t.subarray(-s)),this.i=s,o}let i;if(this.i+=r.length,this.i===this.nextBlock.length){i=this._runCFB(this.nextBlock),this.i=0;const s=t.subarray(r.length);this.nextBlock.set(s,this.i),this.i+=s.length}else i=new Uint8Array;return i}async finish(){let t;return this.i===0?t=new Uint8Array:t=this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),t}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function kn(n,t){const e=Math.min(n.length,t.length);for(let r=0;r<e;r++)n[r]=n[r]^t[r]}const _i=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),R1=m.getWebCrypto(),F4=m.getNodeCrypto(),Xe=16;function Q1(n,t){const e=n.length-Xe;for(let r=0;r<Xe;r++)n[r+e]^=t[r];return n}const Tn=new Uint8Array(Xe);async function P4(n){const t=await U4(n),e=m.double(await t(Tn)),r=m.double(e);return async function(i){return(await t(function(s,a,o){if(s.length&&s.length%Xe==0)return Q1(s,a);const c=new Uint8Array(s.length+(Xe-s.length%Xe));return c.set(s),c[s.length]=128,Q1(c,o)}(i,e,r))).subarray(-Xe)}}async function U4(n){if(m.getNodeCrypto())return async function(t){const e=new F4.createCipheriv("aes-"+8*n.length+"-cbc",n,Tn).update(t);return new Uint8Array(e)};if(m.getWebCrypto())try{return n=await R1.importKey("raw",n,{name:"AES-CBC",length:8*n.length},!1,["encrypt"]),async function(t){const e=await R1.encrypt({name:"AES-CBC",iv:Tn,length:8*Xe},n,t);return new Uint8Array(e).subarray(0,e.byteLength-Xe)}}catch(t){if(t.name!=="NotSupportedError"&&(n.length!==24||t.name!=="OperationError"))throw t;m.printDebugError("Browser did not support operation: "+t.message)}return async function(t){return j2(n,Tn,{disablePadding:!0}).encrypt(t)}}const _1=m.getWebCrypto(),R4=m.getNodeCrypto(),Q4=m.getNodeBuffer(),er=16,_4=er,h0=er,L1=new Uint8Array(er),ea=new Uint8Array(er);ea[er-1]=1;const ra=new Uint8Array(er);async function L4(n){const t=await P4(n);return function(e,r){return t(m.concatUint8Array([e,r]))}}async function T4(n){if(m.getNodeCrypto())return async function(t,e){const r=new R4.createCipheriv("aes-"+8*n.length+"-ctr",n,e),i=Q4.concat([r.update(t),r.final()]);return new Uint8Array(i)};if(m.getWebCrypto())try{const t=await _1.importKey("raw",n,{name:"AES-CTR",length:8*n.length},!1,["encrypt"]);return async function(e,r){const i=await _1.encrypt({name:"AES-CTR",counter:r,length:8*er},t,e);return new Uint8Array(i)}}catch(t){if(t.name!=="NotSupportedError"&&(n.length!==24||t.name!=="OperationError"))throw t;m.printDebugError("Browser did not support operation: "+t.message)}return async function(t,e){return A4(n,e).encrypt(t)}}async function W0(n,t){if(n!==l.symmetric.aes128&&n!==l.symmetric.aes192&&n!==l.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[e,r]=await Promise.all([L4(t),T4(t)]);return{encrypt:async function(i,s,a){const[o,c]=await Promise.all([e(L1,s),e(ea,a)]),h=await r(i,o),u=await e(ra,h);for(let f=0;f<h0;f++)u[f]^=c[f]^o[f];return m.concatUint8Array([h,u])},decrypt:async function(i,s,a){if(i.length<h0)throw Error("Invalid EAX ciphertext");const o=i.subarray(0,-h0),c=i.subarray(-h0),[h,u,f]=await Promise.all([e(L1,s),e(ea,a),e(ra,o)]),y=f;for(let d=0;d<h0;d++)y[d]^=u[d]^h[d];if(!m.equalsUint8Array(c,y))throw Error("Authentication tag mismatch");return await r(o,h)}}}ra[er-1]=2,W0.getNonce=function(n,t){const e=n.slice();for(let r=0;r<t.length;r++)e[8+r]^=t[r];return e},W0.blockLength=er,W0.ivLength=_4,W0.tagLength=h0;const zt=16,mc=15,pr=16;function T1(n){let t=0;for(let e=1;!(n&e);e<<=1)t++;return t}function Wt(n,t){for(let e=0;e<n.length;e++)n[e]^=t[e];return n}function Cn(n,t){return Wt(n.slice(),t)}const Dn=new Uint8Array(zt),H4=new Uint8Array([1]);async function j0(n,t){const{keySize:e}=lt(n);if(!m.isAES(n)||t.length!==e)throw Error("Unexpected algorithm or key size");let r=0;const i=j2(t,Dn,{disablePadding:!0}),s=h=>i.encrypt(h),a=h=>i.decrypt(h);let o;function c(h,u,f,y){const d=u.length/zt|0;(function(k,B){const E=m.nbits(Math.max(k.length,B.length)/zt|0)-1;for(let C=r+1;C<=E;C++)o[C]=m.double(o[C-1]);r=E})(u,y);const g=m.concatUint8Array([Dn.subarray(0,mc-f.length),H4,f]),p=63&g[zt-1];g[zt-1]&=192;const A=s(g),v=m.concatUint8Array([A,Cn(A.subarray(0,8),A.subarray(1,9))]),w=m.shiftRight(v.subarray(0+(p>>3),17+(p>>3)),8-(7&p)).subarray(1),x=new Uint8Array(zt),b=new Uint8Array(u.length+pr);let S,K=0;for(S=0;S<d;S++)Wt(w,o[T1(S+1)]),b.set(Wt(h(Cn(w,u)),w),K),Wt(x,h===s?u:b.subarray(K)),u=u.subarray(zt),K+=zt;if(u.length){Wt(w,o.x);const k=s(w);b.set(Cn(u,k),K);const B=new Uint8Array(zt);B.set(h===s?u:b.subarray(K,-pr),0),B[u.length]=128,Wt(x,B),K+=u.length}const F=Wt(s(Wt(Wt(x,w),o.$)),function(k){if(!k.length)return Dn;const B=k.length/zt|0,E=new Uint8Array(zt),C=new Uint8Array(zt);for(let I=0;I<B;I++)Wt(E,o[T1(I+1)]),Wt(C,s(Cn(E,k))),k=k.subarray(zt);if(k.length){Wt(E,o.x);const I=new Uint8Array(zt);I.set(k,0),I[k.length]=128,Wt(I,E),Wt(C,s(I))}return C}(y));return b.set(F,K),b}return function(){const h=s(Dn),u=m.double(h);o=[],o[0]=m.double(u),o.x=h,o.$=u}(),{encrypt:async function(h,u,f){return c(s,h,u,f)},decrypt:async function(h,u,f){if(h.length<pr)throw Error("Invalid OCB ciphertext");const y=h.subarray(-pr);h=h.subarray(0,-pr);const d=c(a,h,u,f);if(m.equalsUint8Array(y,d.subarray(-pr)))return d.subarray(0,-pr);throw Error("Authentication tag mismatch")}}}j0.getNonce=function(n,t){const e=n.slice();for(let r=0;r<t.length;r++)e[7+r]^=t[r];return e},j0.blockLength=zt,j0.ivLength=mc,j0.tagLength=pr;const Li=m.getWebCrypto(),H1=m.getNodeCrypto(),M1=m.getNodeBuffer(),u0=16,Ti="AES-GCM";async function p0(n,t){if(n!==l.symmetric.aes128&&n!==l.symmetric.aes192&&n!==l.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(m.getNodeCrypto())return{encrypt:async function(e,r,i=new Uint8Array){const s=new H1.createCipheriv("aes-"+8*t.length+"-gcm",t,r);s.setAAD(i);const a=M1.concat([s.update(e),s.final(),s.getAuthTag()]);return new Uint8Array(a)},decrypt:async function(e,r,i=new Uint8Array){const s=new H1.createDecipheriv("aes-"+8*t.length+"-gcm",t,r);s.setAAD(i),s.setAuthTag(e.slice(e.length-u0,e.length));const a=M1.concat([s.update(e.slice(0,e.length-u0)),s.final()]);return new Uint8Array(a)}};if(m.getWebCrypto())try{const e=await Li.importKey("raw",t,{name:Ti},!1,["encrypt","decrypt"]),r=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(i,s,a=new Uint8Array){if(r&&!i.length)return Bn(t,s,a).encrypt(i);const o=await Li.encrypt({name:Ti,iv:s,additionalData:a,tagLength:8*u0},e,i);return new Uint8Array(o)},decrypt:async function(i,s,a=new Uint8Array){if(r&&i.length===u0)return Bn(t,s,a).decrypt(i);try{const o=await Li.decrypt({name:Ti,iv:s,additionalData:a,tagLength:8*u0},e,i);return new Uint8Array(o)}catch(o){if(o.name==="OperationError")throw Error("Authentication tag mismatch")}}}}catch(e){if(e.name!=="NotSupportedError"&&(t.length!==24||e.name!=="OperationError"))throw e;m.printDebugError("Browser did not support operation: "+e.message)}return{encrypt:async function(e,r,i){return Bn(t,r,i).encrypt(e)},decrypt:async function(e,r,i){return Bn(t,r,i).decrypt(e)}}}function Je(n,t=!1){switch(n){case l.aead.eax:return W0;case l.aead.ocb:return j0;case l.aead.gcm:return p0;case l.aead.experimentalGCM:if(!t)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return p0;default:throw Error("Unsupported AEAD mode")}}async function M4(n,t,e,r,i,s){switch(n){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const{n:a,e:o}=r;return J3(t,i,m.leftPad(e.s,a.length),a,o,s)}case l.publicKey.dsa:{const{g:a,p:o,q:c,y:h}=r,{r:u,s:f}=e;return async function(y,d,g,p,A,v,w,x){if(d=Y(d),g=Y(g),v=Y(v),w=Y(w),A=Y(A),x=Y(x),d<=_n||d>=w||g<=_n||g>=w)return m.printDebug("invalid DSA Signature"),!1;const b=rt(Y(p.subarray(0,te(w))),w),S=m0(g,w);if(S===_n)return m.printDebug("invalid DSA Signature"),!1;A=rt(A,v),x=rt(x,v);const K=rt(b*S,w),F=rt(d*S,w);return rt(rt(Ft(A,K,v)*Ft(x,F,v),v),w)===d}(0,u,f,s,a,o,c,h)}case l.publicKey.ecdsa:{const{oid:a,Q:o}=r,c=new le(a).payloadSize;return Js(a,t,{r:m.leftPad(e.r,c),s:m.leftPad(e.s,c)},i,o,s)}case l.publicKey.eddsaLegacy:{const{oid:a,Q:o}=r,c=new le(a).payloadSize;return uc(a,t,{r:m.leftPad(e.r,c),s:m.leftPad(e.s,c)},0,o,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:a}=r;return va(n,t,e,0,a,s)}default:throw Error("Unknown signature algorithm.")}}async function N4(n,t,e,r,i,s){if(!e||!r)throw Error("Missing key parameters");switch(n){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const{n:a,e:o}=e,{d:c,p:h,q:u,u:f}=r;return{s:await $3(t,i,a,o,c,h,u,f,s)}}case l.publicKey.dsa:{const{g:a,p:o,q:c}=e,{x:h}=r;return async function(u,f,y,d,g,p){const A=BigInt(0);let v,w,x,b;d=Y(d),g=Y(g),y=Y(y),p=Y(p),y=rt(y,d),p=rt(p,g);const S=rt(Y(f.subarray(0,te(g))),g);for(;;){if(v=Br(q0,g),w=rt(Ft(y,v,d),g),w===A)continue;const K=rt(p*w,g);if(b=rt(S+K,g),x=rt(m0(v,g)*b,g),x!==A)break}return{r:Et(w,"be",te(d)),s:Et(x,"be",te(d))}}(0,s,a,o,c,h)}case l.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case l.publicKey.ecdsa:{const{oid:a,Q:o}=e,{d:c}=r;return $s(a,t,i,o,c,s)}case l.publicKey.eddsaLegacy:{const{oid:a,Q:o}=e,{seed:c}=r;return hc(a,t,0,o,c,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:a}=e,{seed:o}=r;return ma(n,t,0,a,o,s)}default:throw Error("Unknown signature algorithm.")}}p0.getNonce=function(n,t){const e=n.slice();for(let r=0;r<t.length;r++)e[4+r]^=t[r];return e},p0.blockLength=16,p0.ivLength=12,p0.tagLength=u0;class pi extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,pi),this.name="Argon2OutOfMemoryError"}}let Sn,Q0;class z4{constructor(t=W){const{passes:e,parallelism:r,memoryExponent:i}=t.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=e,this.p=r,this.encodedM=i}generateSalt(){this.salt=Pt(16)}read(t){let e=0;return this.salt=t.subarray(e,e+16),e+=16,this.t=t[e++],this.p=t[e++],this.encodedM=t[e++],e}write(){const t=[new Uint8Array([l.write(l.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return m.concatUint8Array(t)}async produceKey(t,e){const r=2<<this.encodedM-1;try{Sn=Sn||(await Promise.resolve().then(function(){return t6})).default,Q0=Q0||Sn();const i=await Q0,s=i({version:19,type:2,password:m.encodeUTF8(t),salt:this.salt,tagLength:e,memorySize:r,parallelism:this.p,passes:this.t});return r>1048576&&(Q0=Sn(),Q0.catch(()=>{})),s}catch(i){throw i.message&&(i.message.includes("Unable to grow instance memory")||i.message.includes("failed to grow memory")||i.message.includes("WebAssembly.Memory.grow")||i.message.includes("Out of memory"))?new pi("Could not allocate required memory for Argon2"):i}}}class O4{constructor(t,e=W){this.algorithm=l.hash.sha256,this.type=l.read(l.s2k,t),this.c=e.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=Pt(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(t){let e=0;switch(this.algorithm=t[e++],this.type){case"simple":break;case"salted":this.salt=t.subarray(e,e+8),e+=8;break;case"iterated":this.salt=t.subarray(e,e+8),e+=8,this.c=t[e++];break;case"gnu":if(m.uint8ArrayToString(t.subarray(e,e+3))!=="GNU")throw new ft("Unknown s2k type.");if(e+=3,1e3+t[e++]!==1001)throw new ft("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new ft("Unknown s2k type.")}return e}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...m.stringToUint8Array("GNU"),1]);const t=[new Uint8Array([l.write(l.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":t.push(this.salt);break;case"iterated":t.push(this.salt),t.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return m.concatUint8Array(t)}async produceKey(t,e){t=m.encodeUTF8(t);const r=[];let i=0,s=0;for(;i<e;){let a;switch(this.type){case"simple":a=m.concatUint8Array([new Uint8Array(s),t]);break;case"salted":a=m.concatUint8Array([new Uint8Array(s),this.salt,t]);break;case"iterated":{const c=m.concatUint8Array([this.salt,t]);let h=c.length;const u=Math.max(this.getCount(),h);a=new Uint8Array(s+u),a.set(c,s);for(let f=s+h;f<u;f+=h,h*=2)a.copyWithin(f,s,f);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const o=await Te(this.algorithm,a);r.push(o),i+=o.length,s++}return m.concatUint8Array(r).subarray(0,e)}}const G4=new Set([l.s2k.argon2,l.s2k.iterated]);function Jn(n,t=W){switch(n){case l.s2k.argon2:return new z4(t);case l.s2k.iterated:case l.s2k.gnu:case l.s2k.salted:case l.s2k.simple:return new O4(n,t);default:throw new ft("Unsupported S2K type")}}function vc(n){const{s2kType:t}=n;if(!G4.has(t))throw Error("The provided `config.s2kType` value is not allowed");return Jn(t,n)}var Qt=Uint8Array,$t=Uint16Array,gi=Uint32Array,Ai=new Qt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xi=new Qt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),na=new Qt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ec=function(n,t){for(var e=new $t(31),r=0;r<31;++r)e[r]=t+=1<<n[r-1];var i=new gi(e[30]);for(r=1;r<30;++r)for(var s=e[r];s<e[r+1];++s)i[s]=s-e[r]<<5|r;return[e,i]},Bc=Ec(Ai,2),kc=Bc[0],ia=Bc[1];kc[28]=258,ia[258]=28;for(var N1=Ec(xi,0),q4=N1[0],z1=N1[1],sa=new $t(32768),At=0;At<32768;++At){var Lr=(43690&At)>>>1|(21845&At)<<1;Lr=(61680&(Lr=(52428&Lr)>>>2|(13107&Lr)<<2))>>>4|(3855&Lr)<<4,sa[At]=((65280&Lr)>>>8|(255&Lr)<<8)>>>1}var Qe=function(n,t,e){for(var r=n.length,i=0,s=new $t(t);i<r;++i)n[i]&&++s[n[i]-1];var a,o=new $t(t);for(i=0;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;if(e){a=new $t(1<<t);var c=15-t;for(i=0;i<r;++i)if(n[i])for(var h=i<<4|n[i],u=t-n[i],f=o[n[i]-1]++<<u,y=f|(1<<u)-1;f<=y;++f)a[sa[f]>>>c]=h}else for(a=new $t(r),i=0;i<r;++i)n[i]&&(a[i]=sa[o[n[i]-1]++]>>>15-n[i]);return a},Sr=new Qt(288);for(At=0;At<144;++At)Sr[At]=8;for(At=144;At<256;++At)Sr[At]=9;for(At=256;At<280;++At)Sr[At]=7;for(At=280;At<288;++At)Sr[At]=8;var hn=new Qt(32);for(At=0;At<32;++At)hn[At]=5;var W4=Qe(Sr,9,0),j4=Qe(Sr,9,1),V4=Qe(hn,5,0),Y4=Qe(hn,5,1),Hi=function(n){for(var t=n[0],e=1;e<n.length;++e)n[e]>t&&(t=n[e]);return t},ge=function(n,t,e){var r=t/8|0;return(n[r]|n[r+1]<<8)>>(7&t)&e},Mi=function(n,t){var e=t/8|0;return(n[e]|n[e+1]<<8|n[e+2]<<16)>>(7&t)},Pa=function(n){return(n+7)/8|0},V0=function(n,t,e){(t==null||t<0)&&(t=0),(e==null||e>n.length)&&(e=n.length);var r=new(n.BYTES_PER_ELEMENT==2?$t:n.BYTES_PER_ELEMENT==4?gi:Qt)(e-t);return r.set(n.subarray(t,e)),r},Z4=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ne=function(n,t,e){var r=Error(t||Z4[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,ne),!e)throw r;return r},Oe=function(n,t,e){e<<=7&t;var r=t/8|0;n[r]|=e,n[r+1]|=e>>>8},_0=function(n,t,e){e<<=7&t;var r=t/8|0;n[r]|=e,n[r+1]|=e>>>8,n[r+2]|=e>>>16},Ni=function(n,t){for(var e=[],r=0;r<n.length;++r)n[r]&&e.push({s:r,f:n[r]});var i=e.length,s=e.slice();if(!i)return[Ua,0];if(i==1){var a=new Qt(e[0].s+1);return a[e[0].s]=1,[a,1]}e.sort(function(S,K){return S.f-K.f}),e.push({s:-1,f:25001});var o=e[0],c=e[1],h=0,u=1,f=2;for(e[0]={s:-1,f:o.f+c.f,l:o,r:c};u!=i-1;)o=e[e[h].f<e[f].f?h++:f++],c=e[h!=u&&e[h].f<e[f].f?h++:f++],e[u++]={s:-1,f:o.f+c.f,l:o,r:c};var y=s[0].s;for(r=1;r<i;++r)s[r].s>y&&(y=s[r].s);var d=new $t(y+1),g=aa(e[u-1],d,0);if(g>t){r=0;var p=0,A=g-t,v=1<<A;for(s.sort(function(S,K){return d[K.s]-d[S.s]||S.f-K.f});r<i;++r){var w=s[r].s;if(!(d[w]>t))break;p+=v-(1<<g-d[w]),d[w]=t}for(p>>>=A;p>0;){var x=s[r].s;d[x]<t?p-=1<<t-d[x]++-1:++r}for(;r>=0&&p;--r){var b=s[r].s;d[b]==t&&(--d[b],++p)}g=t}return[new Qt(d),g]},aa=function(n,t,e){return n.s==-1?Math.max(aa(n.l,t,e+1),aa(n.r,t,e+1)):t[n.s]=e},O1=function(n){for(var t=n.length;t&&!n[--t];);for(var e=new $t(++t),r=0,i=n[0],s=1,a=function(c){e[r++]=c},o=1;o<=t;++o)if(n[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=n[o]}return[e.subarray(0,r),t]},L0=function(n,t){for(var e=0,r=0;r<t.length;++r)e+=n[r]*t[r];return e},oa=function(n,t,e){var r=e.length,i=Pa(t+2);n[i]=255&r,n[i+1]=r>>>8,n[i+2]=255^n[i],n[i+3]=255^n[i+1];for(var s=0;s<r;++s)n[i+s+4]=e[s];return 8*(i+4+r)},G1=function(n,t,e,r,i,s,a,o,c,h,u){Oe(t,u++,e),++i[256];for(var f=Ni(i,15),y=f[0],d=f[1],g=Ni(s,15),p=g[0],A=g[1],v=O1(y),w=v[0],x=v[1],b=O1(p),S=b[0],K=b[1],F=new $t(19),k=0;k<w.length;++k)F[31&w[k]]++;for(k=0;k<S.length;++k)F[31&S[k]]++;for(var B=Ni(F,7),E=B[0],C=B[1],I=19;I>4&&!E[na[I-1]];--I);var D,P,U,T,M=h+5<<3,z=L0(i,Sr)+L0(s,hn)+a,O=L0(i,y)+L0(s,p)+a+14+3*I+L0(F,E)+(2*F[16]+3*F[17]+7*F[18]);if(M<=z&&M<=O)return oa(t,u,n.subarray(c,c+h));if(Oe(t,u,1+(O<z)),u+=2,O<z){D=Qe(y,d,0),P=y,U=Qe(p,A,0),T=p;var H=Qe(E,C,0);for(Oe(t,u,x-257),Oe(t,u+5,K-1),Oe(t,u+10,I-4),u+=14,k=0;k<I;++k)Oe(t,u+3*k,E[na[k]]);u+=3*I;for(var R=[w,S],Q=0;Q<2;++Q){var L=R[Q];for(k=0;k<L.length;++k){var _=31&L[k];Oe(t,u,H[_]),u+=E[_],_>15&&(Oe(t,u,L[k]>>>5&127),u+=L[k]>>>12)}}}else D=W4,P=Sr,U=V4,T=hn;for(k=0;k<o;++k)if(r[k]>255){_=r[k]>>>18&31,_0(t,u,D[_+257]),u+=P[_+257],_>7&&(Oe(t,u,r[k]>>>23&31),u+=Ai[_]);var G=31&r[k];_0(t,u,U[G]),u+=T[G],G>3&&(_0(t,u,r[k]>>>5&8191),u+=xi[G])}else _0(t,u,D[r[k]]),u+=P[r[k]];return _0(t,u,D[256]),u+P[256]},X4=new gi([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ua=new Qt(0),Cc=function(n,t,e,r,i){return function(s,a,o,c,h,u){var f=s.length,y=new Qt(c+f+5*(1+Math.ceil(f/7e3))+h),d=y.subarray(c,y.length-h),g=0;if(!a||f<8)for(var p=0;p<=f;p+=65535){var A=p+65535;A>=f&&(d[g>>3]=u),g=oa(d,g+1,s.subarray(p,A))}else{for(var v=X4[a-1],w=v>>>13,x=8191&v,b=(1<<o)-1,S=new $t(32768),K=new $t(b+1),F=Math.ceil(o/3),k=2*F,B=function(de){return(s[de]^s[de+1]<<F^s[de+2]<<k)&b},E=new gi(25e3),C=new $t(288),I=new $t(32),D=0,P=0,U=(p=0,0),T=0,M=0;p<f;++p){var z=B(p),O=32767&p,H=K[z];if(S[O]=H,K[z]=O,T<=p){var R=f-p;if((D>7e3||U>24576)&&R>423){g=G1(s,d,0,E,C,I,P,U,M,p-M,g),U=D=P=0,M=p;for(var Q=0;Q<286;++Q)C[Q]=0;for(Q=0;Q<30;++Q)I[Q]=0}var L=2,_=0,G=x,N=O-H&32767;if(R>2&&z==B(p-N))for(var j=Math.min(w,R)-1,q=Math.min(32767,p),$=Math.min(258,R);N<=q&&--G&&O!=H;){if(s[p+L]==s[p+L-N]){for(var Z=0;Z<$&&s[p+Z]==s[p+Z-N];++Z);if(Z>L){if(L=Z,_=N,Z>j)break;var at=Math.min(N,Z-2),ot=0;for(Q=0;Q<at;++Q){var it=p-N+Q+32768&32767,et=it-S[it]+32768&32767;et>ot&&(ot=et,H=it)}}}N+=(O=H)-(H=S[O])+32768&32767}if(_){E[U++]=268435456|ia[L]<<18|z1[_];var yt=31&ia[L],ye=31&z1[_];P+=Ai[yt]+xi[ye],++C[257+yt],++I[ye],T=p+L,++D}else E[U++]=s[p],++C[s[p]]}}g=G1(s,d,u,E,C,I,P,U,M,p-M,g),!u&&7&g&&(g=oa(d,g+1,Ua))}return V0(y,0,c+Pa(g)+h)}(n,t.level==null?6:t.level,t.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(n.length)))):12+t.mem,e,r,!i)},ca=function(){function n(t,e){e||typeof t!="function"||(e=t,t={}),this.ondata=e,this.o=t||{}}return n.prototype.p=function(t,e){this.ondata(Cc(t,this.o,0,0,!e),e)},n.prototype.push=function(t,e){this.ondata||ne(5),this.d&&ne(4),this.d=e,this.p(t,e||!1)},n}(),Hn=function(){function n(t){this.s={},this.p=new Qt(0),this.ondata=t}return n.prototype.e=function(t){this.ondata||ne(5),this.d&&ne(4);var e=this.p.length,r=new Qt(e+t.length);r.set(this.p),r.set(t,e),this.p=r},n.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,r=function(i,s,a){var o=i.length;if(!o||a&&a.f&&!a.l)return s||new Qt(0);var c=!s||a,h=!a||a.i;a||(a={}),s||(s=new Qt(3*o));var u=function(Z){var at=s.length;if(Z>at){var ot=new Qt(Math.max(2*at,Z));ot.set(s),s=ot}},f=a.f||0,y=a.p||0,d=a.b||0,g=a.l,p=a.d,A=a.m,v=a.n,w=8*o;do{if(!g){f=ge(i,y,1);var x=ge(i,y+1,3);if(y+=3,!x){var b=i[(U=Pa(y)+4)-4]|i[U-3]<<8,S=U+b;if(S>o){h&&ne(0);break}c&&u(d+b),s.set(i.subarray(U,S),d),a.b=d+=b,a.p=y=8*S,a.f=f;continue}if(x==1)g=j4,p=Y4,A=9,v=5;else if(x==2){var K=ge(i,y,31)+257,F=ge(i,y+10,15)+4,k=K+ge(i,y+5,31)+1;y+=14;for(var B=new Qt(k),E=new Qt(19),C=0;C<F;++C)E[na[C]]=ge(i,y+3*C,7);y+=3*F;var I=Hi(E),D=(1<<I)-1,P=Qe(E,I,1);for(C=0;C<k;){var U,T=P[ge(i,y,D)];if(y+=15&T,(U=T>>>4)<16)B[C++]=U;else{var M=0,z=0;for(U==16?(z=3+ge(i,y,3),y+=2,M=B[C-1]):U==17?(z=3+ge(i,y,7),y+=3):U==18&&(z=11+ge(i,y,127),y+=7);z--;)B[C++]=M}}var O=B.subarray(0,K),H=B.subarray(K);A=Hi(O),v=Hi(H),g=Qe(O,A,1),p=Qe(H,v,1)}else ne(1);if(y>w){h&&ne(0);break}}c&&u(d+131072);for(var R=(1<<A)-1,Q=(1<<v)-1,L=y;;L=y){var _=(M=g[Mi(i,y)&R])>>>4;if((y+=15&M)>w){h&&ne(0);break}if(M||ne(2),_<256)s[d++]=_;else{if(_==256){L=y,g=null;break}var G=_-254;if(_>264){var N=Ai[C=_-257];G=ge(i,y,(1<<N)-1)+kc[C],y+=N}var j=p[Mi(i,y)&Q],q=j>>>4;if(j||ne(3),y+=15&j,H=q4[q],q>3&&(N=xi[q],H+=Mi(i,y)&(1<<N)-1,y+=N),y>w){h&&ne(0);break}c&&u(d+131072);for(var $=d+G;d<$;d+=4)s[d]=s[d-H],s[d+1]=s[d+1-H],s[d+2]=s[d+2-H],s[d+3]=s[d+3-H];d=$}}a.l=g,a.p=L,a.b=d,a.f=f,g&&(f=1,a.m=A,a.d=p,a.n=v)}while(!f);return d==s.length?s:V0(s,0,d)}(this.p,this.o,this.s);this.ondata(V0(r,e,this.s.b),this.d),this.o=V0(r,this.s.b-32768),this.s.b=this.o.length,this.p=V0(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(t,e){this.e(t),this.c(e)},n}(),$4=function(){function n(t,e){var r,i;this.c=(r=1,i=0,{p:function(s){for(var a=r,o=i,c=0|s.length,h=0;h!=c;){for(var u=Math.min(h+2655,c);h<u;++h)o+=a+=s[h];a=(65535&a)+15*(a>>16),o=(65535&o)+15*(o>>16)}r=a,i=o},d:function(){return(255&(r%=65521))<<24|r>>>8<<16|(255&(i%=65521))<<8|i>>>8}}),this.v=1,ca.call(this,t,e)}return n.prototype.push=function(t,e){ca.prototype.push.call(this,t,e)},n.prototype.p=function(t,e){this.c.p(t);var r=Cc(t,this.o,this.v&&2,e&&4,!e);this.v&&(function(i,s){var a=s.level,o=a==0?0:a<6?1:a==9?3:2;i[0]=120,i[1]=o<<6|(o?32-2*o:1)}(r,this.o),this.v=0),e&&function(i,s,a){for(;a;++s)i[s]=a,a>>>=8}(r,r.length-4,this.c.d()),this.ondata(r,e)},n}(),J4=function(){function n(t){this.v=1,Hn.call(this,t)}return n.prototype.push=function(t,e){if(Hn.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}e&&(this.p.length<4&&ne(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Hn.prototype.c.call(this,e)},n}(),t8=typeof TextDecoder<"u"&&new TextDecoder;try{t8.decode(Ua,{stream:!0})}catch{}class F0{static get tag(){return l.packet.literalData}constructor(t=new Date){this.format=l.literal.utf8,this.date=m.normalizeDate(t),this.text=null,this.data=null,this.filename=""}setText(t,e=l.literal.utf8){this.format=e,this.text=t,this.data=null}getText(t=!1){return(this.text===null||m.isStream(this.text))&&(this.text=m.decodeUTF8(m.nativeEOL(this.getBytes(t)))),this.text}setBytes(t,e){this.format=e,this.data=t,this.text=null}getBytes(t=!1){return this.data===null&&(this.data=m.canonicalizeEOL(m.encodeUTF8(this.text))),t?tn(this.data):this.data}setFilename(t){this.filename=t}getFilename(){return this.filename}async read(t){await oi(t,async e=>{const r=await e.readByte(),i=await e.readByte();this.filename=m.decodeUTF8(await e.readBytes(i)),this.date=m.readDate(await e.readBytes(4));let s=e.remainder();kt(s)&&(s=await Dt(s)),this.setBytes(s,r)})}writeHeader(){const t=m.encodeUTF8(this.filename),e=new Uint8Array([t.length]),r=new Uint8Array([this.format]),i=m.writeDate(this.date);return m.concatUint8Array([r,e,t,i])}write(){const t=this.writeHeader(),e=this.getBytes();return m.concat([t,e])}}class _e{constructor(){this.bytes=""}read(t){return this.bytes=m.uint8ArrayToString(t.subarray(0,8)),this.bytes.length}write(){return m.stringToUint8Array(this.bytes)}toHex(){return m.uint8ArrayToHex(m.stringToUint8Array(this.bytes))}equals(t,e=!1){return e&&(t.isWildcard()||this.isWildcard())||this.bytes===t.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(t){return t.toHex()}static fromID(t){const e=new _e;return e.read(m.hexToUint8Array(t)),e}static wildcard(){const t=new _e;return t.read(new Uint8Array(8)),t}}const T0=Symbol("verified"),q1="salt@notations.openpgpjs.org",e8=new Set([l.signatureSubpacket.issuerKeyID,l.signatureSubpacket.issuerFingerprint,l.signatureSubpacket.embeddedSignature]);class Lt{static get tag(){return l.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new _e,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[T0]=null}read(t,e=W){let r=0;if(this.version=t[r++],this.version===5&&!e.enableParsingV5Entities)throw new ft("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version!==4&&this.version!==5&&this.version!==6)throw new ft(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=t[r++],this.publicKeyAlgorithm=t[r++],this.hashAlgorithm=t[r++],r+=this.readSubPackets(t.subarray(r,t.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=t.subarray(0,r),r+=this.readSubPackets(t.subarray(r,t.length),!1),this.signedHashValue=t.subarray(r,r+2),r+=2,this.version===6){const o=t[r++];this.salt=t.subarray(r,r+o),r+=o}const i=t.subarray(r,t.length),{read:s,signatureParams:a}=function(o,c){let h=0;switch(o){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const u=m.readMPI(c.subarray(h));return h+=u.length+2,{read:h,signatureParams:{s:u}}}case l.publicKey.dsa:case l.publicKey.ecdsa:{const u=m.readMPI(c.subarray(h));h+=u.length+2;const f=m.readMPI(c.subarray(h));return h+=f.length+2,{read:h,signatureParams:{r:u,s:f}}}case l.publicKey.eddsaLegacy:{const u=m.readMPI(c.subarray(h));h+=u.length+2;const f=m.readMPI(c.subarray(h));return h+=f.length+2,{read:h,signatureParams:{r:u,s:f}}}case l.publicKey.ed25519:case l.publicKey.ed448:{const u=2*hi(o),f=m.readExactSubarray(c,h,h+u);return h+=f.length,{read:h,signatureParams:{RS:f}}}default:throw new ft("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,i);if(s<i.length)throw Error("Error reading MPIs");this.params=a}writeParams(){return this.params instanceof Promise?Kr(async()=>E0(this.publicKeyAlgorithm,await this.params)):E0(this.publicKeyAlgorithm,this.params)}write(){const t=[];return t.push(this.signatureData),t.push(this.writeUnhashedSubPackets()),t.push(this.signedHashValue),this.version===6&&(t.push(new Uint8Array([this.salt.length])),t.push(this.salt)),t.push(this.writeParams()),m.concat(t)}async sign(t,e,r=new Date,i=!1,s){this.version=t.version,this.created=m.normalizeDate(r),this.issuerKeyVersion=t.version,this.issuerFingerprint=t.getFingerprintBytes(),this.issuerKeyID=t.getKeyID();const a=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(this.version===6){const u=zi(this.hashAlgorithm);if(this.salt===null)this.salt=Pt(u);else if(u!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(s.nonDeterministicSignaturesViaNotation){if(this.rawNotations.filter(({name:u})=>u===q1).length!==0)throw Error("Unexpected existing salt notation");{const u=Pt(zi(this.hashAlgorithm));this.rawNotations.push({name:q1,value:u,humanReadable:!1,critical:!1})}}a.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=m.concat(a);const o=this.toHash(this.signatureType,e,i),c=await this.hash(this.signatureType,e,o,i);this.signedHashValue=_t(Gr(c),0,2);const h=async()=>N4(this.publicKeyAlgorithm,this.hashAlgorithm,t.publicParams,t.privateParams,o,await Dt(c));m.isStream(c)?this.params=h():(this.params=await h(),this[T0]=!0)}writeHashedSubPackets(){const t=l.signatureSubpacket,e=[];let r;if(this.created===null)throw Error("Missing signature creation time");e.push(ut(t.signatureCreationTime,!0,m.writeDate(this.created))),this.signatureExpirationTime!==null&&e.push(ut(t.signatureExpirationTime,!0,m.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&e.push(ut(t.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(r=new Uint8Array([this.trustLevel,this.trustAmount]),e.push(ut(t.trustSignature,!0,r))),this.regularExpression!==null&&e.push(ut(t.regularExpression,!0,this.regularExpression)),this.revocable!==null&&e.push(ut(t.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&e.push(ut(t.keyExpirationTime,!0,m.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(r=m.stringToUint8Array(m.uint8ArrayToString(this.preferredSymmetricAlgorithms)),e.push(ut(t.preferredSymmetricAlgorithms,!1,r))),this.revocationKeyClass!==null&&(r=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),r=m.concat([r,this.revocationKeyFingerprint]),e.push(ut(t.revocationKey,!1,r))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&e.push(ut(t.issuerKeyID,!0,this.issuerKeyID.write())),this.rawNotations.forEach(({name:a,value:o,humanReadable:c,critical:h})=>{r=[new Uint8Array([c?128:0,0,0,0])];const u=m.encodeUTF8(a);r.push(m.writeNumber(u.length,2)),r.push(m.writeNumber(o.length,2)),r.push(u),r.push(o),r=m.concat(r),e.push(ut(t.notationData,h,r))}),this.preferredHashAlgorithms!==null&&(r=m.stringToUint8Array(m.uint8ArrayToString(this.preferredHashAlgorithms)),e.push(ut(t.preferredHashAlgorithms,!1,r))),this.preferredCompressionAlgorithms!==null&&(r=m.stringToUint8Array(m.uint8ArrayToString(this.preferredCompressionAlgorithms)),e.push(ut(t.preferredCompressionAlgorithms,!1,r))),this.keyServerPreferences!==null&&(r=m.stringToUint8Array(m.uint8ArrayToString(this.keyServerPreferences)),e.push(ut(t.keyServerPreferences,!1,r))),this.preferredKeyServer!==null&&e.push(ut(t.preferredKeyServer,!1,m.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&e.push(ut(t.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&e.push(ut(t.policyURI,!1,m.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(r=m.stringToUint8Array(m.uint8ArrayToString(this.keyFlags)),e.push(ut(t.keyFlags,!0,r))),this.signersUserID!==null&&e.push(ut(t.signersUserID,!1,m.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(r=m.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),e.push(ut(t.reasonForRevocation,!0,r))),this.features!==null&&(r=m.stringToUint8Array(m.uint8ArrayToString(this.features)),e.push(ut(t.features,!1,r))),this.signatureTargetPublicKeyAlgorithm!==null&&(r=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],r.push(m.stringToUint8Array(this.signatureTargetHash)),r=m.concat(r),e.push(ut(t.signatureTarget,!0,r))),this.embeddedSignature!==null&&e.push(ut(t.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(r=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],r=m.concat(r),e.push(ut(t.issuerFingerprint,this.version>=5,r))),this.preferredAEADAlgorithms!==null&&(r=m.stringToUint8Array(m.uint8ArrayToString(this.preferredAEADAlgorithms)),e.push(ut(t.preferredAEADAlgorithms,!1,r))),this.preferredCipherSuites!==null&&(r=new Uint8Array([].concat(...this.preferredCipherSuites)),e.push(ut(t.preferredCipherSuites,!1,r)));const i=m.concat(e),s=m.writeNumber(i.length,this.version===6?4:2);return m.concat([s,i])}writeUnhashedSubPackets(){const t=this.unhashedSubpackets.map(({type:i,critical:s,body:a})=>ut(i,s,a)),e=m.concat(t),r=m.writeNumber(e.length,this.version===6?4:2);return m.concat([r,e])}readSubPacket(t,e=!0){let r=0;const i=!!(128&t[r]),s=127&t[r];if(r++,e||(this.unhashedSubpackets.push({type:s,critical:i,body:t.subarray(r,t.length)}),e8.has(s)))switch(s){case l.signatureSubpacket.signatureCreationTime:this.created=m.readDate(t.subarray(r,t.length));break;case l.signatureSubpacket.signatureExpirationTime:{const a=m.readNumber(t.subarray(r,t.length));this.signatureNeverExpires=a===0,this.signatureExpirationTime=a;break}case l.signatureSubpacket.exportableCertification:this.exportable=t[r++]===1;break;case l.signatureSubpacket.trustSignature:this.trustLevel=t[r++],this.trustAmount=t[r++];break;case l.signatureSubpacket.regularExpression:this.regularExpression=t[r];break;case l.signatureSubpacket.revocable:this.revocable=t[r++]===1;break;case l.signatureSubpacket.keyExpirationTime:{const a=m.readNumber(t.subarray(r,t.length));this.keyExpirationTime=a,this.keyNeverExpires=a===0;break}case l.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.revocationKey:this.revocationKeyClass=t[r++],this.revocationKeyAlgorithm=t[r++],this.revocationKeyFingerprint=t.subarray(r,r+20);break;case l.signatureSubpacket.issuerKeyID:if(this.version===4)this.issuerKeyID.read(t.subarray(r,t.length));else if(e)throw Error("Unexpected Issuer Key ID subpacket");break;case l.signatureSubpacket.notationData:{const a=!!(128&t[r]);r+=4;const o=m.readNumber(t.subarray(r,r+2));r+=2;const c=m.readNumber(t.subarray(r,r+2));r+=2;const h=m.decodeUTF8(t.subarray(r,r+o)),u=t.subarray(r+o,r+o+c);this.rawNotations.push({name:h,humanReadable:a,value:u,critical:i}),a&&(this.notations[h]=m.decodeUTF8(u));break}case l.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=m.decodeUTF8(t.subarray(r,t.length));break;case l.signatureSubpacket.primaryUserID:this.isPrimaryUserID=t[r++]!==0;break;case l.signatureSubpacket.policyURI:this.policyURI=m.decodeUTF8(t.subarray(r,t.length));break;case l.signatureSubpacket.keyFlags:this.keyFlags=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.signersUserID:this.signersUserID=m.decodeUTF8(t.subarray(r,t.length));break;case l.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=t[r++],this.reasonForRevocationString=m.decodeUTF8(t.subarray(r,t.length));break;case l.signatureSubpacket.features:this.features=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=t[r++],this.signatureTargetHashAlgorithm=t[r++];const a=Ct(this.signatureTargetHashAlgorithm);this.signatureTargetHash=m.uint8ArrayToString(t.subarray(r,r+a));break}case l.signatureSubpacket.embeddedSignature:this.embeddedSignature=new Lt,this.embeddedSignature.read(t.subarray(r,t.length));break;case l.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=t[r++],this.issuerFingerprint=t.subarray(r,t.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case l.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...t.subarray(r,t.length)];break;case l.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let a=r;a<t.length;a+=2)this.preferredCipherSuites.push([t[a],t[a+1]]);break;default:this.unknownSubpackets.push({type:s,critical:i,body:t.subarray(r,t.length)})}}readSubPackets(t,e=!0,r){const i=this.version===6?4:2,s=m.readNumber(t.subarray(0,i));let a=i;for(;a<2+s;){const o=Q2(t.subarray(a,t.length));a+=o.offset,this.readSubPacket(t.subarray(a,a+o.len),e,r),a+=o.len}return a}toSign(t,e){const r=l.signature;switch(t){case r.binary:return e.text!==null?m.encodeUTF8(e.getText(!0)):e.getBytes(!0);case r.text:{const i=e.getBytes(!0);return m.canonicalizeEOL(i)}case r.standalone:return new Uint8Array(0);case r.certGeneric:case r.certPersona:case r.certCasual:case r.certPositive:case r.certRevocation:{let i,s;if(e.userID)s=180,i=e.userID;else{if(!e.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");s=209,i=e.userAttribute}const a=i.write();return m.concat([this.toSign(r.key,e),new Uint8Array([s]),m.writeNumber(a.length,4),a])}case r.subkeyBinding:case r.subkeyRevocation:case r.keyBinding:return m.concat([this.toSign(r.key,e),this.toSign(r.key,{key:e.bind})]);case r.key:if(e.key===void 0)throw Error("Key packet is required for this signature.");return e.key.writeForHash(this.version);case r.keyRevocation:return this.toSign(r.key,e);case r.timestamp:return new Uint8Array(0);case r.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(t,e){let r=0;return mt(Gr(this.signatureData),i=>{r+=i.length},()=>{const i=[];return this.version!==5||this.signatureType!==l.signature.binary&&this.signatureType!==l.signature.text||(e?i.push(new Uint8Array(6)):i.push(t.writeHeader())),i.push(new Uint8Array([this.version,255])),this.version===5&&i.push(new Uint8Array(4)),i.push(m.writeNumber(r,4)),m.concat(i)})}toHash(t,e,r=!1){const i=this.toSign(t,e);return m.concat([this.salt||new Uint8Array,i,this.signatureData,this.calculateTrailer(e,r)])}async hash(t,e,r,i=!1){if(this.version===6&&this.salt.length!==zi(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return r||(r=this.toHash(t,e,i)),Te(this.hashAlgorithm,r)}async verify(t,e,r,i=new Date,s=!1,a=W){if(!this.issuerKeyID.equals(t.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const o=e===l.signature.binary||e===l.signature.text;if(!(this[T0]&&!o)){let h,u;if(this.hashed?u=await this.hashed:(h=this.toHash(e,r,s),u=await this.hash(e,r,h)),u=await Dt(u),this.signedHashValue[0]!==u[0]||this.signedHashValue[1]!==u[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[T0]=await M4(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,t.publicParams,h,u),!this[T0])throw Error("Signature verification failed")}const c=m.normalizeDate(i);if(c&&this.created>c)throw Error("Signature creation time is in the future");if(c&&c>=this.getExpirationTime())throw Error("Signature is expired");if(a.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+l.read(l.hash,this.hashAlgorithm).toUpperCase());if(a.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[l.signature.binary,l.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+l.read(l.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:h,critical:u})=>{if(u)throw Error("Unknown critical signature subpacket type "+h)}),this.rawNotations.forEach(({name:h,critical:u})=>{if(u&&a.knownNotations.indexOf(h)<0)throw Error("Unknown critical notation: "+h)}),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(t=new Date){const e=m.normalizeDate(t);return e!==null&&!(this.created<=e&&e<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function ut(n,t,e){const r=[];return r.push(ci(e.length+1)),r.push(new Uint8Array([(t?128:0)|n])),r.push(e),m.concat(r)}function zi(n){switch(n){case l.hash.sha256:return 16;case l.hash.sha384:return 24;case l.hash.sha512:return 32;case l.hash.sha224:case l.hash.sha3_256:return 16;case l.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class fe{static get tag(){return l.packet.onePassSignature}static fromSignaturePacket(t,e){const r=new fe;return r.version=t.version===6?6:3,r.signatureType=t.signatureType,r.hashAlgorithm=t.hashAlgorithm,r.publicKeyAlgorithm=t.publicKeyAlgorithm,r.issuerKeyID=t.issuerKeyID,r.salt=t.salt,r.issuerFingerprint=t.issuerFingerprint,r.flags=e?1:0,r}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(t){let e=0;if(this.version=t[e++],this.version!==3&&this.version!==6)throw new ft(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=t[e++],this.hashAlgorithm=t[e++],this.publicKeyAlgorithm=t[e++],this.version===6){const r=t[e++];this.salt=t.subarray(e,e+r),e+=r,this.issuerFingerprint=t.subarray(e,e+32),e+=32,this.issuerKeyID=new _e,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new _e,this.issuerKeyID.read(t.subarray(e,e+8)),e+=8;return this.flags=t[e++],this}write(){const t=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return this.version===6?t.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):t.push(this.issuerKeyID.write()),t.push(new Uint8Array([this.flags])),m.concatUint8Array(t)}calculateTrailer(...t){return Kr(async()=>Lt.prototype.calculateTrailer.apply(await this.correspondingSig,t))}async verify(){const t=await this.correspondingSig;if(!t||t.constructor.tag!==l.packet.signature)throw Error("Corresponding signature packet missing");if(t.signatureType!==this.signatureType||t.hashAlgorithm!==this.hashAlgorithm||t.publicKeyAlgorithm!==this.publicKeyAlgorithm||!t.issuerKeyID.equals(this.issuerKeyID)||this.version===3&&t.version===6||this.version===6&&t.version!==6||this.version===6&&!m.equalsUint8Array(t.issuerFingerprint,this.issuerFingerprint)||this.version===6&&!m.equalsUint8Array(t.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return t.hashed=this.hashed,t.verify.apply(t,arguments)}}function r8(n,t){if(!t[n]){let e;try{e=l.read(l.packet,n)}catch{throw new _2("Unknown packet type with tag: "+n)}throw Error("Packet not allowed in this context: "+e)}return new t[n]}fe.prototype.hash=Lt.prototype.hash,fe.prototype.toHash=Lt.prototype.toHash,fe.prototype.toSign=Lt.prototype.toSign;class ct extends Array{static async fromBinary(t,e,r=W){const i=new ct;return await i.read(t,e,r),i}async read(t,e,r=W){r.additionalAllowedPackets.length&&(e={...e,...m.constructAllowedPackets(r.additionalAllowedPackets)}),this.stream=Ir(t,async(s,a)=>{const o=se(a);try{for(;;)if(await o.ready,await h4(s,async c=>{try{if(c.tag===l.packet.marker||c.tag===l.packet.trust||c.tag===l.packet.padding)return;const h=r8(c.tag,e);h.packets=new ct,h.fromStream=m.isStream(c.packet),await h.read(c.packet,r),await o.write(h)}catch(h){if(h instanceof _2){if(!(c.tag<=39))return;await o.abort(h)}const u=!r.ignoreUnsupportedPackets&&h instanceof ft,f=!(r.ignoreMalformedPackets||h instanceof ft);if(u||f||Rn(c.tag))await o.abort(h);else{const y=new Vs(c.tag,c.packet);await o.write(y)}m.printDebugError(h)}}))return await o.ready,void await o.close()}catch(c){await o.abort(c)}});const i=rr(this.stream);for(;;){const{done:s,value:a}=await i.read();if(s?this.stream=null:this.push(a),s||Rn(a.constructor.tag))break}i.releaseLock()}write(){const t=[];for(let e=0;e<this.length;e++){const r=this[e]instanceof Vs?this[e].tag:this[e].constructor.tag,i=this[e].write();if(m.isStream(i)&&Rn(this[e].constructor.tag)){let s=[],a=0;const o=512;t.push(qn(r)),t.push(mt(i,c=>{if(s.push(c),a+=c.length,a>=o){const h=Math.min(Math.log(a)/Math.LN2|0,30),u=2**h,f=m.concat([c4(h)].concat(s));return s=[f.subarray(1+u)],a=s[0].length,f.subarray(0,1+u)}},()=>m.concat([ci(a)].concat(s))))}else{if(m.isStream(i)){let s=0;t.push(mt(Gr(i),a=>{s+=a.length},()=>m1(r,s)))}else t.push(m1(r,i.length));t.push(i)}}return m.concat(t)}filterByTag(...t){const e=new ct,r=i=>s=>i===s;for(let i=0;i<this.length;i++)t.some(r(this[i].constructor.tag))&&e.push(this[i]);return e}findPacket(t){return this.find(e=>e.constructor.tag===t)}indexOfTag(...t){const e=[],r=this,i=s=>a=>s===a;for(let s=0;s<this.length;s++)t.some(i(r[s].constructor.tag))&&e.push(s);return e}}const n8=m.constructAllowedPackets([F0,fe,Lt]);class gn{static get tag(){return l.packet.compressedData}constructor(t=W){this.packets=null,this.algorithm=t.preferredCompressionAlgorithm,this.compressed=null}async read(t,e=W){await oi(t,async r=>{this.algorithm=await r.readByte(),this.compressed=r.remainder(),await this.decompress(e)})}write(){return this.compressed===null&&this.compress(),m.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(t=W){const e=l.read(l.compression,this.algorithm),r=a8[e];if(!r)throw Error(e+" decompression not supported");this.packets=await ct.fromBinary(await r(this.compressed),n8,t)}compress(){const t=l.read(l.compression,this.algorithm),e=s8[t];if(!e)throw Error(t+" compression not supported");this.compressed=e(this.packets.write())}}function ti(n,t){return e=>{if(!m.isStream(e)||kt(e))return Kr(()=>Dt(e).then(s=>new Promise((a,o)=>{const c=new t;c.ondata=h=>{a(h)};try{c.push(s,!0)}catch(h){o(h)}})));if(n)try{const s=n();return e.pipeThrough(s)}catch(s){if(s.name!=="TypeError")throw s}const r=e.getReader(),i=new t;return new ReadableStream({async start(s){for(i.ondata=async(a,o)=>{s.enqueue(a),o&&s.close()};;){const{done:a,value:o}=await r.read();if(a)return void i.push(new Uint8Array,!0);o.length&&i.push(o)}}})}}function i8(){return async function(n){const{decode:t}=await Promise.resolve().then(function(){return a6});return Kr(async()=>t(await Dt(n)))}}const ei=n=>({compressor:typeof CompressionStream<"u"&&(()=>new CompressionStream(n)),decompressor:typeof DecompressionStream<"u"&&(()=>new DecompressionStream(n))}),s8={zip:ti(ei("deflate-raw").compressor,ca),zlib:ti(ei("deflate").compressor,$4)},a8={uncompressed:n=>n,zip:ti(ei("deflate-raw").decompressor,Hn),zlib:ti(ei("deflate").decompressor,J4),bzip2:i8()},o8=m.constructAllowedPackets([F0,gn,fe,Lt]);class B0{static get tag(){return l.packet.symEncryptedIntegrityProtectedData}static fromObject({version:t,aeadAlgorithm:e}){if(t!==1&&t!==2)throw Error("Unsupported SEIPD version");const r=new B0;return r.version=t,t===2&&(r.aeadAlgorithm=e),r}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(t){await oi(t,async e=>{if(this.version=await e.readByte(),this.version!==1&&this.version!==2)throw new ft(`Version ${this.version} of the SEIP packet is unsupported.`);this.version===2&&(this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte(),this.salt=await e.readBytes(32)),this.encrypted=e.remainder()})}write(){return this.version===2?m.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):m.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(t,e,r=W){const{blockSize:i,keySize:s}=lt(t);if(e.length!==s)throw Error("Unexpected session key size");let a=this.packets.write();if(kt(a)&&(a=await Dt(a)),this.version===2)this.cipherAlgorithm=t,this.salt=Pt(32),this.chunkSizeByte=r.aeadChunkSizeByte,this.encrypted=await ri(this,"encrypt",e,a);else{const o=await wc(t),c=new Uint8Array([211,20]),h=m.concat([o,a,c]),u=await Te(l.hash.sha1,tn(h)),f=m.concat([h,u]);this.encrypted=await cn(t,e,f,new Uint8Array(i))}return!0}async decrypt(t,e,r=W){if(e.length!==lt(t).keySize)throw Error("Unexpected session key size");let i,s=Gr(this.encrypted);if(kt(s)&&(s=await Dt(s)),this.version===2){if(this.cipherAlgorithm!==t)throw Error("Unexpected session key algorithm");i=await ri(this,"decrypt",e,s)}else{const{blockSize:a}=lt(t),o=await di(t,e,s,new Uint8Array(a)),c=_t(tn(o),-20),h=_t(o,0,-20),u=Promise.all([Dt(await Te(l.hash.sha1,tn(h))),Dt(c)]).then(([y,d])=>{if(!m.equalsUint8Array(y,d))throw Error("Modification detected.");return new Uint8Array}),f=_t(h,a+2);i=_t(f,0,-2),i=Yt([i,Kr(()=>u)]),m.isStream(s)&&r.allowUnauthenticatedStream||(i=await Dt(i))}return this.packets=await ct.fromBinary(i,o8,r),!0}}async function ri(n,t,e,r){const i=n instanceof B0&&n.version===2,s=!i&&n.constructor.tag===l.packet.aeadEncryptedData;if(!i&&!s)throw Error("Unexpected packet type");const a=Je(n.aeadAlgorithm,s),o=t==="decrypt"?a.tagLength:0,c=t==="encrypt"?a.tagLength:0,h=2**(n.chunkSizeByte+6)+o,u=s?8:0,f=new ArrayBuffer(13+u),y=new Uint8Array(f,0,5+u),d=new Uint8Array(f),g=new DataView(f),p=new Uint8Array(f,5,8);y.set([192|n.constructor.tag,n.version,n.cipherAlgorithm,n.aeadAlgorithm,n.chunkSizeByte],0);let A,v,w=0,x=Promise.resolve(),b=0,S=0;if(i){const{keySize:F}=lt(n.cipherAlgorithm),{ivLength:k}=a,B=new Uint8Array(f,0,5),E=await Dr(l.hash.sha256,e,n.salt,B,F+k);e=E.subarray(0,F),A=E.subarray(F),A.fill(0,A.length-8),v=new DataView(A.buffer,A.byteOffset,A.byteLength)}else A=n.iv;const K=await a(n.cipherAlgorithm,e);return Ir(r,async(F,k)=>{if(m.isStream(F)!=="array"){const C=new TransformStream({},{highWaterMark:m.getHardwareConcurrency()*2**(n.chunkSizeByte+6),size:I=>I.length});Or(C.readable,k),k=C.writable}const B=rr(F),E=se(k);try{for(;;){let C=await B.readBytes(h+o)||new Uint8Array;const I=C.subarray(C.length-o);let D,P,U;if(C=C.subarray(0,C.length-o),i)U=A;else{U=A.slice();for(let T=0;T<8;T++)U[A.length-8+T]^=p[T]}if(!w||C.length?(B.unshift(I),D=K[t](C,U,y),D.catch(()=>{}),S+=C.length-o+c):(g.setInt32(5+u+4,b),D=K[t](I,U,d),D.catch(()=>{}),S+=c,P=!0),b+=C.length-o,x=x.then(()=>D).then(async T=>{await E.ready,await E.write(T),S-=T.length}).catch(T=>E.abort(T)),(P||S>E.desiredSize)&&await x,P){await E.close();break}i?v.setInt32(A.length-4,++w):g.setInt32(9,++w)}}catch(C){await E.ready.catch(()=>{}),await E.abort(C)}})}const c8=m.constructAllowedPackets([F0,gn,fe,Lt]);class h8{static get tag(){return l.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=l.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(t){await oi(t,async e=>{const r=await e.readByte();if(r!==1)throw new ft(`Version ${r} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte();const i=Je(this.aeadAlgorithm,!0);this.iv=await e.readBytes(i.ivLength),this.encrypted=e.remainder()})}write(){return m.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(t,e,r=W){this.packets=await ct.fromBinary(await ri(this,"decrypt",e,Gr(this.encrypted)),c8,r)}async encrypt(t,e,r=W){this.cipherAlgorithm=t;const{ivLength:i}=Je(this.aeadAlgorithm,!0);this.iv=Pt(i),this.chunkSizeByte=r.aeadChunkSizeByte;const s=this.packets.write();this.encrypted=await ri(this,"encrypt",e,s)}}class un{static get tag(){return l.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new _e,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:t,encryptionKeyPacket:e,anonymousRecipient:r,sessionKey:i,sessionKeyAlgorithm:s}){const a=new un;if(t!==3&&t!==6)throw Error("Unsupported PKESK version");return a.version=t,t===6&&(a.publicKeyVersion=r?null:e.version,a.publicKeyFingerprint=r?null:e.getFingerprintBytes()),a.publicKeyID=r?_e.wildcard():e.getKeyID(),a.publicKeyAlgorithm=e.algorithm,a.sessionKey=i,a.sessionKeyAlgorithm=s,a}read(t){let e=0;if(this.version=t[e++],this.version!==3&&this.version!==6)throw new ft(`Version ${this.version} of the PKESK packet is unsupported.`);if(this.version===6){const r=t[e++];if(r){this.publicKeyVersion=t[e++];const i=r-1;this.publicKeyFingerprint=t.subarray(e,e+i),e+=i,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=_e.wildcard()}else e+=this.publicKeyID.read(t.subarray(e,e+8));if(this.publicKeyAlgorithm=t[e++],this.encrypted=function(r,i){let s=0;switch(r){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:return{c:m.readMPI(i.subarray(s))};case l.publicKey.elgamal:{const a=m.readMPI(i.subarray(s));return s+=a.length+2,{c1:a,c2:m.readMPI(i.subarray(s))}}case l.publicKey.ecdh:{const a=m.readMPI(i.subarray(s));s+=a.length+2;const o=new Ac;return o.read(i.subarray(s)),{V:a,C:o}}case l.publicKey.x25519:case l.publicKey.x448:{const a=d0(r),o=m.readExactSubarray(i,s,s+a);s+=o.length;const c=new yi;return c.read(i.subarray(s)),{ephemeralPublicKey:o,C:c}}default:throw new ft("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,t.subarray(e)),this.publicKeyAlgorithm===l.publicKey.x25519||this.publicKeyAlgorithm===l.publicKey.x448){if(this.version===3)this.sessionKeyAlgorithm=l.write(l.symmetric,this.encrypted.C.algorithm);else if(this.encrypted.C.algorithm!==null)throw Error("Unexpected cleartext symmetric algorithm")}}write(){const t=[new Uint8Array([this.version])];return this.version===6?this.publicKeyFingerprint!==null?(t.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),t.push(this.publicKeyFingerprint)):t.push(new Uint8Array([0])):t.push(this.publicKeyID.write()),t.push(new Uint8Array([this.publicKeyAlgorithm]),E0(this.publicKeyAlgorithm,this.encrypted)),m.concatUint8Array(t)}async encrypt(t){const e=l.write(l.publicKey,this.publicKeyAlgorithm),r=this.version===3?this.sessionKeyAlgorithm:null,i=t.version===5?t.getFingerprintBytes().subarray(0,20):t.getFingerprintBytes(),s=W1(this.version,e,r,this.sessionKey);this.encrypted=await D4(e,r,t.publicParams,s,i)}async decrypt(t,e){if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Decryption error");const r=e?W1(this.version,this.publicKeyAlgorithm,e.sessionKeyAlgorithm,e.sessionKey):null,i=t.version===5?t.getFingerprintBytes().subarray(0,20):t.getFingerprintBytes(),s=await S4(this.publicKeyAlgorithm,t.publicParams,t.privateParams,this.encrypted,i,r),{sessionKey:a,sessionKeyAlgorithm:o}=function(c,h,u,f){switch(h){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.elgamal:case l.publicKey.ecdh:{const y=u.subarray(0,u.length-2),d=u.subarray(u.length-2),g=m.writeChecksum(y.subarray(y.length%8)),p=g[0]===d[0]&g[1]===d[1],A=c===6?{sessionKeyAlgorithm:null,sessionKey:y}:{sessionKeyAlgorithm:y[0],sessionKey:y.subarray(1)};if(f){const v=p&A.sessionKeyAlgorithm===f.sessionKeyAlgorithm&A.sessionKey.length===f.sessionKey.length;return{sessionKey:m.selectUint8Array(v,A.sessionKey,f.sessionKey),sessionKeyAlgorithm:c===6?null:m.selectUint8(v,A.sessionKeyAlgorithm,f.sessionKeyAlgorithm)}}if(p&&(c===6||l.read(l.symmetric,A.sessionKeyAlgorithm)))return A;throw Error("Decryption error")}case l.publicKey.x25519:case l.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:u};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,s,e);if(this.version===3){const c=this.publicKeyAlgorithm!==l.publicKey.x25519&&this.publicKeyAlgorithm!==l.publicKey.x448;if(this.sessionKeyAlgorithm=c?o:this.sessionKeyAlgorithm,a.length!==lt(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=a}}function W1(n,t,e,r){switch(t){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.elgamal:case l.publicKey.ecdh:return m.concatUint8Array([new Uint8Array(n===6?[]:[e]),r,m.writeChecksum(r.subarray(r.length%8))]);case l.publicKey.x25519:case l.publicKey.x448:return r;default:throw Error("Unsupported public key algorithm")}}class k0{static get tag(){return l.packet.symEncryptedSessionKey}constructor(t=W){this.version=t.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=l.write(l.aead,t.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(t){let e=0;if(this.version=t[e++],this.version!==4&&this.version!==5&&this.version!==6)throw new ft(`Version ${this.version} of the SKESK packet is unsupported.`);this.version===6&&e++;const r=t[e++];this.version>=5&&(this.aeadAlgorithm=t[e++],this.version===6&&e++);const i=t[e++];if(this.s2k=Jn(i),e+=this.s2k.read(t.subarray(e,t.length)),this.version>=5){const s=Je(this.aeadAlgorithm,!0);this.iv=t.subarray(e,e+=s.ivLength)}this.version>=5||e<t.length?(this.encrypted=t.subarray(e,t.length),this.sessionKeyEncryptionAlgorithm=r):this.sessionKeyAlgorithm=r}write(){const t=this.encrypted===null?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let e;const r=this.s2k.write();if(this.version===6){const i=r.length,s=3+i+this.iv.length;e=m.concatUint8Array([new Uint8Array([this.version,s,t,this.aeadAlgorithm,i]),r,this.iv,this.encrypted])}else this.version===5?e=m.concatUint8Array([new Uint8Array([this.version,t,this.aeadAlgorithm]),r,this.iv,this.encrypted]):(e=m.concatUint8Array([new Uint8Array([this.version,t]),r]),this.encrypted!==null&&(e=m.concatUint8Array([e,this.encrypted])));return e}async decrypt(t){const e=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:r,keySize:i}=lt(e),s=await this.s2k.produceKey(t,i);if(this.version>=5){const a=Je(this.aeadAlgorithm,!0),o=new Uint8Array([192|k0.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),c=this.version===6?await Dr(l.hash.sha256,s,new Uint8Array,o,i):s,h=await a(e,c);this.sessionKey=await h.decrypt(this.encrypted,this.iv,o)}else if(this.encrypted!==null){const a=await di(e,s,this.encrypted,new Uint8Array(r));if(this.sessionKeyAlgorithm=l.write(l.symmetric,a[0]),this.sessionKey=a.subarray(1,a.length),this.sessionKey.length!==lt(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=s}async encrypt(t,e=W){const r=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=r,this.s2k=vc(e),this.s2k.generateSalt();const{blockSize:i,keySize:s}=lt(r),a=await this.s2k.produceKey(t,s);if(this.sessionKey===null&&(this.sessionKey=ta(this.sessionKeyAlgorithm)),this.version>=5){const o=Je(this.aeadAlgorithm);this.iv=Pt(o.ivLength);const c=new Uint8Array([192|k0.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),h=this.version===6?await Dr(l.hash.sha256,a,new Uint8Array,c,s):a,u=await o(r,h);this.encrypted=await u.encrypt(this.sessionKey,this.iv,c)}else{const o=m.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await cn(r,a,o,new Uint8Array(i))}}}class Ue{static get tag(){return l.packet.publicKey}constructor(t=new Date,e=W){this.version=e.v6Keys?6:4,this.created=m.normalizeDate(t),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(t){const e=new Ue,{version:r,created:i,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=t;return e.version=r,e.created=i,e.algorithm=s,e.publicParams=a,e.keyID=o,e.fingerprint=c,e}async read(t,e=W){let r=0;if(this.version=t[r++],this.version===5&&!e.enableParsingV5Entities)throw new ft("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version===4||this.version===5||this.version===6){this.created=m.readDate(t.subarray(r,r+4)),r+=4,this.algorithm=t[r++],this.version>=5&&(r+=4);const{read:i,publicParams:s}=function(a,o){let c=0;switch(a){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const h=m.readMPI(o.subarray(c));c+=h.length+2;const u=m.readMPI(o.subarray(c));return c+=u.length+2,{read:c,publicParams:{n:h,e:u}}}case l.publicKey.dsa:{const h=m.readMPI(o.subarray(c));c+=h.length+2;const u=m.readMPI(o.subarray(c));c+=u.length+2;const f=m.readMPI(o.subarray(c));c+=f.length+2;const y=m.readMPI(o.subarray(c));return c+=y.length+2,{read:c,publicParams:{p:h,q:u,g:f,y}}}case l.publicKey.elgamal:{const h=m.readMPI(o.subarray(c));c+=h.length+2;const u=m.readMPI(o.subarray(c));c+=u.length+2;const f=m.readMPI(o.subarray(c));return c+=f.length+2,{read:c,publicParams:{p:h,g:u,y:f}}}case l.publicKey.ecdsa:{const h=new $e;c+=h.read(o),Qi(h);const u=m.readMPI(o.subarray(c));return c+=u.length+2,{read:c,publicParams:{oid:h,Q:u}}}case l.publicKey.eddsaLegacy:{const h=new $e;if(c+=h.read(o),Qi(h),h.getName()!==l.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let u=m.readMPI(o.subarray(c));return c+=u.length+2,u=m.leftPad(u,33),{read:c,publicParams:{oid:h,Q:u}}}case l.publicKey.ecdh:{const h=new $e;c+=h.read(o),Qi(h);const u=m.readMPI(o.subarray(c));c+=u.length+2;const f=new xc;return c+=f.read(o.subarray(c)),{read:c,publicParams:{oid:h,Q:u,kdfParams:f}}}case l.publicKey.ed25519:case l.publicKey.ed448:case l.publicKey.x25519:case l.publicKey.x448:{const h=m.readExactSubarray(o,c,c+d0(a));return c+=h.length,{read:c,publicParams:{A:h}}}default:throw new ft("Unknown public key encryption algorithm.")}}(this.algorithm,t.subarray(r));if(this.version===6&&s.oid&&(s.oid.getName()===l.curve.curve25519Legacy||s.oid.getName()===l.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=s,r+=i,await this.computeFingerprintAndKeyID(),r}throw new ft(`Version ${this.version} of the key packet is unsupported.`)}write(){const t=[];t.push(new Uint8Array([this.version])),t.push(m.writeDate(this.created)),t.push(new Uint8Array([this.algorithm]));const e=E0(this.algorithm,this.publicParams);return this.version>=5&&t.push(m.writeNumber(e.length,4)),t.push(e),m.concatUint8Array(t)}writeForHash(t){const e=this.writePublicKey(),r=149+t,i=t>=5?4:2;return m.concatUint8Array([new Uint8Array([r]),m.writeNumber(e.length,i),e])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new _e,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const t=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await Te(l.hash.sha256,t);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=await Te(l.hash.sha1,t)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return m.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(t){return this.version===t.version&&m.equalsUint8Array(this.writePublicKey(),t.writePublicKey())}getAlgorithmInfo(){const t={};t.algorithm=l.read(l.publicKey,this.algorithm);const e=this.publicParams.n||this.publicParams.p;return e?t.bits=m.uint8ArrayBitLength(e):this.publicParams.oid&&(t.curve=this.publicParams.oid.getName()),t}}Ue.prototype.readPublicKey=Ue.prototype.read,Ue.prototype.writePublicKey=Ue.prototype.write;const u8=m.constructAllowedPackets([F0,gn,fe,Lt]);class f8{static get tag(){return l.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(t){this.encrypted=t}write(){return this.encrypted}async decrypt(t,e,r=W){if(!r.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:i}=lt(t),s=await Dt(Gr(this.encrypted)),a=await di(t,e,s.subarray(i+2),s.subarray(2,i+2));this.packets=await ct.fromBinary(a,u8,r)}async encrypt(t,e,r=W){const i=this.packets.write(),{blockSize:s}=lt(t),a=await wc(t),o=await cn(t,e,a,new Uint8Array(s)),c=await cn(t,e,i,o.subarray(2));this.encrypted=m.concat([o,c])}}class wi extends Ue{static get tag(){return l.packet.publicSubkey}constructor(t,e){super(t,e)}static fromSecretSubkeyPacket(t){const e=new wi,{version:r,created:i,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=t;return e.version=r,e.created=i,e.algorithm=s,e.publicParams=a,e.keyID=o,e.fingerprint=c,e}}class Ra{static get tag(){return l.packet.userAttribute}constructor(){this.attributes=[]}read(t){let e=0;for(;e<t.length;){const r=Q2(t.subarray(e,t.length));e+=r.offset,this.attributes.push(m.uint8ArrayToString(t.subarray(e,e+r.len))),e+=r.len}}write(){const t=[];for(let e=0;e<this.attributes.length;e++)t.push(ci(this.attributes[e].length)),t.push(m.stringToUint8Array(this.attributes[e]));return m.concatUint8Array(t)}equals(t){return!!(t&&t instanceof Ra)&&this.attributes.every(function(e,r){return e===t.attributes[r]})}}class Qa extends Ue{static get tag(){return l.packet.secretKey}constructor(t=new Date,e=W){super(t,e),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}async read(t,e=W){let r=await this.readPublicKey(t,e);const i=r;this.s2kUsage=t[r++],this.version===5&&r++,this.version===6&&this.s2kUsage&&r++;try{if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){this.symmetric=t[r++],this.s2kUsage===253&&(this.aead=t[r++]),this.version===6&&r++;const s=t[r++];if(this.s2k=Jn(s),r+=this.s2k.read(t.subarray(r,t.length)),this.s2k.type==="gnu-dummy")return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=this.s2kUsage===253&&(this.version===5||this.version===4&&e.parseAEADEncryptedV4KeysAsLegacy),this.s2kUsage!==253||this.isLegacyAEAD?(this.iv=t.subarray(r,r+lt(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=t.subarray(r,r+Je(this.aead).ivLength),this.usedModernAEAD=!0),r+=this.iv.length)}catch(s){if(!this.s2kUsage)throw s;this.unparseableKeyMaterial=t.subarray(i),this.isEncrypted=!0}if(this.version===5&&(r+=4),this.keyMaterial=t.subarray(r),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let s;if(this.version===6)s=this.keyMaterial;else if(s=this.keyMaterial.subarray(0,-2),!m.equalsUint8Array(m.writeChecksum(s),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{read:a,privateParams:o}=P1(this.algorithm,s,this.publicParams);if(a<s.length)throw Error("Error reading MPIs");this.privateParams=o}catch(a){throw a instanceof ft?a:Error("Error reading MPIs")}}}write(){const t=this.writePublicKey();if(this.unparseableKeyMaterial)return m.concatUint8Array([t,this.unparseableKeyMaterial]);const e=[t];e.push(new Uint8Array([this.s2kUsage]));const r=[];if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){r.push(this.symmetric),this.s2kUsage===253&&r.push(this.aead);const i=this.s2k.write();this.version===6&&r.push(i.length),r.push(...i)}return this.s2kUsage&&this.s2k.type!=="gnu-dummy"&&r.push(...this.iv),(this.version===5||this.version===6&&this.s2kUsage)&&e.push(new Uint8Array([r.length])),e.push(new Uint8Array(r)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=E0(this.algorithm,this.privateParams)),this.version===5&&e.push(m.writeNumber(this.keyMaterial.length,4)),e.push(this.keyMaterial),this.s2kUsage||this.version===6||e.push(m.writeChecksum(this.keyMaterial))),m.concatUint8Array(e)}isDecrypted(){return this.isEncrypted===!1}isMissingSecretKeyMaterial(){return this.unparseableKeyMaterial!==void 0||this.isDummy()}isDummy(){return!(!this.s2k||this.s2k.type!=="gnu-dummy")}makeDummy(t=W){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=Jn(l.s2k.gnu,t),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=l.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}async encrypt(t,e=W){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!t)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=vc(e),this.s2k.generateSalt();const r=E0(this.algorithm,this.privateParams);this.symmetric=l.symmetric.aes256;const{blockSize:i}=lt(this.symmetric);if(e.aeadProtect){this.s2kUsage=253,this.aead=e.preferredAEADAlgorithm;const s=Je(this.aead);this.isLegacyAEAD=this.version===5,this.usedModernAEAD=!this.isLegacyAEAD;const a=qn(this.constructor.tag),o=await Oi(this.version,this.s2k,t,this.symmetric,this.aead,a,this.isLegacyAEAD),c=await s(this.symmetric,o);this.iv=this.isLegacyAEAD?Pt(i):Pt(s.ivLength);const h=this.isLegacyAEAD?new Uint8Array:m.concatUint8Array([a,this.writePublicKey()]);this.keyMaterial=await c.encrypt(r,this.iv.subarray(0,s.ivLength),h)}else{this.s2kUsage=254,this.usedModernAEAD=!1;const s=await Oi(this.version,this.s2k,t,this.symmetric);this.iv=Pt(i),this.keyMaterial=await cn(this.symmetric,s,m.concatUint8Array([r,await Te(l.hash.sha1,r)]),this.iv)}}async decrypt(t){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let e;const r=qn(this.constructor.tag);if(this.s2kUsage!==254&&this.s2kUsage!==253)throw this.s2kUsage===255?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");let i;if(e=await Oi(this.version,this.s2k,t,this.symmetric,this.aead,r,this.isLegacyAEAD),this.s2kUsage===253){const s=Je(this.aead,!0),a=await s(this.symmetric,e);try{const o=this.isLegacyAEAD?new Uint8Array:m.concatUint8Array([r,this.writePublicKey()]);i=await a.decrypt(this.keyMaterial,this.iv.subarray(0,s.ivLength),o)}catch(o){throw o.message==="Authentication tag mismatch"?Error("Incorrect key passphrase: "+o.message):o}}else{const s=await di(this.symmetric,e,this.keyMaterial,this.iv);i=s.subarray(0,-20);const a=await Te(l.hash.sha1,i);if(!m.equalsUint8Array(a,s.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:s}=P1(this.algorithm,i,this.publicParams);this.privateParams=s}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");if(this.usedModernAEAD)return;let t;try{t=await K4(this.algorithm,this.publicParams,this.privateParams)}catch{t=!1}if(!t)throw Error("Key is invalid")}async generate(t,e){if(this.version===6&&(this.algorithm===l.publicKey.ecdh&&e===l.curve.curve25519Legacy||this.algorithm===l.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${e}. Generate a key of type 'curve25519' instead`);const{privateParams:r,publicParams:i}=await I4(this.algorithm,t,e);this.privateParams=r,this.publicParams=i,this.isEncrypted=!1}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach(t=>{this.privateParams[t].fill(0),delete this.privateParams[t]}),this.privateParams=null,this.isEncrypted=!0)}}async function Oi(n,t,e,r,i,s,a){if(t.type==="argon2"&&!i)throw Error("Using Argon2 S2K without AEAD is not allowed");if(t.type==="simple"&&n===6)throw Error("Using Simple S2K with version 6 keys is not allowed");const{keySize:o}=lt(r),c=await t.produceKey(e,o);if(!i||n===5||a)return c;const h=m.concatUint8Array([s,new Uint8Array([n,r,i])]);return Dr(l.hash.sha256,c,new Uint8Array,h,o)}class bi{static get tag(){return l.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(t){if(m.isString(t)||t.name&&!m.isString(t.name)||t.email&&!m.isEmailAddress(t.email)||t.comment&&!m.isString(t.comment))throw Error("Invalid user ID format");const e=new bi;Object.assign(e,t);const r=[];return e.name&&r.push(e.name),e.comment&&r.push(`(${e.comment})`),e.email&&r.push(`<${e.email}>`),e.userID=r.join(" "),e}read(t,e=W){const r=m.decodeUTF8(t);if(r.length>e.maxUserIDLength)throw Error("User ID string is too long");const i=/^(?<name>[^()]+\s+)?(?<comment>\([^()]+\)\s+)?(?<email><\S+@\S+>)$/.exec(r);if(i!==null){const{name:s,comment:a,email:o}=i.groups;this.comment=(a==null?void 0:a.replace(/^\(|\)|\s$/g,"").trim())||"",this.name=(s==null?void 0:s.trim())||"",this.email=o.substring(1,o.length-1)}else/^[^\s@]+@[^\s@]+$/.test(r)&&(this.email=r);this.userID=r}write(){return m.encodeUTF8(this.userID)}equals(t){return t&&t.userID===this.userID}}class Dc extends Qa{static get tag(){return l.packet.secretSubkey}constructor(t=new Date,e=W){super(t,e)}}class Sc{constructor(t){this.packets=t||new ct}write(){return this.packets.write()}armor(t=W){const e=this.packets.some(r=>r.constructor.tag===Lt.tag&&r.version!==6);return dn(l.armor.signature,this.write(),void 0,void 0,void 0,e,t)}getSigningKeyIDs(){return this.packets.map(t=>t.issuerKeyID)}}async function Ic(n,t){const e=new Dc(n.date,t);return e.packets=null,e.algorithm=l.write(l.publicKey,n.algorithm),await e.generate(n.rsaBits,n.curve),await e.computeFingerprintAndKeyID(),e}async function l8(n,t){const e=new Qa(n.date,t);return e.packets=null,e.algorithm=l.write(l.publicKey,n.algorithm),await e.generate(n.rsaBits,n.curve,n.config),await e.computeFingerprintAndKeyID(),e}async function we(n,t,e,r,i=new Date,s){let a,o;for(let c=n.length-1;c>=0;c--)try{(!a||n[c].created>=a.created)&&(await n[c].verify(t,e,r,i,void 0,s),a=n[c])}catch(h){o=h}if(!a)throw m.wrapError(`Could not find valid ${l.read(l.signature,e)} signature in key ${t.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(c,h,u)=>h+" "+u.toLowerCase()),o);return a}function ha(n,t,e=new Date){const r=m.normalizeDate(e);if(r!==null){const i=ni(n,t);return!(n.created<=r&&r<i)}return!1}async function Kc(n,t,e,r){const i={};i.key=t,i.bind=n;const s={signatureType:l.signature.subkeyBinding};return e.sign?(s.keyFlags=[l.keyFlags.signData],s.embeddedSignature=await Le(i,[],n,{signatureType:l.signature.keyBinding},e.date,void 0,void 0,void 0,r)):s.keyFlags=[l.keyFlags.encryptCommunication|l.keyFlags.encryptStorage],e.keyExpirationTime>0&&(s.keyExpirationTime=e.keyExpirationTime,s.keyNeverExpires=!1),await Le(i,[],t,s,e.date,void 0,void 0,void 0,r)}async function y8(n,t,e=new Date,r=[],i){const s=l.hash.sha256,a=i.preferredHashAlgorithm,o=await Promise.all(n.map(async(f,y)=>(await f.getPrimarySelfSignature(e,r[y],i)).preferredHashAlgorithms||[])),c=new Map;for(const f of o)for(const y of f)try{const d=l.write(l.hash,y);c.set(d,c.has(d)?c.get(d)+1:1)}catch{}const h=f=>n.length===0||c.get(f)===n.length||f===s,u=()=>{if(c.size===0)return s;const f=Array.from(c.keys()).filter(y=>h(y)).sort((y,d)=>Ct(y)-Ct(d))[0];return Ct(f)>=Ct(s)?f:s};if(new Set([l.publicKey.ecdsa,l.publicKey.eddsaLegacy,l.publicKey.ed25519,l.publicKey.ed448]).has(t.algorithm)){const f=function(g,p){switch(g){case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:return ic(p);case l.publicKey.ed25519:case l.publicKey.ed448:return ui(g);default:throw Error("Unknown elliptic signing algo")}}(t.algorithm,t.publicParams.oid),y=h(a),d=Ct(a)>=Ct(f);if(y&&d)return a;{const g=u();return Ct(g)>=Ct(f)?g:f}}return h(a)?a:u()}async function Le(n,t,e,r,i,s,a=[],o=!1,c){if(e.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!e.isDecrypted())throw Error("Signing key is not decrypted.");const h=new Lt;return Object.assign(h,r),h.publicKeyAlgorithm=e.algorithm,h.hashAlgorithm=await y8(t,e,i,s,c),h.rawNotations=[...a],await h.sign(e,n,i,o,c),h}async function zr(n,t,e,r=new Date,i){(n=n[e])&&(t[e].length?await Promise.all(n.map(async function(s){s.isExpired(r)||i&&!await i(s)||t[e].some(function(a){return m.equalsUint8Array(a.writeParams(),s.writeParams())})||t[e].push(s)})):t[e]=n)}async function C0(n,t,e,r,i,s,a=new Date,o){s=s||n;const c=[];return await Promise.all(r.map(async function(h){try{if(!i||h.issuerKeyID.equals(i.issuerKeyID)){const u=![l.reasonForRevocation.keyRetired,l.reasonForRevocation.keySuperseded,l.reasonForRevocation.userIDInvalid].includes(h.reasonForRevocationFlag);await h.verify(s,t,e,u?null:a,!1,o),c.push(h.issuerKeyID)}}catch{}})),i?(i.revoked=!!c.some(h=>h.equals(i.issuerKeyID))||i.revoked||!1,i.revoked):c.length>0}function ni(n,t){let e;return t.keyNeverExpires===!1&&(e=n.created.getTime()+1e3*t.keyExpirationTime),e?new Date(e):1/0}function ua(n,t={}){switch(n.type=n.type||t.type,n.curve=n.curve||t.curve,n.rsaBits=n.rsaBits||t.rsaBits,n.keyExpirationTime=n.keyExpirationTime!==void 0?n.keyExpirationTime:t.keyExpirationTime,n.passphrase=m.isString(n.passphrase)?n.passphrase:t.passphrase,n.date=n.date||t.date,n.sign=n.sign||!1,n.type){case"ecc":try{n.curve=l.write(l.curve,n.curve)}catch{throw Error("Unknown curve")}n.curve!==l.curve.ed25519Legacy&&n.curve!==l.curve.curve25519Legacy&&n.curve!=="ed25519"&&n.curve!=="curve25519"||(n.curve=n.sign?l.curve.ed25519Legacy:l.curve.curve25519Legacy),n.sign?n.algorithm=n.curve===l.curve.ed25519Legacy?l.publicKey.eddsaLegacy:l.publicKey.ecdsa:n.algorithm=l.publicKey.ecdh;break;case"curve25519":n.algorithm=n.sign?l.publicKey.ed25519:l.publicKey.x25519;break;case"curve448":n.algorithm=n.sign?l.publicKey.ed448:l.publicKey.x448;break;case"rsa":n.algorithm=l.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+n.type)}return n}function j1(n,t,e){switch(n.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.dsa:case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:case l.publicKey.ed25519:case l.publicKey.ed448:if(!t.keyFlags&&!e.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&l.keyFlags.signData);default:return!1}}function V1(n,t,e){switch(n.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.elgamal:case l.publicKey.ecdh:case l.publicKey.x25519:case l.publicKey.x448:if(!t.keyFlags&&!e.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&l.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&l.keyFlags.encryptStorage);default:return!1}}function Y1(n,t,e){if(!t.keyFlags&&!e.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(n.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.elgamal:case l.publicKey.ecdh:case l.publicKey.x25519:case l.publicKey.x448:return!(!(!t.keyFlags||t.keyFlags[0]&l.keyFlags.signData)||!e.allowInsecureDecryptionWithSigningKeys)||!t.keyFlags||!!(t.keyFlags[0]&l.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&l.keyFlags.encryptStorage);default:return!1}}function xr(n,t){const e=l.write(l.publicKey,n.algorithm),r=n.getAlgorithmInfo();if(t.rejectPublicKeyAlgorithms.has(e))throw Error(r.algorithm+" keys are considered too weak.");switch(e){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.rsaEncrypt:if(r.bits<t.minRSABits)throw Error(`RSA keys shorter than ${t.minRSABits} bits are considered too weak.`);break;case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:case l.publicKey.ecdh:if(t.rejectCurves.has(r.curve))throw Error(`Support for ${r.algorithm} keys using curve ${r.curve} is disabled.`)}}class en{constructor(t,e){this.userID=t.constructor.tag===l.packet.userID?t:null,this.userAttribute=t.constructor.tag===l.packet.userAttribute?t:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=e}toPacketList(){const t=new ct;return t.push(this.userID||this.userAttribute),t.push(...this.revocationSignatures),t.push(...this.selfCertifications),t.push(...this.otherCertifications),t}clone(){const t=new en(this.userID||this.userAttribute,this.mainKey);return t.selfCertifications=[...this.selfCertifications],t.otherCertifications=[...this.otherCertifications],t.revocationSignatures=[...this.revocationSignatures],t}async certify(t,e,r){const i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i},a=new en(s.userID||s.userAttribute,this.mainKey);return a.otherCertifications=await Promise.all(t.map(async function(o){if(!o.isPrivate())throw Error("Need private key for signing");if(o.hasSameFingerprintAs(i))throw Error("The user's own key can only be used for self-certifications");const c=await o.getSigningKey(void 0,e,void 0,r);return Le(s,[o],c.keyPacket,{signatureType:l.signature.certGeneric,keyFlags:[l.keyFlags.certifyKeys|l.keyFlags.signData]},e,void 0,void 0,void 0,r)})),await a.update(this,e,r),a}async isRevoked(t,e,r=new Date,i=W){const s=this.mainKey.keyPacket;return C0(s,l.signature.certRevocation,{key:s,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,t,e,r,i)}async verifyCertificate(t,e,r=new Date,i){const s=this,a=this.mainKey.keyPacket,o={userID:this.userID,userAttribute:this.userAttribute,key:a},{issuerKeyID:c}=t,h=e.filter(u=>u.getKeys(c).length>0);return h.length===0?null:(await Promise.all(h.map(async u=>{const f=await u.getSigningKey(c,t.created,void 0,i);if(t.revoked||await s.isRevoked(t,f.keyPacket,r,i))throw Error("User certificate is revoked");try{await t.verify(f.keyPacket,l.signature.certGeneric,o,r,void 0,i)}catch(y){throw m.wrapError("User certificate is invalid",y)}})),!0)}async verifyAllCertifications(t,e=new Date,r){const i=this,s=this.selfCertifications.concat(this.otherCertifications);return Promise.all(s.map(async a=>({keyID:a.issuerKeyID,valid:await i.verifyCertificate(a,t,e,r).catch(()=>!1)})))}async verify(t=new Date,e){if(!this.selfCertifications.length)throw Error("No self-certifications found");const r=this,i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i};let a;for(let o=this.selfCertifications.length-1;o>=0;o--)try{const c=this.selfCertifications[o];if(c.revoked||await r.isRevoked(c,void 0,t,e))throw Error("Self-certification is revoked");try{await c.verify(i,l.signature.certGeneric,s,t,void 0,e)}catch(h){throw m.wrapError("Self-certification is invalid",h)}return!0}catch(c){a=c}throw a}async update(t,e,r){const i=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:i};await zr(t,this,"selfCertifications",e,async function(a){try{return await a.verify(i,l.signature.certGeneric,s,e,!1,r),!0}catch{return!1}}),await zr(t,this,"otherCertifications",e),await zr(t,this,"revocationSignatures",e,function(a){return C0(i,l.signature.certRevocation,s,[a],void 0,void 0,e,r)})}async revoke(t,{flag:e=l.reasonForRevocation.noReason,string:r=""}={},i=new Date,s=W){const a={userID:this.userID,userAttribute:this.userAttribute,key:t},o=new en(a.userID||a.userAttribute,this.mainKey);return o.revocationSignatures.push(await Le(a,[],t,{signatureType:l.signature.certRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,e),reasonForRevocationString:r},i,void 0,void 0,!1,s)),await o.update(this),o}}class D0{constructor(t,e){this.keyPacket=t,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=e}toPacketList(){const t=new ct;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.bindingSignatures),t}clone(){const t=new D0(this.keyPacket,this.mainKey);return t.bindingSignatures=[...this.bindingSignatures],t.revocationSignatures=[...this.revocationSignatures],t}async isRevoked(t,e,r=new Date,i=W){const s=this.mainKey.keyPacket;return C0(s,l.signature.subkeyRevocation,{key:s,bind:this.keyPacket},this.revocationSignatures,t,e,r,i)}async verify(t=new Date,e=W){const r=this.mainKey.keyPacket,i={key:r,bind:this.keyPacket},s=await we(this.bindingSignatures,r,l.signature.subkeyBinding,i,t,e);if(s.revoked||await this.isRevoked(s,null,t,e))throw Error("Subkey is revoked");if(ha(this.keyPacket,s,t))throw Error("Subkey is expired");return s}async getExpirationTime(t=new Date,e=W){const r=this.mainKey.keyPacket,i={key:r,bind:this.keyPacket};let s;try{s=await we(this.bindingSignatures,r,l.signature.subkeyBinding,i,t,e)}catch{return null}const a=ni(this.keyPacket,s),o=s.getExpirationTime();return a<o?a:o}async update(t,e=new Date,r=W){const i=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(t))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===l.packet.publicSubkey&&t.keyPacket.constructor.tag===l.packet.secretSubkey&&(this.keyPacket=t.keyPacket);const s=this,a={key:i,bind:s.keyPacket};await zr(t,this,"bindingSignatures",e,async function(o){for(let c=0;c<s.bindingSignatures.length;c++)if(s.bindingSignatures[c].issuerKeyID.equals(o.issuerKeyID))return o.created>s.bindingSignatures[c].created&&(s.bindingSignatures[c]=o),!1;try{return await o.verify(i,l.signature.subkeyBinding,a,e,void 0,r),!0}catch{return!1}}),await zr(t,this,"revocationSignatures",e,function(o){return C0(i,l.signature.subkeyRevocation,a,[o],void 0,void 0,e,r)})}async revoke(t,{flag:e=l.reasonForRevocation.noReason,string:r=""}={},i=new Date,s=W){const a={key:t,bind:this.keyPacket},o=new D0(this.keyPacket,this.mainKey);return o.revocationSignatures.push(await Le(a,[],t,{signatureType:l.signature.subkeyRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,e),reasonForRevocationString:r},i,void 0,void 0,!1,s)),await o.update(this),o}hasSameFingerprintAs(t){return this.keyPacket.hasSameFingerprintAs(t.keyPacket||t)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(n=>{D0.prototype[n]=function(){return this.keyPacket[n]()}});const d8=m.constructAllowedPackets([Lt]),Z1=new Set([l.packet.publicKey,l.packet.privateKey]),X1=new Set([l.packet.publicKey,l.packet.privateKey,l.packet.publicSubkey,l.packet.privateSubkey]);class Fc{packetListToStructure(t,e=new Set){let r,i,s,a;for(const o of t){if(o instanceof Vs){X1.has(o.tag)&&!a&&(a=Z1.has(o.tag)?Z1:X1);continue}const c=o.constructor.tag;if(a){if(!a.has(c))continue;a=null}if(e.has(c))throw Error("Unexpected packet type: "+c);switch(c){case l.packet.publicKey:case l.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=o,i=this.getKeyID(),!i)throw Error("Missing Key ID");break;case l.packet.userID:case l.packet.userAttribute:r=new en(o,this),this.users.push(r);break;case l.packet.publicSubkey:case l.packet.secretSubkey:r=null,s=new D0(o,this),this.subkeys.push(s);break;case l.packet.signature:switch(o.signatureType){case l.signature.certGeneric:case l.signature.certPersona:case l.signature.certCasual:case l.signature.certPositive:if(!r){m.printDebug("Dropping certification signatures without preceding user packet");continue}o.issuerKeyID.equals(i)?r.selfCertifications.push(o):r.otherCertifications.push(o);break;case l.signature.certRevocation:r?r.revocationSignatures.push(o):this.directSignatures.push(o);break;case l.signature.key:this.directSignatures.push(o);break;case l.signature.subkeyBinding:if(!s){m.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}s.bindingSignatures.push(o);break;case l.signature.keyRevocation:this.revocationSignatures.push(o);break;case l.signature.subkeyRevocation:if(!s){m.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}s.revocationSignatures.push(o)}}}}toPacketList(){const t=new ct;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.directSignatures),this.users.map(e=>t.push(...e.toPacketList())),this.subkeys.map(e=>t.push(...e.toPacketList())),t}clone(t=!1){const e=new this.constructor(this.toPacketList());return t&&e.getKeys().forEach(r=>{if(r.keyPacket=Object.create(Object.getPrototypeOf(r.keyPacket),Object.getOwnPropertyDescriptors(r.keyPacket)),!r.keyPacket.isDecrypted())return;const i={};Object.keys(r.keyPacket.privateParams).forEach(s=>{i[s]=new Uint8Array(r.keyPacket.privateParams[s])}),r.keyPacket.privateParams=i}),e}getSubkeys(t=null){return this.subkeys.filter(e=>!t||e.getKeyID().equals(t,!0))}getKeys(t=null){const e=[];return t&&!this.getKeyID().equals(t,!0)||e.push(this),e.concat(this.getSubkeys(t))}getKeyIDs(){return this.getKeys().map(t=>t.getKeyID())}getUserIDs(){return this.users.map(t=>t.userID?t.userID.userID:null).filter(t=>t!==null)}write(){return this.toPacketList().write()}async getSigningKey(t=null,e=new Date,r={},i=W){await this.verifyPrimaryKey(e,r,i);const s=this.keyPacket;try{xr(s,i)}catch(c){throw m.wrapError("Could not verify primary key",c)}const a=this.subkeys.slice().sort((c,h)=>h.keyPacket.created-c.keyPacket.created);let o;for(const c of a)if(!t||c.getKeyID().equals(t))try{await c.verify(e,i);const h={key:s,bind:c.keyPacket},u=await we(c.bindingSignatures,s,l.signature.subkeyBinding,h,e,i);if(!j1(c.keyPacket,u,i))continue;if(!u.embeddedSignature)throw Error("Missing embedded signature");return await we([u.embeddedSignature],c.keyPacket,l.signature.keyBinding,h,e,i),xr(c.keyPacket,i),c}catch(h){o=h}try{const c=await this.getPrimarySelfSignature(e,r,i);if((!t||s.getKeyID().equals(t))&&j1(s,c,i))return xr(s,i),this}catch(c){o=c}throw m.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),o)}async getEncryptionKey(t,e=new Date,r={},i=W){await this.verifyPrimaryKey(e,r,i);const s=this.keyPacket;try{xr(s,i)}catch(c){throw m.wrapError("Could not verify primary key",c)}const a=this.subkeys.slice().sort((c,h)=>h.keyPacket.created-c.keyPacket.created);let o;for(const c of a)if(!t||c.getKeyID().equals(t))try{await c.verify(e,i);const h={key:s,bind:c.keyPacket},u=await we(c.bindingSignatures,s,l.signature.subkeyBinding,h,e,i);if(V1(c.keyPacket,u,i))return xr(c.keyPacket,i),c}catch(h){o=h}try{const c=await this.getPrimarySelfSignature(e,r,i);if((!t||s.getKeyID().equals(t))&&V1(s,c,i))return xr(s,i),this}catch(c){o=c}throw m.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),o)}async isRevoked(t,e,r=new Date,i=W){return C0(this.keyPacket,l.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,t,e,r,i)}async verifyPrimaryKey(t=new Date,e={},r=W){const i=this.keyPacket;if(await this.isRevoked(null,null,t,r))throw Error("Primary key is revoked");if(ha(i,await this.getPrimarySelfSignature(t,e,r),t))throw Error("Primary key is expired");if(i.version!==6){const s=await we(this.directSignatures,i,l.signature.key,{key:i},t,r).catch(()=>{});if(s&&ha(i,s,t))throw Error("Primary key is expired")}}async getExpirationTime(t,e=W){let r;try{const i=await this.getPrimarySelfSignature(null,t,e),s=ni(this.keyPacket,i),a=i.getExpirationTime(),o=this.keyPacket.version!==6&&await we(this.directSignatures,this.keyPacket,l.signature.key,{key:this.keyPacket},null,e).catch(()=>{});if(o){const c=ni(this.keyPacket,o);r=Math.min(s,a,c)}else r=s<a?s:a}catch{r=null}return m.normalizeDate(r)}async getPrimarySelfSignature(t=new Date,e={},r=W){const i=this.keyPacket;if(i.version===6)return we(this.directSignatures,i,l.signature.key,{key:i},t,r);const{selfCertification:s}=await this.getPrimaryUser(t,e,r);return s}async getPrimaryUser(t=new Date,e={},r=W){const i=this.keyPacket,s=[];let a;for(let u=0;u<this.users.length;u++)try{const f=this.users[u];if(!f.userID)continue;if(e.name!==void 0&&f.userID.name!==e.name||e.email!==void 0&&f.userID.email!==e.email||e.comment!==void 0&&f.userID.comment!==e.comment)throw Error("Could not find user that matches that user ID");const y={userID:f.userID,key:i},d=await we(f.selfCertifications,i,l.signature.certGeneric,y,t,r);s.push({index:u,user:f,selfCertification:d})}catch(f){a=f}if(!s.length)throw a||Error("Could not find primary user");await Promise.all(s.map(async function(u){return u.selfCertification.revoked||u.user.isRevoked(u.selfCertification,null,t,r)}));const o=s.sort(function(u,f){const y=u.selfCertification,d=f.selfCertification;return d.revoked-y.revoked||y.isPrimaryUserID-d.isPrimaryUserID||y.created-d.created}).pop(),{user:c,selfCertification:h}=o;if(h.revoked||await c.isRevoked(h,null,t,r))throw Error("Primary user is revoked");return o}async update(t,e=new Date,r=W){if(!this.hasSameFingerprintAs(t))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&t.isPrivate()){if(!(this.subkeys.length===t.subkeys.length&&this.subkeys.every(s=>t.subkeys.some(a=>s.hasSameFingerprintAs(a)))))throw Error("Cannot update public key with private key if subkeys mismatch");return t.update(this,r)}const i=this.clone();return await zr(t,i,"revocationSignatures",e,s=>C0(i.keyPacket,l.signature.keyRevocation,i,[s],null,t.keyPacket,e,r)),await zr(t,i,"directSignatures",e),await Promise.all(t.users.map(async s=>{const a=i.users.filter(o=>s.userID&&s.userID.equals(o.userID)||s.userAttribute&&s.userAttribute.equals(o.userAttribute));if(a.length>0)await Promise.all(a.map(o=>o.update(s,e,r)));else{const o=s.clone();o.mainKey=i,i.users.push(o)}})),await Promise.all(t.subkeys.map(async s=>{const a=i.subkeys.filter(o=>o.hasSameFingerprintAs(s));if(a.length>0)await Promise.all(a.map(o=>o.update(s,e,r)));else{const o=s.clone();o.mainKey=i,i.subkeys.push(o)}})),i}async getRevocationCertificate(t=new Date,e=W){const r={key:this.keyPacket},i=await we(this.revocationSignatures,this.keyPacket,l.signature.keyRevocation,r,t,e),s=new ct;s.push(i);const a=this.keyPacket.version!==6;return dn(l.armor.publicKey,s.write(),null,null,"This is a revocation certificate",a,e)}async applyRevocationCertificate(t,e=new Date,r=W){const i=await yn(t),s=(await ct.fromBinary(i.data,d8,r)).findPacket(l.packet.signature);if(!s||s.signatureType!==l.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!s.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await s.verify(this.keyPacket,l.signature.keyRevocation,{key:this.keyPacket},e,void 0,r)}catch(o){throw m.wrapError("Could not verify revocation signature",o)}const a=this.clone();return a.revocationSignatures.push(s),a}async signPrimaryUser(t,e,r,i=W){const{index:s,user:a}=await this.getPrimaryUser(e,r,i),o=await a.certify(t,e,i),c=this.clone();return c.users[s]=o,c}async signAllUsers(t,e=new Date,r=W){const i=this.clone();return i.users=await Promise.all(this.users.map(function(s){return s.certify(t,e,r)})),i}async verifyPrimaryUser(t,e=new Date,r,i=W){const s=this.keyPacket,{user:a}=await this.getPrimaryUser(e,r,i);return t?await a.verifyAllCertifications(t,e,i):[{keyID:s.getKeyID(),valid:await a.verify(e,i).catch(()=>!1)}]}async verifyAllUsers(t,e=new Date,r=W){const i=this.keyPacket,s=[];return await Promise.all(this.users.map(async a=>{const o=t?await a.verifyAllCertifications(t,e,r):[{keyID:i.getKeyID(),valid:await a.verify(e,r).catch(()=>!1)}];s.push(...o.map(c=>({userID:a.userID?a.userID.userID:null,userAttribute:a.userAttribute,keyID:c.keyID,valid:c.valid})))})),s}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(n=>{Fc.prototype[n]=D0.prototype[n]});class fa extends Fc{constructor(t){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],t&&(this.packetListToStructure(t,new Set([l.packet.secretKey,l.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(t=W){const e=this.keyPacket.version!==6;return dn(l.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,e,t)}}class An extends fa{constructor(t){if(super(),this.packetListToStructure(t,new Set([l.packet.publicKey,l.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const t=new ct,e=this.toPacketList();for(const r of e)switch(r.constructor.tag){case l.packet.secretKey:{const i=Ue.fromSecretKeyPacket(r);t.push(i);break}case l.packet.secretSubkey:{const i=wi.fromSecretSubkeyPacket(r);t.push(i);break}default:t.push(r)}return new fa(t)}armor(t=W){const e=this.keyPacket.version!==6;return dn(l.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,e,t)}async getDecryptionKeys(t,e=new Date,r={},i=W){const s=this.keyPacket,a=[];let o=null;for(let h=0;h<this.subkeys.length;h++)if(!t||this.subkeys[h].getKeyID().equals(t,!0)){if(this.subkeys[h].keyPacket.isDummy()){o=o||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{const u={key:s,bind:this.subkeys[h].keyPacket},f=await we(this.subkeys[h].bindingSignatures,s,l.signature.subkeyBinding,u,e,i);Y1(this.subkeys[h].keyPacket,f,i)&&a.push(this.subkeys[h])}catch(u){o=u}}const c=await this.getPrimarySelfSignature(e,r,i);if(t&&!s.getKeyID().equals(t,!0)||!Y1(s,c,i)||(s.isDummy()?o=o||Error("Gnu-dummy key packets cannot be used for decryption"):a.push(this)),a.length===0)throw o||Error("No decryption key packets found");return a}isDecrypted(){return this.getKeys().some(({keyPacket:t})=>t.isDecrypted())}async validate(t=W){if(!this.isPrivate())throw Error("Cannot validate a public key");let e;if(this.keyPacket.isDummy()){const r=await this.getSigningKey(null,null,void 0,{...t,rejectPublicKeyAlgorithms:new Set,minRSABits:0});r&&!r.keyPacket.isDummy()&&(e=r.keyPacket)}else e=this.keyPacket;if(e)return e.validate();{const r=this.getKeys();if(r.map(i=>i.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(r.map(async i=>i.keyPacket.validate()))}}clearPrivateParams(){this.getKeys().forEach(({keyPacket:t})=>{t.isDecrypted()&&t.clearPrivateParams()})}async revoke({flag:t=l.reasonForRevocation.noReason,string:e=""}={},r=new Date,i=W){if(!this.isPrivate())throw Error("Need private key for revoking");const s={key:this.keyPacket},a=this.clone();return a.revocationSignatures.push(await Le(s,[],this.keyPacket,{signatureType:l.signature.keyRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,t),reasonForRevocationString:e},r,void 0,void 0,void 0,i)),a}async addSubkey(t={}){const e={...W,...t.config};if(t.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(t.rsaBits<e.minRSABits)throw Error(`rsaBits should be at least ${e.minRSABits}, got: ${t.rsaBits}`);const r=this.keyPacket;if(r.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!r.isDecrypted())throw Error("Key is not decrypted");const i=r.getAlgorithmInfo();i.type=function(c){switch(l.write(l.publicKey,c)){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.dsa:return"rsa";case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:return"ecc";case l.publicKey.ed25519:return"curve25519";case l.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}}(i.algorithm),i.rsaBits=i.bits||4096,i.curve=i.curve||"curve25519Legacy",t=ua(t,i);const s=await Ic(t,{...e,v6Keys:this.keyPacket.version===6});xr(s,e);const a=await Kc(s,r,t,e),o=this.toPacketList();return o.push(s,a),new An(o)}}const Pc=m.constructAllowedPackets([Ue,wi,Qa,Dc,bi,Ra,Lt]);function p8(n){for(const t of n)switch(t.constructor.tag){case l.packet.secretKey:return new An(n);case l.packet.publicKey:return new fa(n)}throw Error("No key packet found")}async function g8(n,t,e,r){e.passphrase&&await n.encrypt(e.passphrase,r),await Promise.all(t.map(async function(c,h){const u=e.subkeys[h].passphrase;u&&await c.encrypt(u,r)}));const i=new ct;function s(c,h){return[h,...c.filter(u=>u!==h)]}function a(){const c={};c.keyFlags=[l.keyFlags.certifyKeys|l.keyFlags.signData];const h=s([l.symmetric.aes256,l.symmetric.aes128],r.preferredSymmetricAlgorithm);if(c.preferredSymmetricAlgorithms=h,r.aeadProtect){const u=s([l.aead.gcm,l.aead.eax,l.aead.ocb],r.preferredAEADAlgorithm);c.preferredCipherSuites=u.flatMap(f=>h.map(y=>[y,f]))}return c.preferredHashAlgorithms=s([l.hash.sha512,l.hash.sha256,l.hash.sha3_512,l.hash.sha3_256],r.preferredHashAlgorithm),c.preferredCompressionAlgorithms=s([l.compression.uncompressed,l.compression.zlib,l.compression.zip],r.preferredCompressionAlgorithm),c.features=[0],c.features[0]|=l.features.modificationDetection,r.aeadProtect&&(c.features[0]|=l.features.seipdv2),e.keyExpirationTime>0&&(c.keyExpirationTime=e.keyExpirationTime,c.keyNeverExpires=!1),c}if(i.push(n),n.version===6){const c={key:n},h=a();h.signatureType=l.signature.key;const u=await Le(c,[],n,h,e.date,void 0,void 0,void 0,r);i.push(u)}await Promise.all(e.userIDs.map(async function(c,h){const u=bi.fromObject(c),f={userID:u,key:n},y=n.version!==6?a():{};return y.signatureType=l.signature.certPositive,h===0&&(y.isPrimaryUserID=!0),{userIDPacket:u,signaturePacket:await Le(f,[],n,y,e.date,void 0,void 0,void 0,r)}})).then(c=>{c.forEach(({userIDPacket:h,signaturePacket:u})=>{i.push(h),i.push(u)})}),await Promise.all(t.map(async function(c,h){const u=e.subkeys[h];return{secretSubkeyPacket:c,subkeySignaturePacket:await Kc(c,n,u,r)}})).then(c=>{c.forEach(({secretSubkeyPacket:h,subkeySignaturePacket:u})=>{i.push(h),i.push(u)})});const o={key:n};return i.push(await Le(o,[],n,{signatureType:l.signature.keyRevocation,reasonForRevocationFlag:l.reasonForRevocation.noReason,reasonForRevocationString:""},e.date,void 0,void 0,void 0,r)),e.passphrase&&n.clearPrivateParams(),await Promise.all(t.map(async function(c,h){e.subkeys[h].passphrase&&c.clearPrivateParams()})),new An(i)}async function L6({armoredKey:n,binaryKey:t,config:e,...r}){if(e={...W,...e},!n&&!t)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(n&&!m.isString(n))throw Error("readKey: options.armoredKey must be a string");if(t&&!m.isUint8Array(t))throw Error("readKey: options.binaryKey must be a Uint8Array");const i=Object.keys(r);if(i.length>0)throw Error("Unknown option: "+i.join(", "));let s;if(n){const{type:c,data:h}=await yn(n);if(c!==l.armor.publicKey&&c!==l.armor.privateKey)throw Error("Armored text not of type key");s=h}else s=t;const a=await ct.fromBinary(s,Pc,e),o=a.indexOfTag(l.packet.publicKey,l.packet.secretKey);if(o.length===0)throw Error("No key packet found");return p8(a.slice(o[0],o[1]))}async function T6({armoredKey:n,binaryKey:t,config:e,...r}){if(e={...W,...e},!n&&!t)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(n&&!m.isString(n))throw Error("readPrivateKey: options.armoredKey must be a string");if(t&&!m.isUint8Array(t))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");const i=Object.keys(r);if(i.length>0)throw Error("Unknown option: "+i.join(", "));let s;if(n){const{type:c,data:h}=await yn(n);if(c!==l.armor.privateKey)throw Error("Armored text not of type private key");s=h}else s=t;const a=await ct.fromBinary(s,Pc,e),o=a.indexOfTag(l.packet.publicKey,l.packet.secretKey);for(let c=0;c<o.length;c++){if(a[o[c]].constructor.tag===l.packet.publicKey)continue;const h=a.slice(o[c],o[c+1]);return new An(h)}throw Error("No secret key packet found")}const A8=m.constructAllowedPackets([F0,gn,h8,B0,f8,un,k0,fe,Lt]),x8=m.constructAllowedPackets([k0]),w8=m.constructAllowedPackets([Lt]);class ce{constructor(t){this.packets=t||new ct}getEncryptionKeyIDs(){const t=[];return this.packets.filterByTag(l.packet.publicKeyEncryptedSessionKey).forEach(function(e){t.push(e.publicKeyID)}),t}getSigningKeyIDs(){const t=this.unwrapCompressed(),e=t.packets.filterByTag(l.packet.onePassSignature);return e.length>0?e.map(r=>r.issuerKeyID):t.packets.filterByTag(l.packet.signature).map(r=>r.issuerKeyID)}async decrypt(t,e,r,i=new Date,s=W){const a=this.packets.filterByTag(l.packet.symmetricallyEncryptedData,l.packet.symEncryptedIntegrityProtectedData,l.packet.aeadEncryptedData);if(a.length===0)throw Error("No encrypted data found");const o=a[0],c=o.cipherAlgorithm,h=r||await this.decryptSessionKeys(t,e,c,i,s);let u=null;const f=Promise.all(h.map(async({algorithm:d,data:g})=>{if(!m.isUint8Array(g)||!o.cipherAlgorithm&&!m.isString(d))throw Error("Invalid session key for decryption.");try{const p=o.cipherAlgorithm||l.write(l.symmetric,d);await o.decrypt(p,g,s)}catch(p){m.printDebugError(p),u=p}}));if(Hs(o.encrypted),o.encrypted=null,await f,!o.packets||!o.packets.length)throw u||Error("Decryption failed.");const y=new ce(o.packets);return o.packets=new ct,y}async decryptSessionKeys(t,e,r,i=new Date,s=W){let a,o=[];if(e){const c=this.packets.filterByTag(l.packet.symEncryptedSessionKey);if(c.length===0)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(e.map(async function(h,u){let f;f=u?await ct.fromBinary(c.write(),x8,s):c,await Promise.all(f.map(async function(y){try{await y.decrypt(h),o.push(y)}catch(d){m.printDebugError(d),d instanceof pi&&(a=d)}}))}))}else{if(!t)throw Error("No key or password specified.");{const c=this.packets.filterByTag(l.packet.publicKeyEncryptedSessionKey);if(c.length===0)throw Error("No public key encrypted session key packet found.");await Promise.all(c.map(async function(h){await Promise.all(t.map(async function(u){let f;try{f=(await u.getDecryptionKeys(h.publicKeyID,null,void 0,s)).map(d=>d.keyPacket)}catch(d){return void(a=d)}let y=[l.symmetric.aes256,l.symmetric.aes128,l.symmetric.tripledes,l.symmetric.cast5];try{const d=await u.getPrimarySelfSignature(i,void 0,s);d.preferredSymmetricAlgorithms&&(y=y.concat(d.preferredSymmetricAlgorithms))}catch{}await Promise.all(f.map(async function(d){if(!d.isDecrypted())throw Error("Decryption key is not decrypted.");if(s.constantTimePKCS1Decryption&&(h.publicKeyAlgorithm===l.publicKey.rsaEncrypt||h.publicKeyAlgorithm===l.publicKey.rsaEncryptSign||h.publicKeyAlgorithm===l.publicKey.rsaSign||h.publicKeyAlgorithm===l.publicKey.elgamal)){const g=h.write();await Promise.all((r?[r]:Array.from(s.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map(async p=>{const A=new un;A.read(g);const v={sessionKeyAlgorithm:p,sessionKey:ta(p)};try{await A.decrypt(d,v),o.push(A)}catch(w){m.printDebugError(w),a=w}}))}else try{await h.decrypt(d);const g=r||h.sessionKeyAlgorithm;if(g&&!y.includes(l.write(l.symmetric,g)))throw Error("A non-preferred symmetric algorithm was used.");o.push(h)}catch(g){m.printDebugError(g),a=g}}))})),Hs(h.encrypted),h.encrypted=null}))}}if(o.length>0){if(o.length>1){const c=new Set;o=o.filter(h=>{const u=h.sessionKeyAlgorithm+m.uint8ArrayToString(h.sessionKey);return!c.has(u)&&(c.add(u),!0)})}return o.map(c=>({data:c.sessionKey,algorithm:c.sessionKeyAlgorithm&&l.read(l.symmetric,c.sessionKeyAlgorithm)}))}throw a||Error("Session key decryption failed.")}getLiteralData(){const t=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return t&&t.getBytes()||null}getFilename(){const t=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return t&&t.getFilename()||null}getText(){const t=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return t?t.getText():null}static async generateSessionKey(t=[],e=new Date,r=[],i=W){const{symmetricAlgo:s,aeadAlgo:a}=await async function(h=[],u=new Date,f=[],y=W){const d=await Promise.all(h.map((A,v)=>A.getPrimarySelfSignature(u,f[v],y)));if(h.length?d.every(A=>A.features&&A.features[0]&l.features.seipdv2):y.aeadProtect){const A={symmetricAlgo:l.symmetric.aes128,aeadAlgo:l.aead.ocb},v=[{symmetricAlgo:y.preferredSymmetricAlgorithm,aeadAlgo:y.preferredAEADAlgorithm},{symmetricAlgo:y.preferredSymmetricAlgorithm,aeadAlgo:l.aead.ocb},{symmetricAlgo:l.symmetric.aes128,aeadAlgo:y.preferredAEADAlgorithm}];for(const w of v)if(d.every(x=>x.preferredCipherSuites&&x.preferredCipherSuites.some(b=>b[0]===w.symmetricAlgo&&b[1]===w.aeadAlgo)))return w;return A}const g=l.symmetric.aes128,p=y.preferredSymmetricAlgorithm;return{symmetricAlgo:d.every(A=>A.preferredSymmetricAlgorithms&&A.preferredSymmetricAlgorithms.includes(p))?p:g,aeadAlgo:void 0}}(t,e,r,i),o=l.read(l.symmetric,s),c=a?l.read(l.aead,a):void 0;return await Promise.all(t.map(h=>h.getEncryptionKey().catch(()=>null).then(u=>{if(u&&(u.keyPacket.algorithm===l.publicKey.x25519||u.keyPacket.algorithm===l.publicKey.x448)&&!c&&!m.isAES(s))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:ta(s),algorithm:o,aeadAlgorithm:c}}async encrypt(t,e,r,i=!1,s=[],a=new Date,o=[],c=W){if(r){if(!m.isUint8Array(r.data)||!m.isString(r.algorithm))throw Error("Invalid session key for encryption.")}else if(t&&t.length)r=await ce.generateSessionKey(t,a,o,c);else{if(!e||!e.length)throw Error("No keys, passwords, or session key provided.");r=await ce.generateSessionKey(void 0,void 0,void 0,c)}const{data:h,algorithm:u,aeadAlgorithm:f}=r,y=await ce.encryptSessionKey(h,u,f,t,e,i,s,a,o,c),d=B0.fromObject({version:f?2:1,aeadAlgorithm:f?l.write(l.aead,f):null});d.packets=this.packets;const g=l.write(l.symmetric,u);return await d.encrypt(g,h,c),y.packets.push(d),d.packets=new ct,y}static async encryptSessionKey(t,e,r,i,s,a=!1,o=[],c=new Date,h=[],u=W){const f=new ct,y=l.write(l.symmetric,e),d=r&&l.write(l.aead,r);if(i){const g=await Promise.all(i.map(async function(p,A){const v=await p.getEncryptionKey(o[A],c,h,u),w=un.fromObject({version:d?6:3,encryptionKeyPacket:v.keyPacket,anonymousRecipient:a,sessionKey:t,sessionKeyAlgorithm:y});return await w.encrypt(v.keyPacket),delete w.sessionKey,w}));f.push(...g)}if(s){const g=async function(w,x){try{return await w.decrypt(x),1}catch{return 0}},p=(w,x)=>w+x,A=async function(w,x,b,S){const K=new k0(u);return K.sessionKey=w,K.sessionKeyAlgorithm=x,b&&(K.aeadAlgorithm=b),await K.encrypt(S,u),u.passwordCollisionCheck&&(await Promise.all(s.map(F=>g(K,F)))).reduce(p)!==1?A(w,x,S):(delete K.sessionKey,K)},v=await Promise.all(s.map(w=>A(t,y,d,w)));f.push(...v)}return new ce(f)}async sign(t=[],e=[],r=null,i=[],s=new Date,a=[],o=[],c=[],h=W){const u=new ct,f=this.packets.findPacket(l.packet.literalData);if(!f)throw Error("No literal data packet to sign.");const y=await $1(f,t,e,r,i,s,a,o,c,!1,h),d=y.map((g,p)=>fe.fromSignaturePacket(g,p===0)).reverse();return u.push(...d),u.push(f),u.push(...y),new ce(u)}compress(t,e=W){if(t===l.compression.uncompressed)return this;const r=new gn(e);r.algorithm=t,r.packets=this.packets;const i=new ct;return i.push(r),new ce(i)}async signDetached(t=[],e=[],r=null,i=[],s=[],a=new Date,o=[],c=[],h=W){const u=this.packets.findPacket(l.packet.literalData);if(!u)throw Error("No literal data packet to sign.");return new Sc(await $1(u,t,e,r,i,s,a,o,c,!0,h))}async verify(t,e=new Date,r=W){const i=this.unwrapCompressed(),s=i.packets.filterByTag(l.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");kt(i.packets.stream)&&i.packets.push(...await Dt(i.packets.stream,c=>c||[]));const a=i.packets.filterByTag(l.packet.onePassSignature).reverse(),o=i.packets.filterByTag(l.packet.signature);return a.length&&!o.length&&m.isStream(i.packets.stream)&&!kt(i.packets.stream)?(await Promise.all(a.map(async c=>{c.correspondingSig=new Promise((h,u)=>{c.correspondingSigResolve=h,c.correspondingSigReject=u}),c.signatureData=Kr(async()=>(await c.correspondingSig).signatureData),c.hashed=Dt(await c.hash(c.signatureType,s[0],void 0,!1)),c.hashed.catch(()=>{})})),i.packets.stream=Ir(i.packets.stream,async(c,h)=>{const u=rr(c),f=se(h);try{for(let y=0;y<a.length;y++){const{value:d}=await u.read();a[y].correspondingSigResolve(d)}await u.readToEnd(),await f.ready,await f.close()}catch(y){a.forEach(d=>{d.correspondingSigReject(y)}),await f.abort(y)}}),Gi(a,s,t,e,!1,r)):Gi(o,s,t,e,!1,r)}verifyDetached(t,e,r=new Date,i=W){const s=this.unwrapCompressed().packets.filterByTag(l.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");return Gi(t.packets.filterByTag(l.packet.signature),s,e,r,!0,i)}unwrapCompressed(){const t=this.packets.filterByTag(l.packet.compressedData);return t.length?new ce(t[0].packets):this}async appendSignature(t,e=W){await this.packets.read(m.isUint8Array(t)?t:(await yn(t)).data,w8,e)}write(){return this.packets.write()}armor(t=W){const e=this.packets[this.packets.length-1],r=e.constructor.tag===B0.tag?e.version!==2:this.packets.some(i=>i.constructor.tag===Lt.tag&&i.version!==6);return dn(l.armor.message,this.write(),null,null,null,r,t)}}async function $1(n,t,e=[],r=null,i=[],s=new Date,a=[],o=[],c=[],h=!1,u=W){const f=new ct,y=n.text===null?l.signature.binary:l.signature.text;if(await Promise.all(t.map(async(d,g)=>{const p=a[g];if(!d.isPrivate())throw Error("Need private key for signing");const A=await d.getSigningKey(i[g],s,p,u);return Le(n,e.length?e:[d],A.keyPacket,{signatureType:y},s,o,c,h,u)})).then(d=>{f.push(...d)}),r){const d=r.packets.filterByTag(l.packet.signature);f.push(...d)}return f}async function Gi(n,t,e,r=new Date,i=!1,s=W){return Promise.all(n.filter(function(a){return["text","binary"].includes(l.read(l.signature,a.signatureType))}).map(async function(a){return async function(o,c,h,u=new Date,f=!1,y=W){let d,g;for(const v of h){const w=v.getKeys(o.issuerKeyID);if(w.length>0){d=v,g=w[0];break}}const p=o instanceof fe?o.correspondingSig:o,A={keyID:o.issuerKeyID,verified:(async()=>{if(!g)throw Error("Could not find signing key with key ID "+o.issuerKeyID.toHex());await o.verify(g.keyPacket,o.signatureType,c[0],u,f,y);const v=await p;if(g.getCreationTime()>v.created)throw Error("Key is newer than the signature");try{await d.getSigningKey(g.getKeyID(),v.created,void 0,y)}catch(w){if(!y.allowInsecureVerificationWithReformattedKeys||!w.message.match(/Signature creation time is in the future/))throw w;await d.getSigningKey(g.getKeyID(),u,void 0,y)}return!0})(),signature:(async()=>{const v=await p,w=new ct;return v&&w.push(v),new Sc(w)})()};return A.signature.catch(()=>{}),A.verified.catch(()=>{}),A}(a,t,e,r,i,s)}))}async function H6({armoredMessage:n,binaryMessage:t,config:e,...r}){e={...W,...e};let i=n||t;if(!i)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(n&&!m.isString(n)&&!m.isStream(n))throw Error("readMessage: options.armoredMessage must be a string or stream");if(t&&!m.isUint8Array(t)&&!m.isStream(t))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(r);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=m.isStream(i);if(n){const{type:h,data:u}=await yn(i);if(h!==l.armor.message)throw Error("Armored text not of type message");i=u}const o=await ct.fromBinary(i,A8,e),c=new ce(o);return c.fromStream=a,c}async function M6({text:n,binary:t,filename:e,date:r=new Date,format:i=n!==void 0?"utf8":"binary",...s}){const a=n!==void 0?n:t;if(a===void 0)throw Error("createMessage: must pass options object containing `text` or `binary`");if(n&&!m.isString(n)&&!m.isStream(n))throw Error("createMessage: options.text must be a string or stream");if(t&&!m.isUint8Array(t)&&!m.isStream(t))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=m.isStream(a),h=new F0(r);n!==void 0?h.setText(a,l.write(l.literal,i)):h.setBytes(a,l.write(l.literal,i)),e!==void 0&&h.setFilename(e);const u=new ct;u.push(h);const f=new ce(u);return f.fromStream=c,f}async function N6({userIDs:n=[],passphrase:t,type:e,curve:r,rsaBits:i=4096,keyExpirationTime:s=0,date:a=new Date,subkeys:o=[{}],format:c="armored",config:h,...u}){mi(h={...W,...h}),e||r?(e=e||"ecc",r=r||"curve25519Legacy"):(e=h.v6Keys?"curve25519":"ecc",r="curve25519Legacy"),n=ie(n);const f=Object.keys(u);if(f.length>0)throw Error("Unknown option: "+f.join(", "));if(n.length===0&&!h.v6Keys)throw Error("UserIDs are required for V4 keys");if(e==="rsa"&&i<h.minRSABits)throw Error(`rsaBits should be at least ${h.minRSABits}, got: ${i}`);const y={userIDs:n,passphrase:t,type:e,rsaBits:i,curve:r,keyExpirationTime:s,date:a,subkeys:o};try{const{key:d,revocationCertificate:g}=await async function(p,A){p.sign=!0,(p=ua(p)).subkeys=p.subkeys.map((S,K)=>ua(p.subkeys[K],p));let v=[l8(p,A)];v=v.concat(p.subkeys.map(S=>Ic(S,A)));const w=await Promise.all(v),x=await g8(w[0],w.slice(1),p,A),b=await x.getRevocationCertificate(p.date,A);return x.revocationSignatures=[],{key:x,revocationCertificate:b}}(y,h);return d.getKeys().forEach(({keyPacket:p})=>xr(p,h)),{privateKey:J1(d,c,h),publicKey:J1(d.toPublic(),c,h),revocationCertificate:g}}catch(d){throw m.wrapError("Error generating keypair",d)}}async function z6({privateKey:n,passphrase:t,config:e,...r}){mi(e={...W,...e});const i=Object.keys(r);if(i.length>0)throw Error("Unknown option: "+i.join(", "));if(!n.isPrivate())throw Error("Cannot decrypt a public key");const s=n.clone(!0),a=m.isArray(t)?t:[t];try{return await Promise.all(s.getKeys().map(o=>m.anyPromise(a.map(c=>o.keyPacket.decrypt(c))))),await s.validate(e),s}catch(o){throw s.clearPrivateParams(),m.wrapError("Error decrypting private key",o)}}async function O6({message:n,encryptionKeys:t,signingKeys:e,passwords:r,sessionKey:i,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:h=[],date:u=new Date,signingUserIDs:f=[],encryptionUserIDs:y=[],signatureNotations:d=[],config:g,...p}){if(mi(g={...W,...g}),Uc(n),b8(s),t=ie(t),e=ie(e),r=ie(r),c=ie(c),h=ie(h),f=ie(f),y=ie(y),d=ie(d),p.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(p.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(p.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(p.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const A=Object.keys(p);if(A.length>0)throw Error("Unknown option: "+A.join(", "));e||(e=[]);try{if((e.length||a)&&(n=await n.sign(e,t,a,c,u,f,h,d,g)),n=n.compress(await async function(w=[],x=new Date,b=[],S=W){const K=l.compression.uncompressed,F=S.preferredCompressionAlgorithm;return(await Promise.all(w.map(async function(B,E){const C=(await B.getPrimarySelfSignature(x,b[E],S)).preferredCompressionAlgorithms;return!!C&&C.indexOf(F)>=0}))).every(Boolean)?F:K}(t,u,y,g),g),n=await n.encrypt(t,r,i,o,h,u,y,g),s==="object")return n;const v=s==="armored"?n.armor(g):n.write();return await Rc(v)}catch(v){throw m.wrapError("Error encrypting message",v)}}async function G6({message:n,decryptionKeys:t,passwords:e,sessionKeys:r,verificationKeys:i,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:h,...u}){if(mi(h={...W,...h}),Uc(n),i=ie(i),t=ie(t),e=ie(e),r=ie(r),u.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(u.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const f=Object.keys(u);if(f.length>0)throw Error("Unknown option: "+f.join(", "));try{const y=await n.decrypt(t,e,r,c,h);i||(i=[]);const d={};if(d.signatures=o?await y.verifyDetached(o,i,c,h):await y.verify(i,c,h),d.data=a==="binary"?y.getLiteralData():y.getText(),d.filename=y.getFilename(),v8(d,n),s){if(i.length===0)throw Error("Verification keys are required to verify message signatures");if(d.signatures.length===0)throw Error("Message is not signed");d.data=Yt([d.data,Kr(async()=>(await m.anyPromise(d.signatures.map(g=>g.verified)),a==="binary"?new Uint8Array:""))])}return d.data=await Rc(d.data),d}catch(y){throw m.wrapError("Error decrypting message",y)}}function Uc(n){if(!(n instanceof ce))throw Error("Parameter [message] needs to be of type Message")}function b8(n){if(n!=="armored"&&n!=="binary"&&n!=="object")throw Error("Unsupported format "+n)}const m8=Object.keys(W).length;function mi(n){const t=Object.keys(n);if(t.length!==m8){for(const e of t)if(W[e]===void 0)throw Error("Unknown config property: "+e)}}function ie(n){return n&&!m.isArray(n)&&(n=[n]),n}async function Rc(n){return m.isStream(n)==="array"?Dt(n):n}function v8(n,t){n.data=Ir(t.packets.stream,async(e,r)=>{await Or(n.data,r,{preventClose:!0});const i=se(r);try{await Dt(e,s=>s),await i.close()}catch(s){await i.abort(s)}})}function J1(n,t,e){switch(t){case"object":return n;case"armored":return n.armor(e);case"binary":return n.write();default:throw Error("Unsupported format "+t)}}function ii(n){if(!Number.isSafeInteger(n)||n<0)throw Error("positive integer expected, not "+n)}function xn(n,...t){if(!((e=n)instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"))throw Error("Uint8Array expected");var e;if(t.length>0&&!t.includes(n.length))throw Error(`Uint8Array expected of length ${t}, not of length=${n.length}`)}function S0(n,t=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(t&&n.finished)throw Error("Hash#digest() has already been called")}function Qc(n,t){xn(n);const e=t.outputLen;if(n.length<e)throw Error("digestInto() expects output buffer of length at least "+e)}const s0=typeof Ht=="object"&&"crypto"in Ht?Ht.crypto:void 0,qi=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Ee=(n,t)=>n<<32-t|n>>>t,vr=(n,t)=>n<<t|n>>>32-t>>>0,to=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function eo(n){for(let e=0;e<n.length;e++)n[e]=(t=n[e])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;var t}function _c(n){if(typeof n!="string")throw Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array(new TextEncoder().encode(n))}function wn(n){return typeof n=="string"&&(n=_c(n)),xn(n),n}function Lc(...n){let t=0;for(let r=0;r<n.length;r++){const i=n[r];xn(i),t+=i.length}const e=new Uint8Array(t);for(let r=0,i=0;r<n.length;r++){const s=n[r];e.set(s,i),i+=s.length}return e}class _a{clone(){return this._cloneInto()}}function He(n){const t=r=>n().update(wn(r)).digest(),e=n();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>n(),t}function La(n=32){if(s0&&typeof s0.getRandomValues=="function")return s0.getRandomValues(new Uint8Array(n));if(s0&&typeof s0.randomBytes=="function")return s0.randomBytes(n);throw Error("crypto.getRandomValues must be defined")}const Tc=(n,t,e)=>n&t^~n&e,Hc=(n,t,e)=>n&t^n&e^t&e;class bn extends _a{constructor(t,e,r,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=qi(this.buffer)}update(t){S0(this);const{view:e,buffer:r,blockLen:i}=this,s=(t=wn(t)).length;for(let a=0;a<s;){const o=Math.min(i-this.pos,s-a);if(o!==i)r.set(t.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(e,0),this.pos=0);else{const c=qi(t);for(;i<=s-a;a+=i)this.process(c,a)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){S0(this),Qc(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:i,isLE:s}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(r,0),a=0);for(let f=a;f<i;f++)e[f]=0;(function(f,y,d,g){if(typeof f.setBigUint64=="function")return f.setBigUint64(y,d,g);const p=BigInt(32),A=BigInt(4294967295),v=Number(d>>p&A),w=Number(d&A),x=g?4:0,b=g?0:4;f.setUint32(y+x,v,g),f.setUint32(y+b,w,g)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);const o=qi(t),c=this.outputLen;if(c%4)throw Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,u=this.get();if(h>u.length)throw Error("_sha2: outputLen bigger than state");for(let f=0;f<h;f++)o.setUint32(4*f,u[f],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:i,finished:s,destroyed:a,pos:o}=this;return t.length=i,t.pos=o,t.finished=s,t.destroyed=a,i%e&&t.buffer.set(r),t}}const E8=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),cr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),hr=new Uint32Array(64);class Mc extends bn{constructor(){super(64,32,8,!1),this.A=0|cr[0],this.B=0|cr[1],this.C=0|cr[2],this.D=0|cr[3],this.E=0|cr[4],this.F=0|cr[5],this.G=0|cr[6],this.H=0|cr[7]}get(){const{A:t,B:e,C:r,D:i,E:s,F:a,G:o,H:c}=this;return[t,e,r,i,s,a,o,c]}set(t,e,r,i,s,a,o,c){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|a,this.G=0|o,this.H=0|c}process(t,e){for(let f=0;f<16;f++,e+=4)hr[f]=t.getUint32(e,!1);for(let f=16;f<64;f++){const y=hr[f-15],d=hr[f-2],g=Ee(y,7)^Ee(y,18)^y>>>3,p=Ee(d,17)^Ee(d,19)^d>>>10;hr[f]=p+hr[f-7]+g+hr[f-16]|0}let{A:r,B:i,C:s,D:a,E:o,F:c,G:h,H:u}=this;for(let f=0;f<64;f++){const y=u+(Ee(o,6)^Ee(o,11)^Ee(o,25))+Tc(o,c,h)+E8[f]+hr[f]|0,d=(Ee(r,2)^Ee(r,13)^Ee(r,22))+Hc(r,i,s)|0;u=h,h=c,c=o,o=a+y|0,a=s,s=i,i=r,r=y+d|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,h=h+this.G|0,u=u+this.H|0,this.set(r,i,s,a,o,c,h,u)}roundClean(){hr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class B8 extends Mc{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const vi=He(()=>new Mc),k8=He(()=>new B8);class Nc extends _a{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(a){if(typeof a!="function"||typeof a.create!="function")throw Error("Hash should be wrapped by utils.wrapConstructor");ii(a.outputLen),ii(a.blockLen)}(t);const r=wn(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?t.create().update(r).digest():r);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(t){return S0(this),this.iHash.update(t),this}digestInto(t){S0(this),xn(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return t.finished=i,t.destroyed=s,t.blockLen=a,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const zc=(n,t,e)=>new Nc(n,t).update(e).digest();zc.create=(n,t)=>new Nc(n,t);const Ta=BigInt(0),si=BigInt(1),C8=BigInt(2);function jr(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function mn(n){if(!jr(n))throw Error("Uint8Array expected")}function tr(n,t){if(typeof t!="boolean")throw Error(`${n} must be valid boolean, got "${t}".`)}const D8=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));function Vr(n){mn(n);let t="";for(let e=0;e<n.length;e++)t+=D8[n[e]];return t}function g0(n){const t=n.toString(16);return 1&t.length?"0"+t:t}function Ha(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":"0x"+n)}const Ge={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function ro(n){return n>=Ge._0&&n<=Ge._9?n-Ge._0:n>=Ge._A&&n<=Ge._F?n-(Ge._A-10):n>=Ge._a&&n<=Ge._f?n-(Ge._a-10):void 0}function I0(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);const t=n.length,e=t/2;if(t%2)throw Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(e);for(let i=0,s=0;i<e;i++,s+=2){const a=ro(n.charCodeAt(s)),o=ro(n.charCodeAt(s+1));if(a===void 0||o===void 0){const c=n[s]+n[s+1];throw Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=16*a+o}return r}function Nr(n){return Ha(Vr(n))}function kr(n){return mn(n),Ha(Vr(Uint8Array.from(n).reverse()))}function b0(n,t){return I0(n.toString(16).padStart(2*t,"0"))}function K0(n,t){return b0(n,t).reverse()}function vt(n,t,e){let r;if(typeof t=="string")try{r=I0(t)}catch(s){throw Error(`${n} must be valid hex string, got "${t}". Cause: ${s}`)}else{if(!jr(t))throw Error(n+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const i=r.length;if(typeof e=="number"&&i!==e)throw Error(`${n} expected ${e} bytes, got ${i}`);return r}function Yr(...n){let t=0;for(let r=0;r<n.length;r++){const i=n[r];mn(i),t+=i.length}const e=new Uint8Array(t);for(let r=0,i=0;r<n.length;r++){const s=n[r];e.set(s,i),i+=s.length}return e}const Wi=n=>typeof n=="bigint"&&Ta<=n;function Ei(n,t,e){return Wi(n)&&Wi(t)&&Wi(e)&&t<=n&&n<e}function Zt(n,t,e,r){if(!Ei(t,e,r))throw Error(`expected valid ${n}: ${e} <= n < ${r}, got ${typeof t} ${t}`)}function Oc(n){let t;for(t=0;n>Ta;n>>=si,t+=1);return t}const Ma=n=>(C8<<BigInt(n-1))-si,ji=n=>new Uint8Array(n),no=n=>Uint8Array.from(n);function Gc(n,t,e){if(typeof n!="number"||n<2)throw Error("hashLen must be a number");if(typeof t!="number"||t<2)throw Error("qByteLen must be a number");if(typeof e!="function")throw Error("hmacFn must be a function");let r=ji(n),i=ji(n),s=0;const a=()=>{r.fill(1),i.fill(0),s=0},o=(...u)=>e(i,r,...u),c=(u=ji())=>{i=o(no([0]),u),r=o(),u.length!==0&&(i=o(no([1]),u),r=o())},h=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let u=0;const f=[];for(;u<t;){r=o();const y=r.slice();f.push(y),u+=r.length}return Yr(...f)};return(u,f)=>{let y;for(a(),c(u);!(y=f(h()));)c();return a(),y}}const S8={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||jr(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,t)=>t.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function Zr(n,t,e={}){const r=(i,s,a)=>{const o=S8[s];if(typeof o!="function")throw Error(`Invalid validator "${s}", expected function`);const c=n[i];if(!(a&&c===void 0||o(c,n)))throw Error(`Invalid param ${i+""}=${c} (${typeof c}), expected ${s}`)};for(const[i,s]of Object.entries(t))r(i,s,!1);for(const[i,s]of Object.entries(e))r(i,s,!0);return n}function fn(n){const t=new WeakMap;return(e,...r)=>{const i=t.get(e);if(i!==void 0)return i;const s=n(e,...r);return t.set(e,s),s}}var I8=Object.freeze({__proto__:null,aInRange:Zt,abool:tr,abytes:mn,bitGet:function(n,t){return n>>BigInt(t)&si},bitLen:Oc,bitMask:Ma,bitSet:function(n,t,e){return n|(e?si:Ta)<<BigInt(t)},bytesToHex:Vr,bytesToNumberBE:Nr,bytesToNumberLE:kr,concatBytes:Yr,createHmacDrbg:Gc,ensureBytes:vt,equalBytes:function(n,t){if(n.length!==t.length)return!1;let e=0;for(let r=0;r<n.length;r++)e|=n[r]^t[r];return e===0},hexToBytes:I0,hexToNumber:Ha,inRange:Ei,isBytes:jr,memoized:fn,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:b0,numberToBytesLE:K0,numberToHexUnpadded:g0,numberToVarBytesBE:function(n){return I0(g0(n))},utf8ToBytes:function(n){if(typeof n!="string")throw Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array(new TextEncoder().encode(n))},validateObject:Zr});/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const It=BigInt(0),Bt=BigInt(1),Tr=BigInt(2),K8=BigInt(3),Vi=BigInt(4),io=BigInt(5),so=BigInt(8);function bt(n,t){const e=n%t;return e>=It?e:t+e}function qc(n,t,e){if(e<=It||t<It)throw Error("Expected power/modulo > 0");if(e===Bt)return It;let r=Bt;for(;t>It;)t&Bt&&(r=r*n%e),n=n*n%e,t>>=Bt;return r}function wt(n,t,e){let r=n;for(;t-- >It;)r*=r,r%=e;return r}function la(n,t){if(n===It||t<=It)throw Error(`invert: expected positive integers, got n=${n} mod=${t}`);let e=bt(n,t),r=t,i=It,s=Bt;for(;e!==It;){const a=r%e,o=i-s*(r/e);r=e,e=a,i=s,s=o}if(r!==Bt)throw Error("invert: does not exist");return bt(i,t)}function F8(n){if(n%Vi===K8){const t=(n+Bt)/Vi;return function(e,r){const i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}if(n%so===io){const t=(n-io)/so;return function(e,r){const i=e.mul(r,Tr),s=e.pow(i,t),a=e.mul(r,s),o=e.mul(e.mul(a,Tr),s),c=e.mul(a,e.sub(o,e.ONE));if(!e.eql(e.sqr(c),r))throw Error("Cannot find square root");return c}}return function(t){const e=(t-Bt)/Tr;let r,i,s;for(r=t-Bt,i=0;r%Tr===It;r/=Tr,i++);for(s=Tr;s<t&&qc(s,e,t)!==t-Bt;s++);if(i===1){const o=(t+Bt)/Vi;return function(c,h){const u=c.pow(h,o);if(!c.eql(c.sqr(u),h))throw Error("Cannot find square root");return u}}const a=(r+Bt)/Tr;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw Error("Cannot find square root");let h=i,u=o.pow(o.mul(o.ONE,s),r),f=o.pow(c,a),y=o.pow(c,r);for(;!o.eql(y,o.ONE);){if(o.eql(y,o.ZERO))return o.ZERO;let d=1;for(let p=o.sqr(y);d<h&&!o.eql(p,o.ONE);d++)p=o.sqr(p);const g=o.pow(u,Bt<<BigInt(h-d-1));u=o.sqr(g),f=o.mul(f,g),y=o.mul(y,u),h=d}return f}}(n)}BigInt(9),BigInt(16);const P8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Wc(n,t){const e=t!==void 0?t:n.toString(2).length;return{nBitLength:e,nByteLength:Math.ceil(e/8)}}function Me(n,t,e=!1,r={}){if(n<=It)throw Error("Expected Field ORDER > 0, got "+n);const{nBitLength:i,nByteLength:s}=Wc(n,t);if(s>2048)throw Error("Field lengths over 2048 bytes are not supported");const a=F8(n),o=Object.freeze({ORDER:n,BITS:i,BYTES:s,MASK:Ma(i),ZERO:It,ONE:Bt,create:c=>bt(c,n),isValid:c=>{if(typeof c!="bigint")throw Error("Invalid field element: expected bigint, got "+typeof c);return It<=c&&c<n},is0:c=>c===It,isOdd:c=>(c&Bt)===Bt,neg:c=>bt(-c,n),eql:(c,h)=>c===h,sqr:c=>bt(c*c,n),add:(c,h)=>bt(c+h,n),sub:(c,h)=>bt(c-h,n),mul:(c,h)=>bt(c*h,n),pow:(c,h)=>function(u,f,y){if(y<It)throw Error("Expected power > 0");if(y===It)return u.ONE;if(y===Bt)return f;let d=u.ONE,g=f;for(;y>It;)y&Bt&&(d=u.mul(d,g)),g=u.sqr(g),y>>=Bt;return d}(o,c,h),div:(c,h)=>bt(c*la(h,n),n),sqrN:c=>c*c,addN:(c,h)=>c+h,subN:(c,h)=>c-h,mulN:(c,h)=>c*h,inv:c=>la(c,n),sqrt:r.sqrt||(c=>a(o,c)),invertBatch:c=>function(h,u){const f=Array(u.length),y=u.reduce((g,p,A)=>h.is0(p)?g:(f[A]=g,h.mul(g,p)),h.ONE),d=h.inv(y);return u.reduceRight((g,p,A)=>h.is0(p)?g:(f[A]=h.mul(g,f[A]),h.mul(g,p)),d),f}(o,c),cmov:(c,h,u)=>u?h:c,toBytes:c=>e?K0(c,s):b0(c,s),fromBytes:c=>{if(c.length!==s)throw Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return e?kr(c):Nr(c)}});return Object.freeze(o)}function jc(n){if(typeof n!="bigint")throw Error("field order must be bigint");const t=n.toString(2).length;return Math.ceil(t/8)}function ao(n){const t=jc(n);return t+Math.ceil(t/2)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const U8=BigInt(0),Yi=BigInt(1),Zi=new WeakMap,oo=new WeakMap;function Vc(n,t){const e=(s,a)=>{const o=a.negate();return s?o:a},r=s=>{if(!Number.isSafeInteger(s)||s<=0||s>t)throw Error(`Wrong window size=${s}, should be [1..${t}]`)},i=s=>(r(s),{windows:Math.ceil(t/s)+1,windowSize:2**(s-1)});return{constTimeNegate:e,unsafeLadder(s,a){let o=n.ZERO,c=s;for(;a>U8;)a&Yi&&(o=o.add(c)),c=c.double(),a>>=Yi;return o},precomputeWindow(s,a){const{windows:o,windowSize:c}=i(a),h=[];let u=s,f=u;for(let y=0;y<o;y++){f=u,h.push(f);for(let d=1;d<c;d++)f=f.add(u),h.push(f);u=f.double()}return h},wNAF(s,a,o){const{windows:c,windowSize:h}=i(s);let u=n.ZERO,f=n.BASE;const y=BigInt(2**s-1),d=2**s,g=BigInt(s);for(let p=0;p<c;p++){const A=p*h;let v=Number(o&y);o>>=g,v>h&&(v-=d,o+=Yi);const w=A,x=A+Math.abs(v)-1,b=p%2!=0,S=v<0;v===0?f=f.add(e(b,a[w])):u=u.add(e(S,a[x]))}return{p:u,f}},wNAFCached(s,a,o){const c=oo.get(s)||1;let h=Zi.get(s);return h||(h=this.precomputeWindow(s,c),c!==1&&Zi.set(s,o(h))),this.wNAF(c,h,a)},setWindowSize(s,a){r(a),oo.set(s,a),Zi.delete(s)}}}function Yc(n,t,e,r){if(!Array.isArray(e)||!Array.isArray(r)||r.length!==e.length)throw Error("arrays of points and scalars must have equal length");r.forEach((u,f)=>{if(!t.isValid(u))throw Error("wrong scalar at index "+f)}),e.forEach((u,f)=>{if(!(u instanceof n))throw Error("wrong point at index "+f)});const i=Oc(BigInt(e.length)),s=i>12?i-3:i>4?i-2:i?2:1,a=(1<<s)-1,o=Array(a+1).fill(n.ZERO),c=Math.floor((t.BITS-1)/s)*s;let h=n.ZERO;for(let u=c;u>=0;u-=s){o.fill(n.ZERO);for(let y=0;y<r.length;y++){const d=r[y],g=Number(d>>BigInt(u)&BigInt(a));o[g]=o[g].add(e[y])}let f=n.ZERO;for(let y=o.length-1,d=n.ZERO;y>0;y--)d=d.add(o[y]),f=f.add(d);if(h=h.add(f),u!==0)for(let y=0;y<s;y++)h=h.double()}return h}function Na(n){return Zr(n.Fp,P8.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Zr(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Wc(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function co(n){n.lowS!==void 0&&tr("lowS",n.lowS),n.prehash!==void 0&&tr("prehash",n.prehash)}const{bytesToNumberBE:R8,hexToBytes:Q8}=I8,Ye={Err:class extends Error{constructor(n=""){super(n)}},_tlv:{encode:(n,t)=>{const{Err:e}=Ye;if(n<0||n>256)throw new e("tlv.encode: wrong tag");if(1&t.length)throw new e("tlv.encode: unpadded data");const r=t.length/2,i=g0(r);if(i.length/2&128)throw new e("tlv.encode: long form length too big");const s=r>127?g0(i.length/2|128):"";return`${g0(n)}${s}${i}${t}`},decode(n,t){const{Err:e}=Ye;let r=0;if(n<0||n>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[r++]!==n)throw new e("tlv.decode: wrong tlv");const i=t[r++];let s=0;if(128&i){const o=127&i;if(!o)throw new e("tlv.decode(long): indefinite length not supported");if(o>4)throw new e("tlv.decode(long): byte length is too big");const c=t.subarray(r,r+o);if(c.length!==o)throw new e("tlv.decode: length bytes not complete");if(c[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(const h of c)s=s<<8|h;if(r+=o,s<128)throw new e("tlv.decode(long): not minimal encoding")}else s=i;const a=t.subarray(r,r+s);if(a.length!==s)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+s)}}},_int:{encode(n){const{Err:t}=Ye;if(n<Ze)throw new t("integer: negative integers are not allowed");let e=g0(n);if(8&Number.parseInt(e[0],16)&&(e="00"+e),1&e.length)throw new t("unexpected assertion");return e},decode(n){const{Err:t}=Ye;if(128&n[0])throw new t("Invalid signature integer: negative");if(n[0]===0&&!(128&n[1]))throw new t("Invalid signature integer: unnecessary leading zero");return R8(n)}},toSig(n){const{Err:t,_int:e,_tlv:r}=Ye,i=typeof n=="string"?Q8(n):n;mn(i);const{v:s,l:a}=r.decode(48,i);if(a.length)throw new t("Invalid signature: left bytes after parsing");const{v:o,l:c}=r.decode(2,s),{v:h,l:u}=r.decode(2,c);if(u.length)throw new t("Invalid signature: left bytes after parsing");return{r:e.decode(o),s:e.decode(h)}},hexFromSig(n){const{_tlv:t,_int:e}=Ye,r=`${t.encode(2,e.encode(n.r))}${t.encode(2,e.encode(n.s))}`;return t.encode(48,r)}},Ze=BigInt(0),St=BigInt(1);BigInt(2);const ho=BigInt(3);function _8(n){const t=function(g){const p=Na(g);Zr(p,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:A,Fp:v,a:w}=p;if(A){if(!v.eql(w,v.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof A!="object"||typeof A.beta!="bigint"||typeof A.splitScalar!="function")throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...p})}(n),{Fp:e}=t,r=Me(t.n,t.nBitLength),i=t.toBytes||((g,p,A)=>{const v=p.toAffine();return Yr(Uint8Array.from([4]),e.toBytes(v.x),e.toBytes(v.y))}),s=t.fromBytes||(g=>{const p=g.subarray(1);return{x:e.fromBytes(p.subarray(0,e.BYTES)),y:e.fromBytes(p.subarray(e.BYTES,2*e.BYTES))}});function a(g){const{a:p,b:A}=t,v=e.sqr(g),w=e.mul(v,g);return e.add(e.add(w,e.mul(g,p)),A)}if(!e.eql(e.sqr(t.Gy),a(t.Gx)))throw Error("bad generator point: equation left != right");function o(g){const{allowedPrivateKeyLengths:p,nByteLength:A,wrapPrivateKey:v,n:w}=t;if(p&&typeof g!="bigint"){if(jr(g)&&(g=Vr(g)),typeof g!="string"||!p.includes(g.length))throw Error("Invalid key");g=g.padStart(2*A,"0")}let x;try{x=typeof g=="bigint"?g:Nr(vt("private key",g,A))}catch{throw Error(`private key must be ${A} bytes, hex or bigint, not ${typeof g}`)}return v&&(x=bt(x,w)),Zt("private key",x,St,w),x}function c(g){if(!(g instanceof f))throw Error("ProjectivePoint expected")}const h=fn((g,p)=>{const{px:A,py:v,pz:w}=g;if(e.eql(w,e.ONE))return{x:A,y:v};const x=g.is0();p==null&&(p=x?e.ONE:e.inv(w));const b=e.mul(A,p),S=e.mul(v,p),K=e.mul(w,p);if(x)return{x:e.ZERO,y:e.ZERO};if(!e.eql(K,e.ONE))throw Error("invZ was invalid");return{x:b,y:S}}),u=fn(g=>{if(g.is0()){if(t.allowInfinityPoint&&!e.is0(g.py))return;throw Error("bad point: ZERO")}const{x:p,y:A}=g.toAffine();if(!e.isValid(p)||!e.isValid(A))throw Error("bad point: x or y not FE");const v=e.sqr(A),w=a(p);if(!e.eql(v,w))throw Error("bad point: equation left != right");if(!g.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class f{constructor(p,A,v){if(this.px=p,this.py=A,this.pz=v,p==null||!e.isValid(p))throw Error("x required");if(A==null||!e.isValid(A))throw Error("y required");if(v==null||!e.isValid(v))throw Error("z required");Object.freeze(this)}static fromAffine(p){const{x:A,y:v}=p||{};if(!p||!e.isValid(A)||!e.isValid(v))throw Error("invalid affine point");if(p instanceof f)throw Error("projective point not allowed");const w=x=>e.eql(x,e.ZERO);return w(A)&&w(v)?f.ZERO:new f(A,v,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const A=e.invertBatch(p.map(v=>v.pz));return p.map((v,w)=>v.toAffine(A[w])).map(f.fromAffine)}static fromHex(p){const A=f.fromAffine(s(vt("pointHex",p)));return A.assertValidity(),A}static fromPrivateKey(p){return f.BASE.multiply(o(p))}static msm(p,A){return Yc(f,r,p,A)}_setWindowSize(p){d.setWindowSize(this,p)}assertValidity(){u(this)}hasEvenY(){const{y:p}=this.toAffine();if(e.isOdd)return!e.isOdd(p);throw Error("Field doesn't support isOdd")}equals(p){c(p);const{px:A,py:v,pz:w}=this,{px:x,py:b,pz:S}=p,K=e.eql(e.mul(A,S),e.mul(x,w)),F=e.eql(e.mul(v,S),e.mul(b,w));return K&&F}negate(){return new f(this.px,e.neg(this.py),this.pz)}double(){const{a:p,b:A}=t,v=e.mul(A,ho),{px:w,py:x,pz:b}=this;let S=e.ZERO,K=e.ZERO,F=e.ZERO,k=e.mul(w,w),B=e.mul(x,x),E=e.mul(b,b),C=e.mul(w,x);return C=e.add(C,C),F=e.mul(w,b),F=e.add(F,F),S=e.mul(p,F),K=e.mul(v,E),K=e.add(S,K),S=e.sub(B,K),K=e.add(B,K),K=e.mul(S,K),S=e.mul(C,S),F=e.mul(v,F),E=e.mul(p,E),C=e.sub(k,E),C=e.mul(p,C),C=e.add(C,F),F=e.add(k,k),k=e.add(F,k),k=e.add(k,E),k=e.mul(k,C),K=e.add(K,k),E=e.mul(x,b),E=e.add(E,E),k=e.mul(E,C),S=e.sub(S,k),F=e.mul(E,B),F=e.add(F,F),F=e.add(F,F),new f(S,K,F)}add(p){c(p);const{px:A,py:v,pz:w}=this,{px:x,py:b,pz:S}=p;let K=e.ZERO,F=e.ZERO,k=e.ZERO;const B=t.a,E=e.mul(t.b,ho);let C=e.mul(A,x),I=e.mul(v,b),D=e.mul(w,S),P=e.add(A,v),U=e.add(x,b);P=e.mul(P,U),U=e.add(C,I),P=e.sub(P,U),U=e.add(A,w);let T=e.add(x,S);return U=e.mul(U,T),T=e.add(C,D),U=e.sub(U,T),T=e.add(v,w),K=e.add(b,S),T=e.mul(T,K),K=e.add(I,D),T=e.sub(T,K),k=e.mul(B,U),K=e.mul(E,D),k=e.add(K,k),K=e.sub(I,k),k=e.add(I,k),F=e.mul(K,k),I=e.add(C,C),I=e.add(I,C),D=e.mul(B,D),U=e.mul(E,U),I=e.add(I,D),D=e.sub(C,D),D=e.mul(B,D),U=e.add(U,D),C=e.mul(I,U),F=e.add(F,C),C=e.mul(T,U),K=e.mul(P,K),K=e.sub(K,C),C=e.mul(P,I),k=e.mul(T,k),k=e.add(k,C),new f(K,F,k)}subtract(p){return this.add(p.negate())}is0(){return this.equals(f.ZERO)}wNAF(p){return d.wNAFCached(this,p,f.normalizeZ)}multiplyUnsafe(p){Zt("scalar",p,Ze,t.n);const A=f.ZERO;if(p===Ze)return A;if(p===St)return this;const{endo:v}=t;if(!v)return d.unsafeLadder(this,p);let{k1neg:w,k1:x,k2neg:b,k2:S}=v.splitScalar(p),K=A,F=A,k=this;for(;x>Ze||S>Ze;)x&St&&(K=K.add(k)),S&St&&(F=F.add(k)),k=k.double(),x>>=St,S>>=St;return w&&(K=K.negate()),b&&(F=F.negate()),F=new f(e.mul(F.px,v.beta),F.py,F.pz),K.add(F)}multiply(p){const{endo:A,n:v}=t;let w,x;if(Zt("scalar",p,St,v),A){const{k1neg:b,k1:S,k2neg:K,k2:F}=A.splitScalar(p);let{p:k,f:B}=this.wNAF(S),{p:E,f:C}=this.wNAF(F);k=d.constTimeNegate(b,k),E=d.constTimeNegate(K,E),E=new f(e.mul(E.px,A.beta),E.py,E.pz),w=k.add(E),x=B.add(C)}else{const{p:b,f:S}=this.wNAF(p);w=b,x=S}return f.normalizeZ([w,x])[0]}multiplyAndAddUnsafe(p,A,v){const w=f.BASE,x=(S,K)=>K!==Ze&&K!==St&&S.equals(w)?S.multiply(K):S.multiplyUnsafe(K),b=x(this,A).add(x(p,v));return b.is0()?void 0:b}toAffine(p){return h(this,p)}isTorsionFree(){const{h:p,isTorsionFree:A}=t;if(p===St)return!0;if(A)return A(f,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:A}=t;return p===St?this:A?A(f,this):this.multiplyUnsafe(t.h)}toRawBytes(p=!0){return tr("isCompressed",p),this.assertValidity(),i(f,this,p)}toHex(p=!0){return tr("isCompressed",p),Vr(this.toRawBytes(p))}}f.BASE=new f(t.Gx,t.Gy,e.ONE),f.ZERO=new f(e.ZERO,e.ONE,e.ZERO);const y=t.nBitLength,d=Vc(f,t.endo?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:o,weierstrassEquation:a,isWithinCurveOrder:function(g){return Ei(g,St,t.n)}}}function L8(n){const t=function(B){const E=Na(B);return Zr(E,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...E})}(n),{Fp:e,n:r}=t,i=e.BYTES+1,s=2*e.BYTES+1;function a(B){return bt(B,r)}function o(B){return la(B,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:h,weierstrassEquation:u,isWithinCurveOrder:f}=_8({...t,toBytes(B,E,C){const I=E.toAffine(),D=e.toBytes(I.x),P=Yr;return tr("isCompressed",C),C?P(Uint8Array.from([E.hasEvenY()?2:3]),D):P(Uint8Array.from([4]),D,e.toBytes(I.y))},fromBytes(B){const E=B.length,C=B[0],I=B.subarray(1);if(E!==i||C!==2&&C!==3){if(E===s&&C===4)return{x:e.fromBytes(I.subarray(0,e.BYTES)),y:e.fromBytes(I.subarray(e.BYTES,2*e.BYTES))};throw Error(`Point of length ${E} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}{const D=Nr(I);if(!Ei(D,St,e.ORDER))throw Error("Point is not on curve");const P=u(D);let U;try{U=e.sqrt(P)}catch(T){const M=T instanceof Error?": "+T.message:"";throw Error("Point is not on curve"+M)}return!(1&~C)!=((U&St)===St)&&(U=e.neg(U)),{x:D,y:U}}}}),y=B=>Vr(b0(B,t.nByteLength));function d(B){return B>r>>St}const g=(B,E,C)=>Nr(B.slice(E,C));class p{constructor(E,C,I){this.r=E,this.s=C,this.recovery=I,this.assertValidity()}static fromCompact(E){const C=t.nByteLength;return E=vt("compactSignature",E,2*C),new p(g(E,0,C),g(E,C,2*C))}static fromDER(E){const{r:C,s:I}=Ye.toSig(vt("DER",E));return new p(C,I)}assertValidity(){Zt("r",this.r,St,r),Zt("s",this.s,St,r)}addRecoveryBit(E){return new p(this.r,this.s,E)}recoverPublicKey(E){const{r:C,s:I,recovery:D}=this,P=x(vt("msgHash",E));if(D==null||![0,1,2,3].includes(D))throw Error("recovery id invalid");const U=D===2||D===3?C+t.n:C;if(U>=e.ORDER)throw Error("recovery id 2 or 3 invalid");const T=1&D?"03":"02",M=c.fromHex(T+y(U)),z=o(U),O=a(-P*z),H=a(I*z),R=c.BASE.multiplyAndAddUnsafe(M,O,H);if(!R)throw Error("point at infinify");return R.assertValidity(),R}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return I0(this.toDERHex())}toDERHex(){return Ye.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return I0(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const A={isValidPrivateKey(B){try{return h(B),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const B=ao(t.n);return function(E,C,I=!1){const D=E.length,P=jc(C),U=ao(C);if(D<16||D<U||D>1024)throw Error(`expected ${U}-1024 bytes of input, got ${D}`);const T=bt(I?Nr(E):kr(E),C-Bt)+Bt;return I?K0(T,P):b0(T,P)}(t.randomBytes(B),t.n)},precompute:(B=8,E=c.BASE)=>(E._setWindowSize(B),E.multiply(BigInt(3)),E)};function v(B){const E=jr(B),C=typeof B=="string",I=(E||C)&&B.length;return E?I===i||I===s:C?I===2*i||I===2*s:B instanceof c}const w=t.bits2int||function(B){const E=Nr(B),C=8*B.length-t.nBitLength;return C>0?E>>BigInt(C):E},x=t.bits2int_modN||function(B){return a(w(B))},b=Ma(t.nBitLength);function S(B){return Zt("num < 2^"+t.nBitLength,B,Ze,b),b0(B,t.nByteLength)}function K(B,E,C=F){if(["recovered","canonical"].some(Q=>Q in C))throw Error("sign() legacy options not supported");const{hash:I,randomBytes:D}=t;let{lowS:P,prehash:U,extraEntropy:T}=C;P==null&&(P=!0),B=vt("msgHash",B),co(C),U&&(B=vt("prehashed msgHash",I(B)));const M=x(B),z=h(E),O=[S(z),S(M)];if(T!=null&&T!==!1){const Q=T===!0?D(e.BYTES):T;O.push(vt("extraEntropy",Q))}const H=Yr(...O),R=M;return{seed:H,k2sig:function(Q){const L=w(Q);if(!f(L))return;const _=o(L),G=c.BASE.multiply(L).toAffine(),N=a(G.x);if(N===Ze)return;const j=a(_*a(R+N*z));if(j===Ze)return;let q=(G.x===N?0:2)|Number(G.y&St),$=j;return P&&d(j)&&($=function(Z){return d(Z)?a(-Z):Z}(j),q^=1),new p(N,$,q)}}}const F={lowS:t.lowS,prehash:!1},k={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(B,E=!0){return c.fromPrivateKey(B).toRawBytes(E)},getSharedSecret:function(B,E,C=!0){if(v(B))throw Error("first arg must be private key");if(!v(E))throw Error("second arg must be public key");return c.fromHex(E).multiply(h(B)).toRawBytes(C)},sign:function(B,E,C=F){const{seed:I,k2sig:D}=K(B,E,C),P=t;return Gc(P.hash.outputLen,P.nByteLength,P.hmac)(I,D)},verify:function(B,E,C,I=k){var G;const D=B;if(E=vt("msgHash",E),C=vt("publicKey",C),"strict"in I)throw Error("options.strict was renamed to lowS");co(I);const{lowS:P,prehash:U}=I;let T,M;try{if(typeof D=="string"||jr(D))try{T=p.fromDER(D)}catch(N){if(!(N instanceof Ye.Err))throw N;T=p.fromCompact(D)}else{if(typeof D!="object"||typeof D.r!="bigint"||typeof D.s!="bigint")throw Error("PARSE");{const{r:N,s:j}=D;T=new p(N,j)}}M=c.fromHex(C)}catch(N){if(N.message==="PARSE")throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(P&&T.hasHighS())return!1;U&&(E=t.hash(E));const{r:z,s:O}=T,H=x(E),R=o(O),Q=a(H*R),L=a(z*R),_=(G=c.BASE.multiplyAndAddUnsafe(M,Q,L))==null?void 0:G.toAffine();return!!_&&a(_.x)===z},ProjectivePoint:c,Signature:p,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function T8(n){return{hash:n,hmac:(t,...e)=>zc(n,t,Lc(...e)),randomBytes:La}}function $r(n,t){const e=r=>L8({...n,...T8(r)});return Object.freeze({...e(t),create:e})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(4);const uo=Me(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),H8=$r({a:uo.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:uo,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},vi),In=BigInt(2**32-1),ya=BigInt(32);function Zc(n,t=!1){return t?{h:Number(n&In),l:Number(n>>ya&In)}:{h:0|Number(n>>ya&In),l:0|Number(n&In)}}function Xc(n,t=!1){let e=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){const{h:s,l:a}=Zc(n[i],t);[e[i],r[i]]=[s,a]}return[e,r]}const $c=(n,t,e)=>n<<e|t>>>32-e,Jc=(n,t,e)=>t<<e|n>>>32-e,t3=(n,t,e)=>t<<e-32|n>>>64-e,e3=(n,t,e)=>n<<e-32|t>>>64-e,J={fromBig:Zc,split:Xc,toBig:(n,t)=>BigInt(n>>>0)<<ya|BigInt(t>>>0),shrSH:(n,t,e)=>n>>>e,shrSL:(n,t,e)=>n<<32-e|t>>>e,rotrSH:(n,t,e)=>n>>>e|t<<32-e,rotrSL:(n,t,e)=>n<<32-e|t>>>e,rotrBH:(n,t,e)=>n<<64-e|t>>>e-32,rotrBL:(n,t,e)=>n>>>e-32|t<<64-e,rotr32H:(n,t)=>t,rotr32L:(n,t)=>n,rotlSH:$c,rotlSL:Jc,rotlBH:t3,rotlBL:e3,add:function(n,t,e,r){const i=(t>>>0)+(r>>>0);return{h:n+e+(i/2**32|0)|0,l:0|i}},add3L:(n,t,e)=>(n>>>0)+(t>>>0)+(e>>>0),add3H:(n,t,e,r)=>t+e+r+(n/2**32|0)|0,add4L:(n,t,e,r)=>(n>>>0)+(t>>>0)+(e>>>0)+(r>>>0),add4H:(n,t,e,r,i)=>t+e+r+i+(n/2**32|0)|0,add5H:(n,t,e,r,i,s)=>t+e+r+i+s+(n/2**32|0)|0,add5L:(n,t,e,r,i)=>(n>>>0)+(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)},[M8,N8]=(()=>J.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))))(),ur=new Uint32Array(80),fr=new Uint32Array(80);class r3 extends bn{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:h,El:u,Fh:f,Fl:y,Gh:d,Gl:g,Hh:p,Hl:A}=this;return[t,e,r,i,s,a,o,c,h,u,f,y,d,g,p,A]}set(t,e,r,i,s,a,o,c,h,u,f,y,d,g,p,A){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|i,this.Ch=0|s,this.Cl=0|a,this.Dh=0|o,this.Dl=0|c,this.Eh=0|h,this.El=0|u,this.Fh=0|f,this.Fl=0|y,this.Gh=0|d,this.Gl=0|g,this.Hh=0|p,this.Hl=0|A}process(t,e){for(let x=0;x<16;x++,e+=4)ur[x]=t.getUint32(e),fr[x]=t.getUint32(e+=4);for(let x=16;x<80;x++){const b=0|ur[x-15],S=0|fr[x-15],K=J.rotrSH(b,S,1)^J.rotrSH(b,S,8)^J.shrSH(b,S,7),F=J.rotrSL(b,S,1)^J.rotrSL(b,S,8)^J.shrSL(b,S,7),k=0|ur[x-2],B=0|fr[x-2],E=J.rotrSH(k,B,19)^J.rotrBH(k,B,61)^J.shrSH(k,B,6),C=J.rotrSL(k,B,19)^J.rotrBL(k,B,61)^J.shrSL(k,B,6),I=J.add4L(F,C,fr[x-7],fr[x-16]),D=J.add4H(I,K,E,ur[x-7],ur[x-16]);ur[x]=0|D,fr[x]=0|I}let{Ah:r,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:h,Dl:u,Eh:f,El:y,Fh:d,Fl:g,Gh:p,Gl:A,Hh:v,Hl:w}=this;for(let x=0;x<80;x++){const b=J.rotrSH(f,y,14)^J.rotrSH(f,y,18)^J.rotrBH(f,y,41),S=J.rotrSL(f,y,14)^J.rotrSL(f,y,18)^J.rotrBL(f,y,41),K=f&d^~f&p,F=y&g^~y&A,k=J.add5L(w,S,F,N8[x],fr[x]),B=J.add5H(k,v,b,K,M8[x],ur[x]),E=0|k,C=J.rotrSH(r,i,28)^J.rotrBH(r,i,34)^J.rotrBH(r,i,39),I=J.rotrSL(r,i,28)^J.rotrBL(r,i,34)^J.rotrBL(r,i,39),D=r&s^r&o^s&o,P=i&a^i&c^a&c;v=0|p,w=0|A,p=0|d,A=0|g,d=0|f,g=0|y,{h:f,l:y}=J.add(0|h,0|u,0|B,0|E),h=0|o,u=0|c,o=0|s,c=0|a,s=0|r,a=0|i;const U=J.add3L(E,I,P);r=J.add3H(U,B,C,D),i=0|U}({h:r,l:i}=J.add(0|this.Ah,0|this.Al,0|r,0|i)),{h:s,l:a}=J.add(0|this.Bh,0|this.Bl,0|s,0|a),{h:o,l:c}=J.add(0|this.Ch,0|this.Cl,0|o,0|c),{h,l:u}=J.add(0|this.Dh,0|this.Dl,0|h,0|u),{h:f,l:y}=J.add(0|this.Eh,0|this.El,0|f,0|y),{h:d,l:g}=J.add(0|this.Fh,0|this.Fl,0|d,0|g),{h:p,l:A}=J.add(0|this.Gh,0|this.Gl,0|p,0|A),{h:v,l:w}=J.add(0|this.Hh,0|this.Hl,0|v,0|w),this.set(r,i,s,a,o,c,h,u,f,y,d,g,p,A,v,w)}roundClean(){ur.fill(0),fr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class z8 extends r3{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const za=He(()=>new r3),Oa=He(()=>new z8),fo=Me(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),O8=$r({a:fo.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:fo,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},Oa),da=Me(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),a0={a:da.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:da,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},G8=$r({a:a0.a,b:a0.b,Fp:da,n:a0.n,Gx:a0.Gx,Gy:a0.Gy,h:a0.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},za),n3=[],i3=[],s3=[],q8=BigInt(0),H0=BigInt(1),W8=BigInt(2),j8=BigInt(7),V8=BigInt(256),Y8=BigInt(113);for(let n=0,t=H0,e=1,r=0;n<24;n++){[e,r]=[r,(2*e+3*r)%5],n3.push(2*(5*r+e)),i3.push((n+1)*(n+2)/2%64);let i=q8;for(let s=0;s<7;s++)t=(t<<H0^(t>>j8)*Y8)%V8,t&W8&&(i^=H0<<(H0<<BigInt(s))-H0);s3.push(i)}const[Z8,X8]=Xc(s3,!0),lo=(n,t,e)=>e>32?t3(n,t,e):$c(n,t,e),yo=(n,t,e)=>e>32?e3(n,t,e):Jc(n,t,e);class Bi extends _a{constructor(t,e,r,i=!1,s=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ii(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");var a;this.state=new Uint8Array(200),this.state32=(a=this.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)))}keccak(){to||eo(this.state32),function(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,h=(o+2)%10,u=r[h],f=r[h+1],y=lo(u,f,1)^r[c],d=yo(u,f,1)^r[c+1];for(let g=0;g<50;g+=10)t[o+g]^=y,t[o+g+1]^=d}let s=t[2],a=t[3];for(let o=0;o<24;o++){const c=i3[o],h=lo(s,a,c),u=yo(s,a,c),f=n3[o];s=t[f],a=t[f+1],t[f]=h,t[f+1]=u}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)r[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~r[(c+2)%10]&r[(c+4)%10]}t[0]^=Z8[i],t[1]^=X8[i]}r.fill(0)}(this.state32,this.rounds),to||eo(this.state32),this.posOut=0,this.pos=0}update(t){S0(this);const{blockLen:e,state:r}=this,i=(t=wn(t)).length;for(let s=0;s<i;){const a=Math.min(e-this.pos,i-s);for(let o=0;o<a;o++)r[this.pos++]^=t[s++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:r,blockLen:i}=this;t[r]^=e,128&e&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){S0(this,!1),xn(t),this.finish();const e=this.state,{blockLen:r}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.keccak();const a=Math.min(r-this.posOut,s-i);t.set(e.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return ii(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Qc(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:r,outputLen:i,rounds:s,enableXOF:a}=this;return t||(t=new Bi(e,r,i,a,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=i,t.enableXOF=a,t.destroyed=this.destroyed,t}}const a3=(n,t,e)=>He(()=>new Bi(t,n,e)),$8=a3(6,136,32),J8=a3(6,72,64),o3=((n,t,e)=>function(r){const i=(a,o)=>r(o).update(wn(a)).digest(),s=r({});return i.outputLen=s.outputLen,i.blockLen=s.blockLen,i.create=a=>r(a),i}((r={})=>new Bi(t,n,r.dkLen===void 0?e:r.dkLen,!0)))(31,136,32),Ae=BigInt(0),qt=BigInt(1),Kn=BigInt(2),t5=BigInt(8),e5={zip215:!0};function r5(n){const t=function(I){const D=Na(I);return Zr(I,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...D})}(n),{Fp:e,n:r,prehash:i,hash:s,randomBytes:a,nByteLength:o,h:c}=t,h=Kn<<BigInt(8*o)-qt,u=e.create,f=Me(t.n,t.nBitLength),y=t.uvRatio||((I,D)=>{try{return{isValid:!0,value:e.sqrt(I*e.inv(D))}}catch{return{isValid:!1,value:Ae}}}),d=t.adjustScalarBytes||(I=>I),g=t.domain||((I,D,P)=>{if(tr("phflag",P),D.length||P)throw Error("Contexts/pre-hash are not supported");return I});function p(I,D){Zt("coordinate "+I,D,Ae,h)}function A(I){if(!(I instanceof x))throw Error("ExtendedPoint expected")}const v=fn((I,D)=>{const{ex:P,ey:U,ez:T}=I,M=I.is0();D==null&&(D=M?t5:e.inv(T));const z=u(P*D),O=u(U*D),H=u(T*D);if(M)return{x:Ae,y:qt};if(H!==qt)throw Error("invZ was invalid");return{x:z,y:O}}),w=fn(I=>{const{a:D,d:P}=t;if(I.is0())throw Error("bad point: ZERO");const{ex:U,ey:T,ez:M,et:z}=I,O=u(U*U),H=u(T*T),R=u(M*M),Q=u(R*R),L=u(O*D);if(u(R*u(L+H))!==u(Q+u(P*u(O*H))))throw Error("bad point: equation left != right (1)");if(u(U*T)!==u(M*z))throw Error("bad point: equation left != right (2)");return!0});class x{constructor(D,P,U,T){this.ex=D,this.ey=P,this.ez=U,this.et=T,p("x",D),p("y",P),p("z",U),p("t",T),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(D){if(D instanceof x)throw Error("extended point not allowed");const{x:P,y:U}=D||{};return p("x",P),p("y",U),new x(P,U,qt,u(P*U))}static normalizeZ(D){const P=e.invertBatch(D.map(U=>U.ez));return D.map((U,T)=>U.toAffine(P[T])).map(x.fromAffine)}static msm(D,P){return Yc(x,f,D,P)}_setWindowSize(D){K.setWindowSize(this,D)}assertValidity(){w(this)}equals(D){A(D);const{ex:P,ey:U,ez:T}=this,{ex:M,ey:z,ez:O}=D,H=u(P*O),R=u(M*T),Q=u(U*O),L=u(z*T);return H===R&&Q===L}is0(){return this.equals(x.ZERO)}negate(){return new x(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:D}=t,{ex:P,ey:U,ez:T}=this,M=u(P*P),z=u(U*U),O=u(Kn*u(T*T)),H=u(D*M),R=P+U,Q=u(u(R*R)-M-z),L=H+z,_=L-O,G=H-z,N=u(Q*_),j=u(L*G),q=u(Q*G),$=u(_*L);return new x(N,j,$,q)}add(D){A(D);const{a:P,d:U}=t,{ex:T,ey:M,ez:z,et:O}=this,{ex:H,ey:R,ez:Q,et:L}=D;if(P===BigInt(-1)){const ye=u((M-T)*(R+H)),de=u((M+T)*(R-H)),Ne=u(de-ye);if(Ne===Ae)return this.double();const e0=u(z*Kn*L),sr=u(O*Kn*Q),Gt=sr+e0,Nt=de+ye,pe=sr-e0,r0=u(Gt*Ne),vn=u(Nt*pe),ar=u(Gt*pe),Pr=u(Ne*Nt);return new x(r0,vn,Pr,ar)}const _=u(T*H),G=u(M*R),N=u(O*U*L),j=u(z*Q),q=u((T+M)*(H+R)-_-G),$=j-N,Z=j+N,at=u(G-P*_),ot=u(q*$),it=u(Z*at),et=u(q*at),yt=u($*Z);return new x(ot,it,yt,et)}subtract(D){return this.add(D.negate())}wNAF(D){return K.wNAFCached(this,D,x.normalizeZ)}multiply(D){const P=D;Zt("scalar",P,qt,r);const{p:U,f:T}=this.wNAF(P);return x.normalizeZ([U,T])[0]}multiplyUnsafe(D){const P=D;return Zt("scalar",P,Ae,r),P===Ae?S:this.equals(S)||P===qt?this:this.equals(b)?this.wNAF(P).p:K.unsafeLadder(this,P)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return K.unsafeLadder(this,r).is0()}toAffine(D){return v(this,D)}clearCofactor(){const{h:D}=t;return D===qt?this:this.multiplyUnsafe(D)}static fromHex(D,P=!1){const{d:U,a:T}=t,M=e.BYTES;D=vt("pointHex",D,M),tr("zip215",P);const z=D.slice(),O=D[M-1];z[M-1]=-129&O;const H=kr(z),R=P?h:e.ORDER;Zt("pointHex.y",H,Ae,R);const Q=u(H*H),L=u(Q-qt),_=u(U*Q-T);let{isValid:G,value:N}=y(L,_);if(!G)throw Error("Point.fromHex: invalid y coordinate");const j=(N&qt)===qt,q=!!(128&O);if(!P&&N===Ae&&q)throw Error("Point.fromHex: x=0 and x_0=1");return q!==j&&(N=u(-N)),x.fromAffine({x:N,y:H})}static fromPrivateKey(D){return B(D).point}toRawBytes(){const{x:D,y:P}=this.toAffine(),U=K0(P,e.BYTES);return U[U.length-1]|=D&qt?128:0,U}toHex(){return Vr(this.toRawBytes())}}x.BASE=new x(t.Gx,t.Gy,qt,u(t.Gx*t.Gy)),x.ZERO=new x(Ae,qt,qt,Ae);const{BASE:b,ZERO:S}=x,K=Vc(x,8*o);function F(I){return bt(I,r)}function k(I){return F(kr(I))}function B(I){const D=o;I=vt("private key",I,D);const P=vt("hashed private key",s(I),2*D),U=d(P.slice(0,D)),T=P.slice(D,2*D),M=k(U),z=b.multiply(M),O=z.toRawBytes();return{head:U,prefix:T,scalar:M,point:z,pointBytes:O}}function E(I=new Uint8Array,...D){const P=Yr(...D);return k(s(g(P,vt("context",I),!!i)))}const C=e5;return b._setWindowSize(8),{CURVE:t,getPublicKey:function(I){return B(I).pointBytes},sign:function(I,D,P={}){I=vt("message",I),i&&(I=i(I));const{prefix:U,scalar:T,pointBytes:M}=B(D),z=E(P.context,U,I),O=b.multiply(z).toRawBytes(),H=F(z+E(P.context,O,M,I)*T);return Zt("signature.s",H,Ae,r),vt("result",Yr(O,K0(H,e.BYTES)),2*o)},verify:function(I,D,P,U=C){const{context:T,zip215:M}=U,z=e.BYTES;I=vt("signature",I,2*z),D=vt("message",D),M!==void 0&&tr("zip215",M),i&&(D=i(D));const O=kr(I.slice(z,2*z));let H,R,Q;try{H=x.fromHex(P,M),R=x.fromHex(I.slice(0,z),M),Q=b.multiplyUnsafe(O)}catch{return!1}if(!M&&H.isSmallOrder())return!1;const L=E(T,R.toRawBytes(),H.toRawBytes(),D);return R.add(H.multiplyUnsafe(L)).subtract(Q).clearCofactor().equals(x.ZERO)},ExtendedPoint:x,utils:{getExtendedPublicKey:B,randomPrivateKey:()=>a(e.BYTES),precompute:(I=8,D=x.BASE)=>(D._setWindowSize(I),D.multiply(BigInt(3)),D)}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const o0=BigInt(0),Xi=BigInt(1);function n5(n){const t=(Zr(e=n,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e}));var e;const{P:r}=t,i=A=>bt(A,r),s=t.montgomeryBits,a=Math.ceil(s/8),o=t.nByteLength,c=t.adjustScalarBytes||(A=>A),h=t.powPminus2||(A=>qc(A,r-BigInt(2),r));function u(A,v,w){const x=i(A*(v-w));return[v=i(v-x),w=i(w+x)]}const f=(t.a-BigInt(2))/BigInt(4);function y(A){return K0(i(A),a)}function d(A,v){const w=function(S){const K=vt("u coordinate",S,a);return o===32&&(K[31]&=127),kr(K)}(v),x=function(S){const K=vt("scalar",S),F=K.length;if(F!==a&&F!==o)throw Error(`Expected ${a} or ${o} bytes, got ${F}`);return kr(c(K))}(A),b=function(S,K){Zt("u",S,o0,r),Zt("scalar",K,o0,r);const F=K,k=S;let B,E=Xi,C=o0,I=S,D=Xi,P=o0;for(let T=BigInt(s-1);T>=o0;T--){const M=F>>T&Xi;P^=M,B=u(P,E,I),E=B[0],I=B[1],B=u(P,C,D),C=B[0],D=B[1],P=M;const z=E+C,O=i(z*z),H=E-C,R=i(H*H),Q=O-R,L=I+D,_=i((I-D)*z),G=i(L*H),N=_+G,j=_-G;I=i(N*N),D=i(k*i(j*j)),E=i(O*R),C=i(Q*(O+i(f*Q)))}B=u(P,E,I),E=B[0],I=B[1],B=u(P,C,D),C=B[0],D=B[1];const U=h(C);return i(E*U)}(w,x);if(b===o0)throw Error("Invalid private or public key received");return y(b)}const g=y(t.Gu);function p(A){return d(A,g)}return{scalarMult:d,scalarMultBase:p,getSharedSecret:(A,v)=>d(A,v),getPublicKey:A=>p(A),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:g}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const i5=He(()=>o3.create({dkLen:114})),ln=(He(()=>o3.create({dkLen:64})),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),s5=BigInt(1),po=BigInt(2),go=BigInt(3);BigInt(4);const a5=BigInt(11),o5=BigInt(22),Ao=BigInt(44),c5=BigInt(88),h5=BigInt(223);function c3(n){const t=ln,e=n*n*n%t,r=e*e*n%t,i=wt(r,go,t)*r%t,s=wt(i,go,t)*r%t,a=wt(s,po,t)*e%t,o=wt(a,a5,t)*a%t,c=wt(o,o5,t)*o%t,h=wt(c,Ao,t)*c%t,u=wt(h,c5,t)*h%t,f=wt(u,Ao,t)*c%t,y=wt(f,po,t)*e%t,d=wt(y,s5,t)*n%t;return wt(d,h5,t)*y%t}function h3(n){return n[0]&=252,n[55]|=128,n[56]=0,n}const u3=Me(ln,456,!0),u5={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:u3,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:i5,randomBytes:La,adjustScalarBytes:h3,domain:(n,t,e)=>{if(t.length>255)throw Error("Context is too big: "+t.length);return Lc(_c("SigEd448"),new Uint8Array([e?1:0,t.length]),t,n)},uvRatio:function(n,t){const e=ln,r=bt(n*n*t,e),i=bt(r*n,e),s=bt(i*r*t,e),a=bt(i*c3(s),e),o=bt(a*a,e);return{isValid:bt(o*t,e)===n,value:a}}},f5=r5(u5),l5=(()=>n5({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:ln,Gu:BigInt(5),powPminus2:n=>{const t=ln;return bt(wt(c3(n),BigInt(2),t)*n,t)},adjustScalarBytes:h3,randomBytes:La}))();u3.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xo=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),wo=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),y5=BigInt(1),pa=BigInt(2),bo=(n,t)=>(n+t/pa)/t,ga=Me(xo,void 0,void 0,{sqrt:function(n){const t=xo,e=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),h=n*n*n%t,u=h*h*n%t,f=wt(u,e,t)*u%t,y=wt(f,e,t)*u%t,d=wt(y,pa,t)*h%t,g=wt(d,i,t)*d%t,p=wt(g,s,t)*g%t,A=wt(p,o,t)*p%t,v=wt(A,c,t)*A%t,w=wt(v,o,t)*p%t,x=wt(w,e,t)*u%t,b=wt(x,a,t)*g%t,S=wt(b,r,t)*h%t,K=wt(S,pa,t);if(!ga.eql(ga.sqr(K),n))throw Error("Cannot find square root");return K}}),f3=$r({a:BigInt(0),b:BigInt(7),Fp:ga,n:wo,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const t=wo,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-y5*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,a=BigInt("0x100000000000000000000000000000000"),o=bo(s*n,t),c=bo(-r*n,t);let h=bt(n-o*e-c*i,t),u=bt(-o*r-c*s,t);const f=h>a,y=u>a;if(f&&(h=t-h),y&&(u=t-u),h>a||u>a)throw Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:f,k1:h,k2neg:y,k2:u}}}},vi);BigInt(0),f3.ProjectivePoint;const mo=Me(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),d5=$r({a:mo.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:mo,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},vi),vo=Me(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),p5=$r({a:vo.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:vo,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},Oa),Eo=Me(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),g5=$r({a:Eo.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:Eo,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},za),A5=new Map(Object.entries({nistP256:H8,nistP384:O8,nistP521:G8,brainpoolP256r1:d5,brainpoolP384r1:p5,brainpoolP512r1:g5,secp256k1:f3,x448:l5,ed448:f5}));var x5=Object.freeze({__proto__:null,nobleCurves:A5});const M0=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),lr=new Uint32Array(80);class w5 extends bn{constructor(){super(64,20,8,!1),this.A=0|M0[0],this.B=0|M0[1],this.C=0|M0[2],this.D=0|M0[3],this.E=0|M0[4]}get(){const{A:t,B:e,C:r,D:i,E:s}=this;return[t,e,r,i,s]}set(t,e,r,i,s){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|s}process(t,e){for(let c=0;c<16;c++,e+=4)lr[c]=t.getUint32(e,!1);for(let c=16;c<80;c++)lr[c]=vr(lr[c-3]^lr[c-8]^lr[c-14]^lr[c-16],1);let{A:r,B:i,C:s,D:a,E:o}=this;for(let c=0;c<80;c++){let h,u;c<20?(h=Tc(i,s,a),u=1518500249):c<40?(h=i^s^a,u=1859775393):c<60?(h=Hc(i,s,a),u=2400959708):(h=i^s^a,u=3395469782);const f=vr(r,5)+h+o+u+lr[c]|0;o=a,a=s,s=vr(i,30),i=r,r=f}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,this.set(r,i,s,a,o)}roundClean(){lr.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const b5=He(()=>new w5),m5=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),l3=new Uint8Array(Array(16).fill(0).map((n,t)=>t)),v5=l3.map(n=>(9*n+5)%16);let Ga=[l3],qa=[v5];for(let n=0;n<4;n++)for(let t of[Ga,qa])t.push(t[n].map(e=>m5[e]));const y3=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(n=>new Uint8Array(n)),E5=Ga.map((n,t)=>n.map(e=>y3[t][e])),B5=qa.map((n,t)=>n.map(e=>y3[t][e])),k5=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),C5=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function Bo(n,t,e,r){return n===0?t^e^r:n===1?t&e|~t&r:n===2?(t|~e)^r:n===3?t&r|e&~r:t^(e|~r)}const Fn=new Uint32Array(16);class D5 extends bn{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:r,h3:i,h4:s}=this;return[t,e,r,i,s]}set(t,e,r,i,s){this.h0=0|t,this.h1=0|e,this.h2=0|r,this.h3=0|i,this.h4=0|s}process(t,e){for(let d=0;d<16;d++,e+=4)Fn[d]=t.getUint32(e,!0);let r=0|this.h0,i=r,s=0|this.h1,a=s,o=0|this.h2,c=o,h=0|this.h3,u=h,f=0|this.h4,y=f;for(let d=0;d<5;d++){const g=4-d,p=k5[d],A=C5[d],v=Ga[d],w=qa[d],x=E5[d],b=B5[d];for(let S=0;S<16;S++){const K=vr(r+Bo(d,s,o,h)+Fn[v[S]]+p,x[S])+f|0;r=f,f=h,h=0|vr(o,10),o=s,s=K}for(let S=0;S<16;S++){const K=vr(i+Bo(g,a,c,u)+Fn[w[S]]+A,b[S])+y|0;i=y,y=u,u=0|vr(c,10),c=a,a=K}}this.set(this.h1+o+u|0,this.h2+h+y|0,this.h3+f+i|0,this.h4+r+a|0,this.h0+s+c|0)}roundClean(){Fn.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const S5=He(()=>new D5),I5=Array.from({length:64},(n,t)=>Math.floor(2**32*Math.abs(Math.sin(t+1)))),ko=(n,t,e)=>n&t^~n&e,Pn=new Uint32Array([1732584193,4023233417,2562383102,271733878]),$i=new Uint32Array(16);class K5 extends bn{constructor(){super(64,16,8,!0),this.A=0|Pn[0],this.B=0|Pn[1],this.C=0|Pn[2],this.D=0|Pn[3]}get(){const{A:t,B:e,C:r,D:i}=this;return[t,e,r,i]}set(t,e,r,i){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|i}process(t,e){for(let o=0;o<16;o++,e+=4)$i[o]=t.getUint32(e,!0);let{A:r,B:i,C:s,D:a}=this;for(let o=0;o<64;o++){let c,h,u;o<16?(c=ko(i,s,a),h=o,u=[7,12,17,22]):o<32?(c=ko(a,i,s),h=(5*o+1)%16,u=[5,9,14,20]):o<48?(c=i^s^a,h=(3*o+5)%16,u=[4,11,16,23]):(c=s^(i|~a),h=7*o%16,u=[6,10,15,21]),c=c+r+I5[o]+$i[h],r=a,a=s,s=i,i+=vr(c,u[o%4])}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,this.set(r,i,s,a)}roundClean(){$i.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}}const F5=new Map(Object.entries({md5:He(()=>new K5),sha1:b5,sha224:k8,sha256:vi,sha384:Oa,sha512:za,sha3_256:$8,sha3_512:J8,ripemd160:S5}));var P5=Object.freeze({__proto__:null,nobleHashes:F5});function Ji(n,t,e,r,i,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],h=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],y=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],d=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let g,p,A,v,w,x,b,S,K,F,k=0,B=t.length;const E=n.length===32?3:9;S=E===3?e?[0,32,2]:[30,-2,-2]:e?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],e&&(t=function(D){const P=8-D.length%8;let U;if(!(P<8)){if(P===8)return D;throw Error("des: invalid padding")}U=0;const T=new Uint8Array(D.length+P);for(let M=0;M<D.length;M++)T[M]=D[M];for(let M=0;M<P;M++)T[D.length+M]=U;return T}(t),B=t.length);let C=new Uint8Array(B),I=0;for(;k<B;){for(x=t[k++]<<24|t[k++]<<16|t[k++]<<8|t[k++],b=t[k++]<<24|t[k++]<<16|t[k++]<<8|t[k++],A=252645135&(x>>>4^b),b^=A,x^=A<<4,A=65535&(x>>>16^b),b^=A,x^=A<<16,A=858993459&(b>>>2^x),x^=A,b^=A<<2,A=16711935&(b>>>8^x),x^=A,b^=A<<8,A=1431655765&(x>>>1^b),b^=A,x^=A<<1,x=x<<1|x>>>31,b=b<<1|b>>>31,p=0;p<E;p+=3){for(K=S[p+1],F=S[p+2],g=S[p];g!==K;g+=F)v=b^n[g],w=(b>>>4|b<<28)^n[g+1],A=x,x=b,b=A^(o[v>>>24&63]|h[v>>>16&63]|f[v>>>8&63]|d[63&v]|a[w>>>24&63]|c[w>>>16&63]|u[w>>>8&63]|y[63&w]);A=x,x=b,b=A}x=x>>>1|x<<31,b=b>>>1|b<<31,A=1431655765&(x>>>1^b),b^=A,x^=A<<1,A=16711935&(b>>>8^x),x^=A,b^=A<<8,A=858993459&(b>>>2^x),x^=A,b^=A<<2,A=65535&(x>>>16^b),b^=A,x^=A<<16,A=252645135&(x>>>4^b),b^=A,x^=A<<4,C[I++]=x>>>24,C[I++]=x>>>16&255,C[I++]=x>>>8&255,C[I++]=255&x,C[I++]=b>>>24,C[I++]=b>>>16&255,C[I++]=b>>>8&255,C[I++]=255&b}return e||(C=function(D){let P,U=null;if(P=0,!U){for(U=1;D[D.length-U]===P;)U++;U--}return D.subarray(0,D.length-U)}(C)),C}function ts(n){const t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],e=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],h=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],y=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=n.length>8?3:1,A=Array(32*p),v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let w,x,b,S=0,K=0;for(let F=0;F<p;F++){let k=n[S++]<<24|n[S++]<<16|n[S++]<<8|n[S++],B=n[S++]<<24|n[S++]<<16|n[S++]<<8|n[S++];b=252645135&(k>>>4^B),B^=b,k^=b<<4,b=65535&(B>>>-16^k),k^=b,B^=b<<-16,b=858993459&(k>>>2^B),B^=b,k^=b<<2,b=65535&(B>>>-16^k),k^=b,B^=b<<-16,b=1431655765&(k>>>1^B),B^=b,k^=b<<1,b=16711935&(B>>>8^k),k^=b,B^=b<<8,b=1431655765&(k>>>1^B),B^=b,k^=b<<1,b=k<<8|B>>>20&240,k=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=b;for(let E=0;E<16;E++)v[E]?(k=k<<2|k>>>26,B=B<<2|B>>>26):(k=k<<1|k>>>27,B=B<<1|B>>>27),k&=-15,B&=-15,w=t[k>>>28]|e[k>>>24&15]|r[k>>>20&15]|i[k>>>16&15]|s[k>>>12&15]|a[k>>>8&15]|o[k>>>4&15],x=c[B>>>28]|h[B>>>24&15]|u[B>>>20&15]|f[B>>>16&15]|y[B>>>12&15]|d[B>>>8&15]|g[B>>>4&15],b=65535&(x>>>16^w),A[K++]=w^b,A[K++]=x^b<<16}return A}function Y0(n){this.key=[];for(let t=0;t<3;t++)this.key.push(new Uint8Array(n.subarray(8*t,8*t+8)));this.encrypt=function(t){return Ji(ts(this.key[2]),Ji(ts(this.key[1]),Ji(ts(this.key[0]),t,!0),!1),!0)}}function U5(){this.BlockSize=8,this.KeySize=16,this.setKey=function(a){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),a.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(a),!0},this.reset=function(){for(let a=0;a<16;a++)this.masking[a]=0,this.rotate[a]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let h,u=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],f=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];h=f,f=u^e(f,this.masking[0],this.rotate[0]),u=h,h=f,f=u^r(f,this.masking[1],this.rotate[1]),u=h,h=f,f=u^i(f,this.masking[2],this.rotate[2]),u=h,h=f,f=u^e(f,this.masking[3],this.rotate[3]),u=h,h=f,f=u^r(f,this.masking[4],this.rotate[4]),u=h,h=f,f=u^i(f,this.masking[5],this.rotate[5]),u=h,h=f,f=u^e(f,this.masking[6],this.rotate[6]),u=h,h=f,f=u^r(f,this.masking[7],this.rotate[7]),u=h,h=f,f=u^i(f,this.masking[8],this.rotate[8]),u=h,h=f,f=u^e(f,this.masking[9],this.rotate[9]),u=h,h=f,f=u^r(f,this.masking[10],this.rotate[10]),u=h,h=f,f=u^i(f,this.masking[11],this.rotate[11]),u=h,h=f,f=u^e(f,this.masking[12],this.rotate[12]),u=h,h=f,f=u^r(f,this.masking[13],this.rotate[13]),u=h,h=f,f=u^i(f,this.masking[14],this.rotate[14]),u=h,h=f,f=u^e(f,this.masking[15],this.rotate[15]),u=h,o[c]=f>>>24&255,o[c+1]=f>>>16&255,o[c+2]=f>>>8&255,o[c+3]=255&f,o[c+4]=u>>>24&255,o[c+5]=u>>>16&255,o[c+6]=u>>>8&255,o[c+7]=255&u}return o},this.decrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let h,u=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],f=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];h=f,f=u^e(f,this.masking[15],this.rotate[15]),u=h,h=f,f=u^i(f,this.masking[14],this.rotate[14]),u=h,h=f,f=u^r(f,this.masking[13],this.rotate[13]),u=h,h=f,f=u^e(f,this.masking[12],this.rotate[12]),u=h,h=f,f=u^i(f,this.masking[11],this.rotate[11]),u=h,h=f,f=u^r(f,this.masking[10],this.rotate[10]),u=h,h=f,f=u^e(f,this.masking[9],this.rotate[9]),u=h,h=f,f=u^i(f,this.masking[8],this.rotate[8]),u=h,h=f,f=u^r(f,this.masking[7],this.rotate[7]),u=h,h=f,f=u^e(f,this.masking[6],this.rotate[6]),u=h,h=f,f=u^i(f,this.masking[5],this.rotate[5]),u=h,h=f,f=u^r(f,this.masking[4],this.rotate[4]),u=h,h=f,f=u^e(f,this.masking[3],this.rotate[3]),u=h,h=f,f=u^i(f,this.masking[2],this.rotate[2]),u=h,h=f,f=u^r(f,this.masking[1],this.rotate[1]),u=h,h=f,f=u^e(f,this.masking[0],this.rotate[0]),u=h,o[c]=f>>>24&255,o[c+1]=f>>>16&255,o[c+2]=f>>>8&255,o[c+3]=255&f,o[c+4]=u>>>24&255,o[c+5]=u>>16&255,o[c+6]=u>>8&255,o[c+7]=255&u}return o};const n=[,,,,];n[0]=[,,,,],n[0][0]=[4,0,13,15,12,14,8],n[0][1]=[5,2,16,18,17,19,10],n[0][2]=[6,3,23,22,21,20,9],n[0][3]=[7,1,26,25,27,24,11],n[1]=[,,,,],n[1][0]=[0,6,21,23,20,22,16],n[1][1]=[1,4,0,2,1,3,18],n[1][2]=[2,5,7,6,5,4,17],n[1][3]=[3,7,10,9,11,8,19],n[2]=[,,,,],n[2][0]=[4,0,13,15,12,14,8],n[2][1]=[5,2,16,18,17,19,10],n[2][2]=[6,3,23,22,21,20,9],n[2][3]=[7,1,26,25,27,24,11],n[3]=[,,,,],n[3][0]=[0,6,21,23,20,22,16],n[3][1]=[1,4,0,2,1,3,18],n[3][2]=[2,5,7,6,5,4,17],n[3][3]=[3,7,10,9,11,8,19];const t=[,,,,];function e(a,o,c){const h=o+a,u=h<<c|h>>>32-c;return(s[0][u>>>24]^s[1][u>>>16&255])-s[2][u>>>8&255]+s[3][255&u]}function r(a,o,c){const h=o^a,u=h<<c|h>>>32-c;return s[0][u>>>24]-s[1][u>>>16&255]+s[2][u>>>8&255]^s[3][255&u]}function i(a,o,c){const h=o-a,u=h<<c|h>>>32-c;return(s[0][u>>>24]+s[1][u>>>16&255]^s[2][u>>>8&255])-s[3][255&u]}t[0]=[,,,,],t[0][0]=[24,25,23,22,18],t[0][1]=[26,27,21,20,22],t[0][2]=[28,29,19,18,25],t[0][3]=[30,31,17,16,28],t[1]=[,,,,],t[1][0]=[3,2,12,13,8],t[1][1]=[1,0,14,15,13],t[1][2]=[7,6,8,9,3],t[1][3]=[5,4,10,11,7],t[2]=[,,,,],t[2][0]=[19,18,28,29,25],t[2][1]=[17,16,30,31,28],t[2][2]=[23,22,24,25,18],t[2][3]=[21,20,26,27,22],t[3]=[,,,,],t[3][0]=[8,9,7,6,3],t[3][1]=[10,11,5,4,7],t[3][2]=[12,13,3,2,8],t[3][3]=[14,15,1,0,13],this.keySchedule=function(a){const o=[,,,,,,,,],c=Array(32);let h;for(let d=0;d<4;d++)h=4*d,o[d]=a[h]<<24|a[h+1]<<16|a[h+2]<<8|a[h+3];const u=[6,7,4,5];let f,y=0;for(let d=0;d<2;d++)for(let g=0;g<4;g++){for(h=0;h<4;h++){const p=n[g][h];f=o[p[1]],f^=s[4][o[p[2]>>>2]>>>24-8*(3&p[2])&255],f^=s[5][o[p[3]>>>2]>>>24-8*(3&p[3])&255],f^=s[6][o[p[4]>>>2]>>>24-8*(3&p[4])&255],f^=s[7][o[p[5]>>>2]>>>24-8*(3&p[5])&255],f^=s[u[h]][o[p[6]>>>2]>>>24-8*(3&p[6])&255],o[p[0]]=f}for(h=0;h<4;h++){const p=t[g][h];f=s[4][o[p[0]>>>2]>>>24-8*(3&p[0])&255],f^=s[5][o[p[1]>>>2]>>>24-8*(3&p[1])&255],f^=s[6][o[p[2]>>>2]>>>24-8*(3&p[2])&255],f^=s[7][o[p[3]>>>2]>>>24-8*(3&p[3])&255],f^=s[4+h][o[p[4]>>>2]>>>24-8*(3&p[4])&255],c[y]=f,y++}}for(let d=0;d<16;d++)this.masking[d]=c[d],this.rotate[d]=31&c[16+d]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Z0(n){this.cast5=new U5,this.cast5.setKey(n),this.encrypt=function(t){return this.cast5.encrypt(t)}}Y0.keySize=Y0.prototype.keySize=24,Y0.blockSize=Y0.prototype.blockSize=8,Z0.blockSize=Z0.prototype.blockSize=8,Z0.keySize=Z0.prototype.keySize=16;const ae=4294967295;function Be(n,t){return(n<<t|n>>>32-t)&ae}function qe(n,t){return n[t]|n[t+1]<<8|n[t+2]<<16|n[t+3]<<24}function yr(n,t,e){n.splice(t,4,255&e,e>>>8&255,e>>>16&255,e>>>24&255)}function X(n,t){return n>>>8*t&255}function X0(n){this.tf=function(){let t=null,e=null,r=-1,i=[],s=[[],[],[],[]];function a(u){return s[0][X(u,0)]^s[1][X(u,1)]^s[2][X(u,2)]^s[3][X(u,3)]}function o(u){return s[0][X(u,3)]^s[1][X(u,0)]^s[2][X(u,1)]^s[3][X(u,2)]}function c(u,f){let y=a(f[0]),d=o(f[1]);f[2]=Be(f[2]^y+d+i[4*u+8]&ae,31),f[3]=Be(f[3],1)^y+2*d+i[4*u+9]&ae,y=a(f[2]),d=o(f[3]),f[0]=Be(f[0]^y+d+i[4*u+10]&ae,31),f[1]=Be(f[1],1)^y+2*d+i[4*u+11]&ae}function h(u,f){let y=a(f[0]),d=o(f[1]);f[2]=Be(f[2],1)^y+d+i[4*u+10]&ae,f[3]=Be(f[3]^y+2*d+i[4*u+11]&ae,31),y=a(f[2]),d=o(f[3]),f[0]=Be(f[0],1)^y+d+i[4*u+8]&ae,f[1]=Be(f[1]^y+2*d+i[4*u+9]&ae,31)}return{name:"twofish",blocksize:16,open:function(u){let f,y,d,g,p;t=u;const A=[],v=[],w=[];let x;const b=[];let S,K,F;const k=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],B=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],E=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],C=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],I=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],D=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],P=[[],[]],U=[[],[],[],[]];function T(R){return R^R>>2^[0,90,180,238][3&R]}function M(R){return R^R>>1^R>>2^[0,238,180,90][3&R]}function z(R,Q){let L,_,G;for(L=0;L<8;L++)_=Q>>>24,Q=Q<<8&ae|R>>>24,R=R<<8&ae,G=_<<1,128&_&&(G^=333),Q^=_^G<<16,G^=_>>>1,1&_&&(G^=166),Q^=G<<24|G<<8;return Q}function O(R,Q){const L=Q>>4,_=15&Q,G=k[R][L^_],N=B[R][I[_]^D[L]];return C[R][I[N]^D[G]]<<4|E[R][G^N]}function H(R,Q){let L=X(R,0),_=X(R,1),G=X(R,2),N=X(R,3);switch(x){case 4:L=P[1][L]^X(Q[3],0),_=P[0][_]^X(Q[3],1),G=P[0][G]^X(Q[3],2),N=P[1][N]^X(Q[3],3);case 3:L=P[1][L]^X(Q[2],0),_=P[1][_]^X(Q[2],1),G=P[0][G]^X(Q[2],2),N=P[0][N]^X(Q[2],3);case 2:L=P[0][P[0][L]^X(Q[1],0)]^X(Q[0],0),_=P[0][P[1][_]^X(Q[1],1)]^X(Q[0],1),G=P[1][P[0][G]^X(Q[1],2)]^X(Q[0],2),N=P[1][P[1][N]^X(Q[1],3)]^X(Q[0],3)}return U[0][L]^U[1][_]^U[2][G]^U[3][N]}for(t=t.slice(0,32),f=t.length;f!==16&&f!==24&&f!==32;)t[f++]=0;for(f=0;f<t.length;f+=4)w[f>>2]=qe(t,f);for(f=0;f<256;f++)P[0][f]=O(0,f),P[1][f]=O(1,f);for(f=0;f<256;f++)S=P[1][f],K=T(S),F=M(S),U[0][f]=S+(K<<8)+(F<<16)+(F<<24),U[2][f]=K+(F<<8)+(S<<16)+(F<<24),S=P[0][f],K=T(S),F=M(S),U[1][f]=F+(F<<8)+(K<<16)+(S<<24),U[3][f]=K+(S<<8)+(F<<16)+(K<<24);for(x=w.length/2,f=0;f<x;f++)y=w[f+f],A[f]=y,d=w[f+f+1],v[f]=d,b[x-f-1]=z(y,d);for(f=0;f<40;f+=2)y=16843009*f,d=y+16843009,y=H(y,A),d=Be(H(d,v),8),i[f]=y+d&ae,i[f+1]=Be(y+2*d,9);for(f=0;f<256;f++)switch(y=d=g=p=f,x){case 4:y=P[1][y]^X(b[3],0),d=P[0][d]^X(b[3],1),g=P[0][g]^X(b[3],2),p=P[1][p]^X(b[3],3);case 3:y=P[1][y]^X(b[2],0),d=P[1][d]^X(b[2],1),g=P[0][g]^X(b[2],2),p=P[0][p]^X(b[2],3);case 2:s[0][f]=U[0][P[0][P[0][y]^X(b[1],0)]^X(b[0],0)],s[1][f]=U[1][P[0][P[1][d]^X(b[1],1)]^X(b[0],1)],s[2][f]=U[2][P[1][P[0][g]^X(b[1],2)]^X(b[0],2)],s[3][f]=U[3][P[1][P[1][p]^X(b[1],3)]^X(b[0],3)]}},close:function(){i=[],s=[[],[],[],[]]},encrypt:function(u,f){e=u,r=f;const y=[qe(e,r)^i[0],qe(e,r+4)^i[1],qe(e,r+8)^i[2],qe(e,r+12)^i[3]];for(let d=0;d<8;d++)c(d,y);return yr(e,r,y[2]^i[4]),yr(e,r+4,y[3]^i[5]),yr(e,r+8,y[0]^i[6]),yr(e,r+12,y[1]^i[7]),r+=16,e},decrypt:function(u,f){e=u,r=f;const y=[qe(e,r)^i[4],qe(e,r+4)^i[5],qe(e,r+8)^i[6],qe(e,r+12)^i[7]];for(let d=7;d>=0;d--)h(d,y);yr(e,r,y[2]^i[0]),yr(e,r+4,y[3]^i[1]),yr(e,r+8,y[0]^i[2]),yr(e,r+12,y[1]^i[3]),r+=16},finalize:function(){return e}}}(),this.tf.open(Array.from(n),0),this.encrypt=function(t){return this.tf.encrypt(Array.from(t),0)}}function xe(){}function $0(n){this.bf=new xe,this.bf.init(n),this.encrypt=function(t){return this.bf.encryptBlock(t)}}X0.keySize=X0.prototype.keySize=32,X0.blockSize=X0.prototype.blockSize=16,xe.prototype.BLOCKSIZE=8,xe.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],xe.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],xe.prototype.NN=16,xe.prototype._clean=function(n){return n<0&&(n=(2147483647&n)+2147483648),n},xe.prototype._F=function(n){let t;const e=255&n,r=255&(n>>>=8),i=255&(n>>>=8),s=255&(n>>>=8);return t=this.sboxes[0][s]+this.sboxes[1][i],t^=this.sboxes[2][r],t+=this.sboxes[3][e],t},xe.prototype._encryptBlock=function(n){let t,e=n[0],r=n[1];for(t=0;t<this.NN;++t){e^=this.parray[t],r=this._F(e)^r;const i=e;e=r,r=i}e^=this.parray[this.NN+0],r^=this.parray[this.NN+1],n[0]=this._clean(r),n[1]=this._clean(e)},xe.prototype.encryptBlock=function(n){let t;const e=[0,0],r=this.BLOCKSIZE/2;for(t=0;t<this.BLOCKSIZE/2;++t)e[0]=e[0]<<8|255&n[t+0],e[1]=e[1]<<8|255&n[t+r];this._encryptBlock(e);const i=[];for(t=0;t<this.BLOCKSIZE/2;++t)i[t+0]=e[0]>>>24-8*t&255,i[t+r]=e[1]>>>24-8*t&255;return i},xe.prototype._decryptBlock=function(n){let t,e=n[0],r=n[1];for(t=this.NN+1;t>1;--t){e^=this.parray[t],r=this._F(e)^r;const i=e;e=r,r=i}e^=this.parray[1],r^=this.parray[0],n[0]=this._clean(r),n[1]=this._clean(e)},xe.prototype.init=function(n){let t,e=0;for(this.parray=[],t=0;t<this.NN+2;++t){let i=0;for(let s=0;s<4;++s)i=i<<8|255&n[e],++e>=n.length&&(e=0);this.parray[t]=this.PARRAY[t]^i}for(this.sboxes=[],t=0;t<4;++t)for(this.sboxes[t]=[],e=0;e<256;++e)this.sboxes[t][e]=this.SBOXES[t][e];const r=[0,0];for(t=0;t<this.NN+2;t+=2)this._encryptBlock(r),this.parray[t+0]=r[0],this.parray[t+1]=r[1];for(t=0;t<4;++t)for(e=0;e<256;e+=2)this._encryptBlock(r),this.sboxes[t][e+0]=r[0],this.sboxes[t][e+1]=r[1]},$0.keySize=$0.prototype.keySize=16,$0.blockSize=$0.prototype.blockSize=8;const R5=new Map(Object.entries({tripledes:Y0,cast5:Z0,twofish:X0,blowfish:$0}));var Q5=Object.freeze({__proto__:null,legacyCiphers:R5});function c0(n,t,e,r){n[t]+=e[r],n[t+1]+=e[r+1]+(n[t]<e[r])}function Co(n,t){n[0]+=t,n[1]+=n[0]<t}function dr(n,t,e,r,i,s,a,o){c0(n,e,n,r),c0(n,e,t,a);let c=n[s]^n[e],h=n[s+1]^n[e+1];n[s]=h,n[s+1]=c,c0(n,i,n,s),c=n[r]^n[i],h=n[r+1]^n[i+1],n[r]=c>>>24^h<<8,n[r+1]=h>>>24^c<<8,c0(n,e,n,r),c0(n,e,t,o),c=n[s]^n[e],h=n[s+1]^n[e+1],n[s]=c>>>16^h<<16,n[s+1]=h>>>16^c<<16,c0(n,i,n,s),c=n[r]^n[i],h=n[r+1]^n[i+1],n[r]=h>>>31^c<<1,n[r+1]=c>>>31^h<<1}const d3=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Tt=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(n=>2*n));function Do(n,t){const e=new Uint32Array(32),r=new Uint32Array(n.b.buffer,n.b.byteOffset,32);for(let s=0;s<16;s++)e[s]=n.h[s],e[s+16]=d3[s];e[24]^=n.t0[0],e[25]^=n.t0[1];const i=t?4294967295:0;e[28]^=i,e[29]^=i;for(let s=0;s<12;s++){const a=s<<4;dr(e,r,0,8,16,24,Tt[a+0],Tt[a+1]),dr(e,r,2,10,18,26,Tt[a+2],Tt[a+3]),dr(e,r,4,12,20,28,Tt[a+4],Tt[a+5]),dr(e,r,6,14,22,30,Tt[a+6],Tt[a+7]),dr(e,r,0,10,20,30,Tt[a+8],Tt[a+9]),dr(e,r,2,12,22,24,Tt[a+10],Tt[a+11]),dr(e,r,4,14,16,26,Tt[a+12],Tt[a+13]),dr(e,r,6,8,18,28,Tt[a+14],Tt[a+15])}for(let s=0;s<16;s++)n.h[s]^=e[s]^e[s+16]}class _5{constructor(t,e,r,i){const s=new Uint8Array(64);this.S={b:new Uint8Array(N0),h:new Uint32Array(Aa/4),t0:new Uint32Array(2),c:0,outlen:t},s[0]=t,e&&(s[1]=e.length),s[2]=1,s[3]=1,r&&s.set(r,32),i&&s.set(i,48);const a=new Uint32Array(s.buffer,s.byteOffset,s.length/Uint32Array.BYTES_PER_ELEMENT);for(let o=0;o<16;o++)this.S.h[o]=d3[o]^a[o];if(e){const o=new Uint8Array(N0);o.set(e),this.update(o)}}update(t){if(!(t instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let e=0;for(;e<t.length;){this.S.c===N0&&(Co(this.S.t0,this.S.c),Do(this.S,!1),this.S.c=0);let r=N0-this.S.c;this.S.b.set(t.subarray(e,e+r),this.S.c);const i=Math.min(r,t.length-e);this.S.c+=i,e+=i}return this}digest(t){Co(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=N0,Do(this.S,!0);const e=t||new Uint8Array(this.S.outlen);for(let r=0;r<this.S.outlen;r++)e[r]=this.S.h[r>>2]>>8*(3&r);return this.S.h=null,e.buffer}}function Mn(n,t,e,r){if(n>Aa)throw Error(`outlen must be at most ${Aa} (given: ${n})`);return new _5(n,t,e,r)}const Aa=64,N0=128,xa=2,So=19,L5=4294967295,T5=4,H5=4294967295,M5=8,N5=4294967295,z5=8,O5=4294967295,G5=4294967295,q5=32,We=1024,W5=64,j5=new Uint8Array(new Uint16Array([43981]).buffer)[0]===205;function jt(n,t,e){return n[e+0]=t,n[e+1]=t>>8,n[e+2]=t>>16,n[e+3]=t>>24,n}function Hr(n,t,e){if(t>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let r=t;for(let i=e;i<e+7;i++)n[i]=r,r=(r-n[i])/256;return n}function es(n,t,e){const r=new Uint8Array(64),i=new Uint8Array(4+t.length);if(jt(i,n,0),i.set(t,4),n<=64)return Mn(n).update(i).digest(e),e;const s=Math.ceil(n/32)-2;for(let o=0;o<s;o++)Mn(64).update(o===0?i:r).digest(r),e.set(r.subarray(0,32),32*o);const a=new Uint8Array(Mn(n-32*s).update(r).digest());return e.set(a,32*s),e}function Io(n,t,e,r){return n.fn.XOR(t.byteOffset,e.byteOffset,r.byteOffset),t}function V5(n,t,e,r){return n.fn.G(t.byteOffset,e.byteOffset,r.byteOffset,n.refs.gZ.byteOffset),r}function Y5(n,t,e,r){return n.fn.G2(t.byteOffset,e.byteOffset,r.byteOffset,n.refs.gZ.byteOffset),r}function*Z5(n,t,e,r,i,s,a,o){n.refs.prngTmp.fill(0);const c=n.refs.prngTmp.subarray(0,48);Hr(c,t,0),Hr(c,e,8),Hr(c,r,16),Hr(c,i,24),Hr(c,s,32),Hr(c,xa,40);for(let h=1;h<=a;h++){Hr(n.refs.prngTmp,h,c.length);const u=Y5(n,n.refs.ZERO1024,n.refs.prngTmp,n.refs.prngR);for(let f=h===1?8*o:0;f<u.length;f+=8)yield u.subarray(f,f+8)}return[]}const p3=1024,X5=64*p3;function $5(n,{memory:t,instance:e}){if(!j5)throw Error("BigEndian system not supported");const r=function({type:B,version:E,tagLength:C,password:I,salt:D,ad:P,secret:U,parallelism:T,memorySize:M,passes:z}){const O=(H,R,Q,L)=>{if(R<Q||R>L)throw Error(`${H} size should be between ${Q} and ${L} bytes`)};if(B!==xa||E!==So)throw Error("Unsupported type or version");return O("password",I,z5,N5),O("salt",D,M5,H5),O("tag",C,T5,L5),O("memory",M,8*T,O5),P&&O("associated data",P,0,G5),U&&O("secret",U,0,q5),{type:B,version:E,tagLength:C,password:I,salt:D,ad:P,secret:U,lanes:T,memorySize:M,passes:z}}({type:xa,version:So,...n}),{G:i,G2:s,xor:a,getLZ:o}=e.exports,c={},h={};h.G=i,h.G2=s,h.XOR=a;const u=4*r.lanes*Math.floor(r.memorySize/(4*r.lanes)),f=u*We+10*p3;if(t.buffer.byteLength<f){const B=Math.ceil((f-t.buffer.byteLength)/X5);t.grow(B)}let y=0;c.gZ=new Uint8Array(t.buffer,y,We),y+=c.gZ.length,c.prngR=new Uint8Array(t.buffer,y,We),y+=c.prngR.length,c.prngTmp=new Uint8Array(t.buffer,y,We),y+=c.prngTmp.length,c.ZERO1024=new Uint8Array(t.buffer,y,1024),y+=c.ZERO1024.length;const d=new Uint32Array(t.buffer,y,2);y+=d.length*Uint32Array.BYTES_PER_ELEMENT;const g={fn:h,refs:c},p=new Uint8Array(t.buffer,y,We);y+=p.length;const A=new Uint8Array(t.buffer,y,r.memorySize*We),v=new Uint8Array(t.buffer,0,y),w=function(B){const E=Mn(W5),C=new Uint8Array(4),I=new Uint8Array(24);jt(I,B.lanes,0),jt(I,B.tagLength,4),jt(I,B.memorySize,8),jt(I,B.passes,12),jt(I,B.version,16),jt(I,B.type,20);const D=[I];B.password?(D.push(jt(new Uint8Array(4),B.password.length,0)),D.push(B.password)):D.push(C),B.salt?(D.push(jt(new Uint8Array(4),B.salt.length,0)),D.push(B.salt)):D.push(C),B.secret?(D.push(jt(new Uint8Array(4),B.secret.length,0)),D.push(B.secret)):D.push(C),B.ad?(D.push(jt(new Uint8Array(4),B.ad.length,0)),D.push(B.ad)):D.push(C),E.update(function(U){if(U.length===1)return U[0];let T=0;for(let O=0;O<U.length;O++){if(!(U[O]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");T+=U[O].length}const M=new Uint8Array(T);let z=0;return U.forEach(O=>{M.set(O,z),z+=O.length}),M}(D));const P=E.digest();return new Uint8Array(P)}(r),x=u/r.lanes,b=Array(r.lanes).fill(null).map(()=>Array(x)),S=(B,E)=>(b[B][E]=A.subarray(B*x*1024+1024*E,B*x*1024+1024*E+We),b[B][E]);for(let B=0;B<r.lanes;B++){const E=new Uint8Array(w.length+8);E.set(w),jt(E,0,w.length),jt(E,B,w.length+4),es(We,E,S(B,0)),jt(E,1,w.length),es(We,E,S(B,1))}const K=x/4;for(let B=0;B<r.passes;B++)for(let E=0;E<4;E++){const C=B===0&&E<=1;for(let I=0;I<r.lanes;I++){let D=E===0&&B===0?2:0;const P=C?Z5(g,B,I,E,u,r.passes,K,D):null;for(;D<K;D++){const U=E*K+D,T=U>0?b[I][U-1]:b[I][x-1],M=C?P.next().value:T;o(d.byteOffset,M.byteOffset,I,r.lanes,B,E,D,4,K);const z=d[0],O=d[1];B===0&&S(I,U),V5(g,T,b[z][O],B>0?p:b[I][U]),B>0&&Io(g,b[I][U],p,b[I][U])}}}const F=b[0][x-1];for(let B=1;B<r.lanes;B++)Io(g,F,F,b[B][x-1]);const k=es(r.tagLength,F,new Uint8Array(r.tagLength));return v.fill(0),t.grow(0),k}let Un;async function J5(n,t){const e=new WebAssembly.Memory({initial:1040,maximum:65536}),r=await async function(i,s,a){const o={env:{memory:i}};if(Un===void 0)try{const c=await s(o);return Un=!0,c}catch{Un=!1}return(Un?s:a)(o)}(e,n,t);return i=>$5(i,{instance:r.instance,memory:e})}function Ko(n,t,e,r){var i=null,s=Ht.atob(e),a=s.length;i=new Uint8Array(new ArrayBuffer(a));for(var o=0;o<a;o++)i[o]=s.charCodeAt(o);return function(c,h){var u=WebAssembly.instantiate,f=WebAssembly.compile;return h?u(c,h):f(c)}(i,r)}var t6=Object.freeze({__proto__:null,default:async()=>J5(n=>Ko(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",n),n=>Ko(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",n))}),Fo=[0,1,3,7,15,31,63,127,255],J0=function(n){this.stream=n,this.bitOffset=0,this.curByte=0,this.hasByte=!1};J0.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},J0.prototype.read=function(n){for(var t=0;n>0;){this._ensureByte();var e=8-this.bitOffset;if(n>=e)t<<=e,t|=Fo[e]&this.curByte,this.hasByte=!1,this.bitOffset=0,n-=e;else{t<<=n;var r=e-n;t|=(this.curByte&Fo[n]<<r)>>r,this.bitOffset+=n,n=0}}return t},J0.prototype.seek=function(n){var t=n%8,e=(n-t)/8;this.bitOffset=t,this.stream.seek(e),this.hasByte=!1},J0.prototype.pi=function(){var n,t=new Uint8Array(6);for(n=0;n<t.length;n++)t[n]=this.read(8);return function(e){return Array.prototype.map.call(e,r=>("00"+r.toString(16)).slice(-2)).join("")}(t)};var e6=J0,Mr=function(){};Mr.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},Mr.prototype.read=function(n,t,e){for(var r=0;r<e;){var i=this.readByte();if(i<0)return r===0?-1:r;n[t++]=i,r++}return r},Mr.prototype.seek=function(n){throw Error("abstract method seek() not implemented")},Mr.prototype.writeByte=function(n){throw Error("abstract method readByte() not implemented")},Mr.prototype.write=function(n,t,e){var r;for(r=0;r<e;r++)this.writeByte(n[t++]);return e},Mr.prototype.flush=function(){};var rs,r6=Mr,n6=(rs=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var n=4294967295;this.getCRC=function(){return~n>>>0},this.updateCRC=function(t){n=n<<8^rs[255&(n>>>24^t)]},this.updateCRCRun=function(t,e){for(;e-- >0;)n=n<<8^rs[255&(n>>>24^t)]}}),i6=e6,rn=r6,g3=n6,Po=function(n,t){var e,r=n[t];for(e=t;e>0;e--)n[e]=n[e-1];return n[0]=r,r},gt={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},gr={};gr[gt.LAST_BLOCK]="Bad file checksum",gr[gt.NOT_BZIP_DATA]="Not bzip data",gr[gt.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",gr[gt.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",gr[gt.DATA_ERROR]="Data error",gr[gt.OUT_OF_MEMORY]="Out of memory",gr[gt.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var Rt=function(n,t){var e=gr[n]||"unknown error";t&&(e+=": "+t);var r=new TypeError(e);throw r.errorCode=n,r},Er=function(n,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(n,t)};Er.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new g3,!0):(this.writeCount=-1,!1)},Er.prototype._start_bunzip=function(n,t){var e=new Uint8Array(4);n.read(e,0,4)===4&&String.fromCharCode(e[0],e[1],e[2])==="BZh"||Rt(gt.NOT_BZIP_DATA,"bad magic");var r=e[3]-48;(r<1||r>9)&&Rt(gt.NOT_BZIP_DATA,"level out of range"),this.reader=new i6(n),this.dbufSize=1e5*r,this.nextoutput=0,this.outputStream=t,this.streamCRC=0},Er.prototype._get_next_block=function(){var n,t,e,r=this.reader,i=r.pi();if(i==="177245385090")return!1;i!=="314159265359"&&Rt(gt.NOT_BZIP_DATA),this.targetBlockCRC=r.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,r.read(1)&&Rt(gt.OBSOLETE_INPUT);var s=r.read(24);s>this.dbufSize&&Rt(gt.DATA_ERROR,"initial position out of bounds");var a=r.read(16),o=new Uint8Array(256),c=0;for(n=0;n<16;n++)if(a&1<<15-n){var h=16*n;for(e=r.read(16),t=0;t<16;t++)e&1<<15-t&&(o[c++]=h+t)}var u=r.read(3);(u<2||u>6)&&Rt(gt.DATA_ERROR);var f=r.read(15);f===0&&Rt(gt.DATA_ERROR);var y=new Uint8Array(256);for(n=0;n<u;n++)y[n]=n;var d=new Uint8Array(f);for(n=0;n<f;n++){for(t=0;r.read(1);t++)t>=u&&Rt(gt.DATA_ERROR);d[n]=Po(y,t)}var g,p=c+2,A=[];for(t=0;t<u;t++){var v,w,x=new Uint8Array(p),b=new Uint16Array(21);for(a=r.read(5),n=0;n<p;n++){for(;(a<1||a>20)&&Rt(gt.DATA_ERROR),r.read(1);)r.read(1)?a--:a++;x[n]=a}for(v=w=x[0],n=1;n<p;n++)x[n]>w?w=x[n]:x[n]<v&&(v=x[n]);g={},A.push(g),g.permute=new Uint16Array(258),g.limit=new Uint32Array(22),g.base=new Uint32Array(21),g.minLen=v,g.maxLen=w;var S=0;for(n=v;n<=w;n++)for(b[n]=g.limit[n]=0,a=0;a<p;a++)x[a]===n&&(g.permute[S++]=a);for(n=0;n<p;n++)b[x[n]]++;for(S=a=0,n=v;n<w;n++)S+=b[n],g.limit[n]=S-1,S<<=1,a+=b[n],g.base[n+1]=S-a;g.limit[w+1]=Number.MAX_VALUE,g.limit[w]=S+b[w]-1,g.base[v]=0}var K=new Uint32Array(256);for(n=0;n<256;n++)y[n]=n;var F,k=0,B=0,E=0,C=this.dbuf=new Uint32Array(this.dbufSize);for(p=0;;){for(p--||(p=49,E>=f&&Rt(gt.DATA_ERROR),g=A[d[E++]]),n=g.minLen,t=r.read(n);n>g.maxLen&&Rt(gt.DATA_ERROR),!(t<=g.limit[n]);n++)t=t<<1|r.read(1);((t-=g.base[n])<0||t>=258)&&Rt(gt.DATA_ERROR);var I=g.permute[t];if(I!==0&&I!==1){if(k)for(k=0,B+a>this.dbufSize&&Rt(gt.DATA_ERROR),K[F=o[y[0]]]+=a;a--;)C[B++]=F;if(I>c)break;B>=this.dbufSize&&Rt(gt.DATA_ERROR),K[F=o[F=Po(y,n=I-1)]]++,C[B++]=F}else k||(k=1,a=0),a+=I===0?k:2*k,k<<=1}for((s<0||s>=B)&&Rt(gt.DATA_ERROR),t=0,n=0;n<256;n++)e=t+K[n],K[n]=t,t=e;for(n=0;n<B;n++)C[K[F=255&C[n]]]|=n<<8,K[F]++;var D=0,P=0,U=0;return B&&(P=255&(D=C[s]),D>>=8,U=-1),this.writePos=D,this.writeCurrent=P,this.writeCount=B,this.writeRun=U,!0},Er.prototype._read_bunzip=function(n,t){var e,r,i;if(this.writeCount<0)return 0;var s=this.dbuf,a=this.writePos,o=this.writeCurrent,c=this.writeCount;this.outputsize;for(var h=this.writeRun;c;){for(c--,r=o,o=255&(a=s[a]),a>>=8,h++==3?(e=o,i=r,o=-1):(e=1,i=o),this.blockCRC.updateCRCRun(i,e);e--;)this.outputStream.writeByte(i),this.nextoutput++;o!=r&&(h=0)}return this.writeCount=c,this.blockCRC.getCRC()!==this.targetBlockCRC&&Rt(gt.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var ns=function(n){if("readByte"in n)return n;var t=new rn;return t.pos=0,t.readByte=function(){return n[this.pos++]},t.seek=function(e){this.pos=e},t.eof=function(){return this.pos>=n.length},t},Uo=function(n){var t=new rn,e=!0;if(n)if(typeof n=="number")t.buffer=new Uint8Array(n),e=!1;else{if("writeByte"in n)return n;t.buffer=n,e=!1}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(r){if(e&&this.pos>=this.buffer.length){var i=new Uint8Array(2*this.buffer.length);i.set(this.buffer),this.buffer=i}this.buffer[this.pos++]=r},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!e)throw new TypeError("outputsize does not match decoded input");var r=new Uint8Array(this.pos);r.set(this.buffer.subarray(0,this.pos)),this.buffer=r}return this.buffer},t._coerced=!0,t},s6={Bunzip:Er,Stream:rn,Err:gt,decode:function(n,t,e){for(var r=ns(n),i=Uo(t),s=new Er(r,i);!("eof"in r)||!r.eof();)if(s._init_block())s._read_bunzip();else{var a=s.reader.read(32)>>>0;if(a!==s.streamCRC&&Rt(gt.DATA_ERROR,"Bad stream CRC (got "+s.streamCRC.toString(16)+" expected "+a.toString(16)+")"),!e||!("eof"in r)||r.eof())break;s._start_bunzip(r,i)}if("getBuffer"in i)return i.getBuffer()},decodeBlock:function(n,t,e){var r=ns(n),i=Uo(e),s=new Er(r,i);if(s.reader.seek(t),s._get_next_block()&&(s.blockCRC=new g3,s.writeCopies=0,s._read_bunzip()),"getBuffer"in i)return i.getBuffer()},table:function(n,t,e){var r=new rn;r.delegate=ns(n),r.pos=0,r.readByte=function(){return this.pos++,this.delegate.readByte()},r.delegate.eof&&(r.eof=r.delegate.eof.bind(r.delegate));var i=new rn;i.pos=0,i.writeByte=function(){this.pos++};for(var s=new Er(r,i),a=s.dbufSize;!("eof"in r)||!r.eof();){var o=8*r.pos+s.reader.bitOffset;if(s.reader.hasByte&&(o-=8),s._init_block()){var c=i.pos;s._read_bunzip(),t(o,i.pos-c)}else{if(s.reader.read(32),!e||!("eof"in r)||r.eof())break;s._start_bunzip(r,i),console.assert(s.dbufSize===a,"shouldn't change block size within multistream file")}}}},a6=_3({__proto__:null},[s6]),A3={exports:{}},is={exports:{}};const o6={},c6=Object.freeze(Object.defineProperty({__proto__:null,default:o6},Symbol.toStringTag,{value:"Module"})),h6=U3(c6);var Ro;function nt(){return Ro||(Ro=1,function(n,t){(function(e,r){n.exports=r()})(tt,function(){var e=e||function(r,i){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof tt<"u"&&tt.crypto&&(s=tt.crypto),!s&&typeof R3=="function")try{s=h6}catch{}var a=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function w(){}return function(x){var b;return w.prototype=x,b=new w,w.prototype=null,b}}(),c={},h=c.lib={},u=h.Base=function(){return{extend:function(w){var x=o(this);return w&&x.mixIn(w),(!x.hasOwnProperty("init")||this.init===x.init)&&(x.init=function(){x.$super.init.apply(this,arguments)}),x.init.prototype=x,x.$super=this,x},create:function(){var w=this.extend();return w.init.apply(w,arguments),w},init:function(){},mixIn:function(w){for(var x in w)w.hasOwnProperty(x)&&(this[x]=w[x]);w.hasOwnProperty("toString")&&(this.toString=w.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=h.WordArray=u.extend({init:function(w,x){w=this.words=w||[],x!=i?this.sigBytes=x:this.sigBytes=w.length*4},toString:function(w){return(w||d).stringify(this)},concat:function(w){var x=this.words,b=w.words,S=this.sigBytes,K=w.sigBytes;if(this.clamp(),S%4)for(var F=0;F<K;F++){var k=b[F>>>2]>>>24-F%4*8&255;x[S+F>>>2]|=k<<24-(S+F)%4*8}else for(var B=0;B<K;B+=4)x[S+B>>>2]=b[B>>>2];return this.sigBytes+=K,this},clamp:function(){var w=this.words,x=this.sigBytes;w[x>>>2]&=4294967295<<32-x%4*8,w.length=r.ceil(x/4)},clone:function(){var w=u.clone.call(this);return w.words=this.words.slice(0),w},random:function(w){for(var x=[],b=0;b<w;b+=4)x.push(a());return new f.init(x,w)}}),y=c.enc={},d=y.Hex={stringify:function(w){for(var x=w.words,b=w.sigBytes,S=[],K=0;K<b;K++){var F=x[K>>>2]>>>24-K%4*8&255;S.push((F>>>4).toString(16)),S.push((F&15).toString(16))}return S.join("")},parse:function(w){for(var x=w.length,b=[],S=0;S<x;S+=2)b[S>>>3]|=parseInt(w.substr(S,2),16)<<24-S%8*4;return new f.init(b,x/2)}},g=y.Latin1={stringify:function(w){for(var x=w.words,b=w.sigBytes,S=[],K=0;K<b;K++){var F=x[K>>>2]>>>24-K%4*8&255;S.push(String.fromCharCode(F))}return S.join("")},parse:function(w){for(var x=w.length,b=[],S=0;S<x;S++)b[S>>>2]|=(w.charCodeAt(S)&255)<<24-S%4*8;return new f.init(b,x)}},p=y.Utf8={stringify:function(w){try{return decodeURIComponent(escape(g.stringify(w)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(w){return g.parse(unescape(encodeURIComponent(w)))}},A=h.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(w){typeof w=="string"&&(w=p.parse(w)),this._data.concat(w),this._nDataBytes+=w.sigBytes},_process:function(w){var x,b=this._data,S=b.words,K=b.sigBytes,F=this.blockSize,k=F*4,B=K/k;w?B=r.ceil(B):B=r.max((B|0)-this._minBufferSize,0);var E=B*F,C=r.min(E*4,K);if(E){for(var I=0;I<E;I+=F)this._doProcessBlock(S,I);x=S.splice(0,E),b.sigBytes-=C}return new f.init(x,C)},clone:function(){var w=u.clone.call(this);return w._data=this._data.clone(),w},_minBufferSize:0});h.Hasher=A.extend({cfg:u.extend(),init:function(w){this.cfg=this.cfg.extend(w),this.reset()},reset:function(){A.reset.call(this),this._doReset()},update:function(w){return this._append(w),this._process(),this},finalize:function(w){w&&this._append(w);var x=this._doFinalize();return x},blockSize:16,_createHelper:function(w){return function(x,b){return new w.init(b).finalize(x)}},_createHmacHelper:function(w){return function(x,b){return new v.HMAC.init(w,b).finalize(x)}}});var v=c.algo={};return c}(Math);return e})}(is)),is.exports}var ss={exports:{}},Qo;function ki(){return Qo||(Qo=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){return function(r){var i=e,s=i.lib,a=s.Base,o=s.WordArray,c=i.x64={};c.Word=a.extend({init:function(h,u){this.high=h,this.low=u}}),c.WordArray=a.extend({init:function(h,u){h=this.words=h||[],u!=r?this.sigBytes=u:this.sigBytes=h.length*8},toX32:function(){for(var h=this.words,u=h.length,f=[],y=0;y<u;y++){var d=h[y];f.push(d.high),f.push(d.low)}return o.create(f,this.sigBytes)},clone:function(){for(var h=a.clone.call(this),u=h.words=this.words.slice(0),f=u.length,y=0;y<f;y++)u[y]=u[y].clone();return h}})}(),e})}(ss)),ss.exports}var as={exports:{}},_o;function u6(){return _o||(_o=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){return function(){if(typeof ArrayBuffer=="function"){var r=e,i=r.lib,s=i.WordArray,a=s.init,o=s.init=function(c){if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),(c instanceof Int8Array||typeof Uint8ClampedArray<"u"&&c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array)&&(c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength)),c instanceof Uint8Array){for(var h=c.byteLength,u=[],f=0;f<h;f++)u[f>>>2]|=c[f]<<24-f%4*8;a.call(this,u,h)}else a.apply(this,arguments)};o.prototype=s}}(),e.lib.WordArray})}(as)),as.exports}var os={exports:{}},Lo;function f6(){return Lo||(Lo=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.WordArray,a=r.enc;a.Utf16=a.Utf16BE={stringify:function(c){for(var h=c.words,u=c.sigBytes,f=[],y=0;y<u;y+=2){var d=h[y>>>2]>>>16-y%4*8&65535;f.push(String.fromCharCode(d))}return f.join("")},parse:function(c){for(var h=c.length,u=[],f=0;f<h;f++)u[f>>>1]|=c.charCodeAt(f)<<16-f%2*16;return s.create(u,h*2)}},a.Utf16LE={stringify:function(c){for(var h=c.words,u=c.sigBytes,f=[],y=0;y<u;y+=2){var d=o(h[y>>>2]>>>16-y%4*8&65535);f.push(String.fromCharCode(d))}return f.join("")},parse:function(c){for(var h=c.length,u=[],f=0;f<h;f++)u[f>>>1]|=o(c.charCodeAt(f)<<16-f%2*16);return s.create(u,h*2)}};function o(c){return c<<8&4278255360|c>>>8&16711935}}(),e.enc.Utf16})}(os)),os.exports}var cs={exports:{}},To;function Jr(){return To||(To=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.WordArray,a=r.enc;a.Base64={stringify:function(c){var h=c.words,u=c.sigBytes,f=this._map;c.clamp();for(var y=[],d=0;d<u;d+=3)for(var g=h[d>>>2]>>>24-d%4*8&255,p=h[d+1>>>2]>>>24-(d+1)%4*8&255,A=h[d+2>>>2]>>>24-(d+2)%4*8&255,v=g<<16|p<<8|A,w=0;w<4&&d+w*.75<u;w++)y.push(f.charAt(v>>>6*(3-w)&63));var x=f.charAt(64);if(x)for(;y.length%4;)y.push(x);return y.join("")},parse:function(c){var h=c.length,u=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var y=0;y<u.length;y++)f[u.charCodeAt(y)]=y}var d=u.charAt(64);if(d){var g=c.indexOf(d);g!==-1&&(h=g)}return o(c,h,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(c,h,u){for(var f=[],y=0,d=0;d<h;d++)if(d%4){var g=u[c.charCodeAt(d-1)]<<d%4*2,p=u[c.charCodeAt(d)]>>>6-d%4*2,A=g|p;f[y>>>2]|=A<<24-y%4*8,y++}return s.create(f,y)}}(),e.enc.Base64})}(cs)),cs.exports}var hs={exports:{}},Ho;function l6(){return Ho||(Ho=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.WordArray,a=r.enc;a.Base64url={stringify:function(c,h){h===void 0&&(h=!0);var u=c.words,f=c.sigBytes,y=h?this._safe_map:this._map;c.clamp();for(var d=[],g=0;g<f;g+=3)for(var p=u[g>>>2]>>>24-g%4*8&255,A=u[g+1>>>2]>>>24-(g+1)%4*8&255,v=u[g+2>>>2]>>>24-(g+2)%4*8&255,w=p<<16|A<<8|v,x=0;x<4&&g+x*.75<f;x++)d.push(y.charAt(w>>>6*(3-x)&63));var b=y.charAt(64);if(b)for(;d.length%4;)d.push(b);return d.join("")},parse:function(c,h){h===void 0&&(h=!0);var u=c.length,f=h?this._safe_map:this._map,y=this._reverseMap;if(!y){y=this._reverseMap=[];for(var d=0;d<f.length;d++)y[f.charCodeAt(d)]=d}var g=f.charAt(64);if(g){var p=c.indexOf(g);p!==-1&&(u=p)}return o(c,u,y)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function o(c,h,u){for(var f=[],y=0,d=0;d<h;d++)if(d%4){var g=u[c.charCodeAt(d-1)]<<d%4*2,p=u[c.charCodeAt(d)]>>>6-d%4*2,A=g|p;f[y>>>2]|=A<<24-y%4*8,y++}return s.create(f,y)}}(),e.enc.Base64url})}(hs)),hs.exports}var us={exports:{}},Mo;function t0(){return Mo||(Mo=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){return function(r){var i=e,s=i.lib,a=s.WordArray,o=s.Hasher,c=i.algo,h=[];(function(){for(var p=0;p<64;p++)h[p]=r.abs(r.sin(p+1))*4294967296|0})();var u=c.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(p,A){for(var v=0;v<16;v++){var w=A+v,x=p[w];p[w]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}var b=this._hash.words,S=p[A+0],K=p[A+1],F=p[A+2],k=p[A+3],B=p[A+4],E=p[A+5],C=p[A+6],I=p[A+7],D=p[A+8],P=p[A+9],U=p[A+10],T=p[A+11],M=p[A+12],z=p[A+13],O=p[A+14],H=p[A+15],R=b[0],Q=b[1],L=b[2],_=b[3];R=f(R,Q,L,_,S,7,h[0]),_=f(_,R,Q,L,K,12,h[1]),L=f(L,_,R,Q,F,17,h[2]),Q=f(Q,L,_,R,k,22,h[3]),R=f(R,Q,L,_,B,7,h[4]),_=f(_,R,Q,L,E,12,h[5]),L=f(L,_,R,Q,C,17,h[6]),Q=f(Q,L,_,R,I,22,h[7]),R=f(R,Q,L,_,D,7,h[8]),_=f(_,R,Q,L,P,12,h[9]),L=f(L,_,R,Q,U,17,h[10]),Q=f(Q,L,_,R,T,22,h[11]),R=f(R,Q,L,_,M,7,h[12]),_=f(_,R,Q,L,z,12,h[13]),L=f(L,_,R,Q,O,17,h[14]),Q=f(Q,L,_,R,H,22,h[15]),R=y(R,Q,L,_,K,5,h[16]),_=y(_,R,Q,L,C,9,h[17]),L=y(L,_,R,Q,T,14,h[18]),Q=y(Q,L,_,R,S,20,h[19]),R=y(R,Q,L,_,E,5,h[20]),_=y(_,R,Q,L,U,9,h[21]),L=y(L,_,R,Q,H,14,h[22]),Q=y(Q,L,_,R,B,20,h[23]),R=y(R,Q,L,_,P,5,h[24]),_=y(_,R,Q,L,O,9,h[25]),L=y(L,_,R,Q,k,14,h[26]),Q=y(Q,L,_,R,D,20,h[27]),R=y(R,Q,L,_,z,5,h[28]),_=y(_,R,Q,L,F,9,h[29]),L=y(L,_,R,Q,I,14,h[30]),Q=y(Q,L,_,R,M,20,h[31]),R=d(R,Q,L,_,E,4,h[32]),_=d(_,R,Q,L,D,11,h[33]),L=d(L,_,R,Q,T,16,h[34]),Q=d(Q,L,_,R,O,23,h[35]),R=d(R,Q,L,_,K,4,h[36]),_=d(_,R,Q,L,B,11,h[37]),L=d(L,_,R,Q,I,16,h[38]),Q=d(Q,L,_,R,U,23,h[39]),R=d(R,Q,L,_,z,4,h[40]),_=d(_,R,Q,L,S,11,h[41]),L=d(L,_,R,Q,k,16,h[42]),Q=d(Q,L,_,R,C,23,h[43]),R=d(R,Q,L,_,P,4,h[44]),_=d(_,R,Q,L,M,11,h[45]),L=d(L,_,R,Q,H,16,h[46]),Q=d(Q,L,_,R,F,23,h[47]),R=g(R,Q,L,_,S,6,h[48]),_=g(_,R,Q,L,I,10,h[49]),L=g(L,_,R,Q,O,15,h[50]),Q=g(Q,L,_,R,E,21,h[51]),R=g(R,Q,L,_,M,6,h[52]),_=g(_,R,Q,L,k,10,h[53]),L=g(L,_,R,Q,U,15,h[54]),Q=g(Q,L,_,R,K,21,h[55]),R=g(R,Q,L,_,D,6,h[56]),_=g(_,R,Q,L,H,10,h[57]),L=g(L,_,R,Q,C,15,h[58]),Q=g(Q,L,_,R,z,21,h[59]),R=g(R,Q,L,_,B,6,h[60]),_=g(_,R,Q,L,T,10,h[61]),L=g(L,_,R,Q,F,15,h[62]),Q=g(Q,L,_,R,P,21,h[63]),b[0]=b[0]+R|0,b[1]=b[1]+Q|0,b[2]=b[2]+L|0,b[3]=b[3]+_|0},_doFinalize:function(){var p=this._data,A=p.words,v=this._nDataBytes*8,w=p.sigBytes*8;A[w>>>5]|=128<<24-w%32;var x=r.floor(v/4294967296),b=v;A[(w+64>>>9<<4)+15]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,A[(w+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,p.sigBytes=(A.length+1)*4,this._process();for(var S=this._hash,K=S.words,F=0;F<4;F++){var k=K[F];K[F]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return S},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});function f(p,A,v,w,x,b,S){var K=p+(A&v|~A&w)+x+S;return(K<<b|K>>>32-b)+A}function y(p,A,v,w,x,b,S){var K=p+(A&w|v&~w)+x+S;return(K<<b|K>>>32-b)+A}function d(p,A,v,w,x,b,S){var K=p+(A^v^w)+x+S;return(K<<b|K>>>32-b)+A}function g(p,A,v,w,x,b,S){var K=p+(v^(A|~w))+x+S;return(K<<b|K>>>32-b)+A}i.MD5=o._createHelper(u),i.HmacMD5=o._createHmacHelper(u)}(Math),e.MD5})}(us)),us.exports}var fs={exports:{}},No;function x3(){return No||(No=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.WordArray,a=i.Hasher,o=r.algo,c=[],h=o.SHA1=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,f){for(var y=this._hash.words,d=y[0],g=y[1],p=y[2],A=y[3],v=y[4],w=0;w<80;w++){if(w<16)c[w]=u[f+w]|0;else{var x=c[w-3]^c[w-8]^c[w-14]^c[w-16];c[w]=x<<1|x>>>31}var b=(d<<5|d>>>27)+v+c[w];w<20?b+=(g&p|~g&A)+1518500249:w<40?b+=(g^p^A)+1859775393:w<60?b+=(g&p|g&A|p&A)-1894007588:b+=(g^p^A)-899497514,v=A,A=p,p=g<<30|g>>>2,g=d,d=b}y[0]=y[0]+d|0,y[1]=y[1]+g|0,y[2]=y[2]+p|0,y[3]=y[3]+A|0,y[4]=y[4]+v|0},_doFinalize:function(){var u=this._data,f=u.words,y=this._nDataBytes*8,d=u.sigBytes*8;return f[d>>>5]|=128<<24-d%32,f[(d+64>>>9<<4)+14]=Math.floor(y/4294967296),f[(d+64>>>9<<4)+15]=y,u.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});r.SHA1=a._createHelper(h),r.HmacSHA1=a._createHmacHelper(h)}(),e.SHA1})}(fs)),fs.exports}var ls={exports:{}},zo;function Wa(){return zo||(zo=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){return function(r){var i=e,s=i.lib,a=s.WordArray,o=s.Hasher,c=i.algo,h=[],u=[];(function(){function d(v){for(var w=r.sqrt(v),x=2;x<=w;x++)if(!(v%x))return!1;return!0}function g(v){return(v-(v|0))*4294967296|0}for(var p=2,A=0;A<64;)d(p)&&(A<8&&(h[A]=g(r.pow(p,1/2))),u[A]=g(r.pow(p,1/3)),A++),p++})();var f=[],y=c.SHA256=o.extend({_doReset:function(){this._hash=new a.init(h.slice(0))},_doProcessBlock:function(d,g){for(var p=this._hash.words,A=p[0],v=p[1],w=p[2],x=p[3],b=p[4],S=p[5],K=p[6],F=p[7],k=0;k<64;k++){if(k<16)f[k]=d[g+k]|0;else{var B=f[k-15],E=(B<<25|B>>>7)^(B<<14|B>>>18)^B>>>3,C=f[k-2],I=(C<<15|C>>>17)^(C<<13|C>>>19)^C>>>10;f[k]=E+f[k-7]+I+f[k-16]}var D=b&S^~b&K,P=A&v^A&w^v&w,U=(A<<30|A>>>2)^(A<<19|A>>>13)^(A<<10|A>>>22),T=(b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25),M=F+T+D+u[k]+f[k],z=U+P;F=K,K=S,S=b,b=x+M|0,x=w,w=v,v=A,A=M+z|0}p[0]=p[0]+A|0,p[1]=p[1]+v|0,p[2]=p[2]+w|0,p[3]=p[3]+x|0,p[4]=p[4]+b|0,p[5]=p[5]+S|0,p[6]=p[6]+K|0,p[7]=p[7]+F|0},_doFinalize:function(){var d=this._data,g=d.words,p=this._nDataBytes*8,A=d.sigBytes*8;return g[A>>>5]|=128<<24-A%32,g[(A+64>>>9<<4)+14]=r.floor(p/4294967296),g[(A+64>>>9<<4)+15]=p,d.sigBytes=g.length*4,this._process(),this._hash},clone:function(){var d=o.clone.call(this);return d._hash=this._hash.clone(),d}});i.SHA256=o._createHelper(y),i.HmacSHA256=o._createHmacHelper(y)}(Math),e.SHA256})}(ls)),ls.exports}var ys={exports:{}},Oo;function y6(){return Oo||(Oo=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Wa())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.WordArray,a=r.algo,o=a.SHA256,c=a.SHA224=o.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var h=o._doFinalize.call(this);return h.sigBytes-=4,h}});r.SHA224=o._createHelper(c),r.HmacSHA224=o._createHmacHelper(c)}(),e.SHA224})}(ys)),ys.exports}var ds={exports:{}},Go;function w3(){return Go||(Go=1,function(n,t){(function(e,r,i){n.exports=r(nt(),ki())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.Hasher,a=r.x64,o=a.Word,c=a.WordArray,h=r.algo;function u(){return o.create.apply(o,arguments)}var f=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],y=[];(function(){for(var g=0;g<80;g++)y[g]=u()})();var d=h.SHA512=s.extend({_doReset:function(){this._hash=new c.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(g,p){for(var A=this._hash.words,v=A[0],w=A[1],x=A[2],b=A[3],S=A[4],K=A[5],F=A[6],k=A[7],B=v.high,E=v.low,C=w.high,I=w.low,D=x.high,P=x.low,U=b.high,T=b.low,M=S.high,z=S.low,O=K.high,H=K.low,R=F.high,Q=F.low,L=k.high,_=k.low,G=B,N=E,j=C,q=I,$=D,Z=P,at=U,ot=T,it=M,et=z,yt=O,ye=H,de=R,Ne=Q,e0=L,sr=_,Gt=0;Gt<80;Gt++){var Nt,pe,r0=y[Gt];if(Gt<16)pe=r0.high=g[p+Gt*2]|0,Nt=r0.low=g[p+Gt*2+1]|0;else{var vn=y[Gt-15],ar=vn.high,Pr=vn.low,b3=(ar>>>1|Pr<<31)^(ar>>>8|Pr<<24)^ar>>>7,Va=(Pr>>>1|ar<<31)^(Pr>>>8|ar<<24)^(Pr>>>7|ar<<25),Ya=y[Gt-2],n0=Ya.high,P0=Ya.low,m3=(n0>>>19|P0<<13)^(n0<<3|P0>>>29)^n0>>>6,Za=(P0>>>19|n0<<13)^(P0<<3|n0>>>29)^(P0>>>6|n0<<26),Xa=y[Gt-7],v3=Xa.high,E3=Xa.low,$a=y[Gt-16],B3=$a.high,Ja=$a.low;Nt=Va+E3,pe=b3+v3+(Nt>>>0<Va>>>0?1:0),Nt=Nt+Za,pe=pe+m3+(Nt>>>0<Za>>>0?1:0),Nt=Nt+Ja,pe=pe+B3+(Nt>>>0<Ja>>>0?1:0),r0.high=pe,r0.low=Nt}var k3=it&yt^~it&de,t1=et&ye^~et&Ne,C3=G&j^G&$^j&$,D3=N&q^N&Z^q&Z,S3=(G>>>28|N<<4)^(G<<30|N>>>2)^(G<<25|N>>>7),e1=(N>>>28|G<<4)^(N<<30|G>>>2)^(N<<25|G>>>7),I3=(it>>>14|et<<18)^(it>>>18|et<<14)^(it<<23|et>>>9),K3=(et>>>14|it<<18)^(et>>>18|it<<14)^(et<<23|it>>>9),r1=f[Gt],F3=r1.high,n1=r1.low,re=sr+K3,or=e0+I3+(re>>>0<sr>>>0?1:0),re=re+t1,or=or+k3+(re>>>0<t1>>>0?1:0),re=re+n1,or=or+F3+(re>>>0<n1>>>0?1:0),re=re+Nt,or=or+pe+(re>>>0<Nt>>>0?1:0),i1=e1+D3,P3=S3+C3+(i1>>>0<e1>>>0?1:0);e0=de,sr=Ne,de=yt,Ne=ye,yt=it,ye=et,et=ot+re|0,it=at+or+(et>>>0<ot>>>0?1:0)|0,at=$,ot=Z,$=j,Z=q,j=G,q=N,N=re+i1|0,G=or+P3+(N>>>0<re>>>0?1:0)|0}E=v.low=E+N,v.high=B+G+(E>>>0<N>>>0?1:0),I=w.low=I+q,w.high=C+j+(I>>>0<q>>>0?1:0),P=x.low=P+Z,x.high=D+$+(P>>>0<Z>>>0?1:0),T=b.low=T+ot,b.high=U+at+(T>>>0<ot>>>0?1:0),z=S.low=z+et,S.high=M+it+(z>>>0<et>>>0?1:0),H=K.low=H+ye,K.high=O+yt+(H>>>0<ye>>>0?1:0),Q=F.low=Q+Ne,F.high=R+de+(Q>>>0<Ne>>>0?1:0),_=k.low=_+sr,k.high=L+e0+(_>>>0<sr>>>0?1:0)},_doFinalize:function(){var g=this._data,p=g.words,A=this._nDataBytes*8,v=g.sigBytes*8;p[v>>>5]|=128<<24-v%32,p[(v+128>>>10<<5)+30]=Math.floor(A/4294967296),p[(v+128>>>10<<5)+31]=A,g.sigBytes=p.length*4,this._process();var w=this._hash.toX32();return w},clone:function(){var g=s.clone.call(this);return g._hash=this._hash.clone(),g},blockSize:1024/32});r.SHA512=s._createHelper(d),r.HmacSHA512=s._createHmacHelper(d)}(),e.SHA512})}(ds)),ds.exports}var ps={exports:{}},qo;function d6(){return qo||(qo=1,function(n,t){(function(e,r,i){n.exports=r(nt(),ki(),w3())})(tt,function(e){return function(){var r=e,i=r.x64,s=i.Word,a=i.WordArray,o=r.algo,c=o.SHA512,h=o.SHA384=c.extend({_doReset:function(){this._hash=new a.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var u=c._doFinalize.call(this);return u.sigBytes-=16,u}});r.SHA384=c._createHelper(h),r.HmacSHA384=c._createHmacHelper(h)}(),e.SHA384})}(ps)),ps.exports}var gs={exports:{}},Wo;function p6(){return Wo||(Wo=1,function(n,t){(function(e,r,i){n.exports=r(nt(),ki())})(tt,function(e){return function(r){var i=e,s=i.lib,a=s.WordArray,o=s.Hasher,c=i.x64,h=c.Word,u=i.algo,f=[],y=[],d=[];(function(){for(var A=1,v=0,w=0;w<24;w++){f[A+5*v]=(w+1)*(w+2)/2%64;var x=v%5,b=(2*A+3*v)%5;A=x,v=b}for(var A=0;A<5;A++)for(var v=0;v<5;v++)y[A+5*v]=v+(2*A+3*v)%5*5;for(var S=1,K=0;K<24;K++){for(var F=0,k=0,B=0;B<7;B++){if(S&1){var E=(1<<B)-1;E<32?k^=1<<E:F^=1<<E-32}S&128?S=S<<1^113:S<<=1}d[K]=h.create(F,k)}})();var g=[];(function(){for(var A=0;A<25;A++)g[A]=h.create()})();var p=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var A=this._state=[],v=0;v<25;v++)A[v]=new h.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(A,v){for(var w=this._state,x=this.blockSize/2,b=0;b<x;b++){var S=A[v+2*b],K=A[v+2*b+1];S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,K=(K<<8|K>>>24)&16711935|(K<<24|K>>>8)&4278255360;var F=w[b];F.high^=K,F.low^=S}for(var k=0;k<24;k++){for(var B=0;B<5;B++){for(var E=0,C=0,I=0;I<5;I++){var F=w[B+5*I];E^=F.high,C^=F.low}var D=g[B];D.high=E,D.low=C}for(var B=0;B<5;B++)for(var P=g[(B+4)%5],U=g[(B+1)%5],T=U.high,M=U.low,E=P.high^(T<<1|M>>>31),C=P.low^(M<<1|T>>>31),I=0;I<5;I++){var F=w[B+5*I];F.high^=E,F.low^=C}for(var z=1;z<25;z++){var E,C,F=w[z],O=F.high,H=F.low,R=f[z];R<32?(E=O<<R|H>>>32-R,C=H<<R|O>>>32-R):(E=H<<R-32|O>>>64-R,C=O<<R-32|H>>>64-R);var Q=g[y[z]];Q.high=E,Q.low=C}var L=g[0],_=w[0];L.high=_.high,L.low=_.low;for(var B=0;B<5;B++)for(var I=0;I<5;I++){var z=B+5*I,F=w[z],G=g[z],N=g[(B+1)%5+5*I],j=g[(B+2)%5+5*I];F.high=G.high^~N.high&j.high,F.low=G.low^~N.low&j.low}var F=w[0],q=d[k];F.high^=q.high,F.low^=q.low}},_doFinalize:function(){var A=this._data,v=A.words;this._nDataBytes*8;var w=A.sigBytes*8,x=this.blockSize*32;v[w>>>5]|=1<<24-w%32,v[(r.ceil((w+1)/x)*x>>>5)-1]|=128,A.sigBytes=v.length*4,this._process();for(var b=this._state,S=this.cfg.outputLength/8,K=S/8,F=[],k=0;k<K;k++){var B=b[k],E=B.high,C=B.low;E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,F.push(C),F.push(E)}return new a.init(F,S)},clone:function(){for(var A=o.clone.call(this),v=A._state=this._state.slice(0),w=0;w<25;w++)v[w]=v[w].clone();return A}});i.SHA3=o._createHelper(p),i.HmacSHA3=o._createHmacHelper(p)}(Math),e.SHA3})}(gs)),gs.exports}var As={exports:{}},jo;function g6(){return jo||(jo=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=e,s=i.lib,a=s.WordArray,o=s.Hasher,c=i.algo,h=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),y=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=a.create([0,1518500249,1859775393,2400959708,2840853838]),g=a.create([1352829926,1548603684,1836072691,2053994217,0]),p=c.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(K,F){for(var k=0;k<16;k++){var B=F+k,E=K[B];K[B]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}var C=this._hash.words,I=d.words,D=g.words,P=h.words,U=u.words,T=f.words,M=y.words,z,O,H,R,Q,L,_,G,N,j;L=z=C[0],_=O=C[1],G=H=C[2],N=R=C[3],j=Q=C[4];for(var q,k=0;k<80;k+=1)q=z+K[F+P[k]]|0,k<16?q+=A(O,H,R)+I[0]:k<32?q+=v(O,H,R)+I[1]:k<48?q+=w(O,H,R)+I[2]:k<64?q+=x(O,H,R)+I[3]:q+=b(O,H,R)+I[4],q=q|0,q=S(q,T[k]),q=q+Q|0,z=Q,Q=R,R=S(H,10),H=O,O=q,q=L+K[F+U[k]]|0,k<16?q+=b(_,G,N)+D[0]:k<32?q+=x(_,G,N)+D[1]:k<48?q+=w(_,G,N)+D[2]:k<64?q+=v(_,G,N)+D[3]:q+=A(_,G,N)+D[4],q=q|0,q=S(q,M[k]),q=q+j|0,L=j,j=N,N=S(G,10),G=_,_=q;q=C[1]+H+N|0,C[1]=C[2]+R+j|0,C[2]=C[3]+Q+L|0,C[3]=C[4]+z+_|0,C[4]=C[0]+O+G|0,C[0]=q},_doFinalize:function(){var K=this._data,F=K.words,k=this._nDataBytes*8,B=K.sigBytes*8;F[B>>>5]|=128<<24-B%32,F[(B+64>>>9<<4)+14]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,K.sigBytes=(F.length+1)*4,this._process();for(var E=this._hash,C=E.words,I=0;I<5;I++){var D=C[I];C[I]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360}return E},clone:function(){var K=o.clone.call(this);return K._hash=this._hash.clone(),K}});function A(K,F,k){return K^F^k}function v(K,F,k){return K&F|~K&k}function w(K,F,k){return(K|~F)^k}function x(K,F,k){return K&k|F&~k}function b(K,F,k){return K^(F|~k)}function S(K,F){return K<<F|K>>>32-F}i.RIPEMD160=o._createHelper(p),i.HmacRIPEMD160=o._createHmacHelper(p)}(),e.RIPEMD160})}(As)),As.exports}var xs={exports:{}},Vo;function ja(){return Vo||(Vo=1,function(n,t){(function(e,r){n.exports=r(nt())})(tt,function(e){(function(){var r=e,i=r.lib,s=i.Base,a=r.enc,o=a.Utf8,c=r.algo;c.HMAC=s.extend({init:function(h,u){h=this._hasher=new h.init,typeof u=="string"&&(u=o.parse(u));var f=h.blockSize,y=f*4;u.sigBytes>y&&(u=h.finalize(u)),u.clamp();for(var d=this._oKey=u.clone(),g=this._iKey=u.clone(),p=d.words,A=g.words,v=0;v<f;v++)p[v]^=1549556828,A[v]^=909522486;d.sigBytes=g.sigBytes=y,this.reset()},reset:function(){var h=this._hasher;h.reset(),h.update(this._iKey)},update:function(h){return this._hasher.update(h),this},finalize:function(h){var u=this._hasher,f=u.finalize(h);u.reset();var y=u.finalize(this._oKey.clone().concat(f));return y}})})()})}(xs)),xs.exports}var ws={exports:{}},Yo;function A6(){return Yo||(Yo=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Wa(),ja())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.Base,a=i.WordArray,o=r.algo,c=o.SHA256,h=o.HMAC,u=o.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:c,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,y){for(var d=this.cfg,g=h.create(d.hasher,f),p=a.create(),A=a.create([1]),v=p.words,w=A.words,x=d.keySize,b=d.iterations;v.length<x;){var S=g.update(y).finalize(A);g.reset();for(var K=S.words,F=K.length,k=S,B=1;B<b;B++){k=g.finalize(k),g.reset();for(var E=k.words,C=0;C<F;C++)K[C]^=E[C]}p.concat(S),w[0]++}return p.sigBytes=x*4,p}});r.PBKDF2=function(f,y,d){return u.create(d).compute(f,y)}}(),e.PBKDF2})}(ws)),ws.exports}var bs={exports:{}},Zo;function Fr(){return Zo||(Zo=1,function(n,t){(function(e,r,i){n.exports=r(nt(),x3(),ja())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.Base,a=i.WordArray,o=r.algo,c=o.MD5,h=o.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:c,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,f){for(var y,d=this.cfg,g=d.hasher.create(),p=a.create(),A=p.words,v=d.keySize,w=d.iterations;A.length<v;){y&&g.update(y),y=g.update(u).finalize(f),g.reset();for(var x=1;x<w;x++)y=g.finalize(y),g.reset();p.concat(y)}return p.sigBytes=v*4,p}});r.EvpKDF=function(u,f,y){return h.create(y).compute(u,f)}}(),e.EvpKDF})}(bs)),bs.exports}var ms={exports:{}},Xo;function Ut(){return Xo||(Xo=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Fr())})(tt,function(e){e.lib.Cipher||function(r){var i=e,s=i.lib,a=s.Base,o=s.WordArray,c=s.BufferedBlockAlgorithm,h=i.enc;h.Utf8;var u=h.Base64,f=i.algo,y=f.EvpKDF,d=s.Cipher=c.extend({cfg:a.extend(),createEncryptor:function(E,C){return this.create(this._ENC_XFORM_MODE,E,C)},createDecryptor:function(E,C){return this.create(this._DEC_XFORM_MODE,E,C)},init:function(E,C,I){this.cfg=this.cfg.extend(I),this._xformMode=E,this._key=C,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(E){return this._append(E),this._process()},finalize:function(E){E&&this._append(E);var C=this._doFinalize();return C},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function E(C){return typeof C=="string"?B:K}return function(C){return{encrypt:function(I,D,P){return E(D).encrypt(C,I,D,P)},decrypt:function(I,D,P){return E(D).decrypt(C,I,D,P)}}}}()});s.StreamCipher=d.extend({_doFinalize:function(){var E=this._process(!0);return E},blockSize:1});var g=i.mode={},p=s.BlockCipherMode=a.extend({createEncryptor:function(E,C){return this.Encryptor.create(E,C)},createDecryptor:function(E,C){return this.Decryptor.create(E,C)},init:function(E,C){this._cipher=E,this._iv=C}}),A=g.CBC=function(){var E=p.extend();E.Encryptor=E.extend({processBlock:function(I,D){var P=this._cipher,U=P.blockSize;C.call(this,I,D,U),P.encryptBlock(I,D),this._prevBlock=I.slice(D,D+U)}}),E.Decryptor=E.extend({processBlock:function(I,D){var P=this._cipher,U=P.blockSize,T=I.slice(D,D+U);P.decryptBlock(I,D),C.call(this,I,D,U),this._prevBlock=T}});function C(I,D,P){var U,T=this._iv;T?(U=T,this._iv=r):U=this._prevBlock;for(var M=0;M<P;M++)I[D+M]^=U[M]}return E}(),v=i.pad={},w=v.Pkcs7={pad:function(E,C){for(var I=C*4,D=I-E.sigBytes%I,P=D<<24|D<<16|D<<8|D,U=[],T=0;T<D;T+=4)U.push(P);var M=o.create(U,D);E.concat(M)},unpad:function(E){var C=E.words[E.sigBytes-1>>>2]&255;E.sigBytes-=C}};s.BlockCipher=d.extend({cfg:d.cfg.extend({mode:A,padding:w}),reset:function(){var E;d.reset.call(this);var C=this.cfg,I=C.iv,D=C.mode;this._xformMode==this._ENC_XFORM_MODE?E=D.createEncryptor:(E=D.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==E?this._mode.init(this,I&&I.words):(this._mode=E.call(D,this,I&&I.words),this._mode.__creator=E)},_doProcessBlock:function(E,C){this._mode.processBlock(E,C)},_doFinalize:function(){var E,C=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(C.pad(this._data,this.blockSize),E=this._process(!0)):(E=this._process(!0),C.unpad(E)),E},blockSize:128/32});var x=s.CipherParams=a.extend({init:function(E){this.mixIn(E)},toString:function(E){return(E||this.formatter).stringify(this)}}),b=i.format={},S=b.OpenSSL={stringify:function(E){var C,I=E.ciphertext,D=E.salt;return D?C=o.create([1398893684,1701076831]).concat(D).concat(I):C=I,C.toString(u)},parse:function(E){var C,I=u.parse(E),D=I.words;return D[0]==1398893684&&D[1]==1701076831&&(C=o.create(D.slice(2,4)),D.splice(0,4),I.sigBytes-=16),x.create({ciphertext:I,salt:C})}},K=s.SerializableCipher=a.extend({cfg:a.extend({format:S}),encrypt:function(E,C,I,D){D=this.cfg.extend(D);var P=E.createEncryptor(I,D),U=P.finalize(C),T=P.cfg;return x.create({ciphertext:U,key:I,iv:T.iv,algorithm:E,mode:T.mode,padding:T.padding,blockSize:E.blockSize,formatter:D.format})},decrypt:function(E,C,I,D){D=this.cfg.extend(D),C=this._parse(C,D.format);var P=E.createDecryptor(I,D).finalize(C.ciphertext);return P},_parse:function(E,C){return typeof E=="string"?C.parse(E,this):E}}),F=i.kdf={},k=F.OpenSSL={execute:function(E,C,I,D,P){if(D||(D=o.random(64/8)),P)var U=y.create({keySize:C+I,hasher:P}).compute(E,D);else var U=y.create({keySize:C+I}).compute(E,D);var T=o.create(U.words.slice(C),I*4);return U.sigBytes=C*4,x.create({key:U,iv:T,salt:D})}},B=s.PasswordBasedCipher=K.extend({cfg:K.cfg.extend({kdf:k}),encrypt:function(E,C,I,D){D=this.cfg.extend(D);var P=D.kdf.execute(I,E.keySize,E.ivSize,D.salt,D.hasher);D.iv=P.iv;var U=K.encrypt.call(this,E,C,P.key,D);return U.mixIn(P),U},decrypt:function(E,C,I,D){D=this.cfg.extend(D),C=this._parse(C,D.format);var P=D.kdf.execute(I,E.keySize,E.ivSize,C.salt,D.hasher);D.iv=P.iv;var U=K.decrypt.call(this,E,C,P.key,D);return U}})}()})}(ms)),ms.exports}var vs={exports:{}},$o;function x6(){return $o||($o=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.mode.CFB=function(){var r=e.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(s,a){var o=this._cipher,c=o.blockSize;i.call(this,s,a,c,o),this._prevBlock=s.slice(a,a+c)}}),r.Decryptor=r.extend({processBlock:function(s,a){var o=this._cipher,c=o.blockSize,h=s.slice(a,a+c);i.call(this,s,a,c,o),this._prevBlock=h}});function i(s,a,o,c){var h,u=this._iv;u?(h=u.slice(0),this._iv=void 0):h=this._prevBlock,c.encryptBlock(h,0);for(var f=0;f<o;f++)s[a+f]^=h[f]}return r}(),e.mode.CFB})}(vs)),vs.exports}var Es={exports:{}},Jo;function w6(){return Jo||(Jo=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.mode.CTR=function(){var r=e.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(s,a){var o=this._cipher,c=o.blockSize,h=this._iv,u=this._counter;h&&(u=this._counter=h.slice(0),this._iv=void 0);var f=u.slice(0);o.encryptBlock(f,0),u[c-1]=u[c-1]+1|0;for(var y=0;y<c;y++)s[a+y]^=f[y]}});return r.Decryptor=i,r}(),e.mode.CTR})}(Es)),Es.exports}var Bs={exports:{}},t2;function b6(){return t2||(t2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return e.mode.CTRGladman=function(){var r=e.lib.BlockCipherMode.extend();function i(o){if((o>>24&255)===255){var c=o>>16&255,h=o>>8&255,u=o&255;c===255?(c=0,h===255?(h=0,u===255?u=0:++u):++h):++c,o=0,o+=c<<16,o+=h<<8,o+=u}else o+=1<<24;return o}function s(o){return(o[0]=i(o[0]))===0&&(o[1]=i(o[1])),o}var a=r.Encryptor=r.extend({processBlock:function(o,c){var h=this._cipher,u=h.blockSize,f=this._iv,y=this._counter;f&&(y=this._counter=f.slice(0),this._iv=void 0),s(y);var d=y.slice(0);h.encryptBlock(d,0);for(var g=0;g<u;g++)o[c+g]^=d[g]}});return r.Decryptor=a,r}(),e.mode.CTRGladman})}(Bs)),Bs.exports}var ks={exports:{}},e2;function m6(){return e2||(e2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.mode.OFB=function(){var r=e.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(s,a){var o=this._cipher,c=o.blockSize,h=this._iv,u=this._keystream;h&&(u=this._keystream=h.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var f=0;f<c;f++)s[a+f]^=u[f]}});return r.Decryptor=i,r}(),e.mode.OFB})}(ks)),ks.exports}var Cs={exports:{}},r2;function v6(){return r2||(r2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.mode.ECB=function(){var r=e.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,s){this._cipher.encryptBlock(i,s)}}),r.Decryptor=r.extend({processBlock:function(i,s){this._cipher.decryptBlock(i,s)}}),r}(),e.mode.ECB})}(Cs)),Cs.exports}var Ds={exports:{}},n2;function E6(){return n2||(n2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.pad.AnsiX923={pad:function(r,i){var s=r.sigBytes,a=i*4,o=a-s%a,c=s+o-1;r.clamp(),r.words[c>>>2]|=o<<24-c%4*8,r.sigBytes+=o},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},e.pad.Ansix923})}(Ds)),Ds.exports}var Ss={exports:{}},i2;function B6(){return i2||(i2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.pad.Iso10126={pad:function(r,i){var s=i*4,a=s-r.sigBytes%s;r.concat(e.lib.WordArray.random(a-1)).concat(e.lib.WordArray.create([a<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},e.pad.Iso10126})}(Ss)),Ss.exports}var Is={exports:{}},s2;function k6(){return s2||(s2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.pad.Iso97971={pad:function(r,i){r.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(r,i)},unpad:function(r){e.pad.ZeroPadding.unpad(r),r.sigBytes--}},e.pad.Iso97971})}(Is)),Is.exports}var Ks={exports:{}},a2;function C6(){return a2||(a2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.pad.ZeroPadding={pad:function(r,i){var s=i*4;r.clamp(),r.sigBytes+=s-(r.sigBytes%s||s)},unpad:function(r){for(var i=r.words,s=r.sigBytes-1,s=r.sigBytes-1;s>=0;s--)if(i[s>>>2]>>>24-s%4*8&255){r.sigBytes=s+1;break}}},e.pad.ZeroPadding})}(Ks)),Ks.exports}var Fs={exports:{}},o2;function D6(){return o2||(o2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding})}(Fs)),Fs.exports}var Ps={exports:{}},c2;function S6(){return c2||(c2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Ut())})(tt,function(e){return function(r){var i=e,s=i.lib,a=s.CipherParams,o=i.enc,c=o.Hex,h=i.format;h.Hex={stringify:function(u){return u.ciphertext.toString(c)},parse:function(u){var f=c.parse(u);return a.create({ciphertext:f})}}}(),e.format.Hex})}(Ps)),Ps.exports}var Us={exports:{}},h2;function I6(){return h2||(h2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Jr(),t0(),Fr(),Ut())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.BlockCipher,a=r.algo,o=[],c=[],h=[],u=[],f=[],y=[],d=[],g=[],p=[],A=[];(function(){for(var x=[],b=0;b<256;b++)b<128?x[b]=b<<1:x[b]=b<<1^283;for(var S=0,K=0,b=0;b<256;b++){var F=K^K<<1^K<<2^K<<3^K<<4;F=F>>>8^F&255^99,o[S]=F,c[F]=S;var k=x[S],B=x[k],E=x[B],C=x[F]*257^F*16843008;h[S]=C<<24|C>>>8,u[S]=C<<16|C>>>16,f[S]=C<<8|C>>>24,y[S]=C;var C=E*16843009^B*65537^k*257^S*16843008;d[F]=C<<24|C>>>8,g[F]=C<<16|C>>>16,p[F]=C<<8|C>>>24,A[F]=C,S?(S=k^x[x[x[E^k]]],K^=x[x[K]]):S=K=1}})();var v=[0,1,2,4,8,16,32,64,128,27,54],w=a.AES=s.extend({_doReset:function(){var x;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var b=this._keyPriorReset=this._key,S=b.words,K=b.sigBytes/4,F=this._nRounds=K+6,k=(F+1)*4,B=this._keySchedule=[],E=0;E<k;E++)E<K?B[E]=S[E]:(x=B[E-1],E%K?K>6&&E%K==4&&(x=o[x>>>24]<<24|o[x>>>16&255]<<16|o[x>>>8&255]<<8|o[x&255]):(x=x<<8|x>>>24,x=o[x>>>24]<<24|o[x>>>16&255]<<16|o[x>>>8&255]<<8|o[x&255],x^=v[E/K|0]<<24),B[E]=B[E-K]^x);for(var C=this._invKeySchedule=[],I=0;I<k;I++){var E=k-I;if(I%4)var x=B[E];else var x=B[E-4];I<4||E<=4?C[I]=x:C[I]=d[o[x>>>24]]^g[o[x>>>16&255]]^p[o[x>>>8&255]]^A[o[x&255]]}}},encryptBlock:function(x,b){this._doCryptBlock(x,b,this._keySchedule,h,u,f,y,o)},decryptBlock:function(x,b){var S=x[b+1];x[b+1]=x[b+3],x[b+3]=S,this._doCryptBlock(x,b,this._invKeySchedule,d,g,p,A,c);var S=x[b+1];x[b+1]=x[b+3],x[b+3]=S},_doCryptBlock:function(x,b,S,K,F,k,B,E){for(var C=this._nRounds,I=x[b]^S[0],D=x[b+1]^S[1],P=x[b+2]^S[2],U=x[b+3]^S[3],T=4,M=1;M<C;M++){var z=K[I>>>24]^F[D>>>16&255]^k[P>>>8&255]^B[U&255]^S[T++],O=K[D>>>24]^F[P>>>16&255]^k[U>>>8&255]^B[I&255]^S[T++],H=K[P>>>24]^F[U>>>16&255]^k[I>>>8&255]^B[D&255]^S[T++],R=K[U>>>24]^F[I>>>16&255]^k[D>>>8&255]^B[P&255]^S[T++];I=z,D=O,P=H,U=R}var z=(E[I>>>24]<<24|E[D>>>16&255]<<16|E[P>>>8&255]<<8|E[U&255])^S[T++],O=(E[D>>>24]<<24|E[P>>>16&255]<<16|E[U>>>8&255]<<8|E[I&255])^S[T++],H=(E[P>>>24]<<24|E[U>>>16&255]<<16|E[I>>>8&255]<<8|E[D&255])^S[T++],R=(E[U>>>24]<<24|E[I>>>16&255]<<16|E[D>>>8&255]<<8|E[P&255])^S[T++];x[b]=z,x[b+1]=O,x[b+2]=H,x[b+3]=R},keySize:256/32});r.AES=s._createHelper(w)}(),e.AES})}(Us)),Us.exports}var Rs={exports:{}},u2;function K6(){return u2||(u2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Jr(),t0(),Fr(),Ut())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.WordArray,a=i.BlockCipher,o=r.algo,c=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],h=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],y=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=o.DES=a.extend({_doReset:function(){for(var v=this._key,w=v.words,x=[],b=0;b<56;b++){var S=c[b]-1;x[b]=w[S>>>5]>>>31-S%32&1}for(var K=this._subKeys=[],F=0;F<16;F++){for(var k=K[F]=[],B=u[F],b=0;b<24;b++)k[b/6|0]|=x[(h[b]-1+B)%28]<<31-b%6,k[4+(b/6|0)]|=x[28+(h[b+24]-1+B)%28]<<31-b%6;k[0]=k[0]<<1|k[0]>>>31;for(var b=1;b<7;b++)k[b]=k[b]>>>(b-1)*4+3;k[7]=k[7]<<5|k[7]>>>27}for(var E=this._invSubKeys=[],b=0;b<16;b++)E[b]=K[15-b]},encryptBlock:function(v,w){this._doCryptBlock(v,w,this._subKeys)},decryptBlock:function(v,w){this._doCryptBlock(v,w,this._invSubKeys)},_doCryptBlock:function(v,w,x){this._lBlock=v[w],this._rBlock=v[w+1],g.call(this,4,252645135),g.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),g.call(this,1,1431655765);for(var b=0;b<16;b++){for(var S=x[b],K=this._lBlock,F=this._rBlock,k=0,B=0;B<8;B++)k|=f[B][((F^S[B])&y[B])>>>0];this._lBlock=F,this._rBlock=K^k}var E=this._lBlock;this._lBlock=this._rBlock,this._rBlock=E,g.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),g.call(this,16,65535),g.call(this,4,252645135),v[w]=this._lBlock,v[w+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function g(v,w){var x=(this._lBlock>>>v^this._rBlock)&w;this._rBlock^=x,this._lBlock^=x<<v}function p(v,w){var x=(this._rBlock>>>v^this._lBlock)&w;this._lBlock^=x,this._rBlock^=x<<v}r.DES=a._createHelper(d);var A=o.TripleDES=a.extend({_doReset:function(){var v=this._key,w=v.words;if(w.length!==2&&w.length!==4&&w.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var x=w.slice(0,2),b=w.length<4?w.slice(0,2):w.slice(2,4),S=w.length<6?w.slice(0,2):w.slice(4,6);this._des1=d.createEncryptor(s.create(x)),this._des2=d.createEncryptor(s.create(b)),this._des3=d.createEncryptor(s.create(S))},encryptBlock:function(v,w){this._des1.encryptBlock(v,w),this._des2.decryptBlock(v,w),this._des3.encryptBlock(v,w)},decryptBlock:function(v,w){this._des3.decryptBlock(v,w),this._des2.encryptBlock(v,w),this._des1.decryptBlock(v,w)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=a._createHelper(A)}(),e.TripleDES})}(Rs)),Rs.exports}var Qs={exports:{}},f2;function F6(){return f2||(f2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Jr(),t0(),Fr(),Ut())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.StreamCipher,a=r.algo,o=a.RC4=s.extend({_doReset:function(){for(var u=this._key,f=u.words,y=u.sigBytes,d=this._S=[],g=0;g<256;g++)d[g]=g;for(var g=0,p=0;g<256;g++){var A=g%y,v=f[A>>>2]>>>24-A%4*8&255;p=(p+d[g]+v)%256;var w=d[g];d[g]=d[p],d[p]=w}this._i=this._j=0},_doProcessBlock:function(u,f){u[f]^=c.call(this)},keySize:256/32,ivSize:0});function c(){for(var u=this._S,f=this._i,y=this._j,d=0,g=0;g<4;g++){f=(f+1)%256,y=(y+u[f])%256;var p=u[f];u[f]=u[y],u[y]=p,d|=u[(u[f]+u[y])%256]<<24-g*8}return this._i=f,this._j=y,d}r.RC4=s._createHelper(o);var h=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)c.call(this)}});r.RC4Drop=s._createHelper(h)}(),e.RC4})}(Qs)),Qs.exports}var _s={exports:{}},l2;function P6(){return l2||(l2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Jr(),t0(),Fr(),Ut())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.StreamCipher,a=r.algo,o=[],c=[],h=[],u=a.Rabbit=s.extend({_doReset:function(){for(var y=this._key.words,d=this.cfg.iv,g=0;g<4;g++)y[g]=(y[g]<<8|y[g]>>>24)&16711935|(y[g]<<24|y[g]>>>8)&4278255360;var p=this._X=[y[0],y[3]<<16|y[2]>>>16,y[1],y[0]<<16|y[3]>>>16,y[2],y[1]<<16|y[0]>>>16,y[3],y[2]<<16|y[1]>>>16],A=this._C=[y[2]<<16|y[2]>>>16,y[0]&4294901760|y[1]&65535,y[3]<<16|y[3]>>>16,y[1]&4294901760|y[2]&65535,y[0]<<16|y[0]>>>16,y[2]&4294901760|y[3]&65535,y[1]<<16|y[1]>>>16,y[3]&4294901760|y[0]&65535];this._b=0;for(var g=0;g<4;g++)f.call(this);for(var g=0;g<8;g++)A[g]^=p[g+4&7];if(d){var v=d.words,w=v[0],x=v[1],b=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,S=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,K=b>>>16|S&4294901760,F=S<<16|b&65535;A[0]^=b,A[1]^=K,A[2]^=S,A[3]^=F,A[4]^=b,A[5]^=K,A[6]^=S,A[7]^=F;for(var g=0;g<4;g++)f.call(this)}},_doProcessBlock:function(y,d){var g=this._X;f.call(this),o[0]=g[0]^g[5]>>>16^g[3]<<16,o[1]=g[2]^g[7]>>>16^g[5]<<16,o[2]=g[4]^g[1]>>>16^g[7]<<16,o[3]=g[6]^g[3]>>>16^g[1]<<16;for(var p=0;p<4;p++)o[p]=(o[p]<<8|o[p]>>>24)&16711935|(o[p]<<24|o[p]>>>8)&4278255360,y[d+p]^=o[p]},blockSize:128/32,ivSize:64/32});function f(){for(var y=this._X,d=this._C,g=0;g<8;g++)c[g]=d[g];d[0]=d[0]+1295307597+this._b|0,d[1]=d[1]+3545052371+(d[0]>>>0<c[0]>>>0?1:0)|0,d[2]=d[2]+886263092+(d[1]>>>0<c[1]>>>0?1:0)|0,d[3]=d[3]+1295307597+(d[2]>>>0<c[2]>>>0?1:0)|0,d[4]=d[4]+3545052371+(d[3]>>>0<c[3]>>>0?1:0)|0,d[5]=d[5]+886263092+(d[4]>>>0<c[4]>>>0?1:0)|0,d[6]=d[6]+1295307597+(d[5]>>>0<c[5]>>>0?1:0)|0,d[7]=d[7]+3545052371+(d[6]>>>0<c[6]>>>0?1:0)|0,this._b=d[7]>>>0<c[7]>>>0?1:0;for(var g=0;g<8;g++){var p=y[g]+d[g],A=p&65535,v=p>>>16,w=((A*A>>>17)+A*v>>>15)+v*v,x=((p&4294901760)*p|0)+((p&65535)*p|0);h[g]=w^x}y[0]=h[0]+(h[7]<<16|h[7]>>>16)+(h[6]<<16|h[6]>>>16)|0,y[1]=h[1]+(h[0]<<8|h[0]>>>24)+h[7]|0,y[2]=h[2]+(h[1]<<16|h[1]>>>16)+(h[0]<<16|h[0]>>>16)|0,y[3]=h[3]+(h[2]<<8|h[2]>>>24)+h[1]|0,y[4]=h[4]+(h[3]<<16|h[3]>>>16)+(h[2]<<16|h[2]>>>16)|0,y[5]=h[5]+(h[4]<<8|h[4]>>>24)+h[3]|0,y[6]=h[6]+(h[5]<<16|h[5]>>>16)+(h[4]<<16|h[4]>>>16)|0,y[7]=h[7]+(h[6]<<8|h[6]>>>24)+h[5]|0}r.Rabbit=s._createHelper(u)}(),e.Rabbit})}(_s)),_s.exports}var Ls={exports:{}},y2;function U6(){return y2||(y2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Jr(),t0(),Fr(),Ut())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.StreamCipher,a=r.algo,o=[],c=[],h=[],u=a.RabbitLegacy=s.extend({_doReset:function(){var y=this._key.words,d=this.cfg.iv,g=this._X=[y[0],y[3]<<16|y[2]>>>16,y[1],y[0]<<16|y[3]>>>16,y[2],y[1]<<16|y[0]>>>16,y[3],y[2]<<16|y[1]>>>16],p=this._C=[y[2]<<16|y[2]>>>16,y[0]&4294901760|y[1]&65535,y[3]<<16|y[3]>>>16,y[1]&4294901760|y[2]&65535,y[0]<<16|y[0]>>>16,y[2]&4294901760|y[3]&65535,y[1]<<16|y[1]>>>16,y[3]&4294901760|y[0]&65535];this._b=0;for(var A=0;A<4;A++)f.call(this);for(var A=0;A<8;A++)p[A]^=g[A+4&7];if(d){var v=d.words,w=v[0],x=v[1],b=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,S=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,K=b>>>16|S&4294901760,F=S<<16|b&65535;p[0]^=b,p[1]^=K,p[2]^=S,p[3]^=F,p[4]^=b,p[5]^=K,p[6]^=S,p[7]^=F;for(var A=0;A<4;A++)f.call(this)}},_doProcessBlock:function(y,d){var g=this._X;f.call(this),o[0]=g[0]^g[5]>>>16^g[3]<<16,o[1]=g[2]^g[7]>>>16^g[5]<<16,o[2]=g[4]^g[1]>>>16^g[7]<<16,o[3]=g[6]^g[3]>>>16^g[1]<<16;for(var p=0;p<4;p++)o[p]=(o[p]<<8|o[p]>>>24)&16711935|(o[p]<<24|o[p]>>>8)&4278255360,y[d+p]^=o[p]},blockSize:128/32,ivSize:64/32});function f(){for(var y=this._X,d=this._C,g=0;g<8;g++)c[g]=d[g];d[0]=d[0]+1295307597+this._b|0,d[1]=d[1]+3545052371+(d[0]>>>0<c[0]>>>0?1:0)|0,d[2]=d[2]+886263092+(d[1]>>>0<c[1]>>>0?1:0)|0,d[3]=d[3]+1295307597+(d[2]>>>0<c[2]>>>0?1:0)|0,d[4]=d[4]+3545052371+(d[3]>>>0<c[3]>>>0?1:0)|0,d[5]=d[5]+886263092+(d[4]>>>0<c[4]>>>0?1:0)|0,d[6]=d[6]+1295307597+(d[5]>>>0<c[5]>>>0?1:0)|0,d[7]=d[7]+3545052371+(d[6]>>>0<c[6]>>>0?1:0)|0,this._b=d[7]>>>0<c[7]>>>0?1:0;for(var g=0;g<8;g++){var p=y[g]+d[g],A=p&65535,v=p>>>16,w=((A*A>>>17)+A*v>>>15)+v*v,x=((p&4294901760)*p|0)+((p&65535)*p|0);h[g]=w^x}y[0]=h[0]+(h[7]<<16|h[7]>>>16)+(h[6]<<16|h[6]>>>16)|0,y[1]=h[1]+(h[0]<<8|h[0]>>>24)+h[7]|0,y[2]=h[2]+(h[1]<<16|h[1]>>>16)+(h[0]<<16|h[0]>>>16)|0,y[3]=h[3]+(h[2]<<8|h[2]>>>24)+h[1]|0,y[4]=h[4]+(h[3]<<16|h[3]>>>16)+(h[2]<<16|h[2]>>>16)|0,y[5]=h[5]+(h[4]<<8|h[4]>>>24)+h[3]|0,y[6]=h[6]+(h[5]<<16|h[5]>>>16)+(h[4]<<16|h[4]>>>16)|0,y[7]=h[7]+(h[6]<<8|h[6]>>>24)+h[5]|0}r.RabbitLegacy=s._createHelper(u)}(),e.RabbitLegacy})}(Ls)),Ls.exports}var Ts={exports:{}},d2;function R6(){return d2||(d2=1,function(n,t){(function(e,r,i){n.exports=r(nt(),Jr(),t0(),Fr(),Ut())})(tt,function(e){return function(){var r=e,i=r.lib,s=i.BlockCipher,a=r.algo;const o=16,c=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],h=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function f(A,v){let w=v>>24&255,x=v>>16&255,b=v>>8&255,S=v&255,K=A.sbox[0][w]+A.sbox[1][x];return K=K^A.sbox[2][b],K=K+A.sbox[3][S],K}function y(A,v,w){let x=v,b=w,S;for(let K=0;K<o;++K)x=x^A.pbox[K],b=f(A,x)^b,S=x,x=b,b=S;return S=x,x=b,b=S,b=b^A.pbox[o],x=x^A.pbox[o+1],{left:x,right:b}}function d(A,v,w){let x=v,b=w,S;for(let K=o+1;K>1;--K)x=x^A.pbox[K],b=f(A,x)^b,S=x,x=b,b=S;return S=x,x=b,b=S,b=b^A.pbox[1],x=x^A.pbox[0],{left:x,right:b}}function g(A,v,w){for(let F=0;F<4;F++){A.sbox[F]=[];for(let k=0;k<256;k++)A.sbox[F][k]=h[F][k]}let x=0;for(let F=0;F<o+2;F++)A.pbox[F]=c[F]^v[x],x++,x>=w&&(x=0);let b=0,S=0,K=0;for(let F=0;F<o+2;F+=2)K=y(A,b,S),b=K.left,S=K.right,A.pbox[F]=b,A.pbox[F+1]=S;for(let F=0;F<4;F++)for(let k=0;k<256;k+=2)K=y(A,b,S),b=K.left,S=K.right,A.sbox[F][k]=b,A.sbox[F][k+1]=S;return!0}var p=a.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var A=this._keyPriorReset=this._key,v=A.words,w=A.sigBytes/4;g(u,v,w)}},encryptBlock:function(A,v){var w=y(u,A[v],A[v+1]);A[v]=w.left,A[v+1]=w.right},decryptBlock:function(A,v){var w=d(u,A[v],A[v+1]);A[v]=w.left,A[v+1]=w.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=s._createHelper(p)}(),e.Blowfish})}(Ts)),Ts.exports}(function(n,t){(function(e,r,i){n.exports=r(nt(),ki(),u6(),f6(),Jr(),l6(),t0(),x3(),Wa(),y6(),w3(),d6(),p6(),g6(),ja(),A6(),Fr(),Ut(),x6(),w6(),b6(),m6(),v6(),E6(),B6(),k6(),C6(),D6(),S6(),I6(),K6(),F6(),P6(),U6(),R6())})(tt,function(e){return e})})(A3);var Q6=A3.exports;const q6=Q3(Q6);export{q6 as C,L6 as R,T6 as T,z6 as X,N6 as Z,H6 as _,M6 as j,G6 as r,O6 as t};
