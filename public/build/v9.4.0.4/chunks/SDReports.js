import{_ as ee,Z as $t,c as Lt,B as G,ap as tt,ah as Ut,C as at,E as se,aK as jt,f as H,ae as Ht,A as Bt,D as rt,T as Vt,k as F,W as ke,o as c,m as R,G as re,v as u,x,F as E,l as m,q as b,L as q,I as z,t as Ue,aL as ne,aM as st,N as Nt,J as Q,K as he,e as v,$ as nt,aj as zt,w as qt,aN as Wt}from"./bootstrap.js";import{D as it,B as lt,P as Jt,a as Gt}from"./agentRouter.js";import{v as Xt,m as fe,t as Kt,r as D,d as Yt,b as Zt,c as Qt,e as ot,i as ce,A as je,P as ea,B as He,f as ta,g as aa,h as te,j as Se,L as dt,p as Pe,k as De,l as Ee,n as ra}from"./FormGenerator.js";import{C as sa,N as na,T as ia}from"./DataTableActions.js";import{T as la}from"./PermaLink.js";import{C as oa}from"./Checkbox.js";import{C as da}from"./ChangeCustomFields.js";import{u as ca}from"./vue-router.js";const ua={name:"save-report-modal",setup(){const e=$t();return{formattedTime:Lt(()=>e.getters.formattedTime)}},props:{modalMode:{type:String,required:!0},reportDataObj:{type:Object,required:!0},onClose:{type:Function,required:!0},from:{type:String,default:""},filterValues:{type:Object,default:()=>{}},filterArray:{type:Array,default:()=>[]},chartType:{type:String,default:""}},data(){return{title:"",name:"",description:"",isPublic:!0,isLoading:!1,renderSharingOption:!1,teams:[],departments:[],agents:[],iconColor:"#00C0EF",iconClass:"fas fa-life-ring",isPrivate:!1,iconList:[],canViewCreatorProfile:!0,created_by:[],created_at:null,isEditing:!1,display_order:""}},beforeMount(){this.setUpComponentPropertiesBasisOfMode(),this.getIconList()},methods:{getIconList(){G.get("/json/icon-list.json").then(e=>{this.iconList=e.data.data}).catch(e=>{this.iconList=[]})},subString(e,t=25){return tt(e,t)},setUpComponentPropertiesBasisOfMode(){var e;this.modalMode==="fork"?this.title="save_filter":this.modalMode==="update"&&(this.isEditing=!0,this.name=this.reportDataObj.name,this.description=this.reportDataObj.description,this.isPrivate=!this.reportDataObj.is_public,this.title="update_this_report",this.renderSharingOption=this.isPrivate,this.iconClass=this.reportDataObj.iconClass??"fas fa-life-ring",this.iconColor=this.reportDataObj.iconColor??"#6C757d",this.created_at=this.reportDataObj.created_at,this.created_by=(e=this.reportDataObj.creator)==null?void 0:e[0],this.display_order=this.reportDataObj.display_order,this.reportDataObj.shareAbles&&(this.agents=this.reportDataObj.shareAbles.agents,this.departments=this.reportDataObj.shareAbles.departments,this.teams=this.reportDataObj.shareAbles.teams))},isValid(){const{errors:e,isValid:t}=Xt(this.$data);return t},onSubmit(){if(this.isValid()){this.$store.dispatch("unsetValidationError"),this.isLoading=!0;let e;e=this.from==="sd_report"||this.from==="sd_report_home"?"service-desk/api/fork/sd-report":"api/agent/report-config",this.modalMode==="fork"&&(e=this.from==="sd_report"||this.from==="sd_report_home"?e:e+"/"+Ut(window.location.pathname)),G.post(e,this.from==="sd_report"||this.from==="sd_report_home"?this.getSdReportParams():this.getSaveReportParams()).then(t=>{setTimeout(()=>this.onClose(),1e3),at(t,"save-report-modal"),this.modalMode==="fork"?this.redirectToReporListPage():window.emitter.emit(this.from==="sd_report"?"refreshSdReport":this.from==="report-list"||this.from==="sd_report_home"?"refreshReportHomePage":"refreshReportEntryPage"),window.emitter.emit("updateAgentSidebar")}).catch(t=>{se(t,"save-report-modal")}).finally(t=>{this.isLoading=!1})}},getSaveReportParams(){const e=JSON.parse(JSON.stringify(this.reportDataObj));return this.modalMode==="fork"&&(e.id=null),e.name=this.name,e.description=this.description,e.is_public=!this.isPrivate,e.shareAbles={agents:this.agents,departments:this.departments,teams:this.teams},e.iconClass=this.iconClass,e.iconColor=this.iconColor,e.display_order=this.display_order,e},getSdReportParams(){const e={},t=JSON.parse(JSON.stringify(this.reportDataObj));return this.modalMode==="update"&&(e.id=t.id),e.name=this.name,e.description=this.description,e.chart_type=this.chartType,e.filters=this.formattedFilterData(),e.is_plugin=1,e.type=parseInt(t.type),e.is_default=0,e.parentId=t.id,e.is_public=!this.isPrivate,e.shareAbles={agents:this.agents,departments:this.departments,teams:this.teams},e.iconClass=this.iconClass,e.iconColor=this.iconColor,e.display_order=this.display_order,e},formattedFilterData(){let e=jt(this.filterArray,this.filterValues);return Object.keys(e).filter(t=>H(e[t])).map(t=>{let a=e[t];return{key:t,value:a}})},redirectToReporListPage(){setTimeout(()=>this.$router.push({name:"Reports Index"}),1e3)},onPropertyChange(e,t){this[t]=e,t==="isPrivate"&&(this.renderSharingOption=e),t==="iconClass"&&(this.iconClass=e.icon_class)}},components:{"number-field":Ht,ColorPicker:sa,ToolTip:Bt,DynamicSelect:rt,"text-field":Vt,checkbox:oa}},pa={class:"modal-title"},ha={key:0},fa={class:"save-report"},ma={class:"row"},ya={key:0,class:"col-sm-6 ps-0 filter-info mt-4"},_a={class:"col-sm-12"},ga=["href"],va={key:1,class:"permission-update"},ba={class:"col-sm-12"},wa={class:"row"},Ca={class:"col-sm-4 col-md-4"},ka={for:"dashboard-widget-bg-color"},xa={key:1},Fa={class:"row"},Sa={class:"col-sm-4",style:{"line-height":"2"}},Pa={class:"row"},Da={class:"row"},Ea=["disabled"];function Ra(e,t,a,r,s,n){const i=F("alert"),l=F("custom-loader"),o=F("text-field"),d=F("tool-tip"),f=F("color-picker"),y=F("dynamic-select"),w=F("number-field"),O=F("checkbox"),W=F("modal"),U=ke("tooltip"),A=ke("focus-first-input");return c(),R(W,{showModal:!0,onClose:a.onClose},{title:re(()=>[u("h4",pa,x(e.lang(s.title)),1)]),alert:re(()=>[E(i,{componentName:"save-report-modal"})]),fields:re(()=>[s.isLoading?(c(),m("div",ha,[E(l)])):b("",!0),q((c(),m("div",fa,[u("div",ma,[E(o,{id:"name",label:e.lang("name"),type:"text",name:"name",classname:"col-md-6",value:s.name,onChange:n.onPropertyChange,placehold:e.lang("enter_a_value"),required:!0},null,8,["label","value","onChange","placehold"]),s.isEditing?(c(),m("div",ya,[u("div",_a,[u("b",null,x(e.lang("created_by"))+":",1),t[1]||(t[1]=z("  ")),u("span",null,[s.canViewCreatorProfile?q((c(),m("a",{key:0,target:"_blank",class:"creater-info",href:e.basePath()+"/panel/user/"+s.created_by.id},[z(x(n.subString(s.created_by.full_name)),1)],8,ga)),[[U,e.trans(s.created_by.full_name)]]):q((c(),m("span",va,[z(x(n.subString(s.created_by.full_name)),1)])),[[U,e.trans("access_denied_now")]])])]),u("div",ba,[u("b",null,x(e.trans("created_at"))+":",1),t[2]||(t[2]=z(" ")),q((c(),m("span",null,[z(x(r.formattedTime(s.created_at)),1)])),[[U,r.formattedTime(s.created_at)]])])])):b("",!0)]),E(o,{id:"description",label:e.lang("description"),type:"textarea",name:"description",classname:"col-md-12",value:s.description,onChange:n.onPropertyChange,placehold:e.lang("enter_a_value"),required:!0,"show-word-limit":!0,length:"180"},null,8,["label","value","onChange","placehold"])])),[[A]]),u("div",wa,[u("div",Ca,[u("label",ka,x(e.lang("icon_color")),1),E(d,{message:e.lang("dashboard_icon_background_color_hint"),size:"small"},null,8,["message"]),E(f,{id:"dashboard-widget-bg-color",name:"iconColor",color:s.iconColor,onColor:n.onPropertyChange},null,8,["color","onColor"])]),E(y,{name:"iconClass",label:e.lang("icon_class"),value:s.iconClass,onChange:n.onPropertyChange,classname:"col-md-4",elements:s.iconList,multiple:!1,"option-label":"icon_class",clearable:!1,hint:e.lang("report_icon_class_hint")},null,8,["label","value","onChange","elements","hint"]),E(w,{label:e.lang("display_order"),value:s.display_order,name:"display_order",classname:"col-sm-4",onChange:n.onPropertyChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"])]),E(O,{name:"isPrivate",value:s.isPrivate,label:e.lang("make_this_report_private"),onChange:n.onPropertyChange,classname:"col-md-12",id:"allow-only-ldap-login"},null,8,["value","label","onChange"]),s.renderSharingOption?(c(),m("div",xa,[u("div",Fa,[u("div",Sa,[u("span",null,[u("strong",null,x(e.lang("share_with")+":"),1)]),E(d,{message:e.lang("report_filter_share_hint"),size:"small"},null,8,["message"])])]),u("div",Pa,[E(y,{label:e.lang("agents"),multiple:!0,name:"agents",prePopulate:!0,class:"col-md-12",apiEndpoint:"/api/dependency/agents",value:s.agents,onChange:n.onPropertyChange},null,8,["label","value","onChange"])]),u("div",Da,[E(y,{label:e.lang("departments"),multiple:!0,name:"departments",prePopulate:!0,class:"col-md-6",apiEndpoint:"/api/dependency/departments",value:s.departments,onChange:n.onPropertyChange},null,8,["label","value","onChange"]),E(y,{label:e.lang("teams"),multiple:!0,name:"teams",prePopulate:!0,classname:"col-md-6",apiEndpoint:"/api/dependency/teams",value:s.teams,onChange:n.onPropertyChange},null,8,["label","value","onChange"])])])):b("",!0)]),controls:re(()=>[u("button",{class:"btn btn-primary",id:"new-report-submit",onClick:t[0]||(t[0]=(...T)=>n.onSubmit&&n.onSubmit(...T)),disabled:s.isLoading},[u("span",null,[u("i",{class:Ue(a.modalMode==="fork"?"fas fa-save":"fas fa-sync-alt")},null,2)]),z(" "+x(e.trans(a.modalMode==="fork"?"save":"update")),1)],8,Ea)]),_:1},8,["onClose"])}const Oa=ee(ua,[["render",Ra]]),Ta=e=>{let t=[],a=[],r=[];return e.forEach(s=>{t.push(s.value),a.push(s.label),r.push(s.redirectTo)}),{data:t,labels:a,redirectURLs:r}},Pn=e=>{let t=[];return e.forEach(a=>{const r=Ta(a.data);let s={chartId:a.id,panelTitle:a.name,axisLabel:a.dataLabel,data:r.data,labels:r.labels,redirectURLs:r.redirectURLs};t.push(s)}),t},Dn=e=>{const t=JSON.parse(JSON.stringify(e));let a=[];for(let n=0;n<t.length;n++)for(let i=0;i<t[n].data.length;i++){const l=t[n].data[i],o={id:l.id,label:l.label};a.push(o)}const r=a.sort(Ma);return Aa(r,"label").map(n=>n.label)},Aa=(e,t)=>Array.from(new Set(e.map(r=>r[t]))).map(r=>e.find(s=>s[t]===r)),Ma=(e,t)=>isNaN(Number(e.id))?new Date(e.id)-new Date(t.id):Number(e.id)-Number(t.id);function Ia(e,t,a,r,s){for(let n=0;n<e[s].data.length+1;n++)if(n===e[s].data.length)a.values.push(0),a.redirectTo.push(null);else if(e[s].data[n].label===t[r]){a.values.push(e[s].data[n].value||0),a.redirectTo.push(e[s].data[n].redirectTo);break}}function En(e,t){const a=JSON.parse(JSON.stringify(e));let r=[];for(let s=0;s<a.length;s++){let n={chartId:"",label:"",values:[],redirectTo:[]};n.label=a[s].name,n.chartId=a[s].id;for(let i=0;i<t.length;i++)Ia(a,t,n,i,s);r.push(n)}return r}const ct=(e,t=18)=>e.length>t?e.substr(0,t).trim()+"...":e,ut=(e,t)=>{const a=/\.00$/,s=JSON.parse(JSON.stringify(t.dataset.data)).reduce((i,l)=>Number(i)+Number(l));let n=(Number(e)/s*100).toFixed(2)+"";return a.test(n)&&(n=n.replace(a,"")),n+"%"},Re=(e,t,a)=>{try{const r=document.getElementById(t);r.style.cursor="default",e[0]&&a[e[0].index]&&(r.style.cursor="pointer")}catch{}};/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var We=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),ue={toTextLines:function(e){var t=[],a;for(e=[].concat(e);e.length;)a=e.pop(),typeof a=="string"?t.unshift.apply(t,a.split(`
`)):Array.isArray(a)?e.push.apply(e,a):ce(e)||t.unshift(""+a);return t},textSize:function(e,t,a){var r=[].concat(t),s=r.length,n=e.font,i=0,l;for(e.font=a.string,l=0;l<s;++l)i=Math.max(e.measureText(r[l]).width,i);return e.font=n,{height:s*a.lineHeight,width:i}},bound:function(e,t,a){return Math.max(e,Math.min(t,a))},arrayDiff:function(e,t){var a=e.slice(),r=[],s,n,i,l;for(s=0,i=t.length;s<i;++s)l=t[s],n=a.indexOf(l),n===-1?r.push([l,1]):a.splice(n,1);for(s=0,i=a.length;s<i;++s)r.push([a[s],-1]);return r},rasterize:function(e){return Math.round(e*We)/We}};function Me(e,t){var a=t.x,r=t.y;if(a===null)return{x:0,y:-1};if(r===null)return{x:1,y:0};var s=e.x-a,n=e.y-r,i=Math.sqrt(s*s+n*n);return{x:i?s/i:0,y:i?n/i:-1}}function $a(e,t,a,r,s){switch(s){case"center":a=r=0;break;case"bottom":a=0,r=1;break;case"right":a=1,r=0;break;case"left":a=-1,r=0;break;case"top":a=0,r=-1;break;case"start":a=-a,r=-r;break;case"end":break;default:s*=Math.PI/180,a=Math.cos(s),r=Math.sin(s);break}return{x:e,y:t,vx:a,vy:r}}var La=0,pt=1,ht=2,ft=4,mt=8;function ge(e,t,a){var r=La;return e<a.left?r|=pt:e>a.right&&(r|=ht),t<a.top?r|=mt:t>a.bottom&&(r|=ft),r}function Ua(e,t){for(var a=e.x0,r=e.y0,s=e.x1,n=e.y1,i=ge(a,r,t),l=ge(s,n,t),o,d,f;!(!(i|l)||i&l);)o=i||l,o&mt?(d=a+(s-a)*(t.top-r)/(n-r),f=t.top):o&ft?(d=a+(s-a)*(t.bottom-r)/(n-r),f=t.bottom):o&ht?(f=r+(n-r)*(t.right-a)/(s-a),d=t.right):o&pt&&(f=r+(n-r)*(t.left-a)/(s-a),d=t.left),o===i?(a=d,r=f,i=ge(a,r,t)):(s=d,n=f,l=ge(s,n,t));return{x0:a,x1:s,y0:r,y1:n}}function ve(e,t){var a=t.anchor,r=e,s,n;return t.clamp&&(r=Ua(r,t.area)),a==="start"?(s=r.x0,n=r.y0):a==="end"?(s=r.x1,n=r.y1):(s=(r.x0+r.x1)/2,n=(r.y0+r.y1)/2),$a(s,n,e.vx,e.vy,t.align)}var be={arc:function(e,t){var a=(e.startAngle+e.endAngle)/2,r=Math.cos(a),s=Math.sin(a),n=e.innerRadius,i=e.outerRadius;return ve({x0:e.x+r*n,y0:e.y+s*n,x1:e.x+r*i,y1:e.y+s*i,vx:r,vy:s},t)},point:function(e,t){var a=Me(e,t.origin),r=a.x*e.options.radius,s=a.y*e.options.radius;return ve({x0:e.x-r,y0:e.y-s,x1:e.x+r,y1:e.y+s,vx:a.x,vy:a.y},t)},bar:function(e,t){var a=Me(e,t.origin),r=e.x,s=e.y,n=0,i=0;return e.horizontal?(r=Math.min(e.x,e.base),n=Math.abs(e.base-e.x)):(s=Math.min(e.y,e.base),i=Math.abs(e.base-e.y)),ve({x0:r,y0:s+i,x1:r+n,y1:s,vx:a.x,vy:a.y},t)},fallback:function(e,t){var a=Me(e,t.origin);return ve({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:a.x,vy:a.y},t)}},X=ue.rasterize;function ja(e){var t=e.borderWidth||0,a=e.padding,r=e.size.height,s=e.size.width,n=-s/2,i=-r/2;return{frame:{x:n-a.left-t,y:i-a.top-t,w:s+a.width+t*2,h:r+a.height+t*2},text:{x:n,y:i,w:s,h:r}}}function Ha(e,t){var a=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!a)return null;if(a.xCenter!==void 0&&a.yCenter!==void 0)return{x:a.xCenter,y:a.yCenter};var r=a.getBasePixel();return e.horizontal?{x:r,y:null}:{x:null,y:r}}function Ba(e){return e instanceof je?be.arc:e instanceof ea?be.point:e instanceof He?be.bar:be.fallback}function Va(e,t,a,r,s,n){var i=Math.PI/2;if(n){var l=Math.min(n,s/2,r/2),o=t+l,d=a+l,f=t+r-l,y=a+s-l;e.moveTo(t,d),o<f&&d<y?(e.arc(o,d,l,-Math.PI,-i),e.arc(f,d,l,-i,0),e.arc(f,y,l,0,i),e.arc(o,y,l,i,Math.PI)):o<f?(e.moveTo(o,a),e.arc(f,d,l,-i,i),e.arc(o,d,l,i,Math.PI+i)):d<y?(e.arc(o,d,l,-Math.PI,0),e.arc(o,y,l,0,Math.PI)):e.arc(o,d,l,-Math.PI,Math.PI),e.closePath(),e.moveTo(t,a)}else e.rect(t,a,r,s)}function Na(e,t,a){var r=a.backgroundColor,s=a.borderColor,n=a.borderWidth;!r&&(!s||!n)||(e.beginPath(),Va(e,X(t.x)+n/2,X(t.y)+n/2,X(t.w)-n,X(t.h)-n,a.borderRadius),e.closePath(),r&&(e.fillStyle=r,e.fill()),s&&n&&(e.strokeStyle=s,e.lineWidth=n,e.lineJoin="miter",e.stroke()))}function za(e,t,a){var r=a.lineHeight,s=e.w,n=e.x,i=e.y+r/2;return t==="center"?n+=s/2:(t==="end"||t==="right")&&(n+=s),{h:r,w:s,x:n,y:i}}function qa(e,t,a){var r=e.shadowBlur,s=a.stroked,n=X(a.x),i=X(a.y),l=X(a.w);s&&e.strokeText(t,n,i,l),a.filled&&(r&&s&&(e.shadowBlur=0),e.fillText(t,n,i,l),r&&s&&(e.shadowBlur=r))}function Wa(e,t,a,r){var s=r.textAlign,n=r.color,i=!!n,l=r.font,o=t.length,d=r.textStrokeColor,f=r.textStrokeWidth,y=d&&f,w;if(!(!o||!i&&!y))for(a=za(a,s,l),e.font=l.string,e.textAlign=s,e.textBaseline="middle",e.shadowBlur=r.textShadowBlur,e.shadowColor=r.textShadowColor,i&&(e.fillStyle=n),y&&(e.lineJoin="round",e.lineWidth=f,e.strokeStyle=d),w=0,o=t.length;w<o;++w)qa(e,t[w],{stroked:y,filled:i,w:a.w,x:a.x,y:a.y+a.h*w})}var yt=function(e,t,a,r){var s=this;s._config=e,s._index=r,s._model=null,s._rects=null,s._ctx=t,s._el=a};fe(yt.prototype,{_modelize:function(e,t,a,r){var s=this,n=s._index,i=Kt(D([a.font,{}],r,n)),l=D([a.color,Yt.color],r,n);return{align:D([a.align,"center"],r,n),anchor:D([a.anchor,"center"],r,n),area:r.chart.chartArea,backgroundColor:D([a.backgroundColor,null],r,n),borderColor:D([a.borderColor,null],r,n),borderRadius:D([a.borderRadius,0],r,n),borderWidth:D([a.borderWidth,0],r,n),clamp:D([a.clamp,!1],r,n),clip:D([a.clip,!1],r,n),color:l,display:e,font:i,lines:t,offset:D([a.offset,4],r,n),opacity:D([a.opacity,1],r,n),origin:Ha(s._el,r),padding:Zt(D([a.padding,4],r,n)),positioner:Ba(s._el),rotation:D([a.rotation,0],r,n)*(Math.PI/180),size:ue.textSize(s._ctx,t,i),textAlign:D([a.textAlign,"start"],r,n),textShadowBlur:D([a.textShadowBlur,0],r,n),textShadowColor:D([a.textShadowColor,l],r,n),textStrokeColor:D([a.textStrokeColor,l],r,n),textStrokeWidth:D([a.textStrokeWidth,0],r,n)}},update:function(e){var t=this,a=null,r=null,s=t._index,n=t._config,i,l,o,d=D([n.display,!0],e,s);d&&(i=e.dataset.data[s],l=Qt(ot(n.formatter,[i,e]),i),o=ce(l)?[]:ue.toTextLines(l),o.length&&(a=t._modelize(d,o,n,e),r=ja(a))),t._model=a,t._rects=r},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,t){var a=this,r=e.ctx,s=a._model,n=a._rects,i;this.visible()&&(r.save(),s.clip&&(i=s.area,r.beginPath(),r.rect(i.left,i.top,i.right-i.left,i.bottom-i.top),r.clip()),r.globalAlpha=ue.bound(0,s.opacity,1),r.translate(X(t.x),X(t.y)),r.rotate(s.rotation),Na(r,n.frame,s),Wa(r,s.lines,n.text,s),r.restore())}});var Ja=Number.MIN_SAFE_INTEGER||-9007199254740991,Ga=Number.MAX_SAFE_INTEGER||9007199254740991;function de(e,t,a){var r=Math.cos(a),s=Math.sin(a),n=t.x,i=t.y;return{x:n+r*(e.x-n)-s*(e.y-i),y:i+s*(e.x-n)+r*(e.y-i)}}function Je(e,t){var a=Ga,r=Ja,s=t.origin,n,i,l,o,d;for(n=0;n<e.length;++n)i=e[n],l=i.x-s.x,o=i.y-s.y,d=t.vx*l+t.vy*o,a=Math.min(a,d),r=Math.max(r,d);return{min:a,max:r}}function we(e,t){var a=t.x-e.x,r=t.y-e.y,s=Math.sqrt(a*a+r*r);return{vx:(t.x-e.x)/s,vy:(t.y-e.y)/s,origin:e,ln:s}}var _t=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};fe(_t.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,t,a){this._rotation=a,this._rect={x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},contains:function(e){var t=this,a=1,r=t._rect;return e=de(e,t.center(),-t._rotation),!(e.x<r.x-a||e.y<r.y-a||e.x>r.x+r.w+a*2||e.y>r.y+r.h+a*2)},intersects:function(e){var t=this._points(),a=e._points(),r=[we(t[0],t[1]),we(t[0],t[3])],s,n,i;for(this._rotation!==e._rotation&&r.push(we(a[0],a[1]),we(a[0],a[3])),s=0;s<r.length;++s)if(n=Je(t,r[s]),i=Je(a,r[s]),n.max<i.min||i.max<n.min)return!1;return!0},_points:function(){var e=this,t=e._rect,a=e._rotation,r=e.center();return[de({x:t.x,y:t.y},r,a),de({x:t.x+t.w,y:t.y},r,a),de({x:t.x+t.w,y:t.y+t.h},r,a),de({x:t.x,y:t.y+t.h},r,a)]}});function gt(e,t,a){var r=t.positioner(e,t),s=r.vx,n=r.vy;if(!s&&!n)return{x:r.x,y:r.y};var i=a.w,l=a.h,o=t.rotation,d=Math.abs(i/2*Math.cos(o))+Math.abs(l/2*Math.sin(o)),f=Math.abs(i/2*Math.sin(o))+Math.abs(l/2*Math.cos(o)),y=1/Math.max(Math.abs(s),Math.abs(n));return d*=s*y,f*=n*y,d+=t.offset*s,f+=t.offset*n,{x:r.x+d,y:r.y+f}}function Xa(e,t){var a,r,s,n;for(a=e.length-1;a>=0;--a)for(s=e[a].$layout,r=a-1;r>=0&&s._visible;--r)n=e[r].$layout,n._visible&&s._box.intersects(n._box)&&t(s,n);return e}function Ka(e){var t,a,r,s,n,i,l;for(t=0,a=e.length;t<a;++t)r=e[t],s=r.$layout,s._visible&&(l=new Proxy(r._el,{get:(o,d)=>o.getProps([d],!0)[d]}),n=r.geometry(),i=gt(l,r.model(),n),s._box.update(i,n,r.rotation()));return Xa(e,function(o,d){var f=o._hidable,y=d._hidable;f&&y||y?d._visible=!1:f&&(o._visible=!1)})}var pe={prepare:function(e){var t=[],a,r,s,n,i;for(a=0,s=e.length;a<s;++a)for(r=0,n=e[a].length;r<n;++r)i=e[a][r],t.push(i),i.$layout={_box:new _t,_hidable:!1,_visible:!0,_set:a,_idx:i._index};return t.sort(function(l,o){var d=l.$layout,f=o.$layout;return d._idx===f._idx?f._set-d._set:f._idx-d._idx}),this.update(t),t},update:function(e){var t=!1,a,r,s,n,i;for(a=0,r=e.length;a<r;++a)s=e[a],n=s.model(),i=s.$layout,i._hidable=n&&n.display==="auto",i._visible=s.visible(),t|=i._hidable;t&&Ka(e)},lookup:function(e,t){var a,r;for(a=e.length-1;a>=0;--a)if(r=e[a].$layout,r&&r._visible&&r._box.contains(t))return e[a];return null},draw:function(e,t){var a,r,s,n,i,l;for(a=0,r=t.length;a<r;++a)s=t[a],n=s.$layout,n._visible&&(i=s.geometry(),l=gt(s._el,s.model(),i),n._box.update(l,i,s.rotation()),s.draw(e,l))}},Ya=function(e){if(ce(e))return null;var t=e,a,r,s;if(aa(e))if(!ce(e.label))t=e.label;else if(!ce(e.r))t=e.r;else for(t="",a=Object.keys(e),s=0,r=a.length;s<r;++s)t+=(s!==0?", ":"")+a[s]+": "+e[a[s]];return""+t},Za={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:Ya,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},$="$datalabels",vt="$default";function Qa(e,t){var a=e.datalabels,r={},s=[],n,i;return a===!1?null:(a===!0&&(a={}),t=fe({},[t,a]),n=t.labels||{},i=Object.keys(n),delete t.labels,i.length?i.forEach(function(l){n[l]&&s.push(fe({},[t,n[l],{_key:l}]))}):s.push(t),r=s.reduce(function(l,o){return ta(o.listeners||{},function(d,f){l[f]=l[f]||{},l[f][o._key||vt]=d}),delete o.listeners,l},{}),{labels:s,listeners:r})}function $e(e,t,a,r){if(t){var s=a.$context,n=a.$groups,i;t[n._set]&&(i=t[n._set][n._key],i&&ot(i,[s,r])===!0&&(e[$]._dirty=!0,a.update(s)))}}function er(e,t,a,r,s){var n,i;!a&&!r||(a?r?a!==r&&(i=n=!0):i=!0:n=!0,i&&$e(e,t.leave,a,s),n&&$e(e,t.enter,r,s))}function tr(e,t){var a=e[$],r=a._listeners,s,n;if(!(!r.enter&&!r.leave)){if(t.type==="mousemove")n=pe.lookup(a._labels,t);else if(t.type!=="mouseout")return;s=a._hovered,a._hovered=n,er(e,r,s,n,t)}}function ar(e,t){var a=e[$],r=a._listeners.click,s=r&&pe.lookup(a._labels,t);s&&$e(e,r,s,t)}var Oe={id:"datalabels",defaults:Za,beforeInit:function(e){e[$]={_actives:[]}},beforeUpdate:function(e){var t=e[$];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(e,t,a){var r=t.index,s=e[$],n=s._datasets[r]=[],i=e.isDatasetVisible(r),l=e.data.datasets[r],o=Qa(l,a),d=t.meta.data||[],f=e.ctx,y,w,O,W,U,A,T,M;for(f.save(),y=0,O=d.length;y<O;++y)if(T=d[y],T[$]=[],i&&T&&e.getDataVisibility(y)&&!T.skip)for(w=0,W=o.labels.length;w<W;++w)U=o.labels[w],A=U._key,M=new yt(U,f,T,y),M.$groups={_set:r,_key:A||vt},M.$context={active:!1,chart:e,dataIndex:y,dataset:l,datasetIndex:r},M.update(M.$context),T[$].push(M),n.push(M);f.restore(),fe(s._listeners,o.listeners,{merger:function(N,Y,Z){Y[N]=Y[N]||{},Y[N][t.index]=Z[N],s._listened=!0}})},afterUpdate:function(e){e[$]._labels=pe.prepare(e[$]._datasets)},afterDatasetsDraw:function(e){pe.draw(e,e[$]._labels)},beforeEvent:function(e,t){if(e[$]._listened){var a=t.event;switch(a.type){case"mousemove":case"mouseout":tr(e,a);break;case"click":ar(e,a);break}}},afterEvent:function(e){var t=e[$],a=t._actives,r=t._actives=e.getActiveElements(),s=ue.arrayDiff(a,r),n,i,l,o,d,f,y;for(n=0,i=s.length;n<i;++n)if(d=s[n],d[1])for(y=d[0].element[$]||[],l=0,o=y.length;l<o;++l)f=y[l],f.$context.active=d[1]===1,f.update(f.$context);(t._dirty||s.length)&&(pe.update(t._labels),e.render()),delete t._dirty}};function rr(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const a=document.implementation.createHTMLDocument(),r=a.createElement("base"),s=a.createElement("a");return a.head.appendChild(r),a.body.appendChild(s),t&&(r.href=t),s.href=e,s.href}const sr=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function K(e){const t=[];for(let a=0,r=e.length;a<r;a++)t.push(e[a]);return t}function xe(e,t){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return r?parseFloat(r.replace("px","")):0}function nr(e){const t=xe(e,"border-left-width"),a=xe(e,"border-right-width");return e.clientWidth+t+a}function ir(e){const t=xe(e,"border-top-width"),a=xe(e,"border-bottom-width");return e.clientHeight+t+a}function bt(e,t={}){const a=t.width||nr(e),r=t.height||ir(e);return{width:a,height:r}}function lr(){let e,t;try{t=process}catch{}const a=t&&t.env?t.env.devicePixelRatio:null;return a&&(e=parseInt(a,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const j=16384;function or(e){(e.width>j||e.height>j)&&(e.width>j&&e.height>j?e.width>e.height?(e.height*=j/e.width,e.width=j):(e.width*=j/e.height,e.height=j):e.width>j?(e.height*=j/e.width,e.width=j):(e.width*=j/e.height,e.height=j))}function Fe(e){return new Promise((t,a)=>{const r=new Image;r.decode=()=>t(r),r.onload=()=>t(r),r.onerror=a,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function dr(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function cr(e,t,a){const r="http://www.w3.org/2000/svg",s=document.createElementNS(r,"svg"),n=document.createElementNS(r,"foreignObject");return s.setAttribute("width",`${t}`),s.setAttribute("height",`${a}`),s.setAttribute("viewBox",`0 0 ${t} ${a}`),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("x","0"),n.setAttribute("y","0"),n.setAttribute("externalResourcesRequired","true"),s.appendChild(n),n.appendChild(e),dr(s)}const L=(e,t)=>{if(e instanceof t)return!0;const a=Object.getPrototypeOf(e);return a===null?!1:a.constructor.name===t.name||L(a,t)};function ur(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function pr(e){return K(e).map(t=>{const a=e.getPropertyValue(t),r=e.getPropertyPriority(t);return`${t}: ${a}${r?" !important":""};`}).join(" ")}function hr(e,t,a){const r=`.${e}:${t}`,s=a.cssText?ur(a):pr(a);return document.createTextNode(`${r}{${s}}`)}function Ge(e,t,a){const r=window.getComputedStyle(e,a),s=r.getPropertyValue("content");if(s===""||s==="none")return;const n=sr();try{t.className=`${t.className} ${n}`}catch{return}const i=document.createElement("style");i.appendChild(hr(n,a,r)),t.appendChild(i)}function fr(e,t){Ge(e,t,":before"),Ge(e,t,":after")}const Xe="application/font-woff",Ke="image/jpeg",mr={woff:Xe,woff2:Xe,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Ke,jpeg:Ke,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function yr(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Be(e){const t=yr(e).toLowerCase();return mr[t]||""}function _r(e){return e.split(/,/)[1]}function Le(e){return e.search(/^(data:)/)!==-1}function wt(e,t){return`data:${t};base64,${e}`}async function Ct(e,t,a){const r=await fetch(e,t);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const s=await r.blob();return new Promise((n,i)=>{const l=new FileReader;l.onerror=i,l.onloadend=()=>{try{n(a({res:r,result:l.result}))}catch(o){i(o)}},l.readAsDataURL(s)})}const Ie={};function gr(e,t,a){let r=e.replace(/\?.*/,"");return a&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),t?`[${t}]${r}`:r}async function Ve(e,t,a){const r=gr(e,t,a.includeQueryParams);if(Ie[r]!=null)return Ie[r];a.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const n=await Ct(e,a.fetchRequestInit,({res:i,result:l})=>(t||(t=i.headers.get("Content-Type")||""),_r(l)));s=wt(n,t)}catch(n){s=a.imagePlaceholder||"";let i=`Failed to fetch resource: ${e}`;n&&(i=typeof n=="string"?n:n.message),i&&console.warn(i)}return Ie[r]=s,s}async function vr(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):Fe(t)}async function br(e,t){if(e.currentSrc){const n=document.createElement("canvas"),i=n.getContext("2d");n.width=e.clientWidth,n.height=e.clientHeight,i==null||i.drawImage(e,0,0,n.width,n.height);const l=n.toDataURL();return Fe(l)}const a=e.poster,r=Be(a),s=await Ve(a,r,t);return Fe(s)}async function wr(e){var t;try{if(!((t=e==null?void 0:e.contentDocument)===null||t===void 0)&&t.body)return await Te(e.contentDocument.body,{},!0)}catch{}return e.cloneNode(!1)}async function Cr(e,t){return L(e,HTMLCanvasElement)?vr(e):L(e,HTMLVideoElement)?br(e,t):L(e,HTMLIFrameElement)?wr(e):e.cloneNode(!1)}const kr=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT";async function xr(e,t,a){var r,s;let n=[];return kr(e)&&e.assignedNodes?n=K(e.assignedNodes()):L(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?n=K(e.contentDocument.body.childNodes):n=K(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),n.length===0||L(e,HTMLVideoElement)||await n.reduce((i,l)=>i.then(()=>Te(l,a)).then(o=>{o&&t.appendChild(o)}),Promise.resolve()),t}function Fr(e,t){const a=t.style;if(!a)return;const r=window.getComputedStyle(e);r.cssText?(a.cssText=r.cssText,a.transformOrigin=r.transformOrigin):K(r).forEach(s=>{let n=r.getPropertyValue(s);s==="font-size"&&n.endsWith("px")&&(n=`${Math.floor(parseFloat(n.substring(0,n.length-2)))-.1}px`),L(e,HTMLIFrameElement)&&s==="display"&&n==="inline"&&(n="block"),s==="d"&&t.getAttribute("d")&&(n=`path(${t.getAttribute("d")})`),a.setProperty(s,n,r.getPropertyPriority(s))})}function Sr(e,t){L(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),L(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function Pr(e,t){if(L(e,HTMLSelectElement)){const a=t,r=Array.from(a.children).find(s=>e.value===s.getAttribute("value"));r&&r.setAttribute("selected","")}}function Dr(e,t){return L(t,Element)&&(Fr(e,t),fr(e,t),Sr(e,t),Pr(e,t)),t}async function Er(e,t){const a=e.querySelectorAll?e.querySelectorAll("use"):[];if(a.length===0)return e;const r={};for(let n=0;n<a.length;n++){const l=a[n].getAttribute("xlink:href");if(l){const o=e.querySelector(l),d=document.querySelector(l);!o&&d&&!r[l]&&(r[l]=await Te(d,t,!0))}}const s=Object.values(r);if(s.length){const n="http://www.w3.org/1999/xhtml",i=document.createElementNS(n,"svg");i.setAttribute("xmlns",n),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const l=document.createElementNS(n,"defs");i.appendChild(l);for(let o=0;o<s.length;o++)l.appendChild(s[o]);e.appendChild(i)}return e}async function Te(e,t,a){return!a&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(r=>Cr(r,t)).then(r=>xr(e,r,t)).then(r=>Dr(e,r)).then(r=>Er(r,t))}const kt=/url\((['"]?)([^'"]+?)\1\)/g,Rr=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Or=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Tr(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function Ar(e){const t=[];return e.replace(kt,(a,r,s)=>(t.push(s),a)),t.filter(a=>!Le(a))}async function Mr(e,t,a,r,s){try{const n=a?rr(t,a):t,i=Be(t);let l;if(s){const o=await s(n);l=wt(o,i)}else l=await Ve(n,i,r);return e.replace(Tr(t),`$1${l}$3`)}catch{}return e}function Ir(e,{preferredFontFormat:t}){return t?e.replace(Or,a=>{for(;;){const[r,,s]=Rr.exec(a)||[];if(!s)return"";if(s===t)return`src: ${r};`}}):e}function xt(e){return e.search(kt)!==-1}async function Ft(e,t,a){if(!xt(e))return e;const r=Ir(e,a);return Ar(r).reduce((n,i)=>n.then(l=>Mr(l,i,t,a)),Promise.resolve(r))}async function Ce(e,t,a){var r;const s=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(s){const n=await Ft(s,null,a);return t.style.setProperty(e,n,t.style.getPropertyPriority(e)),!0}return!1}async function $r(e,t){await Ce("background",e,t)||await Ce("background-image",e,t),await Ce("mask",e,t)||await Ce("mask-image",e,t)}async function Lr(e,t){const a=L(e,HTMLImageElement);if(!(a&&!Le(e.src))&&!(L(e,SVGImageElement)&&!Le(e.href.baseVal)))return;const r=a?e.src:e.href.baseVal,s=await Ve(r,Be(r),t);await new Promise((n,i)=>{e.onload=n,e.onerror=i;const l=e;l.decode&&(l.decode=n),l.loading==="lazy"&&(l.loading="eager"),a?(e.srcset="",e.src=s):e.href.baseVal=s})}async function Ur(e,t){const r=K(e.childNodes).map(s=>St(s,t));await Promise.all(r).then(()=>e)}async function St(e,t){L(e,Element)&&(await $r(e,t),await Lr(e,t),await Ur(e,t))}function jr(e,t){const{style:a}=e;t.backgroundColor&&(a.backgroundColor=t.backgroundColor),t.width&&(a.width=`${t.width}px`),t.height&&(a.height=`${t.height}px`);const r=t.style;return r!=null&&Object.keys(r).forEach(s=>{a[s]=r[s]}),e}const Ye={};async function Ze(e){let t=Ye[e];if(t!=null)return t;const r=await(await fetch(e)).text();return t={url:e,cssText:r},Ye[e]=t,t}async function Qe(e,t){let a=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,n=(a.match(/url\([^)]+\)/g)||[]).map(async i=>{let l=i.replace(r,"$1");return l.startsWith("https://")||(l=new URL(l,e.url).href),Ct(l,t.fetchRequestInit,({result:o})=>(a=a.replace(i,`url(${o})`),[i,o]))});return Promise.all(n).then(()=>a)}function et(e){if(e==null)return[];const t=[],a=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(a,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const o=s.exec(r);if(o===null)break;t.push(o[0])}r=r.replace(s,"");const n=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(i,"gi");for(;;){let o=n.exec(r);if(o===null){if(o=l.exec(r),o===null)break;n.lastIndex=l.lastIndex}else l.lastIndex=n.lastIndex;t.push(o[0])}return t}async function Hr(e,t){const a=[],r=[];return e.forEach(s=>{if("cssRules"in s)try{K(s.cssRules||[]).forEach((n,i)=>{if(n.type===CSSRule.IMPORT_RULE){let l=i+1;const o=n.href,d=Ze(o).then(f=>Qe(f,t)).then(f=>et(f).forEach(y=>{try{s.insertRule(y,y.startsWith("@import")?l+=1:s.cssRules.length)}catch(w){console.error("Error inserting rule from remote css",{rule:y,error:w})}})).catch(f=>{console.error("Error loading remote css",f.toString())});r.push(d)}})}catch(n){const i=e.find(l=>l.href==null)||document.styleSheets[0];s.href!=null&&r.push(Ze(s.href).then(l=>Qe(l,t)).then(l=>et(l).forEach(o=>{i.insertRule(o,s.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",n)}}),Promise.all(r).then(()=>(e.forEach(s=>{if("cssRules"in s)try{K(s.cssRules||[]).forEach(n=>{a.push(n)})}catch(n){console.error(`Error while reading CSS rules from ${s.href}`,n)}}),a))}function Br(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>xt(t.style.getPropertyValue("src")))}async function Vr(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const a=K(e.ownerDocument.styleSheets),r=await Hr(a,t);return Br(r)}async function Nr(e,t){const a=await Vr(e,t);return(await Promise.all(a.map(s=>{const n=s.parentStyleSheet?s.parentStyleSheet.href:null;return Ft(s.cssText,n,t)}))).join(`
`)}async function zr(e,t){const a=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await Nr(e,t);if(a){const r=document.createElement("style"),s=document.createTextNode(a);r.appendChild(s),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function qr(e,t={}){const{width:a,height:r}=bt(e,t),s=await Te(e,t,!0);return await zr(s,t),await St(s,t),jr(s,t),await cr(s,a,r)}async function Wr(e,t={}){const{width:a,height:r}=bt(e,t),s=await qr(e,t),n=await Fe(s),i=document.createElement("canvas"),l=i.getContext("2d"),o=t.pixelRatio||lr(),d=t.canvasWidth||a,f=t.canvasHeight||r;return i.width=d*o,i.height=f*o,t.skipAutoScale||or(i),i.style.width=`${d}`,i.style.height=`${f}`,t.backgroundColor&&(l.fillStyle=t.backgroundColor,l.fillRect(0,0,i.width,i.height)),l.drawImage(n,0,0,i.width,i.height),i}async function Jr(e,t={}){return(await Wr(e,t)).toDataURL()}te.register(Se,dt,He,Pe,De,Ee);te.register(Oe);const Gr={components:{Doughnut:it,Bar:lt},props:{data:{type:Array,default:()=>[]},colors:{type:Array,default:()=>[]},redirectUrls:{type:Array,default:()=>[]},labelString:{type:String,default:"Count"},from:{type:String,default:""}},data(){return{chartData:"",options:{responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{color:"#000",anchor:"end",clamp:!0,align:"top"},legend:!1},layout:{padding:{left:0,right:0,top:24,bottom:0}},scales:{y:{beginAtZero:!0,title:{display:!0,text:this.labelString},border:{display:!1},grid:{display:!0,drawOnChartArea:!0,drawTicks:!0},ticks:{precision:0},min:0},x:{border:{display:!1},grid:{display:!0,drawOnChartArea:!0,drawTicks:!0},ticks:{callback:function(e,t){return ct(this.getLabelForValue(e))}}}},onClick:this.clickHandler,onHover:this.onHover}}},mounted(){let e=[],t=this.data.result?this.data.result:this.data.chart_parameters;for(var a in t)e.push(t[a].name);this.chartData={labels:e,datasets:[{label:this.labelString,backgroundColor:ne(e.length),borderColor:st(e.length),borderWidth:2,data:t.map(r=>r.count),barThickness:30}]}},methods:{clickHandler(e,t){if(H(t)&&H(this.redirectUrls)){const a=this.redirectUrls[t[0].index];if(H(a)){let r=JSON.parse('{"'+decodeURI(a.split("?")[1]).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');this.$router.push({path:a.replace(this.basePath(),""),query:r})}}},onHover(e,t,a){e.native.target.style.cursor=t[0]?"pointer":"default",Re(t,this.chartId,this.redirectUrls)}}},Xr={key:0,class:"dashboard-charts"},Kr={class:"no-data-section"},Yr={key:1,style:{height:"300px"}};function Zr(e,t,a,r,s,n){const i=F("Bar");return a.from==="sd-reports"&&a.data.chart_parameters.length===0||a.from==="dashboard"&&a.data.result.length===0?(c(),m("div",Xr,[u("div",Kr,x(e.lang("no_data_available")),1)])):(c(),m("div",Yr,[s.chartData?(c(),R(i,{key:0,data:s.chartData,options:s.options},null,8,["data","options"])):b("",!0)]))}const Qr=ee(Gr,[["render",Zr],["__scopeId","data-v-778cf10f"]]);te.register(Pe,De,Ee,je,Se);te.register(Oe);const es={components:{Pie:Jt},props:{data:{type:Array,default:()=>[]},colors:{type:Array,default:()=>[]},redirectUrls:{type:Array,default:()=>[]},from:{type:String,default:""}},data(){return{chartData:"",options:{responsive:!0,plugins:{datalabels:{display:"auto",color:"#6c757d",anchor:"end",clamp:!0,align:"start",offset:10,font:{weight:"bold"},formatter:this.dataLabelFormatter},legend:{display:!0,position:"top"}},maintainAspectRatio:!1,onClick:this.clickHandler,onHover:this.onHover}}},mounted(){let e=[];e=this.data.chart_parameters.map(t=>t.name),this.chartData={labels:e,datasets:[{backgroundColor:ne(e.length),borderColor:ne(e.length),data:this.data.chart_parameters.map(t=>t.count)}]}},methods:{clickHandler(e,t){if(H(t)&&H(this.redirectUrls)){const a=this.redirectUrls[t[0].index];if(H(a)){let r=JSON.parse('{"'+decodeURI(a.split("?")[1]).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');this.$router.push({path:a.replace(this.basePath(),""),query:r})}}},dataLabelFormatter(e,t){return ut(e,t)},onHover(e,t){e.native.target.style.cursor=t[0]?"pointer":"default",Re(t,this.chartId,this.redirectUrls)}}},ts={key:0,class:"dashboard-charts"},as={class:"no-data-section"},rs={key:1};function ss(e,t,a,r,s,n){const i=F("Pie");return a.from==="sd-reports"&&a.data.chart_parameters.length===0?(c(),m("div",ts,[u("div",as,x(e.lang("no_data_available")),1)])):(c(),m("div",rs,[s.chartData?(c(),R(i,{key:0,data:s.chartData,options:s.options},null,8,["data","options"])):b("",!0)]))}const ns=ee(es,[["render",ss]]);te.register(Se,dt,He,Pe,De,Ee);te.register(Oe);const is={components:{Bar:lt},props:{data:{type:Array,default:()=>[]},colors:{type:Array,default:()=>[]},redirectUrls:{type:Array,default:()=>[]},from:{type:String,default:""}},data(){return{chartData:"",options:{indexAxis:"y",responsive:!0,title:!1,maintainAspectRatio:!1,plugins:{datalabels:{display:"auto",color:"#000",anchor:"end",clamp:!0,align:"right",font:{weight:"20px"}},legend:!1},layout:{padding:{left:0,right:24,top:0,bottom:0}},scales:{y:{beginAtZero:!0,title:{display:!0,text:""},border:{display:!1},grid:{display:!0,drawOnChartArea:!0,drawTicks:!0}},x:{border:{display:!1},title:{display:!0,text:"count"},grid:{display:!0,drawOnChartArea:!0,drawTicks:!0},ticks:{precision:0,callback:function(e,t){return ct(this.getLabelForValue(e))}}}},onClick:this.clickHandler,onHover:this.onHover}}},mounted(){let e=[],t=this.data.chart_parameters;for(var a in t)e.push(t[a].name);this.chartData={labels:e,datasets:[{label:"",backgroundColor:ne(e.length),borderColor:st(e.length),borderWidth:2,data:t.map(r=>r.count),barThickness:30}]}},methods:{clickHandler(e,t){if(H(t)&&H(this.redirectUrls)){const a=this.redirectUrls[t[0].index];if(H(a)){let r=JSON.parse('{"'+decodeURI(a.split("?")[1]).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');this.$router.push({path:a.replace(this.basePath(),""),query:r})}}},onHover(e,t,a){e.native.target.style.cursor=t[0]?"pointer":"default",Re(t,this.chartId,this.redirectUrls)}}},ls={key:0,class:"dashboard-charts"},os={class:"no-data-section"},ds={key:1,style:{height:"300px"}};function cs(e,t,a,r,s,n){const i=F("Bar");return a.from==="sd-reports"&&a.data.chart_parameters.length===0?(c(),m("div",ls,[u("div",os,x(e.lang("no_data_available")),1)])):(c(),m("div",ds,[s.chartData?(c(),R(i,{key:0,data:s.chartData,options:s.options},null,8,["data","options"])):b("",!0)]))}const us=ee(is,[["render",cs],["__scopeId","data-v-c1b16956"]]);te.register(Pe,De,Ee,je,Se);te.register(Oe);const ps={components:{Doughnut:it},props:{data:{type:Array,default:()=>[]},colors:{type:Array,default:()=>[]},redirectUrls:{type:Array,default:()=>[]},from:{type:String,default:""}},data(){return{chartDetail:"",chartData:"",options:{responsive:!0,plugins:{datalabels:{display:"auto",color:"#6c757d",anchor:"end",clamp:!0,align:"start",offset:10,font:{weight:"bold"},formatter:this.dataLabelFormatter},legend:{display:!0,position:"top"}},maintainAspectRatio:!1,onClick:this.clickHandler,onHover:this.onHover}}},beforeMount(){this.chartDetail=this.data.result?this.data.result:this.data.chart_parameters},mounted(){let e=[];e=this.chartDetail.map(t=>t.name),this.chartData={labels:e,datasets:[{backgroundColor:ne(e.length),borderColor:ne(e.length),data:this.chartDetail.map(t=>t.count)}]}},methods:{clickHandler(e,t){if(H(t)&&H(this.redirectUrls)){const a=this.redirectUrls[t[0].index];if(H(a)){let r=JSON.parse('{"'+decodeURI(a.split("?")[1]).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');this.$router.push({path:a.replace(this.basePath(),""),query:r})}}},dataLabelFormatter(e,t){return ut(e,t)},onHover(e,t){e.native.target.style.cursor=t[0]?"pointer":"default",Re(t,this.chartId,this.redirectUrls)}}},hs={key:0,class:"dashboard-charts"},fs={class:"no-data-section"},ms={key:1};function ys(e,t,a,r,s,n){const i=F("Doughnut");return a.from==="sd-reports"&&a.data.chart_parameters.length===0||a.from==="dashboard"&&a.data.result.length===0?(c(),m("div",hs,[u("div",fs,x(e.lang("no_data_available")),1)])):(c(),m("div",ms,[s.chartData?(c(),R(i,{key:0,data:s.chartData,options:s.options},null,8,["data","options"])):b("",!0)]))}const _s=ee(ps,[["render",ys]]);const gs={props:{chartData:{type:[Object,Array,String],default:()=>[]},redirectUrls:{type:[Array],default:()=>[]},type:{type:String,default:"pie"},showTitle:{type:Boolean,default:!0},from:{type:String,default:""}},components:{"bar-chart":Qr,"pie-chart":ns,"horizontal-chart":us,"doughnut-chart":_s},data(){return{colors:[]}},beforeMount(){this.getRandomColor()},methods:{getRandomColor(){for(;this.colors.length<100;){do var e=Math.floor(Math.random()*1e6+1);while(this.colors.indexOf(e)>=0);this.colors.push("#"+("000000"+e.toString(16)).slice(-6))}}}},vs={key:0,class:"container container-1"},bs={class:"col-sm-12"},ws={key:0,class:"Chart"},Cs={key:0,style:{"text-align":"center"},id:"type"},ks={key:1,class:"Chart"},xs={key:0,style:{"text-align":"center"},id:"type"},Fs={key:2,class:"Chart"},Ss={key:0,style:{"text-align":"center"},id:"type"},Ps={key:3,class:"Chart"},Ds={key:0,style:{"text-align":"center"},id:"type"};function Es(e,t,a,r,s,n){const i=F("bar-chart"),l=F("pie-chart"),o=F("horizontal-chart"),d=F("doughnut-chart");return a.chartData?(c(),m("div",vs,[u("div",bs,[a.type==="bar"?(c(),m("div",ws,[a.showTitle?(c(),m("h1",Cs,"Barchart")):b("",!0),E(i,{from:a.from,data:a.chartData,colors:s.colors,redirectUrls:a.redirectUrls},null,8,["from","data","colors","redirectUrls"])])):b("",!0),a.type==="pie"?(c(),m("div",ks,[a.showTitle?(c(),m("h1",xs,"Piechart")):b("",!0),E(l,{from:a.from,data:a.chartData,colors:s.colors,redirectUrls:a.redirectUrls},null,8,["from","data","colors","redirectUrls"])])):b("",!0),a.type==="horizontal"?(c(),m("div",Fs,[a.showTitle?(c(),m("h1",Ss,"Horizontalchart")):b("",!0),E(o,{from:a.from,data:a.chartData,colors:s.colors,redirectUrls:a.redirectUrls},null,8,["from","data","colors","redirectUrls"])])):b("",!0),a.type==="doughnut"?(c(),m("div",Ps,[a.showTitle?(c(),m("h1",Ds,"Doughnutchart")):b("",!0),E(d,{from:a.from,data:a.chartData,colors:s.colors,redirectUrls:a.redirectUrls},null,8,["from","data","colors","redirectUrls"])])):b("",!0)])])):b("",!0)}const Rs=ee(gs,[["render",Es]]);const Os={name:"custom-filter",description:"Custom Fields Filter Component",props:{updateFilterFields:{type:Function,default:()=>{}},selectedFilterFields:{type:Array,default:()=>[]},endPoint:{type:String,required:!0},defaultFiltersObj:{type:Object,default:()=>{}}},data(){return{customFields:[],loading:!0,selectedFields:this.selectedFilterFields,search:"",locale:"",hasMoreData:!0,page:1}},created(){window.emitter.on("clearCustomFields",this.clearFields)},computed:{filteredList(){return this.customFields.filter(e=>e.label.toLowerCase().includes(this.search.toLowerCase()))}},methods:{clearAndCall(){this.customFields=[],this.loading=!0,this.search="",this.page=1,this.hasMoreData=!0,this.getFields()},handleFilterScroll:ra.debounce(function(){const e=document.getElementById("filter-dropdown"),t=e.scrollHeight,a=e.scrollTop,r=e.clientHeight;a+r>=t-100&&!this.loading&&this.hasMoreData&&this.getFields()},200),clearFields(){this.selectedFields=[]},subString(e){return tt(e,30)},onCancel(){var e=document.getElementById("filter-div");e.classList.remove("open")},onClick(e){if(this.selectedFields.map(a=>a.id).includes(e.id)){for(var t in this.selectedFields)if(this.selectedFields[t].id===e.id){this.selectedFields.splice(t,1);break}}else e.name="custom_"+e.id,e.isCustom=!0,e.value="",e.className="col-sm-4",this.selectedFields.push(e);this.updateFilterFields(this.selectedFields)},async getFields(){try{this.loading=!0;let e={page:this.page,time:Date.now()};this.defaultFiltersObj&&this.defaultFiltersObj.hasOwnProperty("change_type_ids")&&this.defaultFiltersObj.change_type_ids&&this.defaultFiltersObj.change_type_ids.forEach((a,r)=>{e[`change_type_ids[${r}]`]=a.id}),this.defaultFiltersObj&&this.defaultFiltersObj.hasOwnProperty("asset_type_ids")&&this.defaultFiltersObj.asset_type_ids&&this.defaultFiltersObj.asset_type_ids.forEach((a,r)=>{e[`asset_type_ids[${r}]`]=a.id});const t=await G.get(this.endPoint,{params:e});t.data.data.data.length>0?(this.customFields=[...this.customFields,...t.data.data.data],this.page++):(this.hasMoreData=!1,this.checkPresentFields())}catch(e){console.error("Error fetching data:",e)}finally{this.loading=!1}},getCustomFields(e,t){this.customFields=[],this.selectedFields=[],G.get(e).then(a=>{let r=a.data.data.data;if(this.page++,r.length){for(var s in r){if(t.length)for(var n in t)t[n].key===r[s].key&&(r[s].name=t[n].key,r[s].isCustom=!0,r[s].className="col-sm-4",r[s].value||(r[s].data_type==="checkbox"?r[s].value=t[n].value.split(","):r[s].value=t[n].value,this.selectedFields.push(r[s]),this.selectedFields.length===t.length&&this.updateFilterFields(this.selectedFields)));for(var i in this.selectedFields)this.selectedFields[i].id===r[s].id&&(r[s].value=this.selectedFields[i].value)}this.customFields=r,this.checkPresentFields()}}).catch(a=>{})},checkPresentFields(){let e=this.customFields.map(t=>t.key);this.selectedFields.forEach(t=>{e.includes(t.key)||(t.selected=0,this.selectedFields=this.selectedFields.filter(function(a){return a.id!==t.id}))}),this.updateFilterFields(this.selectedFields)}}},Ts={id:"filter-div",class:"card-tools"},As={key:0,class:"nav-item"},Ms={class:"form-group has-feedback has-search filter_div"},Is=["placeholder"],$s=["onClick"],Ls={key:0,class:"fa fa-check field_select"},Us={id:"field_title"},js={key:1},Hs={class:"text-center"},Bs={key:2,class:"field_loader nav-item"};function Vs(e,t,a,r,s,n){const i=F("loader"),l=ke("tooltip");return c(),m("div",Ts,[q((c(),m("button",{type:"button",class:"btn btn-tool dropdown-toggle","data-bs-toggle":"dropdown",id:"labels-button",onClick:t[0]||(t[0]=o=>n.clearAndCall())},t[4]||(t[4]=[u("i",{class:"glyphicon glyphicon-plus"},null,-1)]))),[[l,e.trans("add_custom_field")]]),u("ul",{id:"filter-dropdown",class:"dropdown-menu dropdown-menu-right filter_menu",onClick:t[2]||(t[2]=o=>o.stopPropagation()),onScroll:t[3]||(t[3]=o=>n.handleFilterScroll())},[s.loading?b("",!0):(c(),m("li",As,[u("div",Ms,[q(u("input",{type:"text",class:"form-control",name:"label",placeholder:e.trans("search"),"onUpdate:modelValue":t[1]||(t[1]=o=>s.search=o)},null,8,Is),[[Nt,s.search]])])])),(c(!0),m(Q,null,he(n.filteredList,o=>q((c(),m("li",{class:"nav-item fields",onClick:d=>n.onClick(o)},[u("a",{class:Ue(["nav-link custom-filter-nav-item",{active:s.selectedFields.map(d=>d.id).includes(o.id)}]),href:"javascript:;"},[s.selectedFields.map(d=>d.id).includes(o.id)?(c(),m("i",Ls)):b("",!0),u("span",Us,x(n.subString(o.label)),1)],2)],8,$s)),[[l,o.hover?o.hover:e.trans(o.label)]])),256)),!s.loading&&s.customFields.length===0?(c(),m("li",js,[u("p",Hs,x(e.trans("no_results_found")),1)])):b("",!0),s.loading?(c(),m("li",Bs,[E(i,{size:30,duration:4e3,color:"#1d78ff"})])):b("",!0)],32)])}const Ns=ee(Os,[["render",Vs],["__scopeId","data-v-98cbc235"]]);const zs={key:0,class:"card-body"},qs={class:"row"},Ws={key:1,id:"table-filter"},Js={class:"row"},Gs={class:"card-footer"},Xs={__name:"SdReportFilter",props:{metaData:{type:Array,required:!0},appliedFilters:{type:Object,default:()=>{}},from:{type:String,default:""},showCustomFilter:{type:Boolean,default:!1},updateFields:{type:Function,default:()=>{}},selectedFields:{type:Array,default:()=>[]},endPoint:{type:String,default:""},saveFilter:{type:Boolean,default:!1},filterFor:{type:String,default:""},filterNum:{type:[String,Number],default:""},redirectTo:{type:String,default:""},deleteUrl:{type:String,default:""},closeFilter:{type:Function,default:()=>{}},save_endpoint:{type:String,default:""},filterData:{type:Object,default:()=>{}},chartType:{type:String,default:()=>""}},emits:["selectedFilters"],setup(e,{emit:t}){const a=e,r=t,s=v(a.appliedFilters),n=v(a.metaData),i=v(!1),l=v({width:"49.5%"}),o=v({width:"20%"}),d=v(!1),f=v(""),y=v(a.filterNum),w=v(""),O=v("");nt(()=>{U(),a.filterNum&&me(),O.value=a.filterData});const W=g=>{for(var C in g)A(g[C].value,g[C].name)},U=()=>{a.updateFields(a.selectedFields);for(var g in a.selectedFields)A(a.selectedFields[g].value,a.selectedFields[g].name)},A=(g,C)=>{s.value[C]=g,window.emitter.emit("onFilterSelected",s.value)},T=()=>{r("selectedFilters",s.value)},M=()=>{r("selectedFilters","closeEvent")},N=g=>{r("selectedFilters",s.value),w.value=g,d.value=!0},Y=()=>{d.value=!1},Z=()=>{s.value={},i.value=!0,setTimeout(()=>{i.value=!1},1e3),r("selectedFilters","resetEvent"),window.emitter.emit("onFilterSelected",s.value)},me=()=>{i.value=!0,axios.get("/service-desk/api/agent/sd-filter/"+y.value).then(g=>{i.value=!1;let C={},ae=[];g.data.data.fields.map(B=>{B.key.indexOf("custom_")!==-1?(ae.push(B),C[B.key]=B.value):C[B.key]=B.value_meta}),ae.length&&le(ae),s.value=C,n.value.map(function(B){B.section.map(function(J){C.hasOwnProperty(J.name)&&(J.value=C[J.name])})}),y.value=g.data.data.id,f.value=g.data.data.name}).catch(g=>{i.value=!1})},ie=v(null),le=g=>{ie.value.getCustomFields(a.endPoint,g)},Ae=g=>{d.value=g};return(g,C)=>{const ae=F("custom-loader"),B=F("faveo-box");return c(),R(B,{"box-class":"card card-light ",title:g.lang("filter")},{customActions:re(()=>[e.showCustomFilter?(c(),R(Ns,{key:0,updateFilterFields:e.updateFields,selectedFilterFields:e.selectedFields,endPoint:e.endPoint,ref_key:"custom_table_filter",ref:ie,defaultFiltersObj:s.value},null,8,["updateFilterFields","selectedFilterFields","endPoint","defaultFiltersObj"])):b("",!0)]),actions:re(()=>[u("div",Gs,[u("button",{id:"filter-apply-btn",class:"btn btn-primary",type:"button",onClick:T},[C[2]||(C[2]=u("span",{class:"fas fa-check"},null,-1)),z("  "+x(g.lang("apply")),1)]),O.value.is_default?b("",!0):(c(),m("button",{key:0,id:"filter-upd",class:"btn btn-primary",type:"button",onClick:C[0]||(C[0]=J=>N("update"))},[C[3]||(C[3]=u("span",{class:"fas fa-sync"},null,-1)),z("  "+x(g.lang("edit")),1)])),u("button",{id:"filter-upd",class:"btn btn-primary",type:"button",onClick:C[1]||(C[1]=J=>N("fork"))},[C[4]||(C[4]=u("span",{class:"fas fa-save"},null,-1)),z("  "+x(g.lang("save")),1)]),u("button",{id:"reset-btn",class:"btn btn-primary",type:"button",onClick:Z},[C[5]||(C[5]=u("span",{class:"fas fa-undo"},null,-1)),z("  "+x(g.lang("reset")),1)]),u("button",{id:"filter-cancel-btn",class:"btn btn-secondary",type:"button",onClick:M},[C[6]||(C[6]=u("span",{class:"fas fa-times"},null,-1)),z("  "+x(g.lang("cancel")),1)])])]),default:re(()=>[i.value?(c(),m("div",zs,[u("div",qs,[E(ae,{"animation-duration":4e3,color:"#1d78ff",size:60})])])):(c(),m("div",Ws,[(c(!0),m(Q,null,he(n.value,J=>(c(),m("div",Js,[(c(!0),m(Q,null,he(J.section,_=>(c(),m(Q,null,[_.isCustom?(c(),R(da,{key:0,formField:_,allFields:e.selectedFields,onUpdated:W,classname:_.className},null,8,["formField","allFields","classname"])):(c(),m(Q,{key:1},[_.type!=="date"&&_.type!=="number"&&_.type!=="text"?(c(),R(rt,{key:_.name,id:_.name,name:_.name,apiEndpoint:_.url,classname:_.className,elements:_.elements,multiple:_.isMultiple,label:g.lang(_.label),value:_.value,onChange:A,strlength:"35",hint:g.lang(_.hint)},null,8,["id","name","apiEndpoint","classname","elements","multiple","label","value","hint"])):b("",!0),_.type==="number"?(c(),R(na,{label:g.lang(_.label),formStyle:l.value,value:_.value,key:_.name,id:_.name,name:_.name,classname:_.className,type:"text",onChange:A,min_placeholder:_.min_placeholder,max_placeholder:_.max_placeholder,required:!1},null,8,["label","formStyle","value","id","name","classname","min_placeholder","max_placeholder"])):b("",!0),_.type==="text"?(c(),R(la,{label:g.lang(_.label),value:_.value,key:_.name,id:_.name,name:_.name,onChange:A,classname:_.className,required:!1},null,8,["label","value","id","name","classname"])):b("",!0),_.type==="date"?(c(),R(ia,{label:_.label,value:_.value,type:"datetime",key:_.name,id:_.name,name:_.name,onChange:A,range:_.range,required:!1,format:"MMMM DD YYYY, h:mm a",classname:_.className,clearable:!1,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":_.timeOptions,isDateSelector:!1,numberStyle:o.value,confirm:!0},null,8,["label","value","id","name","range","classname","time-picker-options","numberStyle"])):b("",!0)],64))],64))),256))]))),256))])),d.value?(c(),R(Oa,{key:2,onClose:Y,filterArray:n.value,toggleFilterPopUp:Ae,closeFilter:e.closeFilter,filterValues:s.value,reportDataObj:O.value,from:e.filterFor,"modal-mode":w.value,chartType:e.chartType},null,8,["filterArray","closeFilter","filterValues","reportDataObj","from","modal-mode","chartType"])):b("",!0)]),_:1},8,["title"])}}},Ks=ee(Xs,[["__scopeId","data-v-06bdb37a"]]),Ys={1:[{section:[{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems"},{name:"dept_ids",url:"api/dependency/departments",label:"departments"},{name:"impact_ids",url:"/service-desk/api/dependency/impacts",label:"impact_type"}]},{section:[{name:"problem_statuses",url:"/service-desk/api/status/list?module=1",label:"status"},{name:"location_ids",url:"api/dependency/locations",label:"location"},{name:"priority_ids",url:"api/dependency/priorities",label:"priority"}]},{section:[{name:"assigned_ids",url:"api/dependency/agents?meta=true",label:"assigned"},{name:"asset_ids",url:"/service-desk/api/asset-list?meta=true",label:"assets"},{name:"ticket_ids",url:"api/dependency/tickets",label:"tickets"}]},{section:[{name:"requester_ids",url:"/api/dependency/users?meta=true",label:"requester"},{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes"},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[]}],2:[{section:[{name:"change_ids",url:"/service-desk/api/dependency/changes?meta=true",label:"changes",isCustom:!1},{name:"department_ids",url:"/api/dependency/departments",label:"departments",isCustom:!1},{name:"team_ids",url:"/api/dependency/teams",label:"teams",isCustom:!1}]},{section:[{name:"requester_ids",url:"/api/dependency/users?meta=true",label:"requester",isCustom:!1},{name:"status_ids",url:"/service-desk/api/status/list?module=2",label:"status",isCustom:!1},{name:"priority_ids",url:"/service-desk/api/dependency/change_priorities",label:"priority",isCustom:!1}]},{section:[{name:"change_type_ids",url:"/service-desk/api/dependency/change_types",label:"change_type",isCustom:!1},{name:"impact_ids",url:"/service-desk/api/dependency/impacts",label:"impact",isCustom:!1},{name:"location_ids",url:"/api/dependency/locations",label:"location",isCustom:!1}]},{section:[{name:"asset_ids",url:"/service-desk/api/asset-list?meta=true",label:"assets",isCustom:!1},{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases",isCustom:!1},{name:"ticket_ids",url:"/api/dependency/tickets",label:"tickets",isCustom:!1}]},{section:[{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems",isCustom:!1},{name:"assignee-ids",url:"/api/dependency/agents",label:"Agent"},{name:"pending_approvers",url:"/api/dependency/users",label:"Pending Approvers"}]},{section:[{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},pickers:!0,range:!0,isCustom:!1}]},{section:[]}],3:[{section:[{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases"},{name:"release_statuses",url:"/service-desk/api/status/list?module=3",label:"status"},{name:"location_ids",url:"/api/dependency/locations",label:"location"}]},{section:[{name:"priority_ids",url:"/service-desk/api/dependency/release_priorities",label:"priority"},{name:"release_type_ids",url:"/service-desk/api/dependency/release_types",label:"release_type"},{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets"}]},{section:[{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes"},{name:"planned_start_date",type:"date",label:["planned_start_date","planned_start_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"planned_end_date",type:"date",label:["planned_end_date","planned_end_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[]}],4:[{section:[{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets",isCustom:!1},{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems",isCustom:!1},{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes",isCustom:!1}]},{section:[{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases",isCustom:!1},{name:"contract_ids",url:"/service-desk/api/dependency/contracts",label:"contracts",isCustom:!1},{name:"asset_type_ids",url:"/service-desk/api/dependency/asset_types",label:"asset_types",isCustom:!1}]},{section:[{name:"used_by_ids",url:"api/dependency/users?meta=true",label:"used_by",isCustom:!1},{name:"managed_by_ids",url:"api/dependency/agents?meta=true",label:"managed_by",isCustom:!1},{name:"location_ids",url:"api/dependency/locations",label:"location",isCustom:!1}]},{section:[{name:"dept_ids",url:"api/dependency/departments",label:"departments",isCustom:!1},{name:"org_ids",url:"api/dependency/organizations",label:"organizations",isCustom:!1},{name:"product_ids",url:"/service-desk/api/dependency/products",label:"products",isCustom:!1}]},{section:[{name:"assigned_on",type:"date",label:["assigned_on","assigned_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0}]},{section:[{name:"impact_type_ids",url:"/service-desk/api/dependency/impacts",label:"impact_types",isCustom:!1},{name:"ticket_ids",url:"/api/dependency/tickets",label:"ticket",isCustom:!1},{name:"asset_status_ids",url:"/service-desk/api/status/list?module=4",label:"asset_status",isCustom:!1}]},{section:[{name:"depreciation_ids",url:"/service-desk/api/dependency/depreciation",label:"Depreciation",isCustom:!1}]},{section:[]}],5:[{section:[{name:"contract_ids",url:"/service-desk/api/dependency/contracts",label:"contracts"},{name:"contract_type_ids",url:"/service-desk/api/dependency/contract_types",label:"contract_type"},{name:"approver_ids",url:"/api/dependency/agents?meta=true",label:"approver"}]},{section:[{name:"vendor_ids",url:"/service-desk/api/dependency/vendors",label:"vendors"},{name:"license_type_ids",url:"/service-desk/api/dependency/license_types",label:"license_type"},{name:"contract_statuses",url:"/service-desk/api/status/list?module=5",label:"status"}]},{section:[{name:"renewal_status_ids",url:"/service-desk/api/dependency/contract_renewal_statuses",label:"renewal_status"},{name:"owner_ids",url:"/api/dependency/agents",label:"owner"},{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets"}]},{section:[{name:"notify_agent_ids",url:"/api/dependency/agents?meta=true",label:"notify_agents"},{name:"cost",label:"cost",type:"number"},{name:"notify_in_days",label:"notify_before",type:"number"}]},{section:[{name:"contract_start_date",type:"date",label:["contract_start_date","contract_start_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"contract_end_date",type:"date",label:["contract_end_date","contract_end_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[]}],7:[{section:[{name:"software_licenses_ids",url:"service-desk/api/dependency/softwarelicense",label:"Software License",isCustom:!1},{name:"license_type",url:"/service-desk/api/dependency/license_types",label:"License type",isCustom:!1},{name:"depreciation_ids",url:"/service-desk/api/dependency/depreciation",label:"Depreciation",isCustom:!1}]},{section:[{name:"vendor_ids",url:"/service-desk/api/dependency/vendors",label:"Vendor",isCustom:!1},{name:"manufacturer_ids",url:"/service-desk/api/dependency/manufacturer",label:"Manufacturer",isCustom:!1},{name:"org_ids",url:"/api/dependency/organizations",label:"Organization",isCustom:!1}]},{section:[{name:"asset_ids",url:"service-desk/api/dependency/assets",label:"Assets",isCustom:!1},{name:"used_by_ids",url:"api/dependency/users?meta=true",label:"Users",isCustom:!1},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},pickers:!0,range:!0,isCustom:!1}]},{section:[]}]},Zs={class:"col-sm-12",id:"sd-report-template"},Qs={class:"card card-light report-box-primary"},en={class:"card-header"},tn={class:"card-title"},an={class:"card-tools"},rn={class:"btn-group"},sn={class:"card-body"},nn={class:"row mb-3"},ln={class:"col-sm-12"},on={class:"float-end btn-group"},dn={class:"btn btn-sm btn-light dropdown-toggle",id:"chart-type-dropdown","data-bs-toggle":"dropdown"},cn={class:"dropdown-menu dropdown-menu-right",style:{},"aria-labelledby":"chart-type-dropdown"},un=["onClick"],pn={class:"data-widget"},hn={class:"row"},fn={class:"card card-light"},mn={class:"card-header"},yn={class:"card-title"},_n={class:"card-body"},Rn={__name:"SDReports",props:{id:{type:Number,default:""},type:{type:String,default:""},module:{type:Number,default:""},schedule:{type:Number,default:""}},setup(e){const t=e,a=ca(),r=v(""),s=v(""),n=v(""),i=v([]),l=v([]),o=v([]),d=v(!1),f=v(["bar","horizontal","pie","doughnut"]),y=v(""),w=v([]),O=v(!1),W=v({}),U=v([]),A=v([]),T=v(""),M=v(""),N=v(!1),Y=v(""),Z=v(!1),me=v(""),ie=v(!1),le=v(0);nt(()=>{r.value=t.id,M.value=t.type,w.value=Ys[t.module];const h={"change-report":"/custom-field-flattened?category=changes&type=changes","asset-report":"/custom-field-flattened?category=asset&type=asset","software-license-report":"/custom-field-flattened?category=license&type=license","problem-report":"/custom-field-flattened?category=problem&type=problem","contract-report":"/custom-field-flattened?category=contract&type=contract","release-report":"/custom-field-flattened?category=release&type=release"};Z.value=h.hasOwnProperty(M.value),me.value=h[M.value]||"",Y.value=Z.value?w.value.length-1:w.value.length,ze(),t.schedule&&Ot(t.schedule),C()}),zt(()=>{window.emitter.on("updateFilter",Ae),window.emitter.on("refreshSdReport",()=>N.value=!0)}),qt(N,(h,p)=>{h===!0&&(O.value=!1,ze()),N.value=!1});const Ae=h=>{w.value.map(function(p){p.section.map(function(k){h.name===k.name&&(k.value=h.value)})})},g=h=>{h.forEach(p=>{p.isCustom&&p.type==="checkbox"&&p.value&&(p.value=Array.isArray(p.value)?p.value:p.value.split(","))}),Z.value&&(U.value=h,w.value[Y.value].section=h)},C=()=>{w.value.map(function(h){h.section.map(function(p){p.isCustom||(p.elements=[],p.isMultiple=!0),p.isPrepopulate=!1,p.value="",p.className="col-sm-4"})})},ae=h=>h==="closeEvent"?O.value=!1:h==="resetEvent"?B():J(h),B=()=>{T.value="/service-desk/api/sd-report/"+s.value+"/"+r.value,ye(),g([]),window.emitter.emit("clearCustomFields"),w.value=w.value.map(function(h){return h.section.map(function(p){p.isCustom||(p.elements=[],p.isMultiple=!0),p.isPrepopulate=!1,p.value="",p.className="col-sm-4"}),h})},J=h=>{W.value=h,U.value.forEach(V=>{h.hasOwnProperty(V.name)&&(V.value=h[V.name])});const p=`/service-desk/api/sd-report/${s.value}/${r.value}?`,k=new URLSearchParams(Wt(w.value,h));let I=k.toString();I.endsWith("&")&&(I=I.slice(0,-1));const P=new URLSearchParams(k),S=Object.fromEntries(P);A.value=_(S),T.value=p+decodeURIComponent(I),ye("fromFilter")},_=h=>{const p={};for(const k in h){const I=k.match(/([a-zA-Z_]+)\[(\d+)\]/);if(I){const[P,S,V]=I;p[S]=p[S]||[],p[S][V]=parseInt(h[k],10)}}return p},Ne=()=>{O.value=!O.value},ze=async()=>{d.value=!0;try{const p=(await G.get(`service-desk/api/report/details/${r.value}?include_filters=1`)).data.data,{sd_filter:k,name:I,type:P}=p;i.value=p,l.value=k?k.id:"",n.value=I,s.value=P;let S="";if(l.value){const{filter_meta:V}=k;V.forEach((oe,At)=>{const{key:Mt,value:_e}=oe;(Array.isArray(_e)?_e:[_e]).forEach((It,qe)=>{S+=`${At||qe?"&":""}${Mt}${Array.isArray(_e)?`[${qe}]`:""}=${It}`})})}T.value=`/service-desk/api/sd-report/${s.value}/${r.value}${S?`?${S}`:""}`,await t.schedule||ye()}catch(h){d.value=!1,se(h,"sd-reports-view")}},ye=h=>{G.get(T.value).then(p=>{o.value=p.data.data,Pt();const k=o.value.charts[0].chart_type;le.value++,h||(y.value=k==="donut_chart"?"doughnut":k)}).catch(p=>{se(p,"sd-reports-view")}).finally(()=>{d.value=!1})},Pt=()=>{const{charts:h=[],widgets:p=[]}=o.value,k=h.every(P=>P.chart_parameters.length===0),I=p.every(P=>P.value===0);ie.value=!k||!I},Dt=h=>{y.value=h,Et(h)},Et=h=>{let p={};p.report_id=r.value,p.chart_type=h,G.post("service-desk/api/report/update/chart-type",p).then(k=>{}).catch(k=>{se(k,"sd-reports-view")})},Rt=async()=>{const h=new FormData,p=document.getElementById("sd-report-template"),k=p.querySelectorAll(".btn-group");O.value===!0&&(O.value=!1),k.forEach(P=>{P.style.display="none"}),p.querySelectorAll("h3").forEach(P=>{P.style.whiteSpace="nowrap"});try{const P=await Jr(p);k.forEach(oe=>{oe.style.display="block"});const S=await fetch(P).then(oe=>oe.blob());h.append("report_id",r.value),h.append("image",S,"report.png"),d.value=!0;const V=await G.post("api/export/graphical-report",h);at(V,"sd-reports-view"),d.value=!1}catch(P){d.value=!1,se(P,"sd-reports-view")}},Ot=h=>{G.get("/api/schedule-filters/"+h).then(p=>{const k=`/service-desk/api/sd-report/${t.module}/${r.value}?`;T.value=k+p.data.data,ye()}).catch(p=>{se(p,"sd-reports-view")})},Tt=()=>{let h=JSON.stringify(A.value);a.push({path:"/reports/schedule/add/"+M.value+"/"+r.value,query:{params:h,type:"sd-reports"}})};return(h,p)=>{const k=F("alert"),I=F("custom-loader"),P=ke("tooltip");return c(),m("div",Zs,[E(k,{componentName:"sd-reports-view"}),u("div",Qs,[u("div",en,[u("h3",tn,x(n.value),1),u("div",an,[u("div",rn,[q((c(),m("button",{id:"report-filter",type:"button",class:"btn btn-tool",onClick:Ne},p[0]||(p[0]=[u("i",{class:"glyphicon glyphicon-filter"},null,-1)]))),[[P,h.lang("Report configuration/filter")]]),ie.value?(c(),m(Q,{key:0},[q((c(),m("button",{id:"export-report-btn",type:"button",class:"btn btn-tool",onClick:Rt},p[1]||(p[1]=[u("i",{class:"fas fa-paper-plane","aria-hidden":"true"},null,-1)]))),[[P,h.lang("export")]]),q((c(),m("button",{id:"schedule-report",class:"btn btn-tool",onClick:Tt},p[2]||(p[2]=[u("i",{class:"fas fa-calendar","aria-hidden":"true"},null,-1)]))),[[P,h.lang("schedule")]])],64)):b("",!0)])])]),u("div",sn,[O.value?(c(),R(Ks,{key:0,id:"filter-box",metaData:w.value,selectedFields:U.value,onSelectedFilters:ae,showCustomFilter:Z.value,updateFields:g,appliedFilters:W.value,saveFilter:!0,endPoint:me.value,filterNum:l.value,filterFor:"sd_report",redirectTo:"/service-desk/reports'",closeFilter:Ne,save_endpoint:"/service-desk/api/agent/sd-filter/",filterData:i.value,chartType:y.value},null,8,["metaData","selectedFields","showCustomFilter","appliedFilters","endPoint","filterNum","filterData","chartType"])):b("",!0),u("div",null,[u("div",null,[d.value?(c(),R(I,{key:0,"animation-duration":4e3,color:"#1d78ff",size:60})):b("",!0),u("div",nn,[u("div",ln,[u("div",on,[u("button",dn,x(h.lang("chart_type")),1),u("div",cn,[(c(!0),m(Q,null,he(f.value,S=>(c(),m("a",{key:S,class:Ue(["dropdown-item",y.value===S?"active":""]),href:"javascript:;",onClick:V=>Dt(S)},x(h.trans("view_by"))+" "+x(h.trans(S)),11,un))),128))])])])]),u("div",pn,[o.value.widgets?(c(),R(Gt,{"data-widget-data":o.value.widgets,key:le.value},null,8,["data-widget-data"])):b("",!0)]),u("div",hn,[(c(!0),m(Q,null,he(o.value.charts,S=>(c(),m("div",{class:"col-sm-6",key:S.id},[u("div",fn,[u("div",mn,[u("h3",yn,x(S.name),1)]),u("div",_n,[(c(),R(Rs,{chartData:S,type:y.value,showTitle:!1,from:"sd-reports",redirectUrls:S.chart_parameters.map(V=>V.redirect_url),key:le.value},null,8,["chartData","type","redirectUrls"]))])])]))),128))])])])])])])}}};export{Rs as C,Oa as S,Rn as _,Dn as a,En as b,Pn as c,Jr as d,Ns as e,ut as g,Re as h,Oe as p,ct as t};
