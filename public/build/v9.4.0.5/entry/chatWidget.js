import{_ as y,ac as f,a7 as v,B as u,k as g,o as i,l as r,v as s,X as n,q as c,I as S,L as b,N as D,F as x,x as d,J as _,K as T,m as B,ab as K,s as L}from"../chunks/bootstrap.js";const A={name:"widget-ui",props:{whiteLabel:{type:Boolean,default:!1}},components:{"faveo-form-client-panel":f,loader:v},data(){return{originalHtml:'<p>This is <strong>HTML</strong> content with an <img src="image.jpg" alt="An image"></p>',search_text:"",showAll:!1,showBack:!1,showTicket:!1,widgetLoad:!0,widgetData:"",articleList:[],loadKb:!0,chatUrl:"",chatId:"",timeoutId:null,layoutDetails:{},widgetSource:"",apiKey:"",form_category:""}},beforeMount(){let o=new URLSearchParams(window.location.search);this.chatUrl=o.get("chat_url"),this.chatId=o.get("chat_id");let t=o.get("chat_data");this.widgetData=t?JSON.parse(t):"",this.apiKey=this.widgetData.api_key?this.widgetData.api_key:"",this.form_category=this.widgetData.form_category?this.widgetData.form_category:"",this.$store.dispatch("setApiKey",this.apiKey),this.widgetLoad=!1,this.layoutDetails={portal:{client_button_border_color:this.widgetData.color_code,client_button_color:this.widgetData.color_code,client_input_field_color:this.widgetData.color_code}},this.getKbData(),this.getSource()},methods:{getSubStr(o){if(o)return o.length>110?o.substring(0,110)+"...":o},getSource(){u.get("/api/dependency/sources?api_key="+this.apiKey).then(o=>{this.widgetSource=o.data.data.sources.find(t=>t.name==="Widget"),this.widgetSource&&this.$store.dispatch("setSource",this.widgetSource.id)}).catch(o=>{this.widgetSource=""})},handleSearch(){clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.search_text?this.getKbData("/api/search",{s:this.search_text},!0):this.getKbData()},1)},strippedText(o){return o.replace(/<\/?[^>]+(>|$)/g,"")},getKbData(o="/api/article-list-with-category",t={},h=!1){this.loadKb=!0;let p=t;u.get(this.chatUrl+o,{params:p}).then(e=>{this.loadKb=!1,this.articleList=h?e.data.data.articles.data.filter(l=>l.type):e.data.data.articles.filter(l=>l.type)}).catch(e=>{this.loadKb=!1})},showAllArticles(){this.showTicket=!1,this.showAll=this.showBack=!0,this.getKbData()},backToHome(){this.showAll=this.showBack=this.showTicket=!1},updateTicket(){this.showAll=!1,this.showTicket=this.showBack=!0}}},C={key:0,class:"widget-UI"},I={class:"dpmsg-Screen"},F={class:"dpmsg-ScreenContent"},Q={class:"scrollarea"},H={class:"scrollarea-content"},N={class:"dpmsg-ScreenHeaderTitle-pad"},U={class:"block-container"},W={key:0,class:"dpmsg-Block"},j={class:"dpmsg-BlockWrapper"},q={class:"fixed-kb"},E={class:"dpmsg-QuickSearchControl"},V={class:"dpmsg-QuickSearchControl--wrapper"},M={class:"dpmsg-QuickSearchControl--label",for:"quickSearchInput"},P={key:0,class:"text-center p-3"},R={key:1,class:"dpmsg-QuickSearchControl--hint"},z={key:0,class:"dpmsg-QuickSearchResults"},J={class:"dpmsg-QuickSearchEntry"},O={class:"dpmsg-QuickSearchEntryHeaderLink"},G=["title","href"],X={class:"dpmsg-QuickSearchExcerpt"},Y={key:1,class:"dpmsg-Block"},Z={class:"dpmsg-BlockWrapper"},$={key:0,class:"dpmsg-BlockText"},ee={class:"dpmsg-ScreenFooter"},te={key:0,class:"dpmsg-ScreenFooterText"},se={class:"dpmsg-ScreenFooterText"};function oe(o,t,h,p,e,l){const k=g("loader"),w=g("faveo-form-client-panel");return!e.widgetLoad&&e.widgetData?(i(),r("div",C,[s("div",I,[s("div",F,[s("div",Q,[s("div",H,[s("div",{class:"dpmsg-ScreenHeader",style:n({"background-color":e.widgetData.color_code})},[s("span",N,[e.showBack?(i(),r("a",{key:0,class:"text-white back-link",href:"javascript:;",onClick:t[0]||(t[0]=a=>l.backToHome())},t[5]||(t[5]=[s("i",{class:"fas fa-arrow-circle-left back-icon"},null,-1)]))):c("",!0),t[6]||(t[6]=S("Get In Touch "))])],4),s("div",U,[e.showTicket?c("",!0):(i(),r("div",W,[s("div",j,[s("div",q,[s("div",{class:"dpmsg-BlockHeader",style:n({"border-bottom":"2px solid "+e.widgetData.color_code})},"KnowledgeBase",4),s("div",E,[s("div",V,[b(s("input",{class:"dpmsg-QuickSearchControl--input",id:"quickSearchInput","onUpdate:modelValue":t[1]||(t[1]=a=>e.search_text=a),type:"text",onInput:t[2]||(t[2]=(...a)=>l.handleSearch&&l.handleSearch(...a))},null,544),[[D,e.search_text]]),s("label",M,[s("i",{class:"fas fa-search",style:n({color:e.widgetData.color_code})},null,4),t[7]||(t[7]=s("span",{"aria-hidden":"true"},"Search",-1))]),t[8]||(t[8]=s("i",{class:"dpmsg-Icon dpmsg-IconSearchClear"},null,-1))]),e.loadKb?(i(),r("div",P,[x(k,{color:e.widgetData.color_code,size:30},null,8,["color"])])):c("",!0),e.search_text&&!e.loadKb&&!e.articleList.length?(i(),r("div",R,[s("span",null,"No results for "+d(e.search_text),1)])):c("",!0)])]),!e.loadKb&&e.articleList.length?(i(),r("div",z,[(i(!0),r(_,null,T(e.showAll?e.articleList.slice().reverse():e.articleList.slice(0,3).reverse(),a=>(i(),r("div",J,[s("h4",O,[s("a",{title:a.name.length>130?a.name:"",rel:"noreferrer noopener",target:"_blank",href:e.chatUrl+"/show/"+a.slug,style:n({color:e.widgetData.color_code})},d(a.name.length>130?a.name.substring(0,130)+"...":a.name),13,G)]),s("div",X,d(l.getSubStr(l.strippedText(a.description))),1),t[9]||(t[9]=s("div",{class:"dpmsg-QuickSearchEntry--divider"},null,-1))]))),256)),!e.showAll&&e.articleList.length>3?(i(),r("a",{key:0,class:"dpmsg-QuickSearchFooter",href:"javascript:;",onClick:t[3]||(t[3]=a=>l.showAllArticles()),style:n({color:e.widgetData.color_code})},"See more results",4)):c("",!0)])):c("",!0)])])),e.showAll?c("",!0):(i(),r("div",Y,[s("div",Z,[s("div",{class:"dpmsg-BlockHeader",style:n({"border-bottom":"2px solid "+e.widgetData.color_code})},"Submit a Ticket",4),e.showTicket?c("",!0):(i(),r("div",$,"Submit an enquiry via our contact form")),e.showTicket?c("",!0):(i(),r("a",{key:1,class:"dpmsg-Button Button-FullWidth Button--primary",onClick:t[4]||(t[4]=a=>l.updateTicket()),title:"Submit an enquiry via our contact form",href:"javascript:;",style:n({background:e.widgetData.color_code})},"Submit a New ticket",4)),e.showTicket?(i(),B(w,{key:2,panel:"client",category:"ticket",layout:e.layoutDetails,isInlineForm:!1,formId:"chat-widget",apiKey:e.apiKey,form_category:e.form_category},null,8,["layout","apiKey","form_category"])):c("",!0)])]))])])])]),s("div",ee,[h.whiteLabel?(i(),r("span",te,d(o.trans("all_rights_reserved")),1)):(i(),r(_,{key:1},[s("span",se,d(o.trans("powered_by"))+"Â ",1),t[10]||(t[10]=s("a",{href:"https://www.faveohelpdesk.com",target:"_blank",rel:"noreferrer noopener"},"Faveo",-1))],64))])])])):c("",!0)}const ie=y(A,[["render",oe]]),m=K({components:{"chat-widget":ie}});Object.assign(m._context,app._context);m.use(L).mount("#chat-widget");
