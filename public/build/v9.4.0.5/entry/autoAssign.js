import{ad as A,a2 as w,s as u,_ as k,B as c,C as V,E as O,R as S,ae as D,D as L,k as r,o as p,l as _,F as n,v as o,x as g,q as d,J as P,m as B,I as E}from"../chunks/bootstrap.js";import{r as N,A as q}from"../chunks/adminRouter.js";import"../chunks/vue-router.js";import"../chunks/FormGenerator.js";import"../chunks/AdminNavigationBar.js";import"../chunks/DataTableActions.js";import"../chunks/Checkbox.js";import"../chunks/HelpSection.js";function R(e){let t={};e.assign_department_option==="specific"&&(t.department_list=[e.department_list,"isRequired"]);const m=new A(w),{errors:i,isValid:a}=m.validate(t);return u.dispatch("setValidationError",i),{errors:i,isValid:a}}const F={name:"auto-assign",data(){return{status:0,only_login:0,assign_not_accept:0,assign_with_type:0,is_location:0,assign_department_option:"all",threshold:"",department_list:[],radioOptions:[{name:"yes",value:1},{name:"no",value:0}],deptOptions:[{name:"all",value:"all"},{name:"specific",value:"specific"}],loading:!0,hasDataPopulated:!1,pageLoad:!1,is_dept_mgr_auto_approve:1,is_team_lead_auto_approve:1}},beforeMount(){this.getValues()},methods:{getValues(){c.get("/api/get-auto-assign").then(e=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(e.data.data.autoAssign)}).catch(e=>{this.loading=!1,this.hasDataPopulated=!0})},updateStatesWithData(e){const t=this,m=this.$data;Object.keys(e).map(i=>{m.hasOwnProperty(i)&&(t[i]=i!="assign_department_option"&&i!="department_list"?parseInt(e[i]):e[i])}),this.threshold=this.threshold?this.threshold:""},onChange(e,t){this[t]=e,this.assign_department_option=="all"&&(this.department_list=[])},isValid(){const{errors:e,isValid:t}=R(this.$data);return t},onSubmit(){if(this.isValid()){this.pageLoad=!0;const e={};e.status=this.status,e.only_login=this.only_login,e.assign_not_accept=this.assign_not_accept,e.assign_with_type=this.assign_with_type,e.is_location=this.is_location,e.threshold=this.threshold,e.assign_department_option=this.assign_department_option,e.is_team_lead_auto_approve=this.is_team_lead_auto_approve,e.is_dept_mgr_auto_approve=this.is_dept_mgr_auto_approve,this.assign_department_option==="specific"&&(e.department_list=this.department_list.map(t=>t.id)),c.post("/api/auto-assign",e).then(t=>{this.pageLoad=!1,V(t,"AutoAssign"),this.getValues()}).catch(t=>{O(t,"AutoAssign"),this.pageLoad=!1})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}},components:{"radio-button":S,"number-field":D,"dynamic-select":L}},H={class:"col-sm-12"},I={class:"card card-light"},M={class:"card-header"},U={class:"card-title"},W={class:"card-body"},j={key:0,class:"row"},z={class:"row"},J={class:"row"},T={class:"row"},G={class:"row"},K={class:"row"},Q={class:"card-footer"},X={key:0,class:"row"};function Y(e,t,m,i,a,s){const h=r("alert"),v=r("reuse-loader"),l=r("radio-button"),b=r("number-field"),f=r("dynamic-select"),C=r("custom-loader");return p(),_("div",H,[n(h,{componentName:"AutoAssign"}),o("div",I,[o("div",M,[o("h3",U,g(e.trans("settings")),1)]),o("div",W,[a.loading||!a.hasDataPopulated?(p(),_("div",j,[n(v,{"animation-duration":4e3,size:60})])):d("",!0),a.hasDataPopulated?(p(),_(P,{key:1},[o("div",z,[n(l,{options:a.radioOptions,label:e.trans("enable"),name:"status",value:a.status,onChange:s.onChange,classname:"form-group col-sm-6 mb-3"},null,8,["options","label","value","onChange"]),n(l,{options:a.radioOptions,label:e.trans("only-login-agents"),name:"only_login",value:a.only_login,onChange:s.onChange,classname:"form-group col-sm-6 mb-3"},null,8,["options","label","value","onChange"])]),o("div",J,[n(l,{options:a.radioOptions,label:e.trans("assign-ticket-even-agent-in-non-acceptable-mode"),name:"assign_not_accept",value:a.assign_not_accept,onChange:s.onChange,classname:"form-group col-sm-6 mb-3"},null,8,["options","label","value","onChange"]),n(l,{options:a.radioOptions,label:e.trans("assign-ticket-with-agent-having-type"),name:"assign_with_type",value:a.assign_with_type,onChange:s.onChange,classname:"form-group col-sm-6 mb-3"},null,8,["options","label","value","onChange"])]),o("div",T,[n(l,{options:a.radioOptions,label:e.trans("auto_approve_dept_mgr"),name:"is_dept_mgr_auto_approve",value:a.is_dept_mgr_auto_approve,onChange:s.onChange,classname:"form-group col-sm-6 mb-3"},null,8,["options","label","value","onChange"]),n(l,{options:a.radioOptions,label:e.trans("auto_approve_team_lead_mgr"),name:"is_team_lead_auto_approve",value:a.is_team_lead_auto_approve,onChange:s.onChange,classname:"form-group col-sm-6 mb-3"},null,8,["options","label","value","onChange"])]),o("div",G,[n(l,{options:a.radioOptions,label:e.trans("assign-ticket-with-agent-having-location"),name:"is_location",value:a.is_location,onChange:s.onChange,classname:"form-group col-sm-6 mb-3"},null,8,["options","label","value","onChange"]),n(l,{options:a.deptOptions,label:e.trans("auto-assign-enabled-departments"),name:"assign_department_option",value:a.assign_department_option,onChange:s.onChange,classname:"form-group col-sm-6 mb-3"},null,8,["options","label","value","onChange"])]),o("div",K,[n(b,{label:e.trans("maximum-number-of-ticket-can-assign-to-agent"),value:a.threshold,name:"threshold",onChange:s.onChange,classname:"col-sm-6",type:"number",required:!1,keyupListener:s.triggerEvent,placeholder:"n"},null,8,["label","value","onChange","keyupListener"]),a.assign_department_option==="specific"?(p(),B(f,{key:0,label:e.trans("select-deparment"),multiple:!0,name:"department_list",classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",value:a.department_list,onChange:s.onChange,strlength:30,required:!0},null,8,["label","value","onChange"])):d("",!0)])],64)):d("",!0)]),o("div",Q,[o("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...y)=>s.onSubmit&&s.onSubmit(...y))},[t[1]||(t[1]=o("i",{class:"fas fa-sync"},null,-1)),E(" "+g(e.trans("update")),1)])])]),a.pageLoad?(p(),_("div",X,[n(C,{duration:4e3})])):d("",!0)])}const Z=k(F,[["render",Y]]);let x={path:"/auto-assign",component:q,name:"Auto Assign Setting",redirect:"/auto-assign/settings",children:[{path:"settings",component:Z,name:"AutoAssign Settings",meta:{title:"auto_assign",crumb:{link:{name:"admin_panel",to:"/"},active:"auto_assign"}}}]};N.addRoute(x);u.dispatch("deleteUser");u.dispatch("updateUser");
