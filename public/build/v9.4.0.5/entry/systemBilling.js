import{s as L,ad as j,a2 as S,_ as C,B as D,C as P,E as V,T as G,ag as H,ae as R,m as w,G as y,q as p,k as u,W as U,o,v as a,x as l,l as m,L as M,F as c,I as _,t as F,an as K,ah as E,aP as de,J as O,K as A,a1 as I,D as J,j as ce,af as z,X as B,aq as ue,Z as W,c as q,P as te,aQ as me,aR as pe,f as Z,V as he,Y,R as _e,aS as ge,O as Q}from"../chunks/bootstrap.js";import{r as be,A as $}from"../chunks/agentRouter.js";import{R as N}from"../chunks/vue-router.js";import{a as ae,b as ne}from"../chunks/DataTableActions.js";import{r as ye,A as se}from"../chunks/adminRouter.js";import{S as X,D as ie}from"../chunks/FormGenerator.js";import{b as fe,c as ve}from"../chunks/CurrencySelect.js";import{D as ke}from"../chunks/DataTableIsDefault.js";import"../chunks/HelpSection.js";import"../chunks/approvalTicketRules.js";import"../chunks/BarcodeModal.js";import"../chunks/Loader.js";import"../chunks/AdminNavigationBar.js";import"../chunks/Checkbox.js";import"../chunks/EleaTicketThreadSummary.js";import"../chunks/PermaLink.js";function we(e){let t={};e.packages&&(t.price=[e.packages.price,"isRequired"]);const s=new j(S),{errors:r,isValid:n}=s.validate(t);return L.dispatch("setValidationError",r),{errors:r,isValid:n}}function Ce(e){const{gateway:t,transaction_id:s,amount:r}=e;let n={gateway:[t,"isRequired"],transaction_id:[s,"isRequired"],amount:[r,"isRequired"]};const i=new j(S),{errors:h,isValid:d}=i.validate(n);return L.dispatch("setValidationError",h),{errors:h,isValid:d}}const De={name:"settings-modal",description:"Settings Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},title:{type:String,default:""},id:{type:[String,Number],default:""}},data:()=>({isDisabled:!1,containerStyle:{width:"600px"},loading:!1,size:60,status:0,transaction_id:"",amount:"",add_to_credit:!1,payment_gateway:[],gateway:"",comment:""}),methods:{isValid(){const{errors:e,isValid:t}=Ce(this.$data);return!!t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;let e={};e.method=this.gateway,e.transactionId=this.transaction_id,e.invoice=this.id,e.amount=parseInt(this.amount),e.comment=this.comment,D.post("/bill/package/add-payment",e).then(t=>{this.loading=!1,this.isDisabled=!1,P(t,"invoice"),window.emitter.emit("reloadInvoiceData"),this.onClose()}).catch(t=>{this.loading=!1,this.isDisabled=!1,V(t,"invoice"),this.onClose()})}}},components:{"text-field":G,"static-select":H,"number-field":R},beforeMount(){D.get("bill/get-gateways-list",{params:{active:1}}).then(e=>{e.data.data.data.forEach(t=>{this.payment_gateway.push({id:t.name,name:t.name})})}).catch(e=>{V(e,"invoice")})}},Me={class:"modal-title"},Se={key:0},Ve={class:"row"},Pe={key:1,class:"row"},Ie=["disabled"];function qe(e,t,s,r,n,i){const h=u("static-select"),d=u("text-field"),g=u("number-field"),f=u("reuse-loader"),v=u("modal"),b=U("focus-first-input");return s.showModal?(o(),w(v,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",Me,l(e.lang(s.title)),1)]),fields:y(()=>[e.loading?p("",!0):(o(),m("div",Se,[M((o(),m("div",Ve,[c(h,{label:e.lang("payment_gateway"),elements:e.payment_gateway,name:"gateway",value:e.gateway,classname:"col-sm-12",onChange:i.onChange,required:!0},null,8,["label","elements","value","onChange"]),c(d,{label:e.lang("transaction_id"),value:e.transaction_id,type:"text",name:"transaction_id",onChange:i.onChange,required:!0,classname:"col-sm-12"},null,8,["label","value","onChange"]),c(g,{label:e.lang("amount"),value:e.amount,name:"amount",classname:"col-sm-12",onChange:i.onChange,type:"number",required:!0},null,8,["label","value","onChange"]),c(d,{label:e.lang("comment"),value:e.comment,type:"textarea",name:"comment",onChange:i.onChange,required:!0,classname:"col-sm-12"},null,8,["label","value","onChange"])])),[[b]])])),e.loading?(o(),m("div",Pe,[c(f,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):p("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=k=>i.onSubmit()),class:"btn btn-primary",disabled:e.isDisabled},[t[1]||(t[1]=a("i",{class:"fas fa-sync","aria-hidden":"true"},null,-1)),_(" "+l(e.lang("ok")),1)],8,Ie)]),_:1},8,["showModal","onClose","containerStyle"])):p("",!0)}const Ue=C(De,[["render",qe],["__scopeId","data-v-1ad1485c"]]);const Te={name:"unpaid-modal",description:"Unpaid Modal component",props:{showModal:{type:Boolean,default:!1},title:{type:String,default:""},id:{type:[Number,String],default:""},onClose:{type:Function},refreshPage:{type:Function}},data:()=>({isDisabled:!1,containerStyle:{width:"500px"},loading:!1,size:60,lang_locale:""}),created(){this.lang_locale=localStorage.getItem("LANGUAGE")},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};e.invoice_id=this.id,e.amount_paid=0,axios.put("/invoice/update",e).then(t=>{this.loading=!1,this.isDisabled=!0,this.refreshPage(),this.onClose(),P(t,"invoice")}).catch(t=>{this.loading=!1,this.isDisabled=!0,V(t,"invoice")})}}},Fe={key:0},Oe={key:1,class:"row",slot:"fields"},Le=["disabled"];function Be(e,t,s,r,n,i){const h=u("reuse-loader"),d=u("modal");return o(),m("div",null,[s.showModal?(o(),w(d,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",null,l(e.lang(s.title)),1)]),fields:y(()=>[e.loading?p("",!0):(o(),m("div",Fe,[a("h5",{id:"H5",class:F({margin:e.lang_locale=="ar"})},l(e.lang("are_you_sure")),3)])),e.loading?(o(),m("div",Oe,[c(h,{"animation-duration":4e3,color:"#1d78ff",size:e.size,class:F({spin:e.lang_locale=="ar"})},null,8,["size","class"])])):p("",!0)]),controls:y(()=>[a("button",{type:"button",onClick:t[0]||(t[0]=(...g)=>i.onSubmit&&i.onSubmit(...g)),class:"btn btn-primary",disabled:e.isDisabled},[t[1]||(t[1]=a("i",{class:"fa fa-save"},null,-1)),_(" "+l(e.lang("proceed")),1)],8,Le)]),_:1},8,["showModal","onClose","containerStyle"])):p("",!0)])}const Ee=C(Te,[["render",Be]]);const Ae={name:"package-invoice",description:"Package invoice page",data(){return{hasDataPopulated:!1,loading:!1,loadingSpeed:4e3,company_name:"",from:{},to:{},invoice_id:0,order_id:0,paid_date:"",packages:{},transactions:[],total_amount:0,paid_amount:0,labelStyle:{display:"none"},showModal:!1,payable_amount:"",showUnpaidModal:!1,currency:null}},computed:{...K(["formattedTime","formattedDate","getUserData"])},beforeMount(){const e=window.location.pathname;this.invoiceId=E(e),this.getData()},created(){window.emitter.on("reloadInvoiceData",this.getData)},methods:{getData(){this.loading=!0,D.get("/bill/package/user-invoice-info/"+this.invoiceId).then(e=>{let t=e.data.data;this.company_name=t.company_name,this.from=t.from,this.to=t.order.user,this.invoice_id=t.invoice_id,this.order_id=t.order_id,this.paid_date=t.paid_date,this.payable_amount=t.payable_amount,this.packages=t.order.package,this.transactions=t.transactions,this.total_amount=t.payable_amount,this.paid_amount=t.amount_paid,this.hasDataPopulated=!0,this.currency=t.currency,this.loading=!1}).catch(e=>{V(e),this.hasDataPopulated=!0,this.loading=!1})},isValid(){const{errors:e,isValid:t}=we(this.$data);return!!t},onClose(){this.showModal=!1,this.showUnpaidModal=!1,this.$store.dispatch("unsetValidationError")},refreshPage(){this.getData()},onChange(e,t){this.payable_amount=e},printInvoice(e){var t=document.getElementById(e).innerHTML,s=window.open("","","width=auto,height=auto");s.document.write("<html><head><title></title></head><body>"+t+"</body>"),s.document.close(),s.focus(),s.print(),setTimeout(function(){s.close()},5)},sendMail(){this.loading=!0,D.get("/invoice/send/"+this.invoice_id).then(e=>{this.loading=!1,P(e,"invoice")}).catch(e=>{V(e,"invoice"),this.loading=!1})},onSubmit(){this.isValid()&&(this.showModal=!0)},onUpdate(){if(this.isValid()){this.loading=!0;const e={};e.invoice_id=this.invoice_id,e.payable_amount=this.payable_amount,D.put("/invoice/update",e).then(t=>{this.loading=!1,this.refreshPage(),P(t,"invoice")}).catch(t=>{this.loading=!1,V(t,"invoice")})}},getFormattedCurrency(e,t){return de(e,t,localStorage.getItem("LANGUAGE"))},generatePDF(){D.get("/invoice/pdf/"+this.invoice_id).then(e=>{e&&this.redirect("/invoice/pdf/"+this.invoice_id)}).catch(e=>{V(e,"invoice")})}},components:{"number-field":R,"invoice-modal":Ue,"unpaid-modal":Ee}},Ne={class:"col-sm-12"},Re={key:0,class:"row"},ze={key:1,class:"invoice"},Ye={class:"invoice p-3 mb-3"},je={class:"row"},He={class:"col-12"},We={class:"dropdown float-end"},xe={class:"dropdown-menu dropdown-menu-right"},Ge={id:"print-invoice",class:"row invoice-info"},Ke={class:"col-sm-4 invoice-col"},Je={key:1},Qe={class:"col-sm-4 invoice-col"},Xe={class:"col-sm-4 invoice-col"},Ze={class:"card card-light"},$e={class:"card-header"},et={class:"card-title"},tt={class:"card-body"},at={class:"table-responsive"},nt={class:"table table-striped"},st={id:"product_price"},it={class:"card card-light"},lt={class:"card-header"},ot={class:"card-title"},rt={class:"card-body"},dt={class:"table-responsive"},ct={class:"table table-striped"},ut={id:"status"},mt={class:"card card-light"},pt={class:"card-header"},ht={class:"card-title"},_t={class:"card-body"},gt={class:"table-responsive"},bt={class:"table"},yt={style:{width:"50%"}},ft={style:{width:"50%"}},vt={class:"card-footer"};function kt(e,t,s,r,n,i){const h=u("custom-loader"),d=u("alert"),g=u("number-field"),f=u("router-link"),v=u("invoice-modal"),b=u("unpaid-modal");return o(),m("div",Ne,[n.hasDataPopulated===!1||n.loading===!0?(o(),m("div",Re,[c(h,{duration:n.loadingSpeed},null,8,["duration"])])):p("",!0),c(d,{componentName:"invoice"}),n.hasDataPopulated===!0?(o(),m("section",ze,[a("div",Ye,[a("div",je,[a("div",He,[a("h4",null,[t[12]||(t[12]=a("i",{class:"fas fa-globe"},null,-1)),_(" "+l(n.company_name)+" ",1),a("div",We,[t[11]||(t[11]=a("button",{class:"btn btn-light dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},[a("i",{class:"fas fa-bars"})],-1)),a("div",xe,[n.total_amount-n.paid_amount>0?(o(),m("a",{key:0,id:"pay",href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=k=>i.onSubmit())},[t[6]||(t[6]=a("i",{class:"fas fa-credit-card"},null,-1)),_(" "+l(e.lang("add_payment")),1)])):p("",!0),n.payable_amount-n.paid_amount<=0?(o(),m("a",{key:1,id:"unpaid",onClick:t[1]||(t[1]=k=>n.showUnpaidModal=!0),href:"javascript:;",class:"dropdown-item"},[t[7]||(t[7]=a("i",{class:"fas fa-thumbs-down"},null,-1)),_(" "+l(e.lang("mark_as_unpaid")),1)])):p("",!0),a("a",{id:"print",class:"dropdown-item",onClick:t[2]||(t[2]=k=>i.printInvoice("print-invoice"))},[t[8]||(t[8]=a("i",{class:"fas fa-print"},null,-1)),_(" "+l(e.lang("print")),1)]),a("a",{id:"pdf",href:"javascript:;",onClick:t[3]||(t[3]=k=>i.generatePDF()),class:"dropdown-item"},[t[9]||(t[9]=a("i",{class:"fas fa-download"},null,-1)),_(" "+l(e.lang("generate_pdf")),1)]),a("a",{id:"mail",onClick:t[4]||(t[4]=k=>i.sendMail()),class:"dropdown-item"},[t[10]||(t[10]=a("i",{class:"fas fa-reply"},null,-1)),_(" "+l(e.lang("send_mail")),1)])])])])])]),a("div",Ge,[a("div",Ke,[_(l(e.lang("from"))+" ",1),a("address",null,[a("strong",null,l(n.from.name),1),t[13]||(t[13]=a("br",null,null,-1)),n.from.address?(o(),m(O,{key:0},[],64)):p("",!0),n.from.address?(o(),m("br",Je)):p("",!0),_(" "+l(e.lang("phone"))+": "+l((n.from.phone_country_code?" +"+n.from.phone_country_code:"")+(n.from.phone?" "+n.from.phone:e.lang("not_mentioned"))+(n.from.ext?"-"+n.from.ext:""))+" ",1),t[14]||(t[14]=a("br",null,null,-1)),_(" "+l(e.lang("website"))+": "+l(n.from.website),1)])]),a("div",Qe,[_(l(e.lang("to"))+" ",1),a("address",null,[a("strong",null,l(n.to.first_name)+l(n.to.last_name),1),t[15]||(t[15]=a("br",null,null,-1)),_(" "+l(e.lang("phone"))+": "+l(n.to.phone_country_code?"+"+n.to.phone_country_code:"")+" "+l(n.to.phone_number?n.to.phone_number:e.lang("not_mentioned"))+" "+l(n.to.ext?"-"+n.to.ext:"")+" ",1),t[16]||(t[16]=a("br",null,null,-1)),_(" "+l(e.lang("email"))+": "+l(n.to.email),1)])]),a("div",Xe,[a("b",null,l(e.lang("invoice_details")),1),t[17]||(t[17]=a("br",null,null,-1)),a("b",null,l(e.lang("invoice"))+":",1),_(" #"+l(n.invoice_id),1),t[18]||(t[18]=a("br",null,null,-1)),a("b",null,l(e.lang("order_id"))+":",1),_(" "+l(n.order_id),1),t[19]||(t[19]=a("br",null,null,-1)),a("b",null,l(e.lang("paid_on"))+":",1),_(" "+l(e.formattedTime(n.paid_date)),1)])]),a("div",Ze,[a("div",$e,[a("h3",et,l(e.lang("product")),1)]),a("div",tt,[a("div",at,[a("table",nt,[a("thead",null,[a("tr",null,[a("th",null,l(e.lang("name")),1),a("th",null,l(e.lang("description")),1),a("th",null,l(e.lang("validity")),1),a("th",null,l(e.lang("price")),1)])]),a("tbody",null,[a("tr",null,[a("td",null,l(n.packages.name),1),a("td",null,l(n.packages.description),1),a("td",null,l(n.packages.validity===null?"One time":n.packages.validity),1),a("td",st,[c(g,{label:e.lang("price"),value:n.payable_amount,name:"payable_amount",classname:"",labelStyle:n.labelStyle,onChange:i.onChange,type:"number",required:!0},null,8,["label","value","labelStyle","onChange"])])])])])])])]),a("div",it,[a("div",lt,[a("h3",ot,l(e.lang("transactions")),1)]),a("div",rt,[a("div",dt,[a("table",ct,[a("thead",null,[a("tr",null,[a("th",null,l(e.lang("id")),1),a("th",null,l(e.lang("payment_method")),1),a("th",null,l(e.lang("amount_paid")),1),a("th",null,l(e.lang("transacted_by")),1),a("th",null,l(e.lang("pay_date")),1),a("th",null,l(e.lang("status")),1)])]),a("tbody",null,[(o(!0),m(O,null,A(n.transactions,k=>(o(),m("tr",null,[a("td",null,l(k.transactionId),1),a("td",null,l(k.payment_method),1),a("td",null,l(k.amount_paid),1),a("td",null,[c(f,{to:"/user/"+k.paid_by.id},{default:y(()=>[_(l(k.paid_by.full_name),1)]),_:2},1032,["to"])]),a("td",null,l(e.formattedTime(k.created_at)),1),a("td",null,[a("a",ut,[a("span",{title:"Status",class:F({"btn btn-success btn-sm":k.status!==0,"btn btn-danger btn-sm":k.status===0}),id:"edit_btn"},l(k.status?e.lang("successful"):e.lang("fail")),3)])])]))),256))])])])])]),a("div",mt,[a("div",pt,[a("h3",ht,l(e.lang("payment_details"))+" "+l(e.formattedTime(n.paid_date)),1)]),a("div",_t,[a("div",gt,[a("table",bt,[a("tbody",null,[a("tr",null,[a("th",yt,l(e.lang("paid_amount"))+" : ",1),a("td",null,l(i.getFormattedCurrency(n.paid_amount,n.currency)),1)]),a("tr",null,[a("th",ft,l(e.lang("balance"))+" : ",1),a("td",null,l(i.getFormattedCurrency(n.paid_amount-n.total_amount,n.currency)),1)]),a("tr",null,[t[20]||(t[20]=a("th",null,"Total:",-1)),a("td",null,l(i.getFormattedCurrency(n.total_amount,n.currency)),1)])])])])]),a("div",vt,[a("button",{type:"button",id:"update_btn",class:"btn btn-primary",onClick:t[5]||(t[5]=k=>i.onUpdate())},[t[21]||(t[21]=a("i",{class:"fas fa-sync"},null,-1)),_(" "+l(e.lang("update")),1)])])])])])):p("",!0),c(I,{name:"modal"},{default:y(()=>[n.showModal?(o(),w(v,{key:0,title:"add_payment",onClose:i.onClose,showModal:n.showModal,id:n.invoice_id},null,8,["onClose","showModal","id"])):p("",!0)]),_:1}),c(I,{name:"modal"},{default:y(()=>[n.showUnpaidModal?(o(),w(b,{key:0,title:"Mark as Unpaid",onClose:i.onClose,refreshPage:i.refreshPage,showModal:n.showUnpaidModal,id:n.invoice_id},null,8,["onClose","refreshPage","showModal","id"])):p("",!0)]),_:1})])}const wt=C(Ae,[["render",kt],["__scopeId","data-v-6ae7f40c"]]);const Ct={name:"invoices-filter",description:"",components:{"dynamic-select":J,"static-select":H,"number-field":R,"date-time-field":ce},props:{apiChange:{type:Function},hideFilter:{type:Function},data:{type:[String,Object],default:""}},data(){return{created_date:"",due_date:"",amount_paid:"",payable_amount:"",statuses:[{id:"paid",name:"Paid",queryPerm:"status=1"},{id:"unpaid",name:"Unpaid",queryPerm:"status=0"}],status:"",modes:[{id:"online",name:"Online",queryPerm:"payment_mode[0]=online"},{id:"cash",name:"Cash",queryPerm:"payment_mode[1]=cash"},{id:"bank_transfer",name:"Bank transfer",queryPerm:"payment_mode[2]=bank_transfer"},{id:"marked_paid_by_agent",name:"Marked paid by agent",queryPerm:"payment_mode[3]=marked_paid_by_agent"}],payment_mode:[],users:[],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},loading:!1,filterApplied:!1}},beforeMount(){if(window.location.search.substring(1)==="status=0"&&(this.status="unpaid",this.apiChange(this.$data)),this.data){const e=this,t=this.$data;Object.keys(this.data).map(s=>{t.hasOwnProperty(s)&&(e[s]=this.data[s])})}},methods:{resetData(){this.filterApplied=!1,this.created_date="",this.due_date="",this.amount_paid="",this.payable_amount="",this.status="",this.payment_mode=[],this.users=[],setTimeout(()=>{this.loading=!1},1e3)},onChange(e,t){this[t]=e},onCancel(){this.hideFilter(this.$data),this.filterApplied?this.apiChange(this.$data):this.resetData()},onApply(){this.filterApplied=!0,this.apiChange(this.$data)},onReset(){this.loading=!0,this.resetData(),this.apiChange(this.$data)}}},Dt={class:"card card-light"},Mt={class:"card-header"},St={class:"card-title"},Vt={class:"card-body"},Pt={key:0,class:"row",style:{"margin-top":"80px","margin-bottom":"94px"}},It={key:1,class:"row",id:"invoice_filter"},qt={key:2,class:"row"},Ut={key:0,class:"card-footer"},Tt={class:"single-btn"},Ft={class:"single-btn"},Ot={class:"single-btn"};function Lt(e,t,s,r,n,i){const h=u("date-time-field"),d=u("number-field"),g=u("static-select"),f=u("dynamic-select");return o(),m("div",Dt,[a("div",Mt,[a("h3",St,l(e.lang("filter")),1)]),a("div",Vt,[n.loading?(o(),m("div",Pt,t[3]||(t[3]=[a("h3",{class:"text-center"},"Loading filters...",-1)]))):p("",!0),n.loading?p("",!0):(o(),m("div",It,[c(h,{label:e.lang("created_date"),value:n.created_date,type:"datetime",name:"created_date",onChange:i.onChange,range:"",required:!1,format:"YYYY-MM-DD HH:mm:ss",classname:"col-sm-4",clearable:!0,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":n.timeOptions},null,8,["label","value","onChange","time-picker-options"]),c(h,{label:e.lang("due_date"),value:n.due_date,type:"datetime",name:"due_date",onChange:i.onChange,range:"",required:!1,format:"YYYY-MM-DD HH:mm:ss",classname:"col-sm-4",clearable:!0,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":n.timeOptions},null,8,["label","value","onChange","time-picker-options"]),c(d,{label:e.lang("amount_paid"),value:n.amount_paid,name:"amount_paid",classname:"col-sm-2",onChange:i.onChange,type:"number"},null,8,["label","value","onChange"]),c(d,{label:e.lang("payable_amount"),value:n.payable_amount,name:"payable_amount",classname:"col-sm-2",onChange:i.onChange,type:"number"},null,8,["label","value","onChange"])])),n.loading?p("",!0):(o(),m("div",qt,[c(g,{label:e.lang("status"),elements:n.statuses,name:"status",value:n.status,classname:"col-sm-4 invoice_select",onChange:i.onChange,required:!1},null,8,["label","elements","value","onChange"]),c(f,{name:"payment_mode",classname:"col-sm-4",elements:n.modes,multiple:!0,prePopulate:!1,label:e.lang("payment_mode"),value:n.payment_mode,onChange:i.onChange},null,8,["elements","label","value","onChange"]),c(f,{name:"users",apiEndpoint:"api/dependency/users?meta=true",classname:"col-sm-4",multiple:!0,prePopulate:!0,label:e.lang("users"),value:n.users,onChange:i.onChange},null,8,["label","value","onChange"])]))]),n.loading?p("",!0):(o(),m("div",Ut,[a("span",Tt,[a("button",{id:"apply-btn",class:"btn btn-primary round-btn",type:"button",onClick:t[0]||(t[0]=(...v)=>i.onApply&&i.onApply(...v))},[t[4]||(t[4]=a("span",{class:"fas fa-check"},null,-1)),_("  "+l(e.lang("apply")),1)])]),a("span",Ft,[a("button",{id:"apply-btn",class:"btn btn-primary single-btn round-btn",type:"button",onClick:t[1]||(t[1]=(...v)=>i.onReset&&i.onReset(...v))},[t[5]||(t[5]=a("span",{class:"fas fa-undo"},null,-1)),_("  "+l(e.lang("reset")),1)])]),a("span",Ot,[a("button",{id:"apply-btn",class:"btn btn-danger single-btn round-btn",type:"button",onClick:t[2]||(t[2]=(...v)=>i.onCancel&&i.onCancel(...v))},[t[6]||(t[6]=a("span",{class:"fas fa-times"},null,-1)),_("  "+l(e.lang("cancel")),1)])])]))])}const Bt=C(Ct,[["render",Lt]]),Et={name:"pacakges",description:"Pacakges data table component",props:{},data(){return{base:window.axios.defaults.baseURL,columns:["id","name","user","payment_mode","total_amount","payable_amount","amount_paid","due_by","status","action"],options:{},apiUrl:"",selectedData:[],showModal:!1,deleteUrl:"",isShowFilter:!1,hideData:"",show:!1,filterStyle:{}}},computed:{...K(["formattedTime","formattedDate"])},watch:{},beforeMount(){const e=this;this.options={headings:{id:this.trans("id"),name:this.trans("invoice_id"),user:this.trans("user"),payment_mode:this.trans("payment_mode"),total_amount:this.trans("total_amount"),payable_amount:this.trans("payable_amount"),amount_paid:this.trans("amount_paid"),due_by:this.trans("due_by"),status:this.trans("status"),action:this.trans("action")},texts:{filter:"",limit:""},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},templates:{name:function(t,s){return e.h(N,{to:"/bill/package/"+s.id+"/user-invoice"},"#"+s.id)},due_by(t,s){return e.formattedTime(s.due_by)},payment_mode(t,s){return S(s.payment_mode)},status:function(t,s){let r=e.h("span",{class:s.order.status===1?"btn btn-success btn-sm":"btn btn-danger btn-sm"},s.order.status===1?this.lang("paid"):this.lang("unpaid"));return e.h("a",{},[r])},user:function(t,s){return e.h(N,{to:"/user/"+s.order.user.id},s.order.user.full_name)},action:(t,s)=>e.h(ae,{data:s})},sortable:["name","payment_mode","total_amount","payable_amount","amount_paid","due_by","user","status"],filterable:["name","validity","allowed_tickets","price","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(r=>(r.delete_url=`bill/delete-user-invoice?invoice_ids=${r.id}`,r.alertComponentName="dataTableModal",r)),count:t.data.total}},orderBy:{column:"id",ascending:!0}}},methods:{packages(e){this.selectedData=e},deletePackage(){this.deleteUrl="bill/delete-user-invoice?invoice_ids="+this.selectedData,this.showModal=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")},toggleFilterView(){this.isShowFilter=!this.isShowFilter,this.show=!this.show,this.show?this.filterStyle={display:"block"}:this.filterStyle={display:"none"}},hideFilter(e){this.isShowFilter=!1,this.show=!1,this.hideData=e},apiChange(e){let t="/bill/package/get-user-invoice?meta="+!0+"&all-users=1&",s="";if(e.status){let r=e.status==="unpaid"?0:1;s+="status="+r+"&"}if(e.payable_amount&&(s+="payable_amount="+e.payable_amount+"&"),e.payment_mode&&e.payment_mode.forEach(function(r,n){s+="payment_mode["+n+"]="+r.id+"&"}),e.users&&e.users.length>0&&(t="/bill/package/get-user-invoice?meta="+!0+"&",e.users.forEach(function(r,n){s+="users["+n+"]="+r.id+"&"})),e.amount_paid&&(s+="amount_paid="+e.amount_paid+"&"),e.created_date){let r=e.created_date,n=r[0]!==null?z(r[0]).format("YYYY-MM-DD+HH:mm:ss"):"",i=r[1]!==null?z(r[1]).format("YYYY-MM-DD+HH:mm:ss"):"";s+="created_at_start="+n+"&created_at_end="+i+"&"}if(e.due_date){let r=e.due_date,n=r[0]!==null?z(r[0]).format("YYYY-MM-DD+HH:mm:ss"):"",i=r[1]!==null?z(r[1]).format("YYYY-MM-DD+HH:mm:ss"):"";s+="due_by_start="+n+"&due_by_end="+i+"&"}s[s.length-1]==="&"&&(s=s.slice(0,-1)),this.apiUrl=t+s}},components:{"delete-modal":ne,"invoices-filter":Bt}},At={class:"col-sm-12"},Nt={class:"card card-light"},Rt={class:"card-header"},zt={class:"card-title",id:"pack-title"},Yt={class:"card-tools"},jt={class:"card-body"};function Ht(e,t,s,r,n,i){const h=u("alert"),d=u("invoices-filter"),g=u("data-table"),f=u("delete-modal"),v=U("tooltip");return o(),m("div",At,[c(h,{componentName:"dataTableModal"}),a("div",Nt,[a("div",Rt,[a("h3",zt,l(e.lang("invoice_list")),1),a("div",Yt,[a("a",{id:"advance-filter-btn",class:"btn btn-tool",onClick:t[0]||(t[0]=(...b)=>i.toggleFilterView&&i.toggleFilterView(...b))},t[2]||(t[2]=[a("i",{class:"glyphicon glyphicon-filter"},null,-1)])),n.selectedData.length>1?M((o(),m("a",{key:0,class:"btn btn-tool",onClick:t[1]||(t[1]=b=>i.deletePackage())},t[3]||(t[3]=[a("span",{class:"fas fa-trash"},null,-1)]))),[[v,e.lang("delete-invoices")]]):p("",!0)])]),a("div",jt,[a("div",{style:B(n.filterStyle)},[M(c(d,{id:"filter-box",apiChange:i.apiChange,hideFilter:i.hideFilter,data:n.hideData},null,8,["apiChange","hideFilter","data"]),[[ue,n.isShowFilter]])],4),n.apiUrl?(o(),w(g,{key:0,url:n.apiUrl,dataColumns:n.columns,option:n.options,scroll_to:"pack-title",tickets:i.packages},null,8,["url","dataColumns","option","tickets"])):p("",!0)]),c(I,{name:"modal"},{default:y(()=>[n.showModal?(o(),w(f,{key:0,onClose:i.onClose,showModal:n.showModal,deleteUrl:n.deleteUrl},null,8,["onClose","showModal","deleteUrl"])):p("",!0)]),_:1})])])}const Wt=C(Et,[["render",Ht]]);const xt={name:"order-details",description:"Order details component",data:()=>({loading:!1,size:60,order_id:0,orderData:{}}),computed:{...K(["formattedTime"])},beforeMount(){const e=window.location.pathname;this.order_id=E(e),this.getData()},methods:{getData(){this.loading=!0,D.get("/bill/package/user-order-info/"+this.order_id).then(e=>{this.loading=!1,this.orderData=e.data.data}).catch(e=>{this.loading=!1})}}},Gt={class:"col-sm-12"},Kt={class:"card card-light"},Jt={class:"card-header"},Qt={class:"card-title"},Xt={class:"card-body"},Zt={key:0,slot:"fields"},$t={class:"callout",style:{"background-color":"rgb(0, 191, 239)",color:"rgb(249, 249, 249)"}},ea={class:"row"},ta={class:"col-md-3"},aa={class:"col-md-3"},na={class:"col-md-3"},sa={class:"col-md-3"},ia={class:"row"},la={class:"col-md-12"},oa={class:"invoice_box box-solid"},ra={class:"box-body"},da={class:"table table-striped"},ca={key:0,class:"row",slot:"fields"};function ua(e,t,s,r,n,i){const h=u("reuse-loader");return o(),m("div",Gt,[a("div",Kt,[a("div",Jt,[a("h3",Qt,l(e.lang("order")),1)]),a("div",Xt,[e.loading?p("",!0):(o(),m("div",Zt,[a("div",$t,[a("div",ea,[a("div",ta,[a("b",null,l(e.lang("package"))+" : ",1),_(" "+l(e.orderData.package.name),1)]),a("div",aa,[a("b",null,l(e.lang("credit_type"))+" : ",1),_(" "+l(e.orderData.credit_type),1)]),a("div",na,[a("b",null,l(e.lang("credit_left"))+" : ",1),_(" "+l(e.orderData.credit),1)]),a("div",sa,[a("b",null,l(e.lang("expiry_date"))+": ",1),_(" "+l(e.formattedTime(e.orderData.expiry_date)),1)])])]),a("div",ia,[a("div",la,[a("div",oa,[a("div",ra,[a("table",da,[a("thead",null,[a("tr",null,[a("th",null,l(e.lang("title")),1),a("th",null,l(e.lang("ticket_no")),1),a("th",null,l(e.lang("created_at")),1),a("th",null,l(e.lang("updated_at")),1)])]),a("tbody",null,[(o(!0),m(O,null,A(e.orderData.order_tickets,d=>(o(),m("tr",null,[a("td",null,l(d.ticket.first_thread.title),1),a("td",null,l("#"+d.ticket.ticket_number),1),a("td",null,l(e.formattedTime(d.ticket.created_at)),1),a("td",null,l(e.formattedTime(d.ticket.updated_at)),1)]))),256))])])])])])])]))]),e.loading?(o(),m("div",ca,[c(h,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):p("",!0)])])}const ma=C(xt,[["render",ua],["__scopeId","data-v-40cf76bd"]]);const pa={name:"billing-packages-table",description:"Billing packages table page",setup(){const e=W();return{formattedTime:q(()=>e.getters.formattedTime),formattedDate:q(()=>e.getters.formattedDate)}},props:{category:{type:String,default:""},columnArray:{type:[Array,String],default:""},apiEndpoint:{type:String,default:""},optionsObj:{type:[Object,String],default:""},disableLoader:{type:Boolean,default:!1}},data(){return{base:window.axios.defaults.baseURL,columns:this.columnArray,options:{},apiUrl:this.apiEndpoint}},watch:{optionsObj(e,t){return this.updateTable(),e}},beforeMount(){this.updateTable()},methods:{updateTable(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:e.optionsObj.headings,texts:{filter:"",limit:""},templates:e.optionsObj.templates,sortable:e.optionsObj.sortable,filterable:e.optionsObj.filterable,pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}},orderBy:{column:"id",ascending:!0}}},handelLoader(e){this.$emit("loaderValue",e)}}};function ha(e,t,s,r,n,i){const h=u("data-table");return o(),w(h,{url:s.apiEndpoint,dataColumns:s.columnArray,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:n.options,scroll_to:"packages_title"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])}const _a=C(pa,[["render",ha]]);const ga={name:"settings-modal",description:"Settings Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},title:{type:String,default:""},id:{type:[String,Number],default:""},userId:{type:String,default:0}},data:()=>({containerStyle:{width:"800px"},loading:!1,size:60,status:0,packages:[],packageId:0,submitDisabled:!0,checked:!1}),beforeMount(){this.getData()},methods:{getData(){this.loading=!0,D.get("bill/package/get-active-packages").then(e=>{this.loading=!1,this.packages=e.data.data.data}).catch(e=>{this.submitDisabled=!0,this.loading=!1,V(e,"add-invoice")})},createInvoice(){let e=this.checked?1:0,t="?package_id="+this.packageId+"&user_id="+this.userId;window.location.pathname.includes("organizations")&&(t="?package_id="+this.packageId+"&organization_id="+this.userId+"&user_id="+this.userId),this.loading=!0,D.get("bill/package/user-checkout"+t+"&meta="+e).then(s=>{this.loading=!1,P(s,"add-invoice"),window.emitter.emit("refreshData"),setTimeout(()=>{this.onClose()},1500)}).catch(s=>{this.submitDisabled=!0,V(s,"add-invoice"),this.loading=!1})},usePackage(e,t){this.submitDisabled=e=="",this.packageId=e}},components:{"static-select":H}},ba={class:"modal-title"},ya={key:0,class:"row"},fa={key:1},va={class:"row"},ka={class:"row"},wa={class:"form-group col-md-12",id:"align"},Ca={class:"label_align"},Da=["disabled"];function Ma(e,t,s,r,n,i){const h=u("alert"),d=u("reuse-loader"),g=u("static-select"),f=u("modal");return s.showModal?(o(),w(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",ba,l(e.lang(s.title))+l(s.id),1)]),alert:y(()=>[c(h,{componentName:"add-invoice"})]),fields:y(()=>[e.loading?(o(),m("div",ya,[c(d,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):p("",!0),e.loading?p("",!0):(o(),m("div",fa,[a("div",va,[c(g,{label:e.lang("select_package"),elements:e.packages,name:"package",value:s.id,classname:"col-sm-12",onChange:i.usePackage,required:!0},null,8,["label","elements","value","onChange"])]),a("div",ka,[a("div",wa,[a("label",Ca,[M(a("input",{class:"checkbox_align",type:"checkbox",name:"meta","onUpdate:modelValue":t[0]||(t[0]=v=>e.checked=v)},null,512),[[te,e.checked]]),_(" "+l(e.lang("send_invoice_to_client")),1)])])])]))]),controls:y(()=>[a("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=v=>i.createInvoice()),disabled:e.submitDisabled},[t[2]||(t[2]=a("i",{class:"fas fa-save"},null,-1)),_(" "+l(e.lang("create")),1)],8,Da)]),_:1},8,["showModal","onClose","containerStyle"])):p("",!0)}const le=C(ga,[["render",Ma],["__scopeId","data-v-b13892b5"]]);const Sa={name:"orders-table",description:"Orders table page",setup(){const e=W();return{formattedTime:q(()=>e.getters.formattedTime),formattedDate:q(()=>e.getters.formattedDate)}},props:{category:{type:String,default:""},apiEndpoint:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{base:window.axios.defaults.baseURL,options:{},apiUrl:this.apiEndpoint,columns:["name","invoice","credit_type","credit","total_amount","period_expiry_date","expiry_date"],orderIds:[],order_id:0,showModal:!1}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},columnsClasses:{invoice:"order-invoice",credit_type:"order-type",credit:"order-credit",total_amount:"order-amount",period_expiry_date:S("period_expiry_date"),name:"order-name",expiry_date:"order-date"},texts:{filter:"",limit:""},templates:{invoice:function(t,s){return e.h(N,{to:"/bill/package/"+s.id+"/user-invoice"},"#"+s.id)},credit_type(t,s){return s.credit_type},credit(t,s){return s.credit},name(t,s){return e.h(N,{to:"/bill/order/"+s.id},s.package.name)},expiry_date(t,s){let r=new Date,n=e.formattedTime(s.expiry_date),i;return r>n?i=e.h("span",{class:"text-danger"},e.formattedTime(s.expiry_date)):i=e.h("span",{class:"text-green"},e.formattedTime(s.expiry_date)),i},total_amount(t,s){return s.invoice.total_amount},period_expiry_date(t,s){return s.period_expiry_date?e.formattedTime(s.period_expiry_date):"---"}},sortable:["credit_type","credit","total_amount","expiry_date","status"],filterable:["credit_type","credit","total_amount","expiry_date","status"],pagination:{chunk:5,nav:"scroll"},headings:{name:this.trans("package_name"),invoice:this.trans("invoice"),credit_type:this.trans("credit_type"),credit:this.trans("credit"),total_amount:this.trans("total_amount"),period_expiry_date:this.trans("period_expiry_date"),expiry_date:this.trans("expiry_date")},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}},orderBy:{column:"id",ascending:!0}}},methods:{orderData(e){this.orderIds=e},onClick(e){this.order_id=e.id,this.showModal=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")},deleteInvoices(){prompt("Are you sure to delete this","yes ")},handelLoader(e){this.$emit("loaderValue",e)}},components:{"orders-modal":le}},Va={class:"order-pack"};function Pa(e,t,s,r,n,i){const h=u("data-table"),d=u("orders-modal");return o(),m("div",Va,[c(h,{url:s.apiEndpoint,dataColumns:n.columns,option:n.options,scroll_to:"packages_title",tickets:i.orderData,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","tickets","onLoaderState","disableLoader"]),c(I,{name:"modal"},{default:y(()=>[n.showModal?(o(),w(d,{key:0,title:"order_details",onClose:i.onClose,showModal:n.showModal,id:n.order_id},null,8,["onClose","showModal","id"])):p("",!0)]),_:1})])}const Ia=C(Sa,[["render",Pa]]);const qa={name:"invoices-table",description:"Invoices table page",setup(){const e=W();return{formattedTime:q(()=>e.getters.formattedTime),formattedDate:q(()=>e.getters.formattedDate)}},props:{category:{type:String,default:""},apiEndpoint:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{base:window.axios.defaults.baseURL,options:{},apiUrl:this.apiEndpoint,columns:["name","created_at","due_by","total_amount","payment_mode","status"],orderIds:[]}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:S("name"),created_at:S("created_at"),total_amount:S("total_amount"),status:S("status"),payment_mode:S("payment_mode"),due_by:S("due_by")},columnsClasses:{name:"invoice-name",created_at:"order-create",due_by:"order-due",total_amount:"order-amount",status:"order-status"},texts:{filter:"",limit:""},templates:{status:function(t,s){let r=e.h("span",{class:s.order.status===1?"btn btn-success btn-sm":"btn btn-danger btn-sm"},s.order.status===1?"Paid":"Unpaid");return e.h("a",{},[r])},created_at(t,s){return e.formattedTime(s.created_at)},due_by(t,s){return e.formattedTime(s.due_by)},payment_mode(t,s){return S(s.payment_mode)},name:function(t,s){return e.h(N,{to:"/bill/package/"+s.id+"/user-invoice"},"#"+s.name)}},sortable:["name","created_at","due_by","total_amount","payment_mode","status"],filterable:["name","created_at","due_by","total_amount","payment_mode"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}},orderBy:{column:"id",ascending:!0}}},methods:{orderData(e){this.orderIds=e},deleteOrders(){prompt("Are you sure to delete this","yes")},handelLoader(e){this.$emit("loaderValue",e)}}},Ua={class:"invoice-pack"};function Ta(e,t,s,r,n,i){const h=u("data-table");return o(),m("div",Ua,[c(h,{url:s.apiEndpoint,dataColumns:n.columns,option:n.options,scroll_to:"packages_title",tickets:i.orderData,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","tickets","onLoaderState","disableLoader"])])}const Fa=C(qa,[["render",Ta]]);const Oa={name:"billing-packages",description:"Billing packages datatable",props:{data:{type:[String,Object]},id:{type:[String,Number],default:""},ids:{type:[String,Number],default:""}},data(){return{pathName:"",category:"orders",tabs:[],user_id:"",org_id:"",loading:!0,apiUrl:"",showModal:!1,cardOpen:!1,loaderState:""}},beforeMount(){this.loaderState=JSON.parse(this.data).disableLoader},watch:{category(e,t){return e}},computed:{currentTableComponent(){return this.category==="orders"?"orders-table":"invoices-table"}},methods:{toggleCard(){if(this.cardOpen=!this.cardOpen,this.cardOpen){const e=window.location.pathname;this.pathNameArray=e.split("/"),this.pathName=this.pathNameArray.includes("organizations")?"organizations":"user",this.user_id=E(e),this.org_id=E(e),this.getCount(),this.getTableData(this.category)}},getTableData(e){this.pathName==="user"?this.apiUrl=e==="orders"?"/bill/package/get-user-packages?user_id="+this.user_id:"/bill/package/get-user-invoice?users[0]="+this.user_id:this.pathName==="organizations"&&(this.apiUrl=e==="orders"?"/bill/package/get-organization-packages/"+this.org_id:"/bill/package/get-organization-invoice/"+this.org_id)},packages(e){this.category=e,this.getCount(),this.getTableData(e)},getCount(){let e=this.pathName==="organizations"?this.org_id:this.user_id;D.get("/bill/package/get-all-count/"+e+"?category="+this.pathName).then(t=>{this.tabs=[{category:"orders",title:"orders",b_class:"badge bg-orange",count:t.data.data.userpackage},{category:"invoice",title:"invoice",b_class:"badge bg-red",count:t.data.data.invoice}]}).catch(t=>{this.tabs=[]})},onClose(){this.showModal=!1,this.packages("invoice"),this.$store.dispatch("unsetAlert")},addInvoice(){this.showModal=!0},handelLoader(e){this.loading=e}},components:{"billing-packages-table":_a,"orders-table":Ia,"invoices-table":Fa,"order-modal":le}},La={id:"billing-packages",class:"card card-light"},Ba={class:"card-title"},Ea={class:"card-tools"},Aa={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},Na={type:"button",class:"btn btn-tool"},Ra={key:0,class:"card-body"},za={class:"nav nav-tabs",role:"tablist"},Ya={class:"nav-item"},ja=["onClick"],Ha={class:"badge text-bg-primary"},Wa={class:"tab-content"},xa={class:"active tab-pane"};function Ga(e,t,s,r,n,i){const h=u("order-modal"),d=U("tooltip");return o(),m("div",La,[a("div",{class:"card-header pointer",onClick:t[1]||(t[1]=(...g)=>i.toggleCard&&i.toggleCard(...g))},[a("h3",Ba,l(e.lang("packages")),1),a("div",Ea,[n.loading&&n.cardOpen?M((o(),m("button",Aa,t[2]||(t[2]=[a("i",{class:"fas fa-sync-alt"},null,-1)]))),[[d,e.lang("refresh")]]):p("",!0),n.cardOpen&&n.category==="invoice"?M((o(),m("a",{key:1,class:"btn-tool",onClick:t[0]||(t[0]=g=>i.addInvoice()),href:"javascript:;"},t[3]||(t[3]=[a("i",{class:"fas fa-plus"},null,-1)]))),[[d,e.lang("create_invoice")]]):p("",!0),a("button",Na,[a("i",{class:F([{"fas fa-angle-up":n.cardOpen,"fas fa-angle-down":!n.cardOpen},"fs-25"])},null,2)])])]),n.cardOpen?(o(),m("div",Ra,[a("ul",za,[(o(!0),m(O,null,A(n.tabs,g=>(o(),m("li",Ya,[a("a",{class:F(["nav-link",{active:n.category===g.category}]),"data-bs-toggle":"pill",role:"tab",href:"javascript:;",onClick:f=>i.packages(g.category)},[_(l(e.lang(g.title))+" ",1),a("span",Ha,l(g.count),1)],10,ja)]))),256))]),a("div",Wa,[a("div",xa,[(o(),w(me(i.currentTableComponent),{id:n.org_id,ids:n.user_id,category:n.category,apiEndpoint:n.apiUrl,disableLoader:n.loaderState,onLoaderValue:i.handelLoader},null,40,["id","ids","category","apiEndpoint","disableLoader","onLoaderValue"]))])])])):p("",!0),c(I,{name:"modal"},{default:y(()=>[n.showModal?(o(),w(h,{key:0,showModal:n.showModal,onClose:i.onClose,orgId:n.org_id,userId:n.user_id,title:e.lang("create_invoice")},null,8,["showModal","onClose","orgId","userId","title"])):p("",!0)]),_:1})])}const oe=C(Oa,[["render",Ga],["__scopeId","data-v-0422ad35"]]);const Ka={name:"pending-invoices",data(){return{pending:""}},beforeMount(){this.getCount()},methods:{getCount(){axios.get("/bill/package/get-user-invoice?meta=true&all-users=1&status=0").then(e=>{this.pending=e.data.data.total}).catch(e=>{this.pending=0})}}},Ja={class:"badge text-bg-danger navbar-badge",style:{position:"relative",top:"-7px",left:"-3px","font-weight":"bold"}};function Qa(e,t,s,r,n,i){const h=u("router-link"),d=U("tooltip");return n.pending?(o(),w(h,{key:0,id:"pending-invoices",class:"nav-link font-1",to:"/billing/invoices?status=0"},{default:y(()=>[M((o(),m("span",null,t[0]||(t[0]=[a("i",{class:"far fa-file-pdf"},null,-1)]))),[[d,e.trans("invoices")]]),a("span",Ja,l(n.pending),1)]),_:1})):p("",!0)}const Xa=C(Ka,[["render",Qa]]),Za={name:"bill-options",data(){return{show_packages:1,allowWithoutPackage:1,invoice_due:"",currency:"",loading:!1,hasDataPopulated:!1,pageLoad:!1,currencyOptions:pe()}},beforeMount(){this.getInitialValues()},methods:{getInitialValues(){this.loading=!0,D.get("/bill/api/get-billing-options").then(e=>{this.allowWithoutPackage=Z(e.data.data.allowWithoutPackage),this.currency=e.data.data.currency?e.data.data.currency:"USD",this.invoice_due=e.data.data["invoice-due"]?e.data.data["invoice-due"]:"",this.show_packages=Z(e.data.data.show_packages),this.loading=!1,this.hasDataPopulated=!0}).catch(e=>{this.loading=!1,this.hasDataPopulated=!0})},onChange(e,t){this[t]=e||""},isValid(){const{errors:e,isValid:t}=fe(this.$data);return t},onSubmit(){if(this.isValid()){this.pageLoad=!0;const e={};e.allowWithoutPackage=this.allowWithoutPackage?1:0,e.currency=this.currency,e["invoice-due"]=this.invoice_due,e.show_packages=this.show_packages?1:0,e._method="PATCH",D.post("/bill/api/update-billing-options",e).then(t=>{this.pageLoad=!1,P(t,"bill_settings"),this.getInitialValues()}).catch(t=>{this.pageLoad=!1,V(t,"bill_settings")})}}},components:{"number-field":R,"status-switch":X,"currency-select":ve}},$a={class:"col-sm-12"},en={key:0,class:"row"},tn={key:1,class:"row"},an={class:"form-group col-sm-4"},nn={for:"status"},sn={class:"form-group col-sm-4"},ln={for:"status"},on={key:2,class:"row"},rn={key:0,class:"card-footer"},dn={key:0,class:"row"};function cn(e,t,s,r,n,i){const h=u("alert"),d=u("reuse-loader"),g=u("status-switch"),f=u("number-field"),v=u("currency-select"),b=u("faveo-box"),k=u("custom-loader");return o(),m("div",$a,[c(h,{componentName:"bill_settings"}),c(b,{title:e.trans("bill_settings")},{actions:y(()=>[n.hasDataPopulated?(o(),m("div",rn,[a("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=T=>i.onSubmit())},[t[5]||(t[5]=a("i",{class:"fas fa-save"},null,-1)),_(" "+l(e.trans("save")),1)])])):p("",!0)]),default:y(()=>[!n.hasDataPopulated||n.loading?(o(),m("div",en,[c(d,{"animation-duration":4e3,size:60})])):p("",!0),n.hasDataPopulated?(o(),m("div",tn,[a("div",an,[a("label",nn,l(e.trans("show_packages")),1),t[1]||(t[1]=a("span",{style:{color:"red"}}," *",-1)),t[2]||(t[2]=a("br",null,null,-1)),c(g,{name:"show_packages",value:n.show_packages,onChange:i.onChange,bold:!0},null,8,["value","onChange"])]),a("div",sn,[a("label",ln,l(e.trans("allowWithoutPackage")),1),t[3]||(t[3]=a("span",{style:{color:"red"}}," *",-1)),t[4]||(t[4]=a("br",null,null,-1)),c(g,{name:"allowWithoutPackage",value:n.allowWithoutPackage,onChange:i.onChange,bold:!0},null,8,["value","onChange"])]),c(f,{label:e.trans("invoice-due-by"),value:n.invoice_due,name:"invoice_due",classname:"col-sm-4",onChange:i.onChange,type:"number",required:!0},null,8,["label","value","onChange"])])):p("",!0),n.hasDataPopulated?(o(),m("div",on,[c(v,{name:"currency",classname:"col-sm-4 faveo-dynamic-select",options:n.currencyOptions,label:e.lang("currency"),value:n.currency,onChange:i.onChange,required:!0},null,8,["options","label","value","onChange"])])):p("",!0)]),_:1},8,["title"]),n.pageLoad?(o(),m("div",dn,[c(k,{duration:4e3})])):p("",!0)])}const un=C(Za,[["render",cn]]);function mn(e){let t={};for(var s in e.extraTextFields)t[e.extraTextFields[s].name]=[e.extraTextFields[s].value,"isRequired"];const r=new j(S),{errors:n,isValid:i}=r.validate(t);return L.dispatch("setValidationError",n),{errors:n,isValid:i}}const pn={name:"settings-modal",description:"Settings Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},title:{type:String,default:""},data:{type:Object}},data:()=>({isDisabled:!0,containerStyle:{width:"800px"},loading:!0,size:60,status:0,name:"",gateway_name:"",is_default:!1,checkDisabled:!1,extraTextFields:[],extraSwitchFields:[],extraFields:{}}),beforeMount(){this.getValues()},methods:{getValues(){let e=this.data.gateway_name?"/bill/gateway/"+this.data.name+"/"+this.data.gateway_name:"/bill/gateway/"+this.data.name;D.get(e).then(t=>{this.loading=!1,this.isDisabled=!1;let s=t.data.data;this.name=s.name,this.gateway_name=s.gateway_name,this.status=s.status,this.is_default=s.is_default,this.checkDisabled=s.is_default!==0,this.extraFields=s.extra;for(var r in s.extra)s.extra[r].name!=="testMode"?(s.extra[r].value=s.extra[r].value==null?"":s.extra[r].value,this.extraTextFields.push(s.extra[r])):this.extraSwitchFields.push(s.extra[r])}).catch(t=>{this.loading=!1,this.isDisabled=!1})},isValid(){const{errors:e,isValid:t}=mn(this.$data);return!!t},onChange(e,t){this[t]=e;for(var s in this.extraTextFields)this.extraTextFields[s].name===t&&(this.extraTextFields[s].value=e);for(var s in this.extraSwitchFields)this.extraSwitchFields[s].name===t&&(this.extraSwitchFields[s].value=e)},onSubmit(){if(this.isValid()){let t={};for(var e in this.extraFields)t[this.extraFields[e].name]=this.extraFields[e].value;this.loading=!0,this.isDisabled=!0;let s={};s.name=this.name,this.gateway_name&&(s.gateway_name=this.gateway_name),s.is_default=this.is_default===!1||this.is_default===0?0:1,s.status=this.status==!1?0:1,Object.keys(t).length>0&&(s.extra=t),D.post("/bill/update/gateway",s).then(r=>{this.loading=!1,this.isDisabled=!1,P(r,"dataTableModal"),window.emitter.emit("refreshData"),this.onClose()}).catch(r=>{this.loading=!1,this.isDisabled=!1,V(r,"dataTableModal")})}}},components:{"text-field":G,"dynamic-select":J,"status-switch":X}},hn={class:"modal-title"},_n={key:0},gn={class:"row"},bn={class:"col-sm-2"},yn={for:"package",class:"col-sm-12 control-label"},fn={class:"col-sm-2"},vn={class:"row"},kn={class:"col-sm-12 control-label"},wn={class:"col-sm-2"},Cn={class:"row"},Dn={class:"form-group col-md-12",id:"align"},Mn={class:"label_align"},Sn=["disabled"],Vn={key:1,class:"row"},Pn=["disabled"];function In(e,t,s,r,n,i){const h=u("text-field"),d=u("status-switch"),g=u("reuse-loader"),f=u("modal"),v=U("focus-first-input");return s.showModal?(o(),w(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",hn,l(e.lang(s.title)),1)]),fields:y(()=>[e.loading?p("",!0):(o(),m("div",_n,[M((o(),m("div",gn,[c(h,{label:e.lang("name"),value:e.name,type:"text",name:"name",disabled:!0,onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-5"},null,8,["label","value","onChange","placehold"]),c(h,{label:e.lang("gateway_name"),value:e.gateway_name,type:"text",name:"gateway_name",disabled:!0,onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-5"},null,8,["label","value","onChange","placehold"]),a("div",bn,[a("label",yn,l(e.lang("status")),1),a("div",fn,[c(d,{name:"status",value:e.status,onChange:i.onChange,classname:"pull-left",bold:!0},null,8,["value","onChange"])])])])),[[v]]),a("div",vn,[(o(!0),m(O,null,A(e.extraTextFields,(b,k)=>(o(),w(h,{key:b.index,label:e.lang(b.name),value:b.value,type:"text",name:b.name,onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-5",required:!0},null,8,["label","value","name","onChange","placehold"]))),128)),(o(!0),m(O,null,A(e.extraSwitchFields,(b,k)=>(o(),m("div",{key:b.index,class:"col-sm-2"},[a("label",kn,l(e.lang(b.name)),1),a("div",wn,[c(d,{name:b.name,value:b.value,onChange:i.onChange,classname:"pull-left",bold:!0},null,8,["name","value","onChange"])])]))),128))]),a("div",Cn,[a("div",Dn,[a("label",Mn,[M(a("input",{class:"checkbox_align",type:"checkbox",name:"default","onUpdate:modelValue":t[0]||(t[0]=b=>e.is_default=b),disabled:e.checkDisabled},null,8,Sn),[[te,e.is_default]]),_(" "+l(e.lang("make-default-payment-gateway")),1)])])])])),e.loading?(o(),m("div",Vn,[c(g,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):p("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=b=>i.onSubmit()),class:"btn btn-primary",disabled:e.isDisabled},[t[2]||(t[2]=a("i",{class:"fas fa-sync","aria-hidden":"true"},null,-1)),_(" "+l(e.lang("update")),1)],8,Pn)]),_:1},8,["showModal","onClose","containerStyle"])):p("",!0)}const qn=C(pn,[["render",In],["__scopeId","data-v-9ab82139"]]),Un={name:"payments",description:"Payments data table component",data(){return{base:window.axios.defaults.baseURL,columns:["name","gateway_name","is_default","status","action"],options:{},apiUrl:"/bill/get-gateways-list",showModal:!1,data:{}}},beforeMount(){const e=this;this.options={headings:{name:this.trans("name"),gateway_name:this.trans("gateway_name"),is_default:this.trans("is_default"),status:this.trans("status"),action:this.trans("action")},texts:{filter:"",limit:""},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},templates:{status:(t,s)=>e.h(ie,{data:s}),action:function(t,s){let r=e.h("i",{class:"fa fa-cogs"});return e.h("button",{class:"btn btn-primary btn-sm",onClick(n){e.onClick(s)}},[r])},is_default:(t,s)=>e.h(ke,{data:s})},sortable:["name","gateway_name","is_default","status"],filterable:["name","gateway_name","is_default","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.data.length}},orderBy:{column:"id",ascending:!0}}},methods:{onClick(e){this.data=e,this.showModal=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"payment-settings-modal":qn}},Tn={class:"col-sm-12"},Fn={class:"card card-light"},On={class:"card-header"},Ln={class:"card-title",id:"payment-title"},Bn={class:"card-body"};function En(e,t,s,r,n,i){const h=u("alert"),d=u("data-table"),g=u("payment-settings-modal");return o(),m("div",Tn,[c(h,{componentName:"dataTableModal"}),a("div",Fn,[a("div",On,[a("h3",Ln,l(e.lang("list_of_payment_gateways")),1)]),a("div",Bn,[c(d,{url:n.apiUrl,dataColumns:n.columns,option:n.options,scroll_to:"payment-title"},null,8,["url","dataColumns","option"])]),c(I,{name:"modal"},{default:y(()=>[n.showModal?(o(),w(g,{key:0,title:"settings",onClose:i.onClose,showModal:n.showModal,data:n.data},null,8,["onClose","showModal","data"])):p("",!0)]),_:1})])])}const An=C(Un,[["render",En]]),Nn={name:"pacakges",description:"Pacakges data table component",data(){return{base:window.axios.defaults.baseURL,columns:["id","name","validity","allowed_tickets","price","status","action"],options:{},apiUrl:"/bill/package/get-inbox-data",selectedData:[],showModal:!1,deleteUrl:""}},beforeMount(){const e=this;this.options={headings:{id:this.trans("id"),name:this.trans("name"),validity:this.trans("validity"),allowed_tickets:this.trans("incident_credit"),price:this.trans("price"),status:this.trans("status"),action:this.trans("action")},texts:{filter:"",limit:""},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},templates:{status:(t,s)=>e.h(ie,{data:s}),action:(t,s)=>e.h(ae,{data:s}),validity(t,s){return s.validity===null?S("one_time"):S(s.validity)}},sortable:["name","validity","allowed_tickets","price","status"],filterable:["name","validity","allowed_tickets","price","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.message.data.map(s=>(s.edit_url="/billing/package/"+s.id+"/edit",s)),count:t.message.total}},orderBy:{column:"id",ascending:!0}}},methods:{packages(e){this.selectedData=e},deletePackage(){this.deleteUrl="bill/package/delete?package_ids="+this.selectedData,this.showModal=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"delete-modal":ne}},Rn={class:"col-sm-12"},zn={class:"card card-light"},Yn={class:"card-header"},jn={class:"card-title",id:"pack-title"},Hn={class:"card-tools"},Wn={class:"card-body"};function xn(e,t,s,r,n,i){const h=u("alert"),d=u("router-link"),g=u("data-table"),f=u("delete-modal"),v=U("tooltip");return o(),m("div",Rn,[c(h,{componentName:"dataTableModal"}),a("div",zn,[a("div",Yn,[a("h3",jn,l(e.lang("list_of_packages")),1),a("div",Hn,[M((o(),w(d,{class:"btn btn-tool",to:"/billing/package/create"},{default:y(()=>t[1]||(t[1]=[a("span",{class:"glyphicon glyphicon-plus"},null,-1)])),_:1})),[[v,e.lang("create-package")]]),n.selectedData.length>0?M((o(),m("a",{key:0,class:"btn btn-tool",onClick:t[0]||(t[0]=b=>i.deletePackage())},t[2]||(t[2]=[a("span",{class:"fas fa-trash"},null,-1)]))),[[v,e.lang("delete-package")]]):p("",!0)])]),a("div",Wn,[c(g,{url:n.apiUrl,dataColumns:n.columns,option:n.options,scroll_to:"pack-title",tickets:i.packages},null,8,["url","dataColumns","option","tickets"])]),c(I,{name:"modal"},{default:y(()=>[n.showModal?(o(),w(f,{key:0,onClose:i.onClose,showModal:n.showModal,deleteUrl:n.deleteUrl},null,8,["onClose","showModal","deleteUrl"])):p("",!0)]),_:1})])])}const Gn=C(Nn,[["render",xn]]);function Kn(e){const{name:t,display_order:s,description:r,allowed_tickets:n,price:i,validity:h,kb_link:d,month_definition:g,selected_option:f,credit_type:v}=e;let b={name:[t,"isRequired"],display_order:[s,"minValue(1)","isRequired"],description:[r,"isRequired"],price:[i,"isRequired"],allowed_tickets:[n,"isRequired"],validity:[h,"isRequired"],kb_link:[d,"isUrl"]};e.credit_type!="all"&&(e.selected_option=="after_specific_number_of_days"&&(b.month_definition=[g,"isRequired","maxValue(31)","minValue(1)"]),b.selected_option=[f,"isRequired"]);const k=new j(S),{errors:T,isValid:x}=k.validate(b);return L.dispatch("setValidationError",T),{errors:T,isValid:x}}const Jn={name:"time-field",description:"time field component along with error block",props:{label:{type:String,required:!0},hint:{type:String,default:""},value:{required:!0},name:{type:String,required:!0},type:{type:String,default:"text"},onChange:{type:Function,Required:!0},classname:{type:String,default:""},required:{type:Boolean,default:!1},labelStyle:{type:Object},formStyle:{type:Object}},data(){return{yearsValue:0,monthsValue:0,daysValue:0,hoursValue:0,minutesValue:0}},created(){window.emitter.on("removeVal",this.initialState)},mounted(){this.value===""?(this.yearsValue=0,this.monthsValue=0,this.daysValue=0,this.hoursValue=0):(this.yearsValue=this.value.years,this.monthsValue=this.value.months,this.daysValue=this.value.days,this.hoursValue=this.value.hours)},methods:{onInput(){let e={years:this.yearsValue,months:this.monthsValue,days:this.daysValue,hours:this.hoursValue};this.onChange(e,this.name)},checkValue(e){e=e||window.event;var t=e.which?e.which:e.keyCode;if(t>31&&(t<48||t>57))e.preventDefault();else return!0},onPaste(e){e=e||window.event,e.preventDefault()},initialState(){this.hoursValue=0,this.monthsValue=0,this.yearssValue=0,this.daysValue=0}},components:{"form-field-template":he}},Qn={class:"inline"},Xn=["type"],Zn=["type"],$n=["type"],es=["type"];function ts(e,t,s,r,n,i){const h=u("form-field-template");return o(),w(h,{label:s.label,labelStyle:s.labelStyle,name:s.name,classname:s.classname,hint:s.hint,required:s.required},{default:y(()=>[a("span",Qn,[M(a("input",{class:"form-control",style:B(s.formStyle),maxlength:"4",type:s.type,id:"txtYears","onUpdate:modelValue":t[0]||(t[0]=d=>n.yearsValue=d),onInput:t[1]||(t[1]=d=>i.onInput()),placeholder:"0",onKeypress:t[2]||(t[2]=(...d)=>i.checkValue&&i.checkValue(...d)),onPaste:t[3]||(t[3]=(...d)=>i.onPaste&&i.onPaste(...d))},null,44,Xn),[[Y,n.yearsValue]]),_(" "+l(e.lang("years"))+" ",1),M(a("input",{class:"form-control",style:B(s.formStyle),maxlength:"4",type:s.type,id:"txtMonths","onUpdate:modelValue":t[4]||(t[4]=d=>n.monthsValue=d),onInput:t[5]||(t[5]=d=>i.onInput()),placeholder:"0",onKeypress:t[6]||(t[6]=(...d)=>i.checkValue&&i.checkValue(...d)),onPaste:t[7]||(t[7]=(...d)=>i.onPaste&&i.onPaste(...d))},null,44,Zn),[[Y,n.monthsValue]]),_(" "+l(e.lang("months"))+" ",1),M(a("input",{class:"form-control",style:B(s.formStyle),maxlength:"4",type:s.type,id:"txtDays","onUpdate:modelValue":t[8]||(t[8]=d=>n.daysValue=d),onInput:t[9]||(t[9]=d=>i.onInput()),placeholder:"0",onKeypress:t[10]||(t[10]=(...d)=>i.checkValue&&i.checkValue(...d)),onPaste:t[11]||(t[11]=(...d)=>i.onPaste&&i.onPaste(...d))},null,44,$n),[[Y,n.daysValue]]),_(" "+l(e.lang("days"))+" ",1),M(a("input",{class:"form-control",style:B(s.formStyle),maxlength:"4",type:s.type,id:"txtHours","onUpdate:modelValue":t[12]||(t[12]=d=>n.hoursValue=d),onInput:t[13]||(t[13]=d=>i.onInput()),placeholder:"0",onKeypress:t[14]||(t[14]=(...d)=>i.checkValue&&i.checkValue(...d)),onPaste:t[15]||(t[15]=(...d)=>i.onPaste&&i.onPaste(...d))},null,44,es),[[Y,n.hoursValue]]),_(" "+l(e.lang("hours")),1)])]),_:1},8,["label","labelStyle","name","classname","hint","required"])}const as=C(Jn,[["render",ts],["__scopeId","data-v-5f058f9b"]]),ns={name:"pacakges",description:"Pacakges data table component",setup(){const e=W();return{getUserData:q(()=>e.getters.getUserData)}},data(){return{base:"",name:"",credit_type:"all",description:"",display_order:"",status:0,radioOptions:[{name:"ticket_credit_overall",value:"all"},{name:"ticket_credit_monthly",value:"monthly"}],is_private:0,cycle_options:[{id:"one_time",name:"One time"},{id:"monthly",name:"Monthly"},{id:"quarterly",name:"Quarterly"},{id:"semi_annually",name:"Semi annually"},{id:"annually",name:"Annually"}],validity:"one_time",title:"create_new_package",iconClass:"fas fa-save",btnName:"save",loading:!1,loadingSpeed:4e3,hasDataPopulated:!0,package_id:"",formStyle:{width:"15%"},price:"",allowed_tickets:"",package_pic:"",kb_link:"",departments:[],month_definition:31,createOption:[{id:"end_of_each_month",name:"At the end of each month"},{id:"after_specific_number_of_days",name:"After x days of credit purchase"}],selected_option:"end_of_each_month"}},watch:{getUserData(e,t){return this.base=e.system_url,e}},beforeMount(){const e=window.location.pathname;this.getValues(e),this.validity=="monthly"&&(this.radioOptions=[{name:"ticket_credit_overall",value:"all"}],this.credit_type="all")},created(){this.getUserData.system_url&&(this.base=this.getUserData.system_url)},methods:{getValues(e){const t=E(e);e.indexOf("edit")>=0?(this.title="edit-package",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,D.get("/api/bill/package/edit/"+e).then(t=>{this.package_id=e,this.hasDataPopulated=!0,this.loading=!1,this.updateStatesWithData(t.data.data)}).catch(t=>{V(t),this.hasDataPopulated=!0,this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(r=>{s.hasOwnProperty(r)&&(t[r]=e[r])}),this.credit_type=e.allowed_tickets_period,this.validity=="monthly"&&(this.radioOptions=[{name:"ticket_credit_overall",value:"all"}],this.credit_type="all"),this.month_definition.includes("-days")?(this.selected_option="after_specific_number_of_days",this.month_definition=this.month_definition.replace("-days","")):(this.selected_option="end_of_each_month",this.month_definition=0)},isValid(){const{errors:e,isValid:t}=Kn(this.$data);return!!t},onSubmit(){if(this.kb_link=this.kb_link===null?"":this.kb_link,this.isValid()){this.loadingSpeed=8e3,this.loading=!0;var e=new FormData;this.package_id!=""&&e.append("id",parseInt(this.package_id)),e.append("name",this.name),e.append("status",this.status===!0||this.status===1?1:0),e.append("is_private",this.is_private===!0||this.is_private===1?1:0),e.append("description",this.description),e.append("display_order",this.display_order),e.append("price",parseInt(this.price)),e.append("validity",this.validity),this.departments.length>0&&e.append("departments",this.departments.map(s=>s.id)),e.append("period",this.credit_type),e.append("allowed_tickets",this.allowed_tickets),this.package_pic&&this.package_pic.id?e.append("package_pic_id",this.package_pic.id):this.package_pic===null?e.append("package_pic",""):this.package_pic.length===1?e.append("package_pic",this.package_pic.shift()):e.append("package_pic",this.package_pic),e.append("kb_link",this.kb_link),this.credit_type!=="all"&&e.append("month_definition",this.selected_option=="after_specific_number_of_days"?this.month_definition+"-days":"months_end");const t={headers:{"Content-Type":"multipart/form-data"}};D.post("/bill/package/store-update",e,t).then(s=>{this.loading=!1,P(s,"package"),this.package_id===""?setTimeout(()=>{this.$router.push({name:"Packages Index"})},3e3):this.getInitialValues(this.package_id)}).catch(s=>{this.loading=!1,V(s,"package")})}},onChange(e,t){this[t]=e,t=="validity"&&(e=="monthly"?(this.radioOptions=[{name:"ticket_credit_overall",value:"all"}],this.credit_type="all",this.selected_option="end_of_each_month"):(this.radioOptions=[{name:"ticket_credit_overall",value:"all"},{name:"ticket_credit_monthly",value:"monthly"}],this.credit_type=this.credit_type))}},components:{"text-field":G,"number-field":R,"radio-button":_e,"static-select":H,"dynamic-select":J,"status-switch":X,"time-field":as,"file-upload":ge}},ss={class:"col-sm-12"},is={key:0,class:"row"},ls={key:1,class:"card card-light"},os={class:"card-header"},rs={class:"card-title"},ds={class:"card-body"},cs={class:"row"},us={class:"row"},ms={class:"row"},ps={class:"col-sm-2"},hs={for:"package",class:"col-sm-12 control-label"},_s={class:"col-sm-2"},gs={class:"col-sm-2"},bs={for:"package",class:"col-sm-12 control-label"},ys={class:"col-sm-2"},fs={key:0,class:"row"},vs={class:"row"},ks={class:"row"},ws={class:"card-footer"},Cs=["disabled"];function Ds(e,t,s,r,n,i){const h=u("custom-loader"),d=u("alert"),g=u("text-field"),f=u("number-field"),v=u("dynamic-select"),b=u("static-select"),k=u("radio-button"),T=u("status-switch"),x=u("file-upload"),re=U("focus-first-input");return o(),m("div",ss,[n.hasDataPopulated===!1||n.loading===!0?(o(),m("div",is,[c(h,{duration:n.loadingSpeed},null,8,["duration"])])):p("",!0),c(d,{componentName:"package"}),n.hasDataPopulated===!0?(o(),m("div",ls,[a("div",os,[a("h3",rs,l(e.lang(n.title)),1)]),a("div",ds,[M((o(),m("div",cs,[c(g,{label:e.lang("name"),value:n.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-4",required:!0},null,8,["label","value","onChange","placehold"]),c(f,{label:e.lang("display_order"),value:n.display_order,name:"display_order",classname:"col-sm-4",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"]),c(v,{label:e.lang("departments"),multiple:!0,name:"departments",prePopulate:!0,classname:"col-sm-4",apiEndpoint:"/api/dependency/departments",value:n.departments,onChange:i.onChange},null,8,["label","value","onChange"])])),[[re]]),a("div",us,[c(g,{label:e.lang("description"),value:n.description,type:"textarea",name:"description",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12",required:!0},null,8,["label","value","onChange","placehold"])]),a("div",ms,[c(b,{label:e.lang("billing_cycle"),elements:n.cycle_options,name:"validity",value:n.validity,classname:"col-sm-4",onChange:i.onChange,required:!0},null,8,["label","elements","value","onChange"]),c(k,{options:n.radioOptions,label:e.lang("credit_type"),name:"credit_type",value:n.credit_type,onChange:i.onChange,classname:"form-group col-sm-4"},null,8,["options","label","value","onChange"]),a("div",ps,[a("label",hs,l(e.lang("status")),1),a("div",_s,[c(T,{name:"status",value:n.status,onChange:i.onChange,classname:"pull-left",bold:!0},null,8,["value","onChange"])])]),a("div",gs,[a("label",bs,l(e.lang("private")),1),a("div",ys,[c(T,{name:"is_private",value:n.is_private,onChange:i.onChange,classname:"pull-left",bold:!0},null,8,["value","onChange"])])])]),n.credit_type!="all"?(o(),m("div",fs,[c(b,{value:n.selected_option,name:"selected_option",elements:n.createOption,label:e.lang("monthly_credit_reset_duration"),onChange:i.onChange,classname:"col-sm-6","hide-empty-select":!0,hint:e.lang("package_schedule"),required:!0},null,8,["value","elements","label","onChange","hint"]),n.selected_option!=="end_of_each_month"?(o(),w(f,{key:0,value:n.month_definition,name:"month_definition",label:e.lang("number_of_days"),type:"number",onChange:i.onChange,placeholder:"n",classname:"col-sm-6",required:!0},null,8,["value","label","onChange"])):p("",!0)])):p("",!0),a("div",vs,[c(f,{label:e.lang("incident_credit"),value:n.allowed_tickets,name:"allowed_tickets",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"]),c(f,{label:e.lang("price"),value:n.price,name:"price",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"])]),a("div",ks,[c(g,{label:e.lang("terms_conditions_page_link"),value:n.kb_link,type:"text",name:"kb_link",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6"},null,8,["label","value","onChange","placehold"]),c(x,{label:e.lang("image"),value:n.package_pic,name:"package_pic",onChange:i.onChange,classname:"col-sm-6",accept:"image/*"},null,8,["label","value","onChange"])])]),a("div",ws,[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=Is=>i.onSubmit()),disabled:n.loading,class:"btn btn-primary"},[a("span",{class:F(n.iconClass)},null,2),_(" "+l(e.lang(n.btnName)),1)],8,Cs)])])):p("",!0)])}const ee=C(ns,[["render",Ds]]);let Ms=[{path:"/bill",component:$,name:"Packages",redirect:"/bill/package/:id/user-invoice",children:[{path:"package/:id/user-invoice",component:wt,name:"Package Invoice",meta:{title:"user_invoice",crumb:{active:"user_invoice"}}},{path:"order/:id/",component:ma,name:"Order Details",meta:{title:"order_details",crumb:{active:"order_details"}}}]},{path:"/billing",component:$,name:"Invoices",redirect:"/billing/invoices",children:[{path:"invoices",component:Wt,name:"Billing Invoice",meta:{title:"invoices",crumb:{active:"invoices"}}}]}];Ms.forEach(function(e){be.addRoute(e)});Q("billing-packages",oe,"user-page-mounted","user-page-table");Q("billing-packages",oe,"org-page-mounted","org-page-div");Q("pending-invoices",Xa,"navbar-mounted","nav-id");let Ss={path:"/billing",component:se,name:"Billing",redirect:"/billing/settings",children:[{path:"settings",component:un,name:"BillOptions",meta:{title:"bill",crumb:{link:{name:"admin_panel",to:"/"},active:"bill"}}},{path:"payment-gateways",component:An,name:"PaymentIndex",meta:{title:"payment_gateway",crumb:{link:{name:"admin_panel",to:"/"},active:"payment_gateway"}}}]},Vs={path:"/billing/package",component:se,name:"Billing Packages",redirect:"/billing/package/list",children:[{path:"list",component:Gn,name:"Packages Index",meta:{title:"packages",crumb:{link:{name:"admin_panel",to:"/"},active:"packages"}}},{path:"create",component:ee,name:"Package Create",meta:{title:"packages",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"packages",to:"/billing/package"},active:"packages"}}},{path:":id/edit",component:ee,name:"Package Edit",meta:{title:"packages",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"packages",to:"/billing/package"},active:"packages"}}}]},Ps=[Ss,Vs];Ps.forEach(function(e){ye.addRoute(e)});L.dispatch("deleteUser");L.dispatch("updateUser");
